[0m13:42:43.567466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb494190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb495f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb4955d0>]}


============================== 13:42:43.575176 | e98740eb-205d-4368-9d8d-2463a64ef625 ==============================
[0m13:42:43.575176 [info ] [MainThread]: Running with dbt=1.9.0
[0m13:42:43.576087 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/logs', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt init dbt_project', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:42:43.582351 [warn ] [MainThread]: [ConfigFolderDirectory]: Unable to parse logging event dictionary. Failed to parse dir field: expected string or bytes-like object, got 'PosixPath'.. Dictionary: {'dir': PosixPath('/root/.dbt')}
[0m13:42:43.582827 [info ] [MainThread]: Creating dbt configuration folder at 
[0m13:42:43.586380 [info ] [MainThread]: Setting up your profile.
[0m13:45:26.273293 [error] [MainThread]: Encountered an error:

[0m13:45:26.284671 [error] [MainThread]: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/main.py", line 477, in init
    results = task.run()
              ^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/init.py", line 320, in run
    self.setup_profile(profile_name)
  File "/usr/local/lib/python3.11/site-packages/dbt/task/init.py", line 262, in setup_profile
    self.create_profile_from_target(adapter, profile_name=profile_name)
  File "/usr/local/lib/python3.11/site-packages/dbt/task/init.py", line 179, in create_profile_from_target
    self.create_profile_from_profile_template(profile_template, profile_name)
  File "/usr/local/lib/python3.11/site-packages/dbt/task/init.py", line 163, in create_profile_from_profile_template
    target = self.generate_target_from_input(prompts, initial_target)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/init.py", line 129, in generate_target_from_input
    target[key] = click.prompt(
                  ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/click/termui.py", line 164, in prompt
    value = prompt_func(prompt)
            ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/click/termui.py", line 147, in prompt_func
    raise Abort() from None
click.exceptions.Abort

[0m13:45:26.289988 [debug] [MainThread]: Resource report: {"command_name": "init", "command_success": false, "command_wall_clock_time": 162.76894, "process_in_blocks": "216", "process_kernel_time": 0.086099, "process_mem_max_rss": "121972", "process_out_blocks": "78", "process_user_time": 1.149331}
[0m13:45:26.291973 [debug] [MainThread]: Command `dbt init` failed at 13:45:26.291499 after 162.77 seconds
[0m13:45:26.293416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb497850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb4e7790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffed4d090>]}
[0m13:45:26.294442 [debug] [MainThread]: Flushing usage events
[0m13:45:28.106733 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:47:02.979037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1602d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb181a850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1903790>]}


============================== 13:47:02.980429 | 2e0e95bd-fff7-4dc1-a7b2-1e94ac3a28d3 ==============================
[0m13:47:02.980429 [info ] [MainThread]: Running with dbt=1.9.0
[0m13:47:02.980901 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt init dbt_project', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:47:02.984413 [warn ] [MainThread]: [ConfigFolderDirectory]: Unable to parse logging event dictionary. Failed to parse dir field: expected string or bytes-like object, got 'PosixPath'.. Dictionary: {'dir': PosixPath('/root/.dbt')}
[0m13:47:02.984712 [info ] [MainThread]: Creating dbt configuration folder at 
[0m13:47:02.987205 [info ] [MainThread]: Setting up your profile.
[0m13:48:15.079400 [info ] [MainThread]: Profile snowflake written to /root/.dbt/profiles.yml using target's profile_template.yml and your supplied values. Run 'dbt debug' to validate the connection.
[0m13:48:15.082810 [debug] [MainThread]: Resource report: {"command_name": "init", "command_success": true, "command_wall_clock_time": 72.12278, "process_in_blocks": "0", "process_kernel_time": 0.063037, "process_mem_max_rss": "98416", "process_out_blocks": "11", "process_user_time": 0.593355}
[0m13:48:15.084007 [debug] [MainThread]: Command `dbt init` succeeded at 13:48:15.083824 after 72.12 seconds
[0m13:48:15.084851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb160c0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb14321d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2103650>]}
[0m13:48:15.085767 [debug] [MainThread]: Flushing usage events
[0m13:48:16.489773 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:48:29.557018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa83a550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa687990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa6879d0>]}


============================== 13:48:29.558399 | edcbcf64-6fb8-445c-81bd-5c63d662ca6b ==============================
[0m13:48:29.558399 [info ] [MainThread]: Running with dbt=1.9.0
[0m13:48:29.558757 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:48:29.562495 [info ] [MainThread]: dbt version: 1.9.0
[0m13:48:29.562770 [info ] [MainThread]: python version: 3.11.11
[0m13:48:29.563086 [info ] [MainThread]: python path: /usr/local/bin/python3.11
[0m13:48:29.563325 [info ] [MainThread]: os info: Linux-6.10.14-linuxkit-aarch64-with-glibc2.36
[0m13:48:29.582630 [info ] [MainThread]: Using profiles dir at /root/.dbt
[0m13:48:29.582918 [info ] [MainThread]: Using profiles.yml file at /root/.dbt/profiles.yml
[0m13:48:29.583165 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt_project.yml
[0m13:48:29.583499 [info ] [MainThread]: adapter type: postgres
[0m13:48:29.583750 [info ] [MainThread]: adapter version: 1.9.0
[0m13:48:29.620660 [info ] [MainThread]: Configuration:
[0m13:48:29.620930 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m13:48:29.621145 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m13:48:29.621362 [info ] [MainThread]: Required dependencies:
[0m13:48:29.621559 [debug] [MainThread]: Executing "git --help"
[0m13:48:29.622105 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m13:48:29.622340 [info ] [MainThread]: Connection:
[0m13:48:29.622596 [info ] [MainThread]:   host: postgres
[0m13:48:29.622808 [info ] [MainThread]:   port: 5432
[0m13:48:29.623058 [info ] [MainThread]:   user: airflow
[0m13:48:29.623344 [info ] [MainThread]:   database: airflow
[0m13:48:29.623567 [info ] [MainThread]:   schema: staging
[0m13:48:29.623831 [info ] [MainThread]:   connect_timeout: 10
[0m13:48:29.624028 [info ] [MainThread]:   role: None
[0m13:48:29.624228 [info ] [MainThread]:   search_path: None
[0m13:48:29.624449 [info ] [MainThread]:   keepalives_idle: 0
[0m13:48:29.624661 [info ] [MainThread]:   sslmode: None
[0m13:48:29.624929 [info ] [MainThread]:   sslcert: None
[0m13:48:29.625122 [info ] [MainThread]:   sslkey: None
[0m13:48:29.625379 [info ] [MainThread]:   sslrootcert: None
[0m13:48:29.625554 [info ] [MainThread]:   application_name: dbt
[0m13:48:29.625768 [info ] [MainThread]:   retries: 1
[0m13:48:29.626136 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:48:29.652459 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m13:48:29.662208 [debug] [MainThread]: Using postgres connection "debug"
[0m13:48:29.662435 [debug] [MainThread]: On debug: select 1 as id
[0m13:48:29.662640 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:48:29.665659 [debug] [MainThread]: SQL status: SELECT 1 in 0.003 seconds
[0m13:48:29.666077 [debug] [MainThread]: On debug: Close
[0m13:48:29.666247 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m13:48:29.666430 [info ] [MainThread]: [31m1 check failed:[0m
[0m13:48:29.666650 [info ] [MainThread]: Error from git --help: Could not find command, ensure it is in the user's PATH: "git"

[0m13:48:29.667216 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.13090076, "process_in_blocks": "40", "process_kernel_time": 0.062929, "process_mem_max_rss": "108216", "process_out_blocks": "48", "process_user_time": 0.633291}
[0m13:48:29.667449 [debug] [MainThread]: Command `dbt debug` failed at 13:48:29.667395 after 0.13 seconds
[0m13:48:29.667636 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m13:48:29.667802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa83bd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa6b4f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa6b7550>]}
[0m13:48:29.668035 [debug] [MainThread]: Flushing usage events
[0m13:48:30.995154 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:58:47.754316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84a372d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84a37890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84a36f90>]}


============================== 13:58:47.756373 | 459d0d81-d590-418b-b1da-ad7bd1977367 ==============================
[0m13:58:47.756373 [info ] [MainThread]: Running with dbt=1.9.0
[0m13:58:47.756820 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:58:47.761120 [info ] [MainThread]: dbt version: 1.9.0
[0m13:58:47.761437 [info ] [MainThread]: python version: 3.11.11
[0m13:58:47.761755 [info ] [MainThread]: python path: /usr/local/bin/python3.11
[0m13:58:47.762064 [info ] [MainThread]: os info: Linux-6.10.14-linuxkit-aarch64-with-glibc2.36
[0m13:58:47.783653 [info ] [MainThread]: Using profiles dir at /root/.dbt
[0m13:58:47.784048 [info ] [MainThread]: Using profiles.yml file at /root/.dbt/profiles.yml
[0m13:58:47.784324 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt_project.yml
[0m13:58:47.784644 [info ] [MainThread]: adapter type: postgres
[0m13:58:47.784857 [info ] [MainThread]: adapter version: 1.9.0
[0m13:58:47.822873 [info ] [MainThread]: Configuration:
[0m13:58:47.823177 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m13:58:47.823437 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m13:58:47.823686 [info ] [MainThread]: Required dependencies:
[0m13:58:47.823971 [debug] [MainThread]: Executing "git --help"
[0m13:58:47.824434 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m13:58:47.824652 [info ] [MainThread]: Connection:
[0m13:58:47.824906 [info ] [MainThread]:   host: postgres
[0m13:58:47.825157 [info ] [MainThread]:   port: 5432
[0m13:58:47.825384 [info ] [MainThread]:   user: airflow
[0m13:58:47.825653 [info ] [MainThread]:   database: airflow
[0m13:58:47.825869 [info ] [MainThread]:   schema: staging
[0m13:58:47.826125 [info ] [MainThread]:   connect_timeout: 10
[0m13:58:47.826395 [info ] [MainThread]:   role: None
[0m13:58:47.826603 [info ] [MainThread]:   search_path: None
[0m13:58:47.826821 [info ] [MainThread]:   keepalives_idle: 0
[0m13:58:47.827047 [info ] [MainThread]:   sslmode: None
[0m13:58:47.827288 [info ] [MainThread]:   sslcert: None
[0m13:58:47.827546 [info ] [MainThread]:   sslkey: None
[0m13:58:47.827782 [info ] [MainThread]:   sslrootcert: None
[0m13:58:47.828026 [info ] [MainThread]:   application_name: dbt
[0m13:58:47.828218 [info ] [MainThread]:   retries: 1
[0m13:58:47.828544 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:58:47.852175 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m13:58:47.863526 [debug] [MainThread]: Using postgres connection "debug"
[0m13:58:47.863774 [debug] [MainThread]: On debug: select 1 as id
[0m13:58:47.863979 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:58:47.867854 [debug] [MainThread]: SQL status: SELECT 1 in 0.004 seconds
[0m13:58:47.868430 [debug] [MainThread]: On debug: Close
[0m13:58:47.868649 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m13:58:47.868891 [info ] [MainThread]: [31m1 check failed:[0m
[0m13:58:47.869356 [info ] [MainThread]: Error from git --help: Could not find command, ensure it is in the user's PATH: "git"

[0m13:58:47.869976 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.13755909, "process_in_blocks": "0", "process_kernel_time": 0.093943, "process_mem_max_rss": "108048", "process_out_blocks": "8", "process_user_time": 0.665601}
[0m13:58:47.870273 [debug] [MainThread]: Command `dbt debug` failed at 13:58:47.870221 after 0.14 seconds
[0m13:58:47.870483 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m13:58:47.870699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8488ccd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85537690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83e11e50>]}
[0m13:58:47.870942 [debug] [MainThread]: Flushing usage events
[0m13:58:49.403157 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:19:42.753175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e933ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e783710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ea68890>]}


============================== 14:19:42.754798 | 05a1bfb2-55b9-41ac-bcce-3d3517b01e0d ==============================
[0m14:19:42.754798 [info ] [MainThread]: Running with dbt=1.9.0
[0m14:19:42.755198 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:19:42.759000 [info ] [MainThread]: dbt version: 1.9.0
[0m14:19:42.759264 [info ] [MainThread]: python version: 3.11.11
[0m14:19:42.759526 [info ] [MainThread]: python path: /usr/local/bin/python3.11
[0m14:19:42.759759 [info ] [MainThread]: os info: Linux-6.10.14-linuxkit-aarch64-with-glibc2.36
[0m14:19:42.761443 [info ] [MainThread]: Using profiles dir at /root/.dbt
[0m14:19:42.761654 [info ] [MainThread]: Using profiles.yml file at /root/.dbt/profiles.yml
[0m14:19:42.761891 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt_project.yml
[0m14:19:42.801211 [info ] [MainThread]: Configuration:
[0m14:19:42.801525 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m14:19:42.801847 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m14:19:42.802041 [info ] [MainThread]: Required dependencies:
[0m14:19:42.802277 [debug] [MainThread]: Executing "git --help"
[0m14:19:42.802831 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m14:19:42.803071 [info ] [MainThread]: Connection test skipped since no profile was found
[0m14:19:42.803449 [info ] [MainThread]: [31m2 checks failed:[0m
[0m14:19:42.803642 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  Could not find profile named 'snowflake'


[0m14:19:42.803886 [info ] [MainThread]: Error from git --help: Could not find command, ensure it is in the user's PATH: "git"

[0m14:19:42.804474 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.07329633, "process_in_blocks": "0", "process_kernel_time": 0.061047, "process_mem_max_rss": "96652", "process_out_blocks": "5", "process_user_time": 0.597465}
[0m14:19:42.804728 [debug] [MainThread]: Command `dbt debug` failed at 14:19:42.804668 after 0.07 seconds
[0m14:19:42.804963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ea1acd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e75e610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83309110>]}
[0m14:19:42.805192 [debug] [MainThread]: Flushing usage events
[0m14:19:44.038546 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:22:06.022898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81d36dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81f4e010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81d36ad0>]}


============================== 14:22:06.024297 | 4e2ff07f-fd48-4033-8789-a8dd4f81318f ==============================
[0m14:22:06.024297 [info ] [MainThread]: Running with dbt=1.9.0
[0m14:22:06.024705 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt debug', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:22:06.028320 [info ] [MainThread]: dbt version: 1.9.0
[0m14:22:06.028574 [info ] [MainThread]: python version: 3.11.11
[0m14:22:06.028923 [info ] [MainThread]: python path: /usr/local/bin/python3.11
[0m14:22:06.029155 [info ] [MainThread]: os info: Linux-6.10.14-linuxkit-aarch64-with-glibc2.36
[0m14:22:06.049934 [info ] [MainThread]: Using profiles dir at /root/.dbt
[0m14:22:06.050224 [info ] [MainThread]: Using profiles.yml file at /root/.dbt/profiles.yml
[0m14:22:06.050459 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt_project.yml
[0m14:22:06.050759 [info ] [MainThread]: adapter type: postgres
[0m14:22:06.050993 [info ] [MainThread]: adapter version: 1.9.0
[0m14:22:06.087739 [info ] [MainThread]: Configuration:
[0m14:22:06.088013 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m14:22:06.088267 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m14:22:06.088550 [info ] [MainThread]: Required dependencies:
[0m14:22:06.088788 [debug] [MainThread]: Executing "git --help"
[0m14:22:06.089298 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m14:22:06.089534 [info ] [MainThread]: Connection:
[0m14:22:06.089777 [info ] [MainThread]:   host: postgres
[0m14:22:06.090019 [info ] [MainThread]:   port: 5432
[0m14:22:06.090292 [info ] [MainThread]:   user: airflow
[0m14:22:06.090511 [info ] [MainThread]:   database: airflow
[0m14:22:06.090746 [info ] [MainThread]:   schema: staging
[0m14:22:06.090984 [info ] [MainThread]:   connect_timeout: 10
[0m14:22:06.091241 [info ] [MainThread]:   role: None
[0m14:22:06.091457 [info ] [MainThread]:   search_path: None
[0m14:22:06.091679 [info ] [MainThread]:   keepalives_idle: 0
[0m14:22:06.091885 [info ] [MainThread]:   sslmode: None
[0m14:22:06.092782 [info ] [MainThread]:   sslcert: None
[0m14:22:06.093105 [info ] [MainThread]:   sslkey: None
[0m14:22:06.093317 [info ] [MainThread]:   sslrootcert: None
[0m14:22:06.093545 [info ] [MainThread]:   application_name: dbt
[0m14:22:06.093757 [info ] [MainThread]:   retries: 1
[0m14:22:06.094340 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:22:06.120519 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m14:22:06.132148 [debug] [MainThread]: Using postgres connection "debug"
[0m14:22:06.132391 [debug] [MainThread]: On debug: select 1 as id
[0m14:22:06.132609 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:22:06.135317 [debug] [MainThread]: SQL status: SELECT 1 in 0.003 seconds
[0m14:22:06.135740 [debug] [MainThread]: On debug: Close
[0m14:22:06.135956 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m14:22:06.136191 [info ] [MainThread]: [31m1 check failed:[0m
[0m14:22:06.136535 [info ] [MainThread]: Error from git --help: Could not find command, ensure it is in the user's PATH: "git"

[0m14:22:06.137150 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.13653366, "process_in_blocks": "0", "process_kernel_time": 0.070564, "process_mem_max_rss": "108152", "process_out_blocks": "40", "process_user_time": 0.636071}
[0m14:22:06.137418 [debug] [MainThread]: Command `dbt debug` failed at 14:22:06.137368 after 0.14 seconds
[0m14:22:06.137626 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m14:22:06.137850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81b61250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81b61110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81163510>]}
[0m14:22:06.138093 [debug] [MainThread]: Flushing usage events
[0m14:22:07.704842 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:22:34.385774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a943610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a797ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a9434d0>]}


============================== 14:22:34.387244 | 0da60d1e-3211-464c-8df4-3555777ac716 ==============================
[0m14:22:34.387244 [info ] [MainThread]: Running with dbt=1.9.0
[0m14:22:34.387603 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:22:34.391569 [info ] [MainThread]: dbt version: 1.9.0
[0m14:22:34.391863 [info ] [MainThread]: python version: 3.11.11
[0m14:22:34.392175 [info ] [MainThread]: python path: /usr/local/bin/python3.11
[0m14:22:34.392473 [info ] [MainThread]: os info: Linux-6.10.14-linuxkit-aarch64-with-glibc2.36
[0m14:22:34.413445 [info ] [MainThread]: Using profiles dir at /root/.dbt
[0m14:22:34.413765 [info ] [MainThread]: Using profiles.yml file at /root/.dbt/profiles.yml
[0m14:22:34.414065 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt_project.yml
[0m14:22:34.414437 [info ] [MainThread]: adapter type: postgres
[0m14:22:34.414766 [info ] [MainThread]: adapter version: 1.9.0
[0m14:22:34.453450 [info ] [MainThread]: Configuration:
[0m14:22:34.453770 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m14:22:34.454164 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m14:22:34.454460 [info ] [MainThread]: Required dependencies:
[0m14:22:34.454753 [debug] [MainThread]: Executing "git --help"
[0m14:22:34.455329 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m14:22:34.455546 [info ] [MainThread]: Connection:
[0m14:22:34.455786 [info ] [MainThread]:   host: postgres
[0m14:22:34.456022 [info ] [MainThread]:   port: 5432
[0m14:22:34.456267 [info ] [MainThread]:   user: airflow
[0m14:22:34.456509 [info ] [MainThread]:   database: airflow
[0m14:22:34.456788 [info ] [MainThread]:   schema: staging
[0m14:22:34.457028 [info ] [MainThread]:   connect_timeout: 10
[0m14:22:34.457261 [info ] [MainThread]:   role: None
[0m14:22:34.457513 [info ] [MainThread]:   search_path: None
[0m14:22:34.457726 [info ] [MainThread]:   keepalives_idle: 0
[0m14:22:34.457940 [info ] [MainThread]:   sslmode: None
[0m14:22:34.458172 [info ] [MainThread]:   sslcert: None
[0m14:22:34.458399 [info ] [MainThread]:   sslkey: None
[0m14:22:34.458648 [info ] [MainThread]:   sslrootcert: None
[0m14:22:34.458869 [info ] [MainThread]:   application_name: dbt
[0m14:22:34.459088 [info ] [MainThread]:   retries: 1
[0m14:22:34.459391 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:22:34.486214 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m14:22:34.496647 [debug] [MainThread]: Using postgres connection "debug"
[0m14:22:34.496899 [debug] [MainThread]: On debug: select 1 as id
[0m14:22:34.497105 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:22:34.499568 [debug] [MainThread]: SQL status: SELECT 1 in 0.002 seconds
[0m14:22:34.500019 [debug] [MainThread]: On debug: Close
[0m14:22:34.500230 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m14:22:34.500458 [info ] [MainThread]: [31m1 check failed:[0m
[0m14:22:34.500770 [info ] [MainThread]: Error from git --help: Could not find command, ensure it is in the user's PATH: "git"

[0m14:22:34.501356 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.13683592, "process_in_blocks": "0", "process_kernel_time": 0.077761, "process_mem_max_rss": "108088", "process_out_blocks": "40", "process_user_time": 0.646015}
[0m14:22:34.501609 [debug] [MainThread]: Command `dbt debug` failed at 14:22:34.501565 after 0.14 seconds
[0m14:22:34.501808 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m14:22:34.502038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a943e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a941110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f2a8f50>]}
[0m14:22:34.502291 [debug] [MainThread]: Flushing usage events
[0m14:22:35.721694 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:23:10.968561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99d0f7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99e445d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99d0ed10>]}


============================== 14:23:10.970019 | 81b31eff-4f2d-49ad-8d20-9fa1faf5243e ==============================
[0m14:23:10.970019 [info ] [MainThread]: Running with dbt=1.9.0
[0m14:23:10.970405 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:23:10.974105 [info ] [MainThread]: dbt version: 1.9.0
[0m14:23:10.974399 [info ] [MainThread]: python version: 3.11.11
[0m14:23:10.974711 [info ] [MainThread]: python path: /usr/local/bin/python3.11
[0m14:23:10.974957 [info ] [MainThread]: os info: Linux-6.10.14-linuxkit-aarch64-with-glibc2.36
[0m14:23:10.976838 [info ] [MainThread]: Using profiles dir at /root/.dbt
[0m14:23:10.977052 [info ] [MainThread]: Using profiles.yml file at /root/.dbt/profiles.yml
[0m14:23:10.977367 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt_project.yml
[0m14:23:11.014464 [info ] [MainThread]: Configuration:
[0m14:23:11.014728 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m14:23:11.015015 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m14:23:11.015249 [info ] [MainThread]: Required dependencies:
[0m14:23:11.015540 [debug] [MainThread]: Executing "git --help"
[0m14:23:11.016077 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m14:23:11.016377 [info ] [MainThread]: Connection test skipped since no profile was found
[0m14:23:11.016622 [info ] [MainThread]: [31m2 checks failed:[0m
[0m14:23:11.016867 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  Could not find profile named 'snowflake'


[0m14:23:11.017110 [info ] [MainThread]: Error from git --help: Could not find command, ensure it is in the user's PATH: "git"

[0m14:23:11.017675 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.070685126, "process_in_blocks": "0", "process_kernel_time": 0.058904, "process_mem_max_rss": "96664", "process_out_blocks": "5", "process_user_time": 0.589048}
[0m14:23:11.017904 [debug] [MainThread]: Command `dbt debug` failed at 14:23:11.017864 after 0.07 seconds
[0m14:23:11.018114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99b3a110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99b3af50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99b398d0>]}
[0m14:23:11.018346 [debug] [MainThread]: Flushing usage events
[0m14:23:12.321742 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:23:43.662680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e747390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e597f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e597b10>]}


============================== 14:23:43.664090 | ed0a7903-af7a-420f-a860-087829e4277f ==============================
[0m14:23:43.664090 [info ] [MainThread]: Running with dbt=1.9.0
[0m14:23:43.664505 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m14:23:43.668089 [info ] [MainThread]: dbt version: 1.9.0
[0m14:23:43.668429 [info ] [MainThread]: python version: 3.11.11
[0m14:23:43.668740 [info ] [MainThread]: python path: /usr/local/bin/python3.11
[0m14:23:43.668997 [info ] [MainThread]: os info: Linux-6.10.14-linuxkit-aarch64-with-glibc2.36
[0m14:23:43.670997 [info ] [MainThread]: Using profiles dir at /root/.dbt
[0m14:23:43.671227 [info ] [MainThread]: Using profiles.yml file at /root/.dbt/profiles.yml
[0m14:23:43.671479 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt_project.yml
[0m14:23:43.708001 [info ] [MainThread]: Configuration:
[0m14:23:43.708245 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m14:23:43.708496 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m14:23:43.708749 [info ] [MainThread]: Required dependencies:
[0m14:23:43.709002 [debug] [MainThread]: Executing "git --help"
[0m14:23:43.709471 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m14:23:43.709675 [info ] [MainThread]: Connection test skipped since no profile was found
[0m14:23:43.709983 [info ] [MainThread]: [31m2 checks failed:[0m
[0m14:23:43.710214 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  Could not find profile named 'airflow'


[0m14:23:43.710460 [info ] [MainThread]: Error from git --help: Could not find command, ensure it is in the user's PATH: "git"

[0m14:23:43.710979 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.06921579, "process_in_blocks": "0", "process_kernel_time": 0.055221, "process_mem_max_rss": "96676", "process_out_blocks": "5", "process_user_time": 0.583334}
[0m14:23:43.711234 [debug] [MainThread]: Command `dbt debug` failed at 14:23:43.711187 after 0.07 seconds
[0m14:23:43.711440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e597d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e572c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3055150>]}
[0m14:23:43.711677 [debug] [MainThread]: Flushing usage events
[0m14:23:45.294167 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:24:49.346525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89d3ab10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89d38450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89d3b910>]}


============================== 14:24:49.347929 | edd29d4e-5e5c-4b87-ba6d-29344a3bbc3d ==============================
[0m14:24:49.347929 [info ] [MainThread]: Running with dbt=1.9.0
[0m14:24:49.348334 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select dimensions.dim_district', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:24:49.407994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'edd29d4e-5e5c-4b87-ba6d-29344a3bbc3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c0b6550>]}
[0m14:24:49.429840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'edd29d4e-5e5c-4b87-ba6d-29344a3bbc3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c82ee90>]}
[0m14:24:49.430205 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:24:49.454645 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m14:24:49.455211 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:24:49.455474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'edd29d4e-5e5c-4b87-ba6d-29344a3bbc3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88f32910>]}
[0m14:24:49.796510 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.etl_waterlevel.example
- models.etl_waterlevel.staging
[0m14:24:49.798912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'edd29d4e-5e5c-4b87-ba6d-29344a3bbc3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8908a7d0>]}
[0m14:24:49.852811 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m14:24:49.854729 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m14:24:49.865098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'edd29d4e-5e5c-4b87-ba6d-29344a3bbc3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89010750>]}
[0m14:24:49.865388 [info ] [MainThread]: Found 1 model, 433 macros
[0m14:24:49.865616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'edd29d4e-5e5c-4b87-ba6d-29344a3bbc3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89025b50>]}
[0m14:24:49.866464 [info ] [MainThread]: 
[0m14:24:49.866721 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:24:49.867002 [info ] [MainThread]: 
[0m14:24:49.867414 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:24:49.867923 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m14:24:49.882607 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m14:24:49.882917 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m14:24:49.883137 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:24:49.885751 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.003 seconds
[0m14:24:49.886412 [debug] [ThreadPool]: On list_airflow: Close
[0m14:24:49.886803 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now create_airflow_staging_dim)
[0m14:24:49.887098 [debug] [ThreadPool]: Creating schema "database: "airflow"
schema: "staging_dim"
"
[0m14:24:49.889523 [debug] [ThreadPool]: Using postgres connection "create_airflow_staging_dim"
[0m14:24:49.889743 [debug] [ThreadPool]: On create_airflow_staging_dim: BEGIN
[0m14:24:49.889936 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:24:49.892069 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m14:24:49.892359 [debug] [ThreadPool]: Using postgres connection "create_airflow_staging_dim"
[0m14:24:49.892596 [debug] [ThreadPool]: On create_airflow_staging_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "create_airflow_staging_dim"} */
create schema if not exists "staging_dim"
[0m14:24:49.894411 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.002 seconds
[0m14:24:49.894901 [debug] [ThreadPool]: On create_airflow_staging_dim: COMMIT
[0m14:24:49.895076 [debug] [ThreadPool]: Using postgres connection "create_airflow_staging_dim"
[0m14:24:49.895213 [debug] [ThreadPool]: On create_airflow_staging_dim: COMMIT
[0m14:24:49.895563 [debug] [ThreadPool]: SQL status: COMMIT in 0.000 seconds
[0m14:24:49.895715 [debug] [ThreadPool]: On create_airflow_staging_dim: Close
[0m14:24:49.896318 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_airflow_staging_dim, now list_airflow_staging_dim)
[0m14:24:49.898903 [debug] [ThreadPool]: Using postgres connection "list_airflow_staging_dim"
[0m14:24:49.899127 [debug] [ThreadPool]: On list_airflow_staging_dim: BEGIN
[0m14:24:49.899290 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:24:49.900665 [debug] [ThreadPool]: SQL status: BEGIN in 0.001 seconds
[0m14:24:49.900920 [debug] [ThreadPool]: Using postgres connection "list_airflow_staging_dim"
[0m14:24:49.901133 [debug] [ThreadPool]: On list_airflow_staging_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_staging_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_dim'
  
[0m14:24:49.904330 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m14:24:49.904862 [debug] [ThreadPool]: On list_airflow_staging_dim: ROLLBACK
[0m14:24:49.905150 [debug] [ThreadPool]: On list_airflow_staging_dim: Close
[0m14:24:49.907168 [debug] [MainThread]: Using postgres connection "master"
[0m14:24:49.907398 [debug] [MainThread]: On master: BEGIN
[0m14:24:49.907567 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:24:49.908849 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m14:24:49.909124 [debug] [MainThread]: Using postgres connection "master"
[0m14:24:49.909341 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:24:49.911408 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m14:24:49.911956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'edd29d4e-5e5c-4b87-ba6d-29344a3bbc3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff885e0a50>]}
[0m14:24:49.912203 [debug] [MainThread]: On master: ROLLBACK
[0m14:24:49.912397 [debug] [MainThread]: Using postgres connection "master"
[0m14:24:49.912525 [debug] [MainThread]: On master: BEGIN
[0m14:24:49.912755 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:24:49.913144 [debug] [MainThread]: On master: COMMIT
[0m14:24:49.913327 [debug] [MainThread]: Using postgres connection "master"
[0m14:24:49.913488 [debug] [MainThread]: On master: COMMIT
[0m14:24:49.913682 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:24:49.913816 [debug] [MainThread]: On master: Close
[0m14:24:49.914825 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.dim_district
[0m14:24:49.915119 [info ] [Thread-1 (]: 1 of 1 START sql view model staging_dim.dim_district ........................... [RUN]
[0m14:24:49.915372 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_staging_dim, now model.etl_waterlevel.dim_district)
[0m14:24:49.915561 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.dim_district
[0m14:24:49.918535 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.dim_district"
[0m14:24:49.919668 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.dim_district
[0m14:24:49.935978 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.dim_district"
[0m14:24:49.937453 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_district"
[0m14:24:49.937674 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_district: BEGIN
[0m14:24:49.937879 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:24:49.939655 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m14:24:49.939919 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_district"
[0m14:24:49.940174 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_district: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.dim_district"} */

  create view "airflow"."staging_dim"."dim_district__dbt_tmp"
    
    
  as (
    -- models/dimensions/dim_district.sql

with source as (
  select distinct
    district_id
  from raw.waterlevels
),

add_names as (
  select
    district_id,
    case district_id
      when 101 then 'Petaling'
      when 102 then 'Klang'
      when 103 then 'Gombak'
      when 104 then 'Hulu Langat'
      when 105 then 'Kuala Selangor'
      when 106 then 'Hulu Selangor'
      when 107 then 'Sabak Bernam'
      when 108 then 'Kuala Langat'
      when 109 then 'Sepang'
      else 'Unknown'
    end as district_name
  from source
)

select * from add_names
  );
[0m14:24:49.940623 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "district_id" does not exist
LINE 11:     district_id
             ^

[0m14:24:49.940871 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_district: ROLLBACK
[0m14:24:49.941130 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_district: Close
[0m14:24:49.942932 [debug] [Thread-1 (]: Database Error in model dim_district (models/dimensions/dim_district.sql)
  column "district_id" does not exist
  LINE 11:     district_id
               ^
  compiled code at target/run/etl_waterlevel/models/dimensions/dim_district.sql
[0m14:24:49.943788 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'edd29d4e-5e5c-4b87-ba6d-29344a3bbc3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff889c9410>]}
[0m14:24:49.944140 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model staging_dim.dim_district .................. [[31mERROR[0m in 0.03s]
[0m14:24:49.944514 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.dim_district
[0m14:24:49.945009 [debug] [Thread-7 (]: Marking all children of 'model.etl_waterlevel.dim_district' to be skipped because of status 'error'.  Reason: Database Error in model dim_district (models/dimensions/dim_district.sql)
  column "district_id" does not exist
  LINE 11:     district_id
               ^
  compiled code at target/run/etl_waterlevel/models/dimensions/dim_district.sql.
[0m14:24:49.946257 [debug] [MainThread]: Using postgres connection "master"
[0m14:24:49.946445 [debug] [MainThread]: On master: BEGIN
[0m14:24:49.946617 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:24:49.948157 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m14:24:49.948383 [debug] [MainThread]: On master: COMMIT
[0m14:24:49.948550 [debug] [MainThread]: Using postgres connection "master"
[0m14:24:49.948715 [debug] [MainThread]: On master: COMMIT
[0m14:24:49.948938 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:24:49.949161 [debug] [MainThread]: On master: Close
[0m14:24:49.949427 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:24:49.949595 [debug] [MainThread]: Connection 'model.etl_waterlevel.dim_district' was properly closed.
[0m14:24:49.949806 [info ] [MainThread]: 
[0m14:24:49.950016 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.08 seconds (0.08s).
[0m14:24:49.950530 [debug] [MainThread]: Command end result
[0m14:24:49.964503 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m14:24:49.965622 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m14:24:49.968649 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m14:24:49.968828 [info ] [MainThread]: 
[0m14:24:49.969096 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:24:49.969342 [info ] [MainThread]: 
[0m14:24:49.969601 [error] [MainThread]:   Database Error in model dim_district (models/dimensions/dim_district.sql)
  column "district_id" does not exist
  LINE 11:     district_id
               ^
  compiled code at target/run/etl_waterlevel/models/dimensions/dim_district.sql
[0m14:24:49.969763 [info ] [MainThread]: 
[0m14:24:49.970043 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:24:49.970590 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.64604294, "process_in_blocks": "0", "process_kernel_time": 0.08606, "process_mem_max_rss": "116312", "process_out_blocks": "2594", "process_user_time": 1.104779}
[0m14:24:49.970792 [debug] [MainThread]: Command `dbt run` failed at 14:24:49.970755 after 0.65 seconds
[0m14:24:49.970984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89b66690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89b67150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89b66ed0>]}
[0m14:24:49.971170 [debug] [MainThread]: Flushing usage events
[0m14:24:51.139858 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:39:36.638198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8630b690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff864408d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8615c1d0>]}


============================== 14:39:36.640402 | aa10e567-fddc-4b94-ba4c-9d34a6633f57 ==============================
[0m14:39:36.640402 [info ] [MainThread]: Running with dbt=1.9.0
[0m14:39:36.640766 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --select dimensions.dim_station', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:39:36.702424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aa10e567-fddc-4b94-ba4c-9d34a6633f57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8615f5d0>]}
[0m14:39:36.725831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aa10e567-fddc-4b94-ba4c-9d34a6633f57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88d45090>]}
[0m14:39:36.726226 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:39:36.751067 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m14:39:36.786750 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m14:39:36.787037 [debug] [MainThread]: Partial parsing: added file: etl_waterlevel://models/dimensions/dim_stations.sql
[0m14:39:36.787243 [debug] [MainThread]: Partial parsing: deleted file: etl_waterlevel://models/dimensions/dim_district.sql
[0m14:39:36.874091 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.etl_waterlevel.staging
- models.etl_waterlevel.example
[0m14:39:36.876333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aa10e567-fddc-4b94-ba4c-9d34a6633f57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff852def10>]}
[0m14:39:36.902669 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m14:39:36.904343 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m14:39:36.910377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aa10e567-fddc-4b94-ba4c-9d34a6633f57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84fe7e90>]}
[0m14:39:36.910619 [info ] [MainThread]: Found 1 model, 433 macros
[0m14:39:36.910840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aa10e567-fddc-4b94-ba4c-9d34a6633f57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85498f10>]}
[0m14:39:36.911188 [warn ] [MainThread]: The selection criterion 'dimensions.dim_station' does not match any enabled nodes
[0m14:39:36.911717 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m14:39:36.912031 [debug] [MainThread]: Command end result
[0m14:39:36.922512 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m14:39:36.923425 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m14:39:36.924903 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m14:39:36.925373 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.3085096, "process_in_blocks": "0", "process_kernel_time": 0.09034, "process_mem_max_rss": "109464", "process_out_blocks": "2442", "process_user_time": 0.82411}
[0m14:39:36.925586 [debug] [MainThread]: Command `dbt run` succeeded at 14:39:36.925543 after 0.31 seconds
[0m14:39:36.925773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8615ee50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86181c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8527a010>]}
[0m14:39:36.925949 [debug] [MainThread]: Flushing usage events
[0m14:39:38.366991 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:41:12.831316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bd43e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bd5e510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bd43310>]}


============================== 14:41:12.832717 | 9e8f41b2-f919-4722-b39f-bcdc7bcd0f48 ==============================
[0m14:41:12.832717 [info ] [MainThread]: Running with dbt=1.9.0
[0m14:41:12.833155 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --select dimensions.dim_stations', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:41:12.892460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9e8f41b2-f919-4722-b39f-bcdc7bcd0f48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b0e9f10>]}
[0m14:41:12.914310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9e8f41b2-f919-4722-b39f-bcdc7bcd0f48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e774c50>]}
[0m14:41:12.914675 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:41:12.939104 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m14:41:12.977463 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:41:12.977700 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:41:12.979984 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.etl_waterlevel.staging
- models.etl_waterlevel.example
[0m14:41:12.988793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9e8f41b2-f919-4722-b39f-bcdc7bcd0f48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bb94390>]}
[0m14:41:13.016914 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m14:41:13.018401 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m14:41:13.023769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9e8f41b2-f919-4722-b39f-bcdc7bcd0f48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ae798d0>]}
[0m14:41:13.024016 [info ] [MainThread]: Found 1 model, 433 macros
[0m14:41:13.024231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9e8f41b2-f919-4722-b39f-bcdc7bcd0f48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bd33dd0>]}
[0m14:41:13.024893 [info ] [MainThread]: 
[0m14:41:13.025146 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:41:13.025340 [info ] [MainThread]: 
[0m14:41:13.025656 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:41:13.026169 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m14:41:13.041925 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m14:41:13.042160 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m14:41:13.042348 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:41:13.045127 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.003 seconds
[0m14:41:13.045699 [debug] [ThreadPool]: On list_airflow: Close
[0m14:41:13.046341 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_staging_dim)
[0m14:41:13.049100 [debug] [ThreadPool]: Using postgres connection "list_airflow_staging_dim"
[0m14:41:13.049297 [debug] [ThreadPool]: On list_airflow_staging_dim: BEGIN
[0m14:41:13.049475 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:41:13.050946 [debug] [ThreadPool]: SQL status: BEGIN in 0.001 seconds
[0m14:41:13.051141 [debug] [ThreadPool]: Using postgres connection "list_airflow_staging_dim"
[0m14:41:13.051330 [debug] [ThreadPool]: On list_airflow_staging_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_staging_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_dim'
  
[0m14:41:13.052705 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.001 seconds
[0m14:41:13.053240 [debug] [ThreadPool]: On list_airflow_staging_dim: ROLLBACK
[0m14:41:13.053506 [debug] [ThreadPool]: On list_airflow_staging_dim: Close
[0m14:41:13.055385 [debug] [MainThread]: Using postgres connection "master"
[0m14:41:13.055582 [debug] [MainThread]: On master: BEGIN
[0m14:41:13.055754 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:41:13.057133 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m14:41:13.057369 [debug] [MainThread]: Using postgres connection "master"
[0m14:41:13.057608 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:41:13.059018 [debug] [MainThread]: SQL status: SELECT 0 in 0.001 seconds
[0m14:41:13.059526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9e8f41b2-f919-4722-b39f-bcdc7bcd0f48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ae87110>]}
[0m14:41:13.059771 [debug] [MainThread]: On master: ROLLBACK
[0m14:41:13.060066 [debug] [MainThread]: Using postgres connection "master"
[0m14:41:13.060256 [debug] [MainThread]: On master: BEGIN
[0m14:41:13.060596 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:41:13.060824 [debug] [MainThread]: On master: COMMIT
[0m14:41:13.061025 [debug] [MainThread]: Using postgres connection "master"
[0m14:41:13.061199 [debug] [MainThread]: On master: COMMIT
[0m14:41:13.061449 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:41:13.061626 [debug] [MainThread]: On master: Close
[0m14:41:13.062874 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.dim_stations
[0m14:41:13.063164 [info ] [Thread-1 (]: 1 of 1 START sql view model staging_dim.dim_stations ........................... [RUN]
[0m14:41:13.063425 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_staging_dim, now model.etl_waterlevel.dim_stations)
[0m14:41:13.063655 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.dim_stations
[0m14:41:13.066487 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.dim_stations"
[0m14:41:13.067294 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.dim_stations
[0m14:41:13.083198 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.dim_stations"
[0m14:41:13.084004 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m14:41:13.084215 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: BEGIN
[0m14:41:13.084412 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:41:13.085938 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m14:41:13.086245 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m14:41:13.086493 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.dim_stations"} */

  create view "airflow"."staging_dim"."dim_stations__dbt_tmp"
    
    
  as (
    -- models/dimensions/dim_station.sql

with station_names as (
  select distinct
    "stationId"     as station_id,
    "stationName"   as station_name,
    "stationCode"   as station_code,
    "stationStatus" as station_status
  from raw.waterlevels
)

select * from station_names
  );
[0m14:41:13.144099 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.057 seconds
[0m14:41:13.147012 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m14:41:13.147225 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.dim_stations"} */
alter table "airflow"."staging_dim"."dim_stations__dbt_tmp" rename to "dim_stations"
[0m14:41:13.150309 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m14:41:13.156203 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: COMMIT
[0m14:41:13.156428 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m14:41:13.156636 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: COMMIT
[0m14:41:13.157165 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m14:41:13.159779 [debug] [Thread-1 (]: Applying DROP to: "airflow"."staging_dim"."dim_stations__dbt_backup"
[0m14:41:13.161713 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m14:41:13.161900 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.dim_stations"} */
drop view if exists "airflow"."staging_dim"."dim_stations__dbt_backup" cascade
[0m14:41:13.162169 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m14:41:13.163177 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: Close
[0m14:41:13.163975 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e8f41b2-f919-4722-b39f-bcdc7bcd0f48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8af62610>]}
[0m14:41:13.164316 [info ] [Thread-1 (]: 1 of 1 OK created sql view model staging_dim.dim_stations ...................... [[32mCREATE VIEW[0m in 0.10s]
[0m14:41:13.164679 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.dim_stations
[0m14:41:13.165423 [debug] [MainThread]: Using postgres connection "master"
[0m14:41:13.165624 [debug] [MainThread]: On master: BEGIN
[0m14:41:13.165763 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:41:13.167349 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m14:41:13.167595 [debug] [MainThread]: On master: COMMIT
[0m14:41:13.167772 [debug] [MainThread]: Using postgres connection "master"
[0m14:41:13.167983 [debug] [MainThread]: On master: COMMIT
[0m14:41:13.168236 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:41:13.168417 [debug] [MainThread]: On master: Close
[0m14:41:13.168650 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:41:13.168836 [debug] [MainThread]: Connection 'model.etl_waterlevel.dim_stations' was properly closed.
[0m14:41:13.169042 [info ] [MainThread]: 
[0m14:41:13.169228 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.14 seconds (0.14s).
[0m14:41:13.169670 [debug] [MainThread]: Command end result
[0m14:41:13.182077 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m14:41:13.183028 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m14:41:13.185865 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m14:41:13.186052 [info ] [MainThread]: 
[0m14:41:13.186274 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:41:13.186475 [info ] [MainThread]: 
[0m14:41:13.186720 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:41:13.187246 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.3772199, "process_in_blocks": "0", "process_kernel_time": 0.085017, "process_mem_max_rss": "113892", "process_out_blocks": "1652", "process_user_time": 0.773158}
[0m14:41:13.187443 [debug] [MainThread]: Command `dbt run` succeeded at 14:41:13.187410 after 0.38 seconds
[0m14:41:13.187613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d6f9610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bb94450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bd5dfd0>]}
[0m14:41:13.187780 [debug] [MainThread]: Flushing usage events
[0m14:41:14.583224 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:48:58.752533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae5429d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae5434d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae543650>]}


============================== 14:48:58.753931 | 68d01f77-bf1a-486c-bbf9-3e19858958f7 ==============================
[0m14:48:58.753931 [info ] [MainThread]: Running with dbt=1.9.0
[0m14:48:58.754393 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --select dimensions.dim_stations', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:48:58.817226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '68d01f77-bf1a-486c-bbf9-3e19858958f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad93bc90>]}
[0m14:48:58.839540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '68d01f77-bf1a-486c-bbf9-3e19858958f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0fd5510>]}
[0m14:48:58.839993 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:48:58.865242 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m14:48:58.899472 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:48:58.899711 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:48:58.901982 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.etl_waterlevel.example
- models.etl_waterlevel.staging
[0m14:48:58.910704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '68d01f77-bf1a-486c-bbf9-3e19858958f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad7c4810>]}
[0m14:48:58.937487 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m14:48:58.938919 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m14:48:58.944227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '68d01f77-bf1a-486c-bbf9-3e19858958f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad6c9110>]}
[0m14:48:58.944495 [info ] [MainThread]: Found 1 model, 433 macros
[0m14:48:58.944755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '68d01f77-bf1a-486c-bbf9-3e19858958f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae638090>]}
[0m14:48:58.945457 [info ] [MainThread]: 
[0m14:48:58.945749 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:48:58.945933 [info ] [MainThread]: 
[0m14:48:58.946287 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:48:58.946819 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m14:48:58.961648 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m14:48:58.961902 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m14:48:58.962123 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:48:58.964706 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.003 seconds
[0m14:48:58.965416 [debug] [ThreadPool]: On list_airflow: Close
[0m14:48:58.966174 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_staging_dim)
[0m14:48:58.969248 [debug] [ThreadPool]: Using postgres connection "list_airflow_staging_dim"
[0m14:48:58.969471 [debug] [ThreadPool]: On list_airflow_staging_dim: BEGIN
[0m14:48:58.969661 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:48:58.971323 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m14:48:58.971580 [debug] [ThreadPool]: Using postgres connection "list_airflow_staging_dim"
[0m14:48:58.971788 [debug] [ThreadPool]: On list_airflow_staging_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_staging_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_dim'
  
[0m14:48:58.973122 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m14:48:58.973758 [debug] [ThreadPool]: On list_airflow_staging_dim: ROLLBACK
[0m14:48:58.974044 [debug] [ThreadPool]: On list_airflow_staging_dim: Close
[0m14:48:58.978857 [debug] [MainThread]: Using postgres connection "master"
[0m14:48:58.980313 [debug] [MainThread]: On master: BEGIN
[0m14:48:58.981086 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:48:58.985035 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m14:48:58.985440 [debug] [MainThread]: Using postgres connection "master"
[0m14:48:58.985745 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:48:58.991353 [debug] [MainThread]: SQL status: SELECT 1 in 0.005 seconds
[0m14:48:58.992079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '68d01f77-bf1a-486c-bbf9-3e19858958f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad94dcd0>]}
[0m14:48:58.992352 [debug] [MainThread]: On master: ROLLBACK
[0m14:48:58.992591 [debug] [MainThread]: Using postgres connection "master"
[0m14:48:58.992732 [debug] [MainThread]: On master: BEGIN
[0m14:48:58.992999 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:48:58.993257 [debug] [MainThread]: On master: COMMIT
[0m14:48:58.993407 [debug] [MainThread]: Using postgres connection "master"
[0m14:48:58.993564 [debug] [MainThread]: On master: COMMIT
[0m14:48:58.993806 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:48:58.993980 [debug] [MainThread]: On master: Close
[0m14:48:58.995444 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.dim_stations
[0m14:48:58.995781 [info ] [Thread-1 (]: 1 of 1 START sql view model staging_dim.dim_stations ........................... [RUN]
[0m14:48:58.996092 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_staging_dim, now model.etl_waterlevel.dim_stations)
[0m14:48:58.996391 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.dim_stations
[0m14:48:59.000077 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.dim_stations"
[0m14:48:59.001302 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.dim_stations
[0m14:48:59.019877 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.dim_stations"
[0m14:48:59.020911 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m14:48:59.021187 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: BEGIN
[0m14:48:59.021434 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:48:59.023517 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m14:48:59.023805 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m14:48:59.024058 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.dim_stations"} */

  create view "airflow"."staging_dim"."dim_stations__dbt_tmp"
    
    
  as (
    -- models/dimensions/dim_station.sql

with station_names as (
  select distinct
    "stationId"     as station_id,
    "stationName"   as station_name,
    "stationCode"   as station_code,
    "stationStatus" as station_status
  from raw.waterlevels
)

select * from station_names
  );
[0m14:48:59.025738 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m14:48:59.028585 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m14:48:59.028789 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.dim_stations"} */
alter table "airflow"."staging_dim"."dim_stations" rename to "dim_stations__dbt_backup"
[0m14:48:59.029098 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:48:59.030360 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m14:48:59.030539 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.dim_stations"} */
alter table "airflow"."staging_dim"."dim_stations__dbt_tmp" rename to "dim_stations"
[0m14:48:59.030825 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:48:59.038214 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: COMMIT
[0m14:48:59.038470 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m14:48:59.038686 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: COMMIT
[0m14:48:59.039470 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m14:48:59.042143 [debug] [Thread-1 (]: Applying DROP to: "airflow"."staging_dim"."dim_stations__dbt_backup"
[0m14:48:59.044155 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m14:48:59.044351 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.dim_stations"} */
drop view if exists "airflow"."staging_dim"."dim_stations__dbt_backup" cascade
[0m14:48:59.046413 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m14:48:59.047481 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: Close
[0m14:48:59.048280 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '68d01f77-bf1a-486c-bbf9-3e19858958f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac93ad10>]}
[0m14:48:59.048633 [info ] [Thread-1 (]: 1 of 1 OK created sql view model staging_dim.dim_stations ...................... [[32mCREATE VIEW[0m in 0.05s]
[0m14:48:59.048940 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.dim_stations
[0m14:48:59.049736 [debug] [MainThread]: Using postgres connection "master"
[0m14:48:59.049934 [debug] [MainThread]: On master: BEGIN
[0m14:48:59.050088 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:48:59.051495 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m14:48:59.051718 [debug] [MainThread]: On master: COMMIT
[0m14:48:59.051913 [debug] [MainThread]: Using postgres connection "master"
[0m14:48:59.052081 [debug] [MainThread]: On master: COMMIT
[0m14:48:59.052270 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:48:59.052424 [debug] [MainThread]: On master: Close
[0m14:48:59.052627 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:48:59.052769 [debug] [MainThread]: Connection 'model.etl_waterlevel.dim_stations' was properly closed.
[0m14:48:59.052946 [info ] [MainThread]: 
[0m14:48:59.053116 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.11 seconds (0.11s).
[0m14:48:59.053546 [debug] [MainThread]: Command end result
[0m14:48:59.065723 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m14:48:59.066724 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m14:48:59.069693 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m14:48:59.069879 [info ] [MainThread]: 
[0m14:48:59.070143 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:48:59.070356 [info ] [MainThread]: 
[0m14:48:59.070614 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:48:59.071116 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.33937582, "process_in_blocks": "0", "process_kernel_time": 0.086126, "process_mem_max_rss": "113864", "process_out_blocks": "1653", "process_user_time": 0.827434}
[0m14:48:59.071350 [debug] [MainThread]: Command `dbt run` succeeded at 14:48:59.071297 after 0.34 seconds
[0m14:48:59.071547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae3bbd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae55dbd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae36f350>]}
[0m14:48:59.071721 [debug] [MainThread]: Flushing usage events
[0m14:49:00.336566 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:23:20.999666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051fee50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105272e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105273a10>]}


============================== 06:23:21.001885 | 90c4074c-b1b5-46d4-9b20-4c8cf68dc43d ==============================
[0m06:23:21.001885 [info ] [MainThread]: Running with dbt=1.9.3
[0m06:23:21.002211 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/aiman/DE_Projects/etl_waterlevel/transform/logs', 'version_check': 'True', 'profiles_dir': '/Users/aiman/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select dim_stations', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:23:21.003628 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'etl_waterlevel'
[0m06:23:21.004765 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.035954416, "process_in_blocks": "0", "process_kernel_time": 0.075048, "process_mem_max_rss": "103448576", "process_out_blocks": "0", "process_user_time": 0.54866}
[0m06:23:21.004978 [debug] [MainThread]: Command `dbt run` failed at 06:23:21.004931 after 0.04 seconds
[0m06:23:21.005153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10524bb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1002affd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100350a50>]}
[0m06:23:21.005321 [debug] [MainThread]: Flushing usage events
[0m06:23:22.313244 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:30:53.866169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84743a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84743690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84743a50>]}


============================== 22:30:53.867649 | 45ff69ca-0996-45d4-b9c4-ecbf1177db01 ==============================
[0m22:30:53.867649 [info ] [MainThread]: Running with dbt=1.9.0
[0m22:30:53.867967 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:30:53.872354 [info ] [MainThread]: dbt version: 1.9.0
[0m22:30:53.872600 [info ] [MainThread]: python version: 3.11.11
[0m22:30:53.872896 [info ] [MainThread]: python path: /usr/local/bin/python3.11
[0m22:30:53.873129 [info ] [MainThread]: os info: Linux-6.10.14-linuxkit-aarch64-with-glibc2.36
[0m22:30:53.914504 [info ] [MainThread]: Using profiles dir at /root/.dbt
[0m22:30:53.914884 [info ] [MainThread]: Using profiles.yml file at /root/.dbt/profiles.yml
[0m22:30:53.915095 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt_project.yml
[0m22:30:53.915445 [info ] [MainThread]: adapter type: postgres
[0m22:30:53.915667 [info ] [MainThread]: adapter version: 1.9.0
[0m22:30:53.952538 [info ] [MainThread]: Configuration:
[0m22:30:53.952790 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m22:30:53.953066 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m22:30:53.953317 [info ] [MainThread]: Required dependencies:
[0m22:30:53.953549 [debug] [MainThread]: Executing "git --help"
[0m22:30:53.954112 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m22:30:53.954379 [info ] [MainThread]: Connection:
[0m22:30:53.954608 [info ] [MainThread]:   host: postgres
[0m22:30:53.954834 [info ] [MainThread]:   port: 5432
[0m22:30:53.955131 [info ] [MainThread]:   user: airflow
[0m22:30:53.955338 [info ] [MainThread]:   database: airflow
[0m22:30:53.955554 [info ] [MainThread]:   schema: staging
[0m22:30:53.955785 [info ] [MainThread]:   connect_timeout: 10
[0m22:30:53.956007 [info ] [MainThread]:   role: None
[0m22:30:53.956215 [info ] [MainThread]:   search_path: None
[0m22:30:53.956398 [info ] [MainThread]:   keepalives_idle: 0
[0m22:30:53.956598 [info ] [MainThread]:   sslmode: None
[0m22:30:53.956812 [info ] [MainThread]:   sslcert: None
[0m22:30:53.957026 [info ] [MainThread]:   sslkey: None
[0m22:30:53.957249 [info ] [MainThread]:   sslrootcert: None
[0m22:30:53.957460 [info ] [MainThread]:   application_name: dbt
[0m22:30:53.957677 [info ] [MainThread]:   retries: 1
[0m22:30:53.957987 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:30:53.990390 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m22:30:54.007097 [debug] [MainThread]: Using postgres connection "debug"
[0m22:30:54.007282 [debug] [MainThread]: On debug: select 1 as id
[0m22:30:54.007422 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:30:54.014302 [debug] [MainThread]: SQL status: SELECT 1 in 0.007 seconds
[0m22:30:54.014746 [debug] [MainThread]: On debug: Close
[0m22:30:54.014945 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m22:30:54.015289 [info ] [MainThread]: [31m1 check failed:[0m
[0m22:30:54.015510 [info ] [MainThread]: Error from git --help: Could not find command, ensure it is in the user's PATH: "git"

[0m22:30:54.016066 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.17228626, "process_in_blocks": "18696", "process_kernel_time": 0.084807, "process_mem_max_rss": "107840", "process_out_blocks": "40", "process_user_time": 0.634558}
[0m22:30:54.016298 [debug] [MainThread]: Command `dbt debug` failed at 22:30:54.016248 after 0.17 seconds
[0m22:30:54.016482 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m22:30:54.016648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84597e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83a3f310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff845977d0>]}
[0m22:30:54.016836 [debug] [MainThread]: Flushing usage events
[0m22:30:55.329323 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:30:59.873058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86b46e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86b45c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86b45550>]}


============================== 22:30:59.874465 | 6c2cf33a-9631-413e-8695-6f1c66adc1b2 ==============================
[0m22:30:59.874465 [info ] [MainThread]: Running with dbt=1.9.0
[0m22:30:59.874828 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:30:59.934213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6c2cf33a-9631-413e-8695-6f1c66adc1b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85f9e390>]}
[0m22:30:59.956022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6c2cf33a-9631-413e-8695-6f1c66adc1b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff895b09d0>]}
[0m22:30:59.956392 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:30:59.982727 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m22:31:00.025820 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:31:00.026018 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:31:00.028208 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.etl_waterlevel.example
- models.etl_waterlevel.staging
[0m22:31:00.036993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6c2cf33a-9631-413e-8695-6f1c66adc1b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85e178d0>]}
[0m22:31:00.062450 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m22:31:00.064340 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m22:31:00.075919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6c2cf33a-9631-413e-8695-6f1c66adc1b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85c9f510>]}
[0m22:31:00.076168 [info ] [MainThread]: Found 1 model, 433 macros
[0m22:31:00.076422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6c2cf33a-9631-413e-8695-6f1c66adc1b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85cf9b90>]}
[0m22:31:00.077191 [info ] [MainThread]: 
[0m22:31:00.077420 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:31:00.077635 [info ] [MainThread]: 
[0m22:31:00.077970 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:31:00.078478 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m22:31:00.093007 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m22:31:00.093229 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m22:31:00.093437 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:31:00.095786 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.002 seconds
[0m22:31:00.096374 [debug] [ThreadPool]: On list_airflow: Close
[0m22:31:00.097020 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_staging_dim)
[0m22:31:00.099850 [debug] [ThreadPool]: Using postgres connection "list_airflow_staging_dim"
[0m22:31:00.100086 [debug] [ThreadPool]: On list_airflow_staging_dim: BEGIN
[0m22:31:00.100308 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:31:00.101833 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m22:31:00.102147 [debug] [ThreadPool]: Using postgres connection "list_airflow_staging_dim"
[0m22:31:00.102344 [debug] [ThreadPool]: On list_airflow_staging_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_staging_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_dim'
  
[0m22:31:00.104114 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m22:31:00.104704 [debug] [ThreadPool]: On list_airflow_staging_dim: ROLLBACK
[0m22:31:00.104975 [debug] [ThreadPool]: On list_airflow_staging_dim: Close
[0m22:31:00.106996 [debug] [MainThread]: Using postgres connection "master"
[0m22:31:00.107159 [debug] [MainThread]: On master: BEGIN
[0m22:31:00.107291 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:31:00.108499 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m22:31:00.108696 [debug] [MainThread]: Using postgres connection "master"
[0m22:31:00.108909 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:31:00.113657 [debug] [MainThread]: SQL status: SELECT 1 in 0.004 seconds
[0m22:31:00.114188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6c2cf33a-9631-413e-8695-6f1c66adc1b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85b53010>]}
[0m22:31:00.114407 [debug] [MainThread]: On master: ROLLBACK
[0m22:31:00.114623 [debug] [MainThread]: Using postgres connection "master"
[0m22:31:00.114791 [debug] [MainThread]: On master: BEGIN
[0m22:31:00.115039 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m22:31:00.115230 [debug] [MainThread]: On master: COMMIT
[0m22:31:00.115375 [debug] [MainThread]: Using postgres connection "master"
[0m22:31:00.115501 [debug] [MainThread]: On master: COMMIT
[0m22:31:00.115679 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:31:00.115809 [debug] [MainThread]: On master: Close
[0m22:31:00.116748 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.dim_stations
[0m22:31:00.117043 [info ] [Thread-1 (]: 1 of 1 START sql view model staging_dim.dim_stations ........................... [RUN]
[0m22:31:00.117323 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_staging_dim, now model.etl_waterlevel.dim_stations)
[0m22:31:00.117529 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.dim_stations
[0m22:31:00.120491 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.dim_stations"
[0m22:31:00.121699 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.dim_stations
[0m22:31:00.137562 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.dim_stations"
[0m22:31:00.138515 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m22:31:00.138722 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: BEGIN
[0m22:31:00.138922 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:31:00.140528 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m22:31:00.140762 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m22:31:00.141021 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.dim_stations"} */

  create view "airflow"."staging_dim"."dim_stations__dbt_tmp"
    
    
  as (
    -- models/dimensions/dim_station.sql

with station_names as (
  select distinct
    "stationId"     as station_id,
    "stationName"   as station_name,
    "stationCode"   as station_code,
    "stationStatus" as station_status
  from raw.waterlevels
)

select * from station_names
  );
[0m22:31:00.146425 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m22:31:00.149067 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m22:31:00.149248 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.dim_stations"} */
alter table "airflow"."staging_dim"."dim_stations" rename to "dim_stations__dbt_backup"
[0m22:31:00.149945 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:31:00.151348 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m22:31:00.151536 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.dim_stations"} */
alter table "airflow"."staging_dim"."dim_stations__dbt_tmp" rename to "dim_stations"
[0m22:31:00.151822 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:31:00.158623 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: COMMIT
[0m22:31:00.158817 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m22:31:00.158974 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: COMMIT
[0m22:31:00.159392 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m22:31:00.161977 [debug] [Thread-1 (]: Applying DROP to: "airflow"."staging_dim"."dim_stations__dbt_backup"
[0m22:31:00.163937 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m22:31:00.164125 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.dim_stations"} */
drop view if exists "airflow"."staging_dim"."dim_stations__dbt_backup" cascade
[0m22:31:00.165160 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m22:31:00.166175 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: Close
[0m22:31:00.167153 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c2cf33a-9631-413e-8695-6f1c66adc1b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84fd0e10>]}
[0m22:31:00.167470 [info ] [Thread-1 (]: 1 of 1 OK created sql view model staging_dim.dim_stations ...................... [[32mCREATE VIEW[0m in 0.05s]
[0m22:31:00.167790 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.dim_stations
[0m22:31:00.168476 [debug] [MainThread]: Using postgres connection "master"
[0m22:31:00.168664 [debug] [MainThread]: On master: BEGIN
[0m22:31:00.168808 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:31:00.170082 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m22:31:00.170262 [debug] [MainThread]: On master: COMMIT
[0m22:31:00.170419 [debug] [MainThread]: Using postgres connection "master"
[0m22:31:00.170596 [debug] [MainThread]: On master: COMMIT
[0m22:31:00.170797 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:31:00.170956 [debug] [MainThread]: On master: Close
[0m22:31:00.171143 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:31:00.171281 [debug] [MainThread]: Connection 'model.etl_waterlevel.dim_stations' was properly closed.
[0m22:31:00.171426 [info ] [MainThread]: 
[0m22:31:00.171630 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.09 seconds (0.09s).
[0m22:31:00.172097 [debug] [MainThread]: Command end result
[0m22:31:00.183435 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m22:31:00.184417 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m22:31:00.187017 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m22:31:00.187242 [info ] [MainThread]: 
[0m22:31:00.187620 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:31:00.187801 [info ] [MainThread]: 
[0m22:31:00.188062 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m22:31:00.188590 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.33637932, "process_in_blocks": "1872", "process_kernel_time": 0.068434, "process_mem_max_rss": "114268", "process_out_blocks": "1773", "process_user_time": 0.794432}
[0m22:31:00.188815 [debug] [MainThread]: Command `dbt run` succeeded at 22:31:00.188775 after 0.34 seconds
[0m22:31:00.189003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b454fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b4546d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b455150>]}
[0m22:31:00.189187 [debug] [MainThread]: Flushing usage events
[0m22:31:01.474733 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:41:01.021823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6b374d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6c6c7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6b34450>]}


============================== 22:41:01.023210 | 6211dc19-c674-4650-8881-e56d515a84fb ==============================
[0m22:41:01.023210 [info ] [MainThread]: Running with dbt=1.9.0
[0m22:41:01.023630 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m22:41:01.064741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6211dc19-c674-4650-8881-e56d515a84fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6a56ad0>]}
[0m22:41:01.074223 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.073484, "process_in_blocks": "16", "process_kernel_time": 0.056086, "process_mem_max_rss": "96184", "process_out_blocks": "3", "process_user_time": 0.572887}
[0m22:41:01.074471 [debug] [MainThread]: Command `dbt clean` succeeded at 22:41:01.074428 after 0.07 seconds
[0m22:41:01.074700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbb474fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbb474710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7637610>]}
[0m22:41:01.074987 [debug] [MainThread]: Flushing usage events
[0m22:41:02.561371 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:41:14.310628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96a3fa50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96c56210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96a3e710>]}


============================== 22:41:14.312023 | a915036d-1321-4837-a730-489690dc59aa ==============================
[0m22:41:14.312023 [info ] [MainThread]: Running with dbt=1.9.0
[0m22:41:14.312476 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select dim_stations', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:41:14.371375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a915036d-1321-4837-a730-489690dc59aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff968b7d90>]}
[0m22:41:14.393052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a915036d-1321-4837-a730-489690dc59aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff994c9f10>]}
[0m22:41:14.393434 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:41:14.417739 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m22:41:14.418307 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:41:14.418598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a915036d-1321-4837-a730-489690dc59aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff968d77d0>]}
[0m22:41:14.760517 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m22:41:14.762776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a915036d-1321-4837-a730-489690dc59aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95c6b9d0>]}
[0m22:41:14.812717 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m22:41:14.814369 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m22:41:14.820131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a915036d-1321-4837-a730-489690dc59aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95af02d0>]}
[0m22:41:14.820408 [info ] [MainThread]: Found 1 model, 433 macros
[0m22:41:14.820661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a915036d-1321-4837-a730-489690dc59aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95aad550>]}
[0m22:41:14.821342 [info ] [MainThread]: 
[0m22:41:14.821651 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:41:14.821916 [info ] [MainThread]: 
[0m22:41:14.822316 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:41:14.822890 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m22:41:14.836692 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m22:41:14.836924 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m22:41:14.837122 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:41:14.839737 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.003 seconds
[0m22:41:14.840332 [debug] [ThreadPool]: On list_airflow: Close
[0m22:41:14.840950 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_staging_dim)
[0m22:41:14.843656 [debug] [ThreadPool]: Using postgres connection "list_airflow_staging_dim"
[0m22:41:14.843857 [debug] [ThreadPool]: On list_airflow_staging_dim: BEGIN
[0m22:41:14.844043 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:41:14.845478 [debug] [ThreadPool]: SQL status: BEGIN in 0.001 seconds
[0m22:41:14.845739 [debug] [ThreadPool]: Using postgres connection "list_airflow_staging_dim"
[0m22:41:14.845956 [debug] [ThreadPool]: On list_airflow_staging_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_staging_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_dim'
  
[0m22:41:14.847195 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m22:41:14.847797 [debug] [ThreadPool]: On list_airflow_staging_dim: ROLLBACK
[0m22:41:14.848074 [debug] [ThreadPool]: On list_airflow_staging_dim: Close
[0m22:41:14.850026 [debug] [MainThread]: Using postgres connection "master"
[0m22:41:14.850224 [debug] [MainThread]: On master: BEGIN
[0m22:41:14.850416 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:41:14.851769 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m22:41:14.852011 [debug] [MainThread]: Using postgres connection "master"
[0m22:41:14.852238 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:41:14.855080 [debug] [MainThread]: SQL status: SELECT 1 in 0.002 seconds
[0m22:41:14.855630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a915036d-1321-4837-a730-489690dc59aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95af21d0>]}
[0m22:41:14.855880 [debug] [MainThread]: On master: ROLLBACK
[0m22:41:14.856147 [debug] [MainThread]: Using postgres connection "master"
[0m22:41:14.856330 [debug] [MainThread]: On master: BEGIN
[0m22:41:14.856649 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m22:41:14.856856 [debug] [MainThread]: On master: COMMIT
[0m22:41:14.857029 [debug] [MainThread]: Using postgres connection "master"
[0m22:41:14.857194 [debug] [MainThread]: On master: COMMIT
[0m22:41:14.857448 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:41:14.857625 [debug] [MainThread]: On master: Close
[0m22:41:14.858867 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.dim_stations
[0m22:41:14.859168 [info ] [Thread-1 (]: 1 of 1 START sql view model staging_dim.dim_stations ........................... [RUN]
[0m22:41:14.859485 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_staging_dim, now model.etl_waterlevel.dim_stations)
[0m22:41:14.859724 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.dim_stations
[0m22:41:14.862663 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.dim_stations"
[0m22:41:14.864100 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.dim_stations
[0m22:41:14.880359 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.dim_stations"
[0m22:41:14.881767 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m22:41:14.881968 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: BEGIN
[0m22:41:14.882165 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:41:14.883610 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m22:41:14.883833 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m22:41:14.884023 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.dim_stations"} */

  create view "airflow"."staging_dim"."dim_stations__dbt_tmp"
    
    
  as (
    -- models/dimensions/dim_station.sql

with station_names as (
  select distinct
    "stationId"     as station_id,
    "stationName"   as station_name,
    "stationCode"   as station_code,
    "stationStatus" as station_status
  from raw.waterlevels
)

select * from station_names
  );
[0m22:41:14.884977 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m22:41:14.887607 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m22:41:14.887790 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.dim_stations"} */
alter table "airflow"."staging_dim"."dim_stations" rename to "dim_stations__dbt_backup"
[0m22:41:14.888091 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:41:14.889380 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m22:41:14.889571 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.dim_stations"} */
alter table "airflow"."staging_dim"."dim_stations__dbt_tmp" rename to "dim_stations"
[0m22:41:14.889866 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:41:14.896966 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: COMMIT
[0m22:41:14.897187 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m22:41:14.897396 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: COMMIT
[0m22:41:14.898077 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m22:41:14.901275 [debug] [Thread-1 (]: Applying DROP to: "airflow"."staging_dim"."dim_stations__dbt_backup"
[0m22:41:14.903285 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m22:41:14.903484 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.dim_stations"} */
drop view if exists "airflow"."staging_dim"."dim_stations__dbt_backup" cascade
[0m22:41:14.904102 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m22:41:14.905162 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: Close
[0m22:41:14.905936 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a915036d-1321-4837-a730-489690dc59aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff951e3910>]}
[0m22:41:14.906267 [info ] [Thread-1 (]: 1 of 1 OK created sql view model staging_dim.dim_stations ...................... [[32mCREATE VIEW[0m in 0.05s]
[0m22:41:14.906590 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.dim_stations
[0m22:41:14.907321 [debug] [MainThread]: Using postgres connection "master"
[0m22:41:14.907491 [debug] [MainThread]: On master: BEGIN
[0m22:41:14.907641 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:41:14.908931 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m22:41:14.909121 [debug] [MainThread]: On master: COMMIT
[0m22:41:14.909286 [debug] [MainThread]: Using postgres connection "master"
[0m22:41:14.909435 [debug] [MainThread]: On master: COMMIT
[0m22:41:14.909641 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:41:14.909778 [debug] [MainThread]: On master: Close
[0m22:41:14.909962 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:41:14.910098 [debug] [MainThread]: Connection 'model.etl_waterlevel.dim_stations' was properly closed.
[0m22:41:14.910242 [info ] [MainThread]: 
[0m22:41:14.910417 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.09 seconds (0.09s).
[0m22:41:14.910773 [debug] [MainThread]: Command end result
[0m22:41:14.922340 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m22:41:14.923299 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m22:41:14.926308 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m22:41:14.926467 [info ] [MainThread]: 
[0m22:41:14.926671 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:41:14.926876 [info ] [MainThread]: 
[0m22:41:14.927106 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m22:41:14.927605 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.6395088, "process_in_blocks": "136", "process_kernel_time": 0.084688, "process_mem_max_rss": "115620", "process_out_blocks": "2469", "process_user_time": 1.078029}
[0m22:41:14.927851 [debug] [MainThread]: Command `dbt run` succeeded at 22:41:14.927810 after 0.64 seconds
[0m22:41:14.928035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b4d56d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9753b950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b3a5190>]}
[0m22:41:14.928211 [debug] [MainThread]: Flushing usage events
[0m22:41:16.078113 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:43:37.436825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8153ac10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81670890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff815383d0>]}


============================== 22:43:37.438208 | 6a2c9d1b-1c17-4329-9ca8-2969d4f5dcf5 ==============================
[0m22:43:37.438208 [info ] [MainThread]: Running with dbt=1.9.0
[0m22:43:37.438636 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:43:37.479558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6a2c9d1b-1c17-4329-9ca8-2969d4f5dcf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81423150>]}
[0m22:43:37.488617 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.07358146, "process_in_blocks": "0", "process_kernel_time": 0.056958, "process_mem_max_rss": "96160", "process_out_blocks": "3", "process_user_time": 0.587569}
[0m22:43:37.488880 [debug] [MainThread]: Command `dbt clean` succeeded at 22:43:37.488824 after 0.07 seconds
[0m22:43:37.489114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81544150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81390ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff813929d0>]}
[0m22:43:37.489336 [debug] [MainThread]: Flushing usage events
[0m22:43:38.720328 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:43:47.359511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99707a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff999cffd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99707690>]}


============================== 22:43:47.360916 | 6534e782-e85b-4678-b30e-63c69fb70136 ==============================
[0m22:43:47.360916 [info ] [MainThread]: Running with dbt=1.9.0
[0m22:43:47.361382 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select dim_stations', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:43:47.421035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6534e782-e85b-4678-b30e-63c69fb70136', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9955a190>]}
[0m22:43:47.442795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6534e782-e85b-4678-b30e-63c69fb70136', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c148110>]}
[0m22:43:47.443175 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:43:47.471187 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m22:43:47.471890 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:43:47.472195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6534e782-e85b-4678-b30e-63c69fb70136', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff988675d0>]}
[0m22:43:47.814713 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m22:43:47.817014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6534e782-e85b-4678-b30e-63c69fb70136', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98b3d190>]}
[0m22:43:47.867226 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m22:43:47.868724 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m22:43:47.879325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6534e782-e85b-4678-b30e-63c69fb70136', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98939cd0>]}
[0m22:43:47.879585 [info ] [MainThread]: Found 1 model, 433 macros
[0m22:43:47.879796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6534e782-e85b-4678-b30e-63c69fb70136', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9890a650>]}
[0m22:43:47.880523 [info ] [MainThread]: 
[0m22:43:47.880802 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:43:47.881081 [info ] [MainThread]: 
[0m22:43:47.881534 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:43:47.882010 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m22:43:47.896550 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m22:43:47.896772 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m22:43:47.896954 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:43:47.899312 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.002 seconds
[0m22:43:47.899876 [debug] [ThreadPool]: On list_airflow: Close
[0m22:43:47.900485 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_staging_dim)
[0m22:43:47.903006 [debug] [ThreadPool]: Using postgres connection "list_airflow_staging_dim"
[0m22:43:47.903215 [debug] [ThreadPool]: On list_airflow_staging_dim: BEGIN
[0m22:43:47.903452 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:43:47.904952 [debug] [ThreadPool]: SQL status: BEGIN in 0.001 seconds
[0m22:43:47.905179 [debug] [ThreadPool]: Using postgres connection "list_airflow_staging_dim"
[0m22:43:47.905370 [debug] [ThreadPool]: On list_airflow_staging_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_staging_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_dim'
  
[0m22:43:47.906603 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m22:43:47.907198 [debug] [ThreadPool]: On list_airflow_staging_dim: ROLLBACK
[0m22:43:47.907467 [debug] [ThreadPool]: On list_airflow_staging_dim: Close
[0m22:43:47.909416 [debug] [MainThread]: Using postgres connection "master"
[0m22:43:47.909611 [debug] [MainThread]: On master: BEGIN
[0m22:43:47.909788 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:43:47.911169 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m22:43:47.911342 [debug] [MainThread]: Using postgres connection "master"
[0m22:43:47.911565 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:43:47.914300 [debug] [MainThread]: SQL status: SELECT 1 in 0.002 seconds
[0m22:43:47.914897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6534e782-e85b-4678-b30e-63c69fb70136', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9894b4d0>]}
[0m22:43:47.915154 [debug] [MainThread]: On master: ROLLBACK
[0m22:43:47.915416 [debug] [MainThread]: Using postgres connection "master"
[0m22:43:47.915590 [debug] [MainThread]: On master: BEGIN
[0m22:43:47.915920 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m22:43:47.916176 [debug] [MainThread]: On master: COMMIT
[0m22:43:47.916348 [debug] [MainThread]: Using postgres connection "master"
[0m22:43:47.916523 [debug] [MainThread]: On master: COMMIT
[0m22:43:47.916772 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:43:47.916954 [debug] [MainThread]: On master: Close
[0m22:43:47.918167 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.dim_stations
[0m22:43:47.918468 [info ] [Thread-1 (]: 1 of 1 START sql view model staging_dim.dim_stations ........................... [RUN]
[0m22:43:47.918767 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_staging_dim, now model.etl_waterlevel.dim_stations)
[0m22:43:47.919016 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.dim_stations
[0m22:43:47.921943 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.dim_stations"
[0m22:43:47.923389 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.dim_stations
[0m22:43:47.939284 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.dim_stations"
[0m22:43:47.940670 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m22:43:47.940877 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: BEGIN
[0m22:43:47.941055 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:43:47.942477 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m22:43:47.942705 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m22:43:47.942895 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.dim_stations"} */

  create view "airflow"."staging_dim"."dim_stations__dbt_tmp"
    
    
  as (
    -- models/dimensions/dim_station.sql

with station_names as (
  select distinct
    "stationId"     as station_id,
    "stationName"   as station_name,
    "stationCode"   as station_code,
    "stationStatus" as station_status
  from raw.waterlevels
)

select * from station_names
  );
[0m22:43:47.943949 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m22:43:47.946582 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m22:43:47.946792 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.dim_stations"} */
alter table "airflow"."staging_dim"."dim_stations" rename to "dim_stations__dbt_backup"
[0m22:43:47.947113 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:43:47.948348 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m22:43:47.948519 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.dim_stations"} */
alter table "airflow"."staging_dim"."dim_stations__dbt_tmp" rename to "dim_stations"
[0m22:43:47.948774 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:43:47.955848 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: COMMIT
[0m22:43:47.956056 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m22:43:47.956230 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: COMMIT
[0m22:43:47.956653 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m22:43:47.959815 [debug] [Thread-1 (]: Applying DROP to: "airflow"."staging_dim"."dim_stations__dbt_backup"
[0m22:43:47.961820 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m22:43:47.962013 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.dim_stations"} */
drop view if exists "airflow"."staging_dim"."dim_stations__dbt_backup" cascade
[0m22:43:47.962573 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m22:43:47.963594 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: Close
[0m22:43:47.964345 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6534e782-e85b-4678-b30e-63c69fb70136', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97b84650>]}
[0m22:43:47.964663 [info ] [Thread-1 (]: 1 of 1 OK created sql view model staging_dim.dim_stations ...................... [[32mCREATE VIEW[0m in 0.05s]
[0m22:43:47.964967 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.dim_stations
[0m22:43:47.965659 [debug] [MainThread]: Using postgres connection "master"
[0m22:43:47.965822 [debug] [MainThread]: On master: BEGIN
[0m22:43:47.965948 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:43:47.967150 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m22:43:47.967344 [debug] [MainThread]: On master: COMMIT
[0m22:43:47.967504 [debug] [MainThread]: Using postgres connection "master"
[0m22:43:47.967650 [debug] [MainThread]: On master: COMMIT
[0m22:43:47.967836 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:43:47.967970 [debug] [MainThread]: On master: Close
[0m22:43:47.968159 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:43:47.968296 [debug] [MainThread]: Connection 'model.etl_waterlevel.dim_stations' was properly closed.
[0m22:43:47.968452 [info ] [MainThread]: 
[0m22:43:47.968637 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.09 seconds (0.09s).
[0m22:43:47.969042 [debug] [MainThread]: Command end result
[0m22:43:47.980187 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m22:43:47.981116 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m22:43:47.983890 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m22:43:47.984064 [info ] [MainThread]: 
[0m22:43:47.984273 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:43:47.984514 [info ] [MainThread]: 
[0m22:43:47.984769 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m22:43:47.985268 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.646948, "process_in_blocks": "0", "process_kernel_time": 0.069193, "process_mem_max_rss": "115644", "process_out_blocks": "2621", "process_user_time": 1.113114}
[0m22:43:47.985493 [debug] [MainThread]: Command `dbt run` succeeded at 22:43:47.985451 after 0.65 seconds
[0m22:43:47.985695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99558450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff995581d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9955b450>]}
[0m22:43:47.985875 [debug] [MainThread]: Flushing usage events
[0m22:43:49.031766 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:52:09.595507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d913590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9dc13650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d92e510>]}


============================== 22:52:09.597022 | 3036afe7-1b76-42f0-b1e2-d6897d66de0b ==============================
[0m22:52:09.597022 [info ] [MainThread]: Running with dbt=1.9.0
[0m22:52:09.597403 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt ls --select dim_stations --output path', 'send_anonymous_usage_stats': 'True'}
[0m22:52:09.657276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3036afe7-1b76-42f0-b1e2-d6897d66de0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ccb7fd0>]}
[0m22:52:09.679088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3036afe7-1b76-42f0-b1e2-d6897d66de0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0346e10>]}
[0m22:52:09.679483 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:52:09.704222 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m22:52:09.740487 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:52:09.740716 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:52:09.742853 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m22:52:09.751688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3036afe7-1b76-42f0-b1e2-d6897d66de0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cb440d0>]}
[0m22:52:09.779551 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m22:52:09.781072 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m22:52:09.786331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3036afe7-1b76-42f0-b1e2-d6897d66de0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ca4b090>]}
[0m22:52:09.786584 [info ] [MainThread]: Found 1 model, 433 macros
[0m22:52:09.786770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3036afe7-1b76-42f0-b1e2-d6897d66de0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ccf2c90>]}
[0m22:52:09.787085 [info ] [MainThread]: models/dimensions/dim_stations.sql
[0m22:52:09.787626 [debug] [MainThread]: Resource report: {"command_name": "list", "command_success": true, "command_wall_clock_time": 0.21491534, "process_in_blocks": "24", "process_kernel_time": 0.075991, "process_mem_max_rss": "105072", "process_out_blocks": "816", "process_user_time": 0.720923}
[0m22:52:09.787880 [debug] [MainThread]: Command `dbt ls` succeeded at 22:52:09.787835 after 0.22 seconds
[0m22:52:09.788068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cb2cdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cb2d690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2209390>]}
[0m22:52:09.788265 [debug] [MainThread]: Flushing usage events
[0m22:52:10.967347 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:53:03.230451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98707a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99203550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9891e510>]}


============================== 22:53:03.231834 | 4c00c970-7e25-4fba-83e9-70503f6c29f8 ==============================
[0m22:53:03.231834 [info ] [MainThread]: Running with dbt=1.9.0
[0m22:53:03.232257 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt ls --select dim_stations --output name', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:53:03.291322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4c00c970-7e25-4fba-83e9-70503f6c29f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97ad3810>]}
[0m22:53:03.313587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4c00c970-7e25-4fba-83e9-70503f6c29f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff979be750>]}
[0m22:53:03.314046 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:53:03.344211 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m22:53:03.381034 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:53:03.381313 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:53:03.383558 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m22:53:03.392301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4c00c970-7e25-4fba-83e9-70503f6c29f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff977bc1d0>]}
[0m22:53:03.419366 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m22:53:03.420806 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m22:53:03.425331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4c00c970-7e25-4fba-83e9-70503f6c29f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff979313d0>]}
[0m22:53:03.425576 [info ] [MainThread]: Found 1 model, 433 macros
[0m22:53:03.425775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4c00c970-7e25-4fba-83e9-70503f6c29f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff978ddf50>]}
[0m22:53:03.426136 [info ] [MainThread]: dim_stations
[0m22:53:03.426639 [debug] [MainThread]: Resource report: {"command_name": "list", "command_success": true, "command_wall_clock_time": 0.2172713, "process_in_blocks": "0", "process_kernel_time": 0.068839, "process_mem_max_rss": "105108", "process_out_blocks": "816", "process_user_time": 0.727303}
[0m22:53:03.426880 [debug] [MainThread]: Command `dbt ls` succeeded at 22:53:03.426842 after 0.22 seconds
[0m22:53:03.427052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98710150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98707b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98706ed0>]}
[0m22:53:03.427223 [debug] [MainThread]: Flushing usage events
[0m22:53:04.450302 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:53:25.700593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2a47090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2a47510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2a47390>]}


============================== 22:53:25.701977 | fc14aae6-2977-4992-a271-34ec7e878741 ==============================
[0m22:53:25.701977 [info ] [MainThread]: Running with dbt=1.9.0
[0m22:53:25.702422 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug --config-dir', 'send_anonymous_usage_stats': 'True'}
[0m22:53:25.706091 [info ] [MainThread]: To view your profiles.yml file, run:

xdg-open /root/.dbt
[0m22:53:25.706630 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.026874125, "process_in_blocks": "0", "process_kernel_time": 0.043035, "process_mem_max_rss": "94752", "process_out_blocks": "2", "process_user_time": 0.557453}
[0m22:53:25.706935 [debug] [MainThread]: Command `dbt debug` succeeded at 22:53:25.706886 after 0.03 seconds
[0m22:53:25.707164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7365410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb73652d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2a37610>]}
[0m22:53:25.707410 [debug] [MainThread]: Flushing usage events
[0m22:53:26.836493 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:53:39.719648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ab43310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ab5e510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a991ad0>]}


============================== 22:53:39.721043 | d7fd7903-5f0f-4678-9120-5372f7e2b255 ==============================
[0m22:53:39.721043 [info ] [MainThread]: Running with dbt=1.9.0
[0m22:53:39.721378 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ls --select dim_stations --output path', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:53:39.780596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd7fd7903-5f0f-4678-9120-5372f7e2b255', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a02e410>]}
[0m22:53:39.802260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd7fd7903-5f0f-4678-9120-5372f7e2b255', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d606d10>]}
[0m22:53:39.802643 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:53:39.826984 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m22:53:39.861613 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:53:39.861857 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:53:39.864043 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m22:53:39.872711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd7fd7903-5f0f-4678-9120-5372f7e2b255', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89df4110>]}
[0m22:53:39.899310 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m22:53:39.900696 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m22:53:39.904910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd7fd7903-5f0f-4678-9120-5372f7e2b255', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89c26fd0>]}
[0m22:53:39.905167 [info ] [MainThread]: Found 1 model, 433 macros
[0m22:53:39.905361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd7fd7903-5f0f-4678-9120-5372f7e2b255', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89c5bd10>]}
[0m22:53:39.905704 [info ] [MainThread]: models/dimensions/dim_stations.sql
[0m22:53:39.906192 [debug] [MainThread]: Resource report: {"command_name": "list", "command_success": true, "command_wall_clock_time": 0.20752046, "process_in_blocks": "0", "process_kernel_time": 0.067052, "process_mem_max_rss": "105084", "process_out_blocks": "816", "process_user_time": 0.701552}
[0m22:53:39.906394 [debug] [MainThread]: Command `dbt ls` succeeded at 22:53:39.906357 after 0.21 seconds
[0m22:53:39.906564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a9913d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ab4c050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a9b23d0>]}
[0m22:53:39.906732 [debug] [MainThread]: Flushing usage events
[0m22:53:41.264151 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:57:00.218734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5d3de50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5d3f7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5d3f250>]}


============================== 22:57:00.220092 | 1339361b-244d-4746-9451-af29e616d2e6 ==============================
[0m22:57:00.220092 [info ] [MainThread]: Running with dbt=1.9.0
[0m22:57:00.220537 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:57:00.261131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1339361b-244d-4746-9451-af29e616d2e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5c52950>]}
[0m22:57:00.269713 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.07173017, "process_in_blocks": "0", "process_kernel_time": 0.048022, "process_mem_max_rss": "96192", "process_out_blocks": "3", "process_user_time": 0.593275}
[0m22:57:00.269969 [debug] [MainThread]: Command `dbt clean` succeeded at 22:57:00.269909 after 0.07 seconds
[0m22:57:00.270208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5b920d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5b91f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5c2f7d0>]}
[0m22:57:00.270439 [debug] [MainThread]: Flushing usage events
[0m22:57:01.460846 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:57:09.516839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a112b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a12e510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89f5bd90>]}


============================== 22:57:09.518215 | 9ca1c92a-0999-453a-a081-bc2e69391b54 ==============================
[0m22:57:09.518215 [info ] [MainThread]: Running with dbt=1.9.0
[0m22:57:09.518604 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select dim_stations', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:57:09.578394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9ca1c92a-0999-453a-a081-bc2e69391b54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff894bfb10>]}
[0m22:57:09.600162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9ca1c92a-0999-453a-a081-bc2e69391b54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cb4dc90>]}
[0m22:57:09.600582 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:57:09.624816 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m22:57:09.625554 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:57:09.625824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9ca1c92a-0999-453a-a081-bc2e69391b54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8925ad10>]}
[0m22:57:09.967974 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m22:57:09.970384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9ca1c92a-0999-453a-a081-bc2e69391b54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ae565d0>]}
[0m22:57:10.022190 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m22:57:10.023860 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m22:57:10.029858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9ca1c92a-0999-453a-a081-bc2e69391b54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff891978d0>]}
[0m22:57:10.030151 [info ] [MainThread]: Found 1 model, 433 macros
[0m22:57:10.030413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9ca1c92a-0999-453a-a081-bc2e69391b54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8910b110>]}
[0m22:57:10.031113 [info ] [MainThread]: 
[0m22:57:10.031424 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:57:10.031687 [info ] [MainThread]: 
[0m22:57:10.032105 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:57:10.032610 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m22:57:10.047878 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m22:57:10.048202 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m22:57:10.048428 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:57:10.050924 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.002 seconds
[0m22:57:10.051530 [debug] [ThreadPool]: On list_airflow: Close
[0m22:57:10.052215 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_staging_dim)
[0m22:57:10.055010 [debug] [ThreadPool]: Using postgres connection "list_airflow_staging_dim"
[0m22:57:10.055230 [debug] [ThreadPool]: On list_airflow_staging_dim: BEGIN
[0m22:57:10.055418 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:57:10.056932 [debug] [ThreadPool]: SQL status: BEGIN in 0.001 seconds
[0m22:57:10.057189 [debug] [ThreadPool]: Using postgres connection "list_airflow_staging_dim"
[0m22:57:10.057387 [debug] [ThreadPool]: On list_airflow_staging_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_staging_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_dim'
  
[0m22:57:10.058738 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m22:57:10.059343 [debug] [ThreadPool]: On list_airflow_staging_dim: ROLLBACK
[0m22:57:10.059681 [debug] [ThreadPool]: On list_airflow_staging_dim: Close
[0m22:57:10.061760 [debug] [MainThread]: Using postgres connection "master"
[0m22:57:10.061996 [debug] [MainThread]: On master: BEGIN
[0m22:57:10.062188 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:57:10.063747 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m22:57:10.063981 [debug] [MainThread]: Using postgres connection "master"
[0m22:57:10.064213 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:57:10.067070 [debug] [MainThread]: SQL status: SELECT 1 in 0.003 seconds
[0m22:57:10.067622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9ca1c92a-0999-453a-a081-bc2e69391b54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a3b14d0>]}
[0m22:57:10.067875 [debug] [MainThread]: On master: ROLLBACK
[0m22:57:10.068163 [debug] [MainThread]: Using postgres connection "master"
[0m22:57:10.068346 [debug] [MainThread]: On master: BEGIN
[0m22:57:10.068671 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m22:57:10.068880 [debug] [MainThread]: On master: COMMIT
[0m22:57:10.069032 [debug] [MainThread]: Using postgres connection "master"
[0m22:57:10.069197 [debug] [MainThread]: On master: COMMIT
[0m22:57:10.069445 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:57:10.069634 [debug] [MainThread]: On master: Close
[0m22:57:10.070899 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.dim_stations
[0m22:57:10.071206 [info ] [Thread-1 (]: 1 of 1 START sql view model staging_dim.dim_stations ........................... [RUN]
[0m22:57:10.071488 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_staging_dim, now model.etl_waterlevel.dim_stations)
[0m22:57:10.071776 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.dim_stations
[0m22:57:10.074675 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.dim_stations"
[0m22:57:10.076165 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.dim_stations
[0m22:57:10.092253 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.dim_stations"
[0m22:57:10.093698 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m22:57:10.093913 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: BEGIN
[0m22:57:10.094143 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:57:10.095621 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m22:57:10.095839 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m22:57:10.096031 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.dim_stations"} */

  create view "airflow"."staging_dim"."dim_stations__dbt_tmp"
    
    
  as (
    -- models/dimensions/dim_stations.sql

with station_names as (
  select distinct
    "stationId"     as station_id,
    "stationName"   as station_name,
    "stationCode"   as station_code,
    "stationStatus" as station_status
  from raw.waterlevels
)

select * from station_names
  );
[0m22:57:10.097498 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m22:57:10.100082 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m22:57:10.100284 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.dim_stations"} */
alter table "airflow"."staging_dim"."dim_stations" rename to "dim_stations__dbt_backup"
[0m22:57:10.100569 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:57:10.101750 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m22:57:10.101918 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.dim_stations"} */
alter table "airflow"."staging_dim"."dim_stations__dbt_tmp" rename to "dim_stations"
[0m22:57:10.102182 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:57:10.109274 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: COMMIT
[0m22:57:10.109510 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m22:57:10.109715 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: COMMIT
[0m22:57:10.110328 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m22:57:10.113611 [debug] [Thread-1 (]: Applying DROP to: "airflow"."staging_dim"."dim_stations__dbt_backup"
[0m22:57:10.115632 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m22:57:10.115823 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.dim_stations"} */
drop view if exists "airflow"."staging_dim"."dim_stations__dbt_backup" cascade
[0m22:57:10.116642 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m22:57:10.117656 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: Close
[0m22:57:10.118410 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ca1c92a-0999-453a-a081-bc2e69391b54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8905aed0>]}
[0m22:57:10.118724 [info ] [Thread-1 (]: 1 of 1 OK created sql view model staging_dim.dim_stations ...................... [[32mCREATE VIEW[0m in 0.05s]
[0m22:57:10.119100 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.dim_stations
[0m22:57:10.119803 [debug] [MainThread]: Using postgres connection "master"
[0m22:57:10.119970 [debug] [MainThread]: On master: BEGIN
[0m22:57:10.120165 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:57:10.121471 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m22:57:10.121662 [debug] [MainThread]: On master: COMMIT
[0m22:57:10.121815 [debug] [MainThread]: Using postgres connection "master"
[0m22:57:10.121967 [debug] [MainThread]: On master: COMMIT
[0m22:57:10.122172 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:57:10.122306 [debug] [MainThread]: On master: Close
[0m22:57:10.122488 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:57:10.122623 [debug] [MainThread]: Connection 'model.etl_waterlevel.dim_stations' was properly closed.
[0m22:57:10.122764 [info ] [MainThread]: 
[0m22:57:10.122959 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.09 seconds (0.09s).
[0m22:57:10.123377 [debug] [MainThread]: Command end result
[0m22:57:10.135009 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m22:57:10.135937 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m22:57:10.138727 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m22:57:10.138887 [info ] [MainThread]: 
[0m22:57:10.139203 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:57:10.139381 [info ] [MainThread]: 
[0m22:57:10.139607 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m22:57:10.140091 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.6440561, "process_in_blocks": "0", "process_kernel_time": 0.070662, "process_mem_max_rss": "115648", "process_out_blocks": "2469", "process_user_time": 1.114673}
[0m22:57:10.140318 [debug] [MainThread]: Command `dbt run` succeeded at 22:57:10.140263 after 0.64 seconds
[0m22:57:10.140518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ac0f910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ea09250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ea09310>]}
[0m22:57:10.140692 [debug] [MainThread]: Flushing usage events
[0m22:57:11.393665 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:58:32.460573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7136c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa734e510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa71378d0>]}


============================== 22:58:32.462033 | 92e31f2f-69a5-42e6-913b-d84dc2b2b344 ==============================
[0m22:58:32.462033 [info ] [MainThread]: Running with dbt=1.9.0
[0m22:58:32.462503 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt ls --select dim_stations --output path', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:58:32.521841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '92e31f2f-69a5-42e6-913b-d84dc2b2b344', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa65c0110>]}
[0m22:58:32.543668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '92e31f2f-69a5-42e6-913b-d84dc2b2b344', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa63f9fd0>]}
[0m22:58:32.544040 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:58:32.568180 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m22:58:32.604219 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:58:32.604450 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:58:32.606643 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m22:58:32.615524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '92e31f2f-69a5-42e6-913b-d84dc2b2b344', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6fced10>]}
[0m22:58:32.642280 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m22:58:32.643650 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m22:58:32.647962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '92e31f2f-69a5-42e6-913b-d84dc2b2b344', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa62e0890>]}
[0m22:58:32.648199 [info ] [MainThread]: Found 1 model, 433 macros
[0m22:58:32.648379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '92e31f2f-69a5-42e6-913b-d84dc2b2b344', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa653de50>]}
[0m22:58:32.648788 [info ] [MainThread]: models/dimensions/dim_stations.sql
[0m22:58:32.649360 [debug] [MainThread]: Resource report: {"command_name": "list", "command_success": true, "command_wall_clock_time": 0.21016476, "process_in_blocks": "0", "process_kernel_time": 0.068031, "process_mem_max_rss": "105120", "process_out_blocks": "816", "process_user_time": 0.68131}
[0m22:58:32.649614 [debug] [MainThread]: Command `dbt ls` succeeded at 22:58:32.649574 after 0.21 seconds
[0m22:58:32.649811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaba952d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaba95810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa62e2650>]}
[0m22:58:32.650005 [debug] [MainThread]: Flushing usage events
[0m22:58:33.925762 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:59:25.799596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c83dcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c6927d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c690c90>]}


============================== 22:59:25.801037 | 1af78d8f-15ae-4609-9003-08dc34d0c12b ==============================
[0m22:59:25.801037 [info ] [MainThread]: Running with dbt=1.9.0
[0m22:59:25.801469 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --select dim_stations', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:59:25.861543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1af78d8f-15ae-4609-9003-08dc34d0c12b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bc9eed0>]}
[0m22:59:25.883496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1af78d8f-15ae-4609-9003-08dc34d0c12b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f2c9a90>]}
[0m22:59:25.883872 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:59:25.908597 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m22:59:25.944885 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:59:25.945123 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:59:25.947319 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m22:59:25.955979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1af78d8f-15ae-4609-9003-08dc34d0c12b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d5d7950>]}
[0m22:59:25.982621 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m22:59:25.984189 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m22:59:25.991077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1af78d8f-15ae-4609-9003-08dc34d0c12b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ba9a390>]}
[0m22:59:25.991401 [info ] [MainThread]: Found 1 model, 433 macros
[0m22:59:25.991691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1af78d8f-15ae-4609-9003-08dc34d0c12b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c82fd90>]}
[0m22:59:25.992388 [info ] [MainThread]: 
[0m22:59:25.992634 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:59:25.992887 [info ] [MainThread]: 
[0m22:59:25.993238 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:59:25.993840 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m22:59:26.008758 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m22:59:26.008997 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m22:59:26.009201 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:59:26.011721 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.003 seconds
[0m22:59:26.012308 [debug] [ThreadPool]: On list_airflow: Close
[0m22:59:26.012985 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_staging_dim)
[0m22:59:26.015703 [debug] [ThreadPool]: Using postgres connection "list_airflow_staging_dim"
[0m22:59:26.015906 [debug] [ThreadPool]: On list_airflow_staging_dim: BEGIN
[0m22:59:26.016099 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:59:26.017578 [debug] [ThreadPool]: SQL status: BEGIN in 0.001 seconds
[0m22:59:26.017792 [debug] [ThreadPool]: Using postgres connection "list_airflow_staging_dim"
[0m22:59:26.018035 [debug] [ThreadPool]: On list_airflow_staging_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_staging_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_dim'
  
[0m22:59:26.019381 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m22:59:26.019966 [debug] [ThreadPool]: On list_airflow_staging_dim: ROLLBACK
[0m22:59:26.020239 [debug] [ThreadPool]: On list_airflow_staging_dim: Close
[0m22:59:26.022231 [debug] [MainThread]: Using postgres connection "master"
[0m22:59:26.022453 [debug] [MainThread]: On master: BEGIN
[0m22:59:26.022633 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:59:26.024025 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m22:59:26.024273 [debug] [MainThread]: Using postgres connection "master"
[0m22:59:26.024500 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:59:26.027376 [debug] [MainThread]: SQL status: SELECT 1 in 0.003 seconds
[0m22:59:26.027955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1af78d8f-15ae-4609-9003-08dc34d0c12b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bc1b9d0>]}
[0m22:59:26.028281 [debug] [MainThread]: On master: ROLLBACK
[0m22:59:26.028544 [debug] [MainThread]: Using postgres connection "master"
[0m22:59:26.028726 [debug] [MainThread]: On master: BEGIN
[0m22:59:26.029075 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m22:59:26.029317 [debug] [MainThread]: On master: COMMIT
[0m22:59:26.029490 [debug] [MainThread]: Using postgres connection "master"
[0m22:59:26.029657 [debug] [MainThread]: On master: COMMIT
[0m22:59:26.029906 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:59:26.030124 [debug] [MainThread]: On master: Close
[0m22:59:26.031396 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.dim_stations
[0m22:59:26.031690 [info ] [Thread-1 (]: 1 of 1 START sql view model staging_dim.dim_stations ........................... [RUN]
[0m22:59:26.031936 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_staging_dim, now model.etl_waterlevel.dim_stations)
[0m22:59:26.032208 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.dim_stations
[0m22:59:26.035138 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.dim_stations"
[0m22:59:26.036271 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.dim_stations
[0m22:59:26.052195 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.dim_stations"
[0m22:59:26.052971 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m22:59:26.053204 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: BEGIN
[0m22:59:26.053390 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:59:26.054837 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m22:59:26.055091 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m22:59:26.055294 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.dim_stations"} */

  create view "airflow"."staging_dim"."dim_stations__dbt_tmp"
    
    
  as (
    -- models/dimensions/dim_stations.sql

with station_names as (
  select distinct
    "stationId"     as station_id,
    "stationName"   as station_name,
    "stationCode"   as station_code,
    "stationStatus" as station_status
  from raw.waterlevels
)

select * from station_names
  );
[0m22:59:26.056246 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m22:59:26.058868 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m22:59:26.059072 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.dim_stations"} */
alter table "airflow"."staging_dim"."dim_stations" rename to "dim_stations__dbt_backup"
[0m22:59:26.059395 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:59:26.060629 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m22:59:26.060804 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.dim_stations"} */
alter table "airflow"."staging_dim"."dim_stations__dbt_tmp" rename to "dim_stations"
[0m22:59:26.061076 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:59:26.068394 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: COMMIT
[0m22:59:26.068619 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m22:59:26.068816 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: COMMIT
[0m22:59:26.069539 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m22:59:26.072082 [debug] [Thread-1 (]: Applying DROP to: "airflow"."staging_dim"."dim_stations__dbt_backup"
[0m22:59:26.074144 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m22:59:26.074364 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.dim_stations"} */
drop view if exists "airflow"."staging_dim"."dim_stations__dbt_backup" cascade
[0m22:59:26.075001 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m22:59:26.076004 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: Close
[0m22:59:26.076803 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1af78d8f-15ae-4609-9003-08dc34d0c12b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bc6fb10>]}
[0m22:59:26.077159 [info ] [Thread-1 (]: 1 of 1 OK created sql view model staging_dim.dim_stations ...................... [[32mCREATE VIEW[0m in 0.04s]
[0m22:59:26.077496 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.dim_stations
[0m22:59:26.078255 [debug] [MainThread]: Using postgres connection "master"
[0m22:59:26.078442 [debug] [MainThread]: On master: BEGIN
[0m22:59:26.078597 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:59:26.079891 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m22:59:26.080133 [debug] [MainThread]: On master: COMMIT
[0m22:59:26.080282 [debug] [MainThread]: Using postgres connection "master"
[0m22:59:26.080429 [debug] [MainThread]: On master: COMMIT
[0m22:59:26.080627 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:59:26.080763 [debug] [MainThread]: On master: Close
[0m22:59:26.080952 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:59:26.081086 [debug] [MainThread]: Connection 'model.etl_waterlevel.dim_stations' was properly closed.
[0m22:59:26.081252 [info ] [MainThread]: 
[0m22:59:26.081435 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.09 seconds (0.09s).
[0m22:59:26.081826 [debug] [MainThread]: Command end result
[0m22:59:26.093866 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m22:59:26.094829 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m22:59:26.097584 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m22:59:26.097751 [info ] [MainThread]: 
[0m22:59:26.097983 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:59:26.098186 [info ] [MainThread]: 
[0m22:59:26.098422 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m22:59:26.098902 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.32045817, "process_in_blocks": "0", "process_kernel_time": 0.098854, "process_mem_max_rss": "113620", "process_out_blocks": "1653", "process_user_time": 0.808812}
[0m22:59:26.099152 [debug] [MainThread]: Command `dbt run` succeeded at 22:59:26.099112 after 0.32 seconds
[0m22:59:26.099334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c690950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff811a5190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff811a5310>]}
[0m22:59:26.099503 [debug] [MainThread]: Flushing usage events
[0m22:59:27.195695 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:01:40.605196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80f3ccd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81155f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81156510>]}


============================== 23:01:40.606880 | 4441b8e3-8d2c-400b-b598-33c9c8bb10dd ==============================
[0m23:01:40.606880 [info ] [MainThread]: Running with dbt=1.9.0
[0m23:01:40.607266 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt compile -m dim_stations', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:01:40.666894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4441b8e3-8d2c-400b-b598-33c9c8bb10dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80d95f50>]}
[0m23:01:40.688735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4441b8e3-8d2c-400b-b598-33c9c8bb10dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff839d9b10>]}
[0m23:01:40.689129 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:01:40.713438 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m23:01:40.749571 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:01:40.749800 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:01:40.752031 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m23:01:40.760643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4441b8e3-8d2c-400b-b598-33c9c8bb10dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8003c350>]}
[0m23:01:40.786298 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m23:01:40.787573 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m23:01:40.792297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4441b8e3-8d2c-400b-b598-33c9c8bb10dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff800c1bd0>]}
[0m23:01:40.792544 [info ] [MainThread]: Found 1 model, 433 macros
[0m23:01:40.792832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4441b8e3-8d2c-400b-b598-33c9c8bb10dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff801b7dd0>]}
[0m23:01:40.793569 [info ] [MainThread]: 
[0m23:01:40.793774 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:01:40.794054 [info ] [MainThread]: 
[0m23:01:40.794360 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:01:40.794800 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow_staging_dim'
[0m23:01:40.811008 [debug] [ThreadPool]: Using postgres connection "list_airflow_staging_dim"
[0m23:01:40.811314 [debug] [ThreadPool]: On list_airflow_staging_dim: BEGIN
[0m23:01:40.811524 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:01:40.813861 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m23:01:40.814116 [debug] [ThreadPool]: Using postgres connection "list_airflow_staging_dim"
[0m23:01:40.814353 [debug] [ThreadPool]: On list_airflow_staging_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_staging_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_dim'
  
[0m23:01:40.815723 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m23:01:40.816364 [debug] [ThreadPool]: On list_airflow_staging_dim: ROLLBACK
[0m23:01:40.816684 [debug] [ThreadPool]: On list_airflow_staging_dim: Close
[0m23:01:40.819111 [debug] [MainThread]: Using postgres connection "master"
[0m23:01:40.819333 [debug] [MainThread]: On master: BEGIN
[0m23:01:40.819516 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:01:40.821147 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m23:01:40.821418 [debug] [MainThread]: Using postgres connection "master"
[0m23:01:40.821677 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:01:40.824471 [debug] [MainThread]: SQL status: SELECT 1 in 0.003 seconds
[0m23:01:40.825089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4441b8e3-8d2c-400b-b598-33c9c8bb10dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ff58550>]}
[0m23:01:40.825339 [debug] [MainThread]: On master: ROLLBACK
[0m23:01:40.825614 [debug] [MainThread]: On master: Close
[0m23:01:40.827241 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.dim_stations
[0m23:01:40.827579 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_staging_dim, now model.etl_waterlevel.dim_stations)
[0m23:01:40.827813 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.dim_stations
[0m23:01:40.831174 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.dim_stations"
[0m23:01:40.831890 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.dim_stations
[0m23:01:40.832231 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.dim_stations
[0m23:01:40.832893 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:01:40.833136 [debug] [MainThread]: Connection 'model.etl_waterlevel.dim_stations' was properly closed.
[0m23:01:40.833471 [debug] [MainThread]: Command end result
[0m23:01:40.843833 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m23:01:40.844849 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m23:01:40.847813 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m23:01:40.847994 [info ] [MainThread]: Compiled node 'dim_stations' is:
-- models/dimensions/dim_stations.sql

with station_names as (
  select distinct
    "stationId"     as station_id,
    "stationName"   as station_name,
    "stationCode"   as station_code,
    "stationStatus" as station_status
  from raw.waterlevels
)

select * from station_names
[0m23:01:40.848541 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 0.2651643, "process_in_blocks": "0", "process_kernel_time": 0.075847, "process_mem_max_rss": "112736", "process_out_blocks": "1640", "process_user_time": 0.759474}
[0m23:01:40.848798 [debug] [MainThread]: Command `dbt compile` succeeded at 23:01:40.848746 after 0.27 seconds
[0m23:01:40.849005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80db2190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80d95e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80d969d0>]}
[0m23:01:40.849194 [debug] [MainThread]: Flushing usage events
[0m23:01:42.139133 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:09:59.475430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bc3f590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e901a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bc3ef50>]}


============================== 23:09:59.476873 | 84160041-59d0-4b65-8eb2-8d010134d1e9 ==============================
[0m23:09:59.476873 [info ] [MainThread]: Running with dbt=1.9.0
[0m23:09:59.477227 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:09:59.518195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '84160041-59d0-4b65-8eb2-8d010134d1e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ba6ae10>]}
[0m23:09:59.526589 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.07222112, "process_in_blocks": "0", "process_kernel_time": 0.05206, "process_mem_max_rss": "96160", "process_out_blocks": "3", "process_user_time": 0.58969}
[0m23:09:59.526994 [debug] [MainThread]: Command `dbt clean` succeeded at 23:09:59.526952 after 0.07 seconds
[0m23:09:59.527202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ba94ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ba96210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ba967d0>]}
[0m23:09:59.527421 [debug] [MainThread]: Flushing usage events
[0m23:10:00.830993 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:10:53.000026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1e47510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1f7c610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1e47bd0>]}


============================== 23:10:53.001422 | a1e3556e-b31b-483e-a1b1-c0e7fb8b1e80 ==============================
[0m23:10:53.001422 [info ] [MainThread]: Running with dbt=1.9.0
[0m23:10:53.001843 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:10:53.061002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a1e3556e-b31b-483e-a1b1-c0e7fb8b1e80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1291450>]}
[0m23:10:53.082762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a1e3556e-b31b-483e-a1b1-c0e7fb8b1e80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4920b50>]}
[0m23:10:53.083129 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:10:53.107356 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m23:10:53.107949 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m23:10:53.108277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a1e3556e-b31b-483e-a1b1-c0e7fb8b1e80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1023010>]}
[0m23:10:53.447205 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m23:10:53.449861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a1e3556e-b31b-483e-a1b1-c0e7fb8b1e80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb10c5650>]}
[0m23:10:53.501623 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m23:10:53.503218 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m23:10:53.509207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a1e3556e-b31b-483e-a1b1-c0e7fb8b1e80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb10a3550>]}
[0m23:10:53.509525 [info ] [MainThread]: Found 1 model, 433 macros
[0m23:10:53.509758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a1e3556e-b31b-483e-a1b1-c0e7fb8b1e80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0edb110>]}
[0m23:10:53.510588 [info ] [MainThread]: 
[0m23:10:53.510842 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:10:53.511095 [info ] [MainThread]: 
[0m23:10:53.511550 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:10:53.512054 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m23:10:53.526004 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m23:10:53.526261 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m23:10:53.526460 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:10:53.528926 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.002 seconds
[0m23:10:53.529583 [debug] [ThreadPool]: On list_airflow: Close
[0m23:10:53.530245 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_staging_dim)
[0m23:10:53.533051 [debug] [ThreadPool]: Using postgres connection "list_airflow_staging_dim"
[0m23:10:53.533267 [debug] [ThreadPool]: On list_airflow_staging_dim: BEGIN
[0m23:10:53.533461 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:10:53.535016 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m23:10:53.535265 [debug] [ThreadPool]: Using postgres connection "list_airflow_staging_dim"
[0m23:10:53.535466 [debug] [ThreadPool]: On list_airflow_staging_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_staging_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_dim'
  
[0m23:10:53.536707 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m23:10:53.537300 [debug] [ThreadPool]: On list_airflow_staging_dim: ROLLBACK
[0m23:10:53.537566 [debug] [ThreadPool]: On list_airflow_staging_dim: Close
[0m23:10:53.539610 [debug] [MainThread]: Using postgres connection "master"
[0m23:10:53.539808 [debug] [MainThread]: On master: BEGIN
[0m23:10:53.539983 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:10:53.541343 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m23:10:53.541646 [debug] [MainThread]: Using postgres connection "master"
[0m23:10:53.541893 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:10:53.544758 [debug] [MainThread]: SQL status: SELECT 1 in 0.003 seconds
[0m23:10:53.545326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a1e3556e-b31b-483e-a1b1-c0e7fb8b1e80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0210cd0>]}
[0m23:10:53.545578 [debug] [MainThread]: On master: ROLLBACK
[0m23:10:53.545877 [debug] [MainThread]: Using postgres connection "master"
[0m23:10:53.546084 [debug] [MainThread]: On master: BEGIN
[0m23:10:53.546476 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:10:53.546742 [debug] [MainThread]: On master: COMMIT
[0m23:10:53.547003 [debug] [MainThread]: Using postgres connection "master"
[0m23:10:53.547225 [debug] [MainThread]: On master: COMMIT
[0m23:10:53.547523 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:10:53.547713 [debug] [MainThread]: On master: Close
[0m23:10:53.548971 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.dim_stations
[0m23:10:53.549305 [info ] [Thread-1 (]: 1 of 1 START sql view model staging_dim.dim_stations ........................... [RUN]
[0m23:10:53.549576 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_staging_dim, now model.etl_waterlevel.dim_stations)
[0m23:10:53.549824 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.dim_stations
[0m23:10:53.552815 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.dim_stations"
[0m23:10:53.554300 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.dim_stations
[0m23:10:53.570799 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.dim_stations"
[0m23:10:53.572270 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m23:10:53.572523 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: BEGIN
[0m23:10:53.572737 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:10:53.574476 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m23:10:53.574762 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m23:10:53.574958 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.dim_stations"} */

  create view "airflow"."staging_dim"."dim_stations__dbt_tmp"
    
    
  as (
    -- models/dimensions/dim_stations.sql

with station_names as (
  select distinct
    "stationId"     as station_id,
    "stationName"   as station_name,
    "stationCode"   as station_code,
    "stationStatus" as station_status
  from raw.waterlevels
)

select * from station_names
  );
[0m23:10:53.576080 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m23:10:53.578823 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m23:10:53.579036 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.dim_stations"} */
alter table "airflow"."staging_dim"."dim_stations" rename to "dim_stations__dbt_backup"
[0m23:10:53.579382 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:10:53.580615 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m23:10:53.580808 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.dim_stations"} */
alter table "airflow"."staging_dim"."dim_stations__dbt_tmp" rename to "dim_stations"
[0m23:10:53.581090 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:10:53.588539 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: COMMIT
[0m23:10:53.588812 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m23:10:53.589040 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: COMMIT
[0m23:10:53.589547 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m23:10:53.592754 [debug] [Thread-1 (]: Applying DROP to: "airflow"."staging_dim"."dim_stations__dbt_backup"
[0m23:10:53.594873 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m23:10:53.595063 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.dim_stations"} */
drop view if exists "airflow"."staging_dim"."dim_stations__dbt_backup" cascade
[0m23:10:53.595692 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m23:10:53.596801 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: Close
[0m23:10:53.597600 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a1e3556e-b31b-483e-a1b1-c0e7fb8b1e80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb02dd210>]}
[0m23:10:53.597930 [info ] [Thread-1 (]: 1 of 1 OK created sql view model staging_dim.dim_stations ...................... [[32mCREATE VIEW[0m in 0.05s]
[0m23:10:53.598245 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.dim_stations
[0m23:10:53.599003 [debug] [MainThread]: Using postgres connection "master"
[0m23:10:53.599209 [debug] [MainThread]: On master: BEGIN
[0m23:10:53.599355 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:10:53.600713 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m23:10:53.600913 [debug] [MainThread]: On master: COMMIT
[0m23:10:53.601061 [debug] [MainThread]: Using postgres connection "master"
[0m23:10:53.601215 [debug] [MainThread]: On master: COMMIT
[0m23:10:53.601426 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:10:53.601567 [debug] [MainThread]: On master: Close
[0m23:10:53.601753 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:10:53.601888 [debug] [MainThread]: Connection 'model.etl_waterlevel.dim_stations' was properly closed.
[0m23:10:53.602034 [info ] [MainThread]: 
[0m23:10:53.602225 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.09 seconds (0.09s).
[0m23:10:53.602615 [debug] [MainThread]: Command end result
[0m23:10:53.613982 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m23:10:53.614915 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m23:10:53.617581 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m23:10:53.617739 [info ] [MainThread]: 
[0m23:10:53.617998 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:10:53.618194 [info ] [MainThread]: 
[0m23:10:53.618576 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:10:53.619091 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.6400153, "process_in_blocks": "0", "process_kernel_time": 0.079844, "process_mem_max_rss": "115648", "process_out_blocks": "2469", "process_user_time": 1.099854}
[0m23:10:53.619329 [debug] [MainThread]: Command `dbt run` succeeded at 23:10:53.619283 after 0.64 seconds
[0m23:10:53.619531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1cbffd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1cbff10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb29475d0>]}
[0m23:10:53.619712 [debug] [MainThread]: Flushing usage events
[0m23:10:54.897067 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:11:08.903827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91533090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91383e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91533c90>]}


============================== 23:11:08.905245 | 09bd25d3-29c3-4881-bb6d-ca22a3f2fda5 ==============================
[0m23:11:08.905245 [info ] [MainThread]: Running with dbt=1.9.0
[0m23:11:08.905636 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:11:08.923100 [error] [MainThread]: Encountered an error:
Runtime Error
  Credentials in profile "etl_waterlevel", target "dev" invalid: None is not of type 'string'
[0m23:11:08.923775 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.041203916, "process_in_blocks": "0", "process_kernel_time": 0.051995, "process_mem_max_rss": "97928", "process_out_blocks": "2", "process_user_time": 0.558951}
[0m23:11:08.924069 [debug] [MainThread]: Command `dbt run` failed at 23:11:08.924011 after 0.04 seconds
[0m23:11:08.924339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9153c050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff913abd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91384690>]}
[0m23:11:08.924603 [debug] [MainThread]: Flushing usage events
[0m23:11:10.154807 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:11:26.451669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb573f950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb573f710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb573f110>]}


============================== 23:11:26.453214 | 5408bf74-076f-4353-afd7-9835c92b9878 ==============================
[0m23:11:26.453214 [info ] [MainThread]: Running with dbt=1.9.0
[0m23:11:26.453608 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m23:11:26.472362 [error] [MainThread]: Encountered an error:
Runtime Error
  Credentials in profile "etl_waterlevel", target "dev" invalid: 'schema' is a required property
[0m23:11:26.472982 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.04327679, "process_in_blocks": "0", "process_kernel_time": 0.051945, "process_mem_max_rss": "97944", "process_out_blocks": "2", "process_user_time": 0.561415}
[0m23:11:26.473260 [debug] [MainThread]: Command `dbt run` failed at 23:11:26.473199 after 0.04 seconds
[0m23:11:26.473500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb55b4490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba1c5590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba055150>]}
[0m23:11:26.473743 [debug] [MainThread]: Flushing usage events
[0m23:11:27.869740 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:14:53.626021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b943390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b95de50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ba788d0>]}


============================== 23:14:53.627425 | b3d07bf2-6a3a-49be-ba4b-1c56d4cee92e ==============================
[0m23:14:53.627425 [info ] [MainThread]: Running with dbt=1.9.0
[0m23:14:53.627801 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:14:53.687150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b3d07bf2-6a3a-49be-ba4b-1c56d4cee92e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9dfdf990>]}
[0m23:14:53.709108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b3d07bf2-6a3a-49be-ba4b-1c56d4cee92e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e3789d0>]}
[0m23:14:53.709473 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:14:53.733597 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m23:14:53.760610 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m23:14:53.760972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b3d07bf2-6a3a-49be-ba4b-1c56d4cee92e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ad893d0>]}
[0m23:14:54.017589 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.etl_waterlevel.dimensions
- models.etl_waterlevel.staging
[0m23:14:54.019920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b3d07bf2-6a3a-49be-ba4b-1c56d4cee92e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ab5ae50>]}
[0m23:14:54.039132 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m23:14:54.040430 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m23:14:54.072574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b3d07bf2-6a3a-49be-ba4b-1c56d4cee92e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9aa6fa50>]}
[0m23:14:54.072954 [info ] [MainThread]: Found 433 macros
[0m23:14:54.073223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b3d07bf2-6a3a-49be-ba4b-1c56d4cee92e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a9e6b90>]}
[0m23:14:54.074051 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m23:14:54.074423 [debug] [MainThread]: Command end result
[0m23:14:54.086699 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m23:14:54.087714 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m23:14:54.089343 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m23:14:54.089845 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.4857547, "process_in_blocks": "0", "process_kernel_time": 0.06438, "process_mem_max_rss": "105604", "process_out_blocks": "2426", "process_user_time": 0.97577}
[0m23:14:54.090054 [debug] [MainThread]: Command `dbt run` succeeded at 23:14:54.090014 after 0.49 seconds
[0m23:14:54.090237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0229490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0228650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0229610>]}
[0m23:14:54.090441 [debug] [MainThread]: Flushing usage events
[0m23:14:55.434697 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:15:17.683506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaec3f0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaec3f510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaec3c050>]}


============================== 23:15:17.684915 | 915f91ec-e114-446a-853b-d9af10fd6b83 ==============================
[0m23:15:17.684915 [info ] [MainThread]: Running with dbt=1.9.0
[0m23:15:17.685328 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:15:17.727446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '915f91ec-e114-446a-853b-d9af10fd6b83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaeb271d0>]}
[0m23:15:17.736011 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.07375533, "process_in_blocks": "0", "process_kernel_time": 0.068991, "process_mem_max_rss": "96164", "process_out_blocks": "3", "process_user_time": 0.582931}
[0m23:15:17.736326 [debug] [MainThread]: Command `dbt clean` succeeded at 23:15:17.736254 after 0.07 seconds
[0m23:15:17.736668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaea6b910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaea6ab50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaea69390>]}
[0m23:15:17.736988 [debug] [MainThread]: Flushing usage events
[0m23:15:18.781124 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:15:21.156098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3942b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3797b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3a380d0>]}


============================== 23:15:21.157497 | 324cf830-ccd4-42ee-bb25-3340026ec353 ==============================
[0m23:15:21.157497 [info ] [MainThread]: Running with dbt=1.9.0
[0m23:15:21.157941 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:15:21.217714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '324cf830-ccd4-42ee-bb25-3340026ec353', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb37d9010>]}
[0m23:15:21.239777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '324cf830-ccd4-42ee-bb25-3340026ec353', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb637a590>]}
[0m23:15:21.240171 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:15:21.269115 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m23:15:21.269666 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m23:15:21.269911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '324cf830-ccd4-42ee-bb25-3340026ec353', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2a8f610>]}
[0m23:15:21.526950 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.etl_waterlevel.dimensions
- models.etl_waterlevel.staging
[0m23:15:21.529227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '324cf830-ccd4-42ee-bb25-3340026ec353', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2b69d90>]}
[0m23:15:21.549984 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m23:15:21.551483 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m23:15:21.561032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '324cf830-ccd4-42ee-bb25-3340026ec353', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2a22310>]}
[0m23:15:21.561262 [info ] [MainThread]: Found 433 macros
[0m23:15:21.561470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '324cf830-ccd4-42ee-bb25-3340026ec353', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2980ed0>]}
[0m23:15:21.562104 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m23:15:21.562473 [debug] [MainThread]: Command end result
[0m23:15:21.573339 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m23:15:21.574052 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m23:15:21.575618 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m23:15:21.576093 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.44097295, "process_in_blocks": "0", "process_kernel_time": 0.070894, "process_mem_max_rss": "106196", "process_out_blocks": "2579", "process_user_time": 0.922626}
[0m23:15:21.576493 [debug] [MainThread]: Command `dbt run` succeeded at 23:15:21.576341 after 0.44 seconds
[0m23:15:21.576775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2b323d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb29e4250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb82290d0>]}
[0m23:15:21.577038 [debug] [MainThread]: Flushing usage events
[0m23:15:22.790004 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:18:06.334523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ae2f710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b046510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ae2f1d0>]}


============================== 23:18:06.335918 | bf33b3dc-3723-44f8-84de-67fbca80e22c ==============================
[0m23:18:06.335918 [info ] [MainThread]: Running with dbt=1.9.0
[0m23:18:06.336312 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:18:06.395813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bf33b3dc-3723-44f8-84de-67fbca80e22c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ae2c5d0>]}
[0m23:18:06.417578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bf33b3dc-3723-44f8-84de-67fbca80e22c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d890e50>]}
[0m23:18:06.417939 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:18:06.442059 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m23:18:06.460296 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m23:18:06.460640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'bf33b3dc-3723-44f8-84de-67fbca80e22c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ba542d0>]}
[0m23:18:06.829068 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m23:18:06.831513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bf33b3dc-3723-44f8-84de-67fbca80e22c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a06b9d0>]}
[0m23:18:06.861172 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m23:18:06.862798 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m23:18:06.868517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bf33b3dc-3723-44f8-84de-67fbca80e22c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79e2cfd0>]}
[0m23:18:06.868769 [info ] [MainThread]: Found 1 model, 433 macros
[0m23:18:06.868944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bf33b3dc-3723-44f8-84de-67fbca80e22c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79fb72d0>]}
[0m23:18:06.869728 [info ] [MainThread]: 
[0m23:18:06.869951 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:18:06.870156 [info ] [MainThread]: 
[0m23:18:06.870475 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:18:06.870952 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m23:18:06.886534 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m23:18:06.886798 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m23:18:06.887002 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:18:06.889466 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.002 seconds
[0m23:18:06.890049 [debug] [ThreadPool]: On list_airflow: Close
[0m23:18:06.890699 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_staging_dim)
[0m23:18:06.893664 [debug] [ThreadPool]: Using postgres connection "list_airflow_staging_dim"
[0m23:18:06.893927 [debug] [ThreadPool]: On list_airflow_staging_dim: BEGIN
[0m23:18:06.894139 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:18:06.896016 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m23:18:06.896396 [debug] [ThreadPool]: Using postgres connection "list_airflow_staging_dim"
[0m23:18:06.896653 [debug] [ThreadPool]: On list_airflow_staging_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_staging_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_dim'
  
[0m23:18:06.898027 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m23:18:06.898681 [debug] [ThreadPool]: On list_airflow_staging_dim: ROLLBACK
[0m23:18:06.898962 [debug] [ThreadPool]: On list_airflow_staging_dim: Close
[0m23:18:06.901159 [debug] [MainThread]: Using postgres connection "master"
[0m23:18:06.901358 [debug] [MainThread]: On master: BEGIN
[0m23:18:06.901531 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:18:06.903134 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m23:18:06.903390 [debug] [MainThread]: Using postgres connection "master"
[0m23:18:06.903655 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:18:06.906495 [debug] [MainThread]: SQL status: SELECT 1 in 0.003 seconds
[0m23:18:06.907060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bf33b3dc-3723-44f8-84de-67fbca80e22c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a2117d0>]}
[0m23:18:06.907351 [debug] [MainThread]: On master: ROLLBACK
[0m23:18:06.907622 [debug] [MainThread]: Using postgres connection "master"
[0m23:18:06.907822 [debug] [MainThread]: On master: BEGIN
[0m23:18:06.908253 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:18:06.908725 [debug] [MainThread]: On master: COMMIT
[0m23:18:06.908945 [debug] [MainThread]: Using postgres connection "master"
[0m23:18:06.909147 [debug] [MainThread]: On master: COMMIT
[0m23:18:06.909500 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:18:06.909715 [debug] [MainThread]: On master: Close
[0m23:18:06.911071 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.dim_stations
[0m23:18:06.911426 [info ] [Thread-1 (]: 1 of 1 START sql view model staging_dim.dim_stations ........................... [RUN]
[0m23:18:06.911776 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_staging_dim, now model.etl_waterlevel.dim_stations)
[0m23:18:06.912006 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.dim_stations
[0m23:18:06.915098 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.dim_stations"
[0m23:18:06.916641 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.dim_stations
[0m23:18:06.934079 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.dim_stations"
[0m23:18:06.935671 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m23:18:06.935862 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: BEGIN
[0m23:18:06.936016 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:18:06.937753 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m23:18:06.937989 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m23:18:06.938189 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.dim_stations"} */

  create view "airflow"."staging_dim"."dim_stations__dbt_tmp"
    
    
  as (
    -- models/dimensions/dim_stations.sql

with station_names as (
  select distinct
    "stationId"     as station_id,
    "stationName"   as station_name,
    "stationCode"   as station_code,
    "stationStatus" as station_status
  from raw.waterlevels
)

select * from station_names
  );
[0m23:18:06.939321 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m23:18:06.942083 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m23:18:06.942323 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.dim_stations"} */
alter table "airflow"."staging_dim"."dim_stations" rename to "dim_stations__dbt_backup"
[0m23:18:06.942686 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:18:06.944004 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m23:18:06.944219 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.dim_stations"} */
alter table "airflow"."staging_dim"."dim_stations__dbt_tmp" rename to "dim_stations"
[0m23:18:06.944599 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:18:06.951762 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: COMMIT
[0m23:18:06.952001 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m23:18:06.952217 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: COMMIT
[0m23:18:06.952901 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m23:18:06.955579 [debug] [Thread-1 (]: Applying DROP to: "airflow"."staging_dim"."dim_stations__dbt_backup"
[0m23:18:06.957618 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m23:18:06.957810 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.dim_stations"} */
drop view if exists "airflow"."staging_dim"."dim_stations__dbt_backup" cascade
[0m23:18:06.958493 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m23:18:06.959584 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: Close
[0m23:18:06.960436 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf33b3dc-3723-44f8-84de-67fbca80e22c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d31a150>]}
[0m23:18:06.960764 [info ] [Thread-1 (]: 1 of 1 OK created sql view model staging_dim.dim_stations ...................... [[32mCREATE VIEW[0m in 0.05s]
[0m23:18:06.961040 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.dim_stations
[0m23:18:06.961834 [debug] [MainThread]: Using postgres connection "master"
[0m23:18:06.962039 [debug] [MainThread]: On master: BEGIN
[0m23:18:06.962200 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:18:06.963562 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m23:18:06.963758 [debug] [MainThread]: On master: COMMIT
[0m23:18:06.963929 [debug] [MainThread]: Using postgres connection "master"
[0m23:18:06.964083 [debug] [MainThread]: On master: COMMIT
[0m23:18:06.964308 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:18:06.964488 [debug] [MainThread]: On master: Close
[0m23:18:06.964685 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:18:06.964827 [debug] [MainThread]: Connection 'model.etl_waterlevel.dim_stations' was properly closed.
[0m23:18:06.964976 [info ] [MainThread]: 
[0m23:18:06.965179 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.09 seconds (0.09s).
[0m23:18:06.965575 [debug] [MainThread]: Command end result
[0m23:18:06.978330 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m23:18:06.979160 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m23:18:06.981965 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m23:18:06.982133 [info ] [MainThread]: 
[0m23:18:06.982399 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:18:06.982593 [info ] [MainThread]: 
[0m23:18:06.982829 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:18:06.983507 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.6698799, "process_in_blocks": "0", "process_kernel_time": 0.061185, "process_mem_max_rss": "115952", "process_out_blocks": "2469", "process_user_time": 1.132436}
[0m23:18:06.983706 [debug] [MainThread]: Command `dbt run` succeeded at 23:18:06.983670 after 0.67 seconds
[0m23:18:06.983882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7aca43d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7aca6510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f708650>]}
[0m23:18:06.984047 [debug] [MainThread]: Flushing usage events
[0m23:18:08.458889 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:19:20.269551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9b3b950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9d56510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa996f310>]}


============================== 23:19:20.270903 | e30d3ac9-f93c-4c99-8cdc-f288da1c0645 ==============================
[0m23:19:20.270903 [info ] [MainThread]: Running with dbt=1.9.0
[0m23:19:20.271308 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt compile -m dim_stations', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:19:20.330785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e30d3ac9-f93c-4c99-8cdc-f288da1c0645', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8f10d90>]}
[0m23:19:20.352696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e30d3ac9-f93c-4c99-8cdc-f288da1c0645', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac5de290>]}
[0m23:19:20.353068 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:19:20.377254 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m23:19:20.413505 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:19:20.413735 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:19:20.416007 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m23:19:20.424636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e30d3ac9-f93c-4c99-8cdc-f288da1c0645', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8bbd4d0>]}
[0m23:19:20.452356 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m23:19:20.453842 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m23:19:20.458353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e30d3ac9-f93c-4c99-8cdc-f288da1c0645', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8eed610>]}
[0m23:19:20.458602 [info ] [MainThread]: Found 1 model, 433 macros
[0m23:19:20.458863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e30d3ac9-f93c-4c99-8cdc-f288da1c0645', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8d24910>]}
[0m23:19:20.459600 [info ] [MainThread]: 
[0m23:19:20.459831 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:19:20.460062 [info ] [MainThread]: 
[0m23:19:20.460395 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:19:20.460807 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow_staging_dim'
[0m23:19:20.475493 [debug] [ThreadPool]: Using postgres connection "list_airflow_staging_dim"
[0m23:19:20.475721 [debug] [ThreadPool]: On list_airflow_staging_dim: BEGIN
[0m23:19:20.475905 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:19:20.478045 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m23:19:20.478313 [debug] [ThreadPool]: Using postgres connection "list_airflow_staging_dim"
[0m23:19:20.478535 [debug] [ThreadPool]: On list_airflow_staging_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_staging_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_dim'
  
[0m23:19:20.479836 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m23:19:20.480432 [debug] [ThreadPool]: On list_airflow_staging_dim: ROLLBACK
[0m23:19:20.480711 [debug] [ThreadPool]: On list_airflow_staging_dim: Close
[0m23:19:20.482877 [debug] [MainThread]: Using postgres connection "master"
[0m23:19:20.483098 [debug] [MainThread]: On master: BEGIN
[0m23:19:20.483256 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:19:20.484705 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m23:19:20.484944 [debug] [MainThread]: Using postgres connection "master"
[0m23:19:20.485165 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:19:20.487911 [debug] [MainThread]: SQL status: SELECT 1 in 0.003 seconds
[0m23:19:20.488502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e30d3ac9-f93c-4c99-8cdc-f288da1c0645', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8d66b90>]}
[0m23:19:20.488744 [debug] [MainThread]: On master: ROLLBACK
[0m23:19:20.488997 [debug] [MainThread]: On master: Close
[0m23:19:20.490557 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.dim_stations
[0m23:19:20.490822 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_staging_dim, now model.etl_waterlevel.dim_stations)
[0m23:19:20.491030 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.dim_stations
[0m23:19:20.494365 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.dim_stations"
[0m23:19:20.495159 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.dim_stations
[0m23:19:20.495510 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.dim_stations
[0m23:19:20.496126 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:19:20.496306 [debug] [MainThread]: Connection 'model.etl_waterlevel.dim_stations' was properly closed.
[0m23:19:20.496622 [debug] [MainThread]: Command end result
[0m23:19:20.506871 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m23:19:20.507891 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m23:19:20.510807 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m23:19:20.510996 [info ] [MainThread]: Compiled node 'dim_stations' is:
-- models/dimensions/dim_stations.sql

with station_names as (
  select distinct
    "stationId"     as station_id,
    "stationName"   as station_name,
    "stationCode"   as station_code,
    "stationStatus" as station_status
  from raw.waterlevels
)

select * from station_names
[0m23:19:20.511511 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 0.2629539, "process_in_blocks": "0", "process_kernel_time": 0.070497, "process_mem_max_rss": "112580", "process_out_blocks": "1641", "process_user_time": 0.738738}
[0m23:19:20.511727 [debug] [MainThread]: Command `dbt compile` succeeded at 23:19:20.511683 after 0.26 seconds
[0m23:19:20.511909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9d41e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa63b550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9e18290>]}
[0m23:19:20.512091 [debug] [MainThread]: Flushing usage events
[0m23:19:21.734147 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:19:45.070986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a28a310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ceb9190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a56c810>]}


============================== 23:19:45.072416 | 13c00a52-3af8-48f6-9a30-0aaed3d3ceff ==============================
[0m23:19:45.072416 [info ] [MainThread]: Running with dbt=1.9.0
[0m23:19:45.072852 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:19:45.132883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '13c00a52-3af8-48f6-9a30-0aaed3d3ceff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff898c6ad0>]}
[0m23:19:45.154711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '13c00a52-3af8-48f6-9a30-0aaed3d3ceff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cec90d0>]}
[0m23:19:45.155076 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:19:45.179264 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m23:19:45.213906 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:19:45.214137 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:19:45.216399 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m23:19:45.225055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '13c00a52-3af8-48f6-9a30-0aaed3d3ceff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff894fdd10>]}
[0m23:19:45.251801 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m23:19:45.253162 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m23:19:45.258353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '13c00a52-3af8-48f6-9a30-0aaed3d3ceff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff895fa6d0>]}
[0m23:19:45.258584 [info ] [MainThread]: Found 1 model, 433 macros
[0m23:19:45.258791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '13c00a52-3af8-48f6-9a30-0aaed3d3ceff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89682c90>]}
[0m23:19:45.259536 [info ] [MainThread]: 
[0m23:19:45.259805 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:19:45.260029 [info ] [MainThread]: 
[0m23:19:45.260365 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:19:45.260936 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m23:19:45.275369 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m23:19:45.275583 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m23:19:45.275801 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:19:45.278149 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.002 seconds
[0m23:19:45.278728 [debug] [ThreadPool]: On list_airflow: Close
[0m23:19:45.279353 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_staging_dim)
[0m23:19:45.282161 [debug] [ThreadPool]: Using postgres connection "list_airflow_staging_dim"
[0m23:19:45.282366 [debug] [ThreadPool]: On list_airflow_staging_dim: BEGIN
[0m23:19:45.282549 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:19:45.283971 [debug] [ThreadPool]: SQL status: BEGIN in 0.001 seconds
[0m23:19:45.284221 [debug] [ThreadPool]: Using postgres connection "list_airflow_staging_dim"
[0m23:19:45.284422 [debug] [ThreadPool]: On list_airflow_staging_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_staging_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_dim'
  
[0m23:19:45.285625 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m23:19:45.286210 [debug] [ThreadPool]: On list_airflow_staging_dim: ROLLBACK
[0m23:19:45.286508 [debug] [ThreadPool]: On list_airflow_staging_dim: Close
[0m23:19:45.288499 [debug] [MainThread]: Using postgres connection "master"
[0m23:19:45.288712 [debug] [MainThread]: On master: BEGIN
[0m23:19:45.288891 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:19:45.290260 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m23:19:45.290478 [debug] [MainThread]: Using postgres connection "master"
[0m23:19:45.290724 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:19:45.293476 [debug] [MainThread]: SQL status: SELECT 1 in 0.003 seconds
[0m23:19:45.294019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '13c00a52-3af8-48f6-9a30-0aaed3d3ceff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89705710>]}
[0m23:19:45.294269 [debug] [MainThread]: On master: ROLLBACK
[0m23:19:45.294529 [debug] [MainThread]: Using postgres connection "master"
[0m23:19:45.294693 [debug] [MainThread]: On master: BEGIN
[0m23:19:45.295026 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:19:45.295239 [debug] [MainThread]: On master: COMMIT
[0m23:19:45.295414 [debug] [MainThread]: Using postgres connection "master"
[0m23:19:45.295582 [debug] [MainThread]: On master: COMMIT
[0m23:19:45.295832 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:19:45.296008 [debug] [MainThread]: On master: Close
[0m23:19:45.297233 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.dim_stations
[0m23:19:45.297531 [info ] [Thread-1 (]: 1 of 1 START sql view model staging_dim.dim_stations ........................... [RUN]
[0m23:19:45.297892 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_staging_dim, now model.etl_waterlevel.dim_stations)
[0m23:19:45.298141 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.dim_stations
[0m23:19:45.301021 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.dim_stations"
[0m23:19:45.301711 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.dim_stations
[0m23:19:45.317352 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.dim_stations"
[0m23:19:45.318270 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m23:19:45.318481 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: BEGIN
[0m23:19:45.318692 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:19:45.320143 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m23:19:45.320355 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m23:19:45.320551 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.dim_stations"} */

  create view "airflow"."staging_dim"."dim_stations__dbt_tmp"
    
    
  as (
    -- models/dimensions/dim_stations.sql

with station_names as (
  select distinct
    "stationId"     as station_id,
    "stationName"   as station_name,
    "stationCode"   as station_code,
    "stationStatus" as station_status
  from raw.waterlevels
)

select * from station_names
  );
[0m23:19:45.321510 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m23:19:45.324163 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m23:19:45.324357 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.dim_stations"} */
alter table "airflow"."staging_dim"."dim_stations" rename to "dim_stations__dbt_backup"
[0m23:19:45.324668 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:19:45.325884 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m23:19:45.326050 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.dim_stations"} */
alter table "airflow"."staging_dim"."dim_stations__dbt_tmp" rename to "dim_stations"
[0m23:19:45.326310 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:19:45.333472 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: COMMIT
[0m23:19:45.333687 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m23:19:45.333884 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: COMMIT
[0m23:19:45.334629 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:19:45.337238 [debug] [Thread-1 (]: Applying DROP to: "airflow"."staging_dim"."dim_stations__dbt_backup"
[0m23:19:45.339217 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m23:19:45.339401 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.dim_stations"} */
drop view if exists "airflow"."staging_dim"."dim_stations__dbt_backup" cascade
[0m23:19:45.340011 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m23:19:45.341053 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: Close
[0m23:19:45.341820 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13c00a52-3af8-48f6-9a30-0aaed3d3ceff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff897faa10>]}
[0m23:19:45.342144 [info ] [Thread-1 (]: 1 of 1 OK created sql view model staging_dim.dim_stations ...................... [[32mCREATE VIEW[0m in 0.04s]
[0m23:19:45.342475 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.dim_stations
[0m23:19:45.343197 [debug] [MainThread]: Using postgres connection "master"
[0m23:19:45.343371 [debug] [MainThread]: On master: BEGIN
[0m23:19:45.343517 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:19:45.344777 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m23:19:45.344974 [debug] [MainThread]: On master: COMMIT
[0m23:19:45.345157 [debug] [MainThread]: Using postgres connection "master"
[0m23:19:45.345298 [debug] [MainThread]: On master: COMMIT
[0m23:19:45.345467 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:19:45.345600 [debug] [MainThread]: On master: Close
[0m23:19:45.345777 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:19:45.345915 [debug] [MainThread]: Connection 'model.etl_waterlevel.dim_stations' was properly closed.
[0m23:19:45.346061 [info ] [MainThread]: 
[0m23:19:45.346226 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.09 seconds (0.09s).
[0m23:19:45.346652 [debug] [MainThread]: Command end result
[0m23:19:45.358822 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m23:19:45.359771 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m23:19:45.363076 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m23:19:45.363294 [info ] [MainThread]: 
[0m23:19:45.363546 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:19:45.363788 [info ] [MainThread]: 
[0m23:19:45.364039 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:19:45.364562 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.31563604, "process_in_blocks": "0", "process_kernel_time": 0.074885, "process_mem_max_rss": "113624", "process_out_blocks": "1653", "process_user_time": 0.785793}
[0m23:19:45.364817 [debug] [MainThread]: Command `dbt run` succeeded at 23:19:45.364773 after 0.32 seconds
[0m23:19:45.365005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8eed5590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ed85290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ed85150>]}
[0m23:19:45.365184 [debug] [MainThread]: Flushing usage events
[0m23:19:46.662853 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:20:09.693091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e736390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ecf01d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e735ed0>]}


============================== 23:20:09.694482 | 1c870422-c7ef-49db-a8fd-e66172ab655c ==============================
[0m23:20:09.694482 [info ] [MainThread]: Running with dbt=1.9.0
[0m23:20:09.694865 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt compile -m dim_stations', 'send_anonymous_usage_stats': 'True'}
[0m23:20:09.756138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1c870422-c7ef-49db-a8fd-e66172ab655c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e590b10>]}
[0m23:20:09.778643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1c870422-c7ef-49db-a8fd-e66172ab655c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa11a9ad0>]}
[0m23:20:09.779082 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:20:09.803672 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m23:20:09.829183 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m23:20:09.829485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1c870422-c7ef-49db-a8fd-e66172ab655c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f35c2d0>]}
[0m23:20:10.082175 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.etl_waterlevel.dimensions
- models.etl_waterlevel.staging
[0m23:20:10.084397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1c870422-c7ef-49db-a8fd-e66172ab655c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9dac1a50>]}
[0m23:20:10.103818 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m23:20:10.105258 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m23:20:10.135846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1c870422-c7ef-49db-a8fd-e66172ab655c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9db94990>]}
[0m23:20:10.136221 [info ] [MainThread]: Found 433 macros
[0m23:20:10.136488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1c870422-c7ef-49db-a8fd-e66172ab655c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d813b10>]}
[0m23:20:10.136979 [warn ] [MainThread]: The selection criterion 'dim_stations' does not match any enabled nodes
[0m23:20:10.137633 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m23:20:10.138038 [debug] [MainThread]: Command end result
[0m23:20:10.149556 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m23:20:10.150425 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m23:20:10.151951 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m23:20:10.152391 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 0.4801127, "process_in_blocks": "0", "process_kernel_time": 0.058989, "process_mem_max_rss": "105636", "process_out_blocks": "2427", "process_user_time": 0.981824}
[0m23:20:10.152590 [debug] [MainThread]: Command `dbt compile` succeeded at 23:20:10.152552 after 0.48 seconds
[0m23:20:10.152763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa30756d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3074890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3075850>]}
[0m23:20:10.152947 [debug] [MainThread]: Flushing usage events
[0m23:20:11.302926 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:29:03.663933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84343110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8435e510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8419e9d0>]}


============================== 23:29:03.665318 | 7eab445a-5816-4d49-b1fb-7e3584b2b088 ==============================
[0m23:29:03.665318 [info ] [MainThread]: Running with dbt=1.9.0
[0m23:29:03.665754 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt compile -m dim_stations', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:29:03.725647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7eab445a-5816-4d49-b1fb-7e3584b2b088', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8370b590>]}
[0m23:29:03.747519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7eab445a-5816-4d49-b1fb-7e3584b2b088', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86d7a6d0>]}
[0m23:29:03.747898 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:29:03.772208 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m23:29:03.790462 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m23:29:03.790779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7eab445a-5816-4d49-b1fb-7e3584b2b088', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8483a750>]}
[0m23:29:04.150848 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m23:29:04.153318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7eab445a-5816-4d49-b1fb-7e3584b2b088', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff851e4ed0>]}
[0m23:29:04.182412 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m23:29:04.183943 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m23:29:04.189020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7eab445a-5816-4d49-b1fb-7e3584b2b088', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8338a9d0>]}
[0m23:29:04.189279 [info ] [MainThread]: Found 1 model, 434 macros
[0m23:29:04.189467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7eab445a-5816-4d49-b1fb-7e3584b2b088', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff835297d0>]}
[0m23:29:04.190200 [info ] [MainThread]: 
[0m23:29:04.190436 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:29:04.190651 [info ] [MainThread]: 
[0m23:29:04.191003 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:29:04.191499 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow_dim'
[0m23:29:04.205804 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m23:29:04.206064 [debug] [ThreadPool]: On list_airflow_dim: BEGIN
[0m23:29:04.206266 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:29:04.208459 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m23:29:04.208725 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m23:29:04.208939 [debug] [ThreadPool]: On list_airflow_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dim'
  
[0m23:29:04.210203 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.001 seconds
[0m23:29:04.210744 [debug] [ThreadPool]: On list_airflow_dim: ROLLBACK
[0m23:29:04.211028 [debug] [ThreadPool]: On list_airflow_dim: Close
[0m23:29:04.213087 [debug] [MainThread]: Using postgres connection "master"
[0m23:29:04.213277 [debug] [MainThread]: On master: BEGIN
[0m23:29:04.213447 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:29:04.214970 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m23:29:04.215212 [debug] [MainThread]: Using postgres connection "master"
[0m23:29:04.215438 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:29:04.218261 [debug] [MainThread]: SQL status: SELECT 1 in 0.003 seconds
[0m23:29:04.218854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7eab445a-5816-4d49-b1fb-7e3584b2b088', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82f2c450>]}
[0m23:29:04.219171 [debug] [MainThread]: On master: ROLLBACK
[0m23:29:04.219428 [debug] [MainThread]: On master: Close
[0m23:29:04.220969 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.dim_stations
[0m23:29:04.221252 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_dim, now model.etl_waterlevel.dim_stations)
[0m23:29:04.221459 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.dim_stations
[0m23:29:04.224736 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.dim_stations"
[0m23:29:04.225475 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.dim_stations
[0m23:29:04.225798 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.dim_stations
[0m23:29:04.226403 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:29:04.226574 [debug] [MainThread]: Connection 'model.etl_waterlevel.dim_stations' was properly closed.
[0m23:29:04.226910 [debug] [MainThread]: Command end result
[0m23:29:04.237846 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m23:29:04.238835 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m23:29:04.241773 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m23:29:04.241954 [info ] [MainThread]: Compiled node 'dim_stations' is:
-- models/dimensions/dim_stations.sql

with station_names as (
  select distinct
    "stationId"     as station_id,
    "stationName"   as station_name,
    "stationCode"   as station_code,
    "stationStatus" as station_status
  from raw.waterlevels
)

select * from station_names
[0m23:29:04.242519 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 0.5995151, "process_in_blocks": "0", "process_kernel_time": 0.058949, "process_mem_max_rss": "114940", "process_out_blocks": "2460", "process_user_time": 1.084071}
[0m23:29:04.242738 [debug] [MainThread]: Command `dbt compile` succeeded at 23:29:04.242700 after 0.60 seconds
[0m23:29:04.242908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8443a1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84e3f310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88c29290>]}
[0m23:29:04.243087 [debug] [MainThread]: Flushing usage events
[0m23:29:05.425285 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:29:11.950195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaff433d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0b69250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaff43bd0>]}


============================== 23:29:11.951578 | 4f253dea-570d-4233-ab79-a53b51598499 ==============================
[0m23:29:11.951578 [info ] [MainThread]: Running with dbt=1.9.0
[0m23:29:11.952095 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:29:12.011665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4f253dea-570d-4233-ab79-a53b51598499', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffafd8ded0>]}
[0m23:29:12.033689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4f253dea-570d-4233-ab79-a53b51598499', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb297a5d0>]}
[0m23:29:12.034102 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:29:12.058275 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m23:29:12.093923 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:29:12.094169 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:29:12.096432 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m23:29:12.105182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4f253dea-570d-4233-ab79-a53b51598499', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf1741d0>]}
[0m23:29:12.132796 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m23:29:12.134171 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m23:29:12.139195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4f253dea-570d-4233-ab79-a53b51598499', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffafd8c1d0>]}
[0m23:29:12.139436 [info ] [MainThread]: Found 1 model, 434 macros
[0m23:29:12.139633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4f253dea-570d-4233-ab79-a53b51598499', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf0cc910>]}
[0m23:29:12.140367 [info ] [MainThread]: 
[0m23:29:12.140596 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:29:12.140827 [info ] [MainThread]: 
[0m23:29:12.141168 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:29:12.141666 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m23:29:12.156137 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m23:29:12.156376 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m23:29:12.156568 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:29:12.158906 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.002 seconds
[0m23:29:12.159510 [debug] [ThreadPool]: On list_airflow: Close
[0m23:29:12.159861 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now create_airflow_dim)
[0m23:29:12.160160 [debug] [ThreadPool]: Creating schema "database: "airflow"
schema: "dim"
"
[0m23:29:12.162608 [debug] [ThreadPool]: Using postgres connection "create_airflow_dim"
[0m23:29:12.162798 [debug] [ThreadPool]: On create_airflow_dim: BEGIN
[0m23:29:12.162989 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:29:12.164419 [debug] [ThreadPool]: SQL status: BEGIN in 0.001 seconds
[0m23:29:12.164687 [debug] [ThreadPool]: Using postgres connection "create_airflow_dim"
[0m23:29:12.164865 [debug] [ThreadPool]: On create_airflow_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "create_airflow_dim"} */
create schema if not exists "dim"
[0m23:29:12.165823 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.001 seconds
[0m23:29:12.166310 [debug] [ThreadPool]: On create_airflow_dim: COMMIT
[0m23:29:12.166496 [debug] [ThreadPool]: Using postgres connection "create_airflow_dim"
[0m23:29:12.166672 [debug] [ThreadPool]: On create_airflow_dim: COMMIT
[0m23:29:12.167345 [debug] [ThreadPool]: SQL status: COMMIT in 0.000 seconds
[0m23:29:12.167524 [debug] [ThreadPool]: On create_airflow_dim: Close
[0m23:29:12.168127 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_airflow_dim, now list_airflow_dim)
[0m23:29:12.170580 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m23:29:12.170764 [debug] [ThreadPool]: On list_airflow_dim: BEGIN
[0m23:29:12.170906 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:29:12.172101 [debug] [ThreadPool]: SQL status: BEGIN in 0.001 seconds
[0m23:29:12.172305 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m23:29:12.172476 [debug] [ThreadPool]: On list_airflow_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dim'
  
[0m23:29:12.173690 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.001 seconds
[0m23:29:12.174181 [debug] [ThreadPool]: On list_airflow_dim: ROLLBACK
[0m23:29:12.174366 [debug] [ThreadPool]: On list_airflow_dim: Close
[0m23:29:12.176231 [debug] [MainThread]: Using postgres connection "master"
[0m23:29:12.176440 [debug] [MainThread]: On master: BEGIN
[0m23:29:12.176618 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:29:12.178003 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m23:29:12.178254 [debug] [MainThread]: Using postgres connection "master"
[0m23:29:12.178492 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:29:12.181281 [debug] [MainThread]: SQL status: SELECT 1 in 0.003 seconds
[0m23:29:12.181795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4f253dea-570d-4233-ab79-a53b51598499', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf08e710>]}
[0m23:29:12.182045 [debug] [MainThread]: On master: ROLLBACK
[0m23:29:12.182313 [debug] [MainThread]: Using postgres connection "master"
[0m23:29:12.182482 [debug] [MainThread]: On master: BEGIN
[0m23:29:12.182812 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:29:12.183027 [debug] [MainThread]: On master: COMMIT
[0m23:29:12.183201 [debug] [MainThread]: Using postgres connection "master"
[0m23:29:12.183366 [debug] [MainThread]: On master: COMMIT
[0m23:29:12.183613 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:29:12.183792 [debug] [MainThread]: On master: Close
[0m23:29:12.184943 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.dim_stations
[0m23:29:12.185290 [info ] [Thread-1 (]: 1 of 1 START sql view model dim.dim_stations ................................... [RUN]
[0m23:29:12.185587 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_dim, now model.etl_waterlevel.dim_stations)
[0m23:29:12.185841 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.dim_stations
[0m23:29:12.188721 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.dim_stations"
[0m23:29:12.189497 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.dim_stations
[0m23:29:12.205051 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.dim_stations"
[0m23:29:12.205805 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m23:29:12.206007 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: BEGIN
[0m23:29:12.206195 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:29:12.207687 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m23:29:12.207965 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m23:29:12.208163 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.dim_stations"} */

  create view "airflow"."dim"."dim_stations__dbt_tmp"
    
    
  as (
    -- models/dimensions/dim_stations.sql

with station_names as (
  select distinct
    "stationId"     as station_id,
    "stationName"   as station_name,
    "stationCode"   as station_code,
    "stationStatus" as station_status
  from raw.waterlevels
)

select * from station_names
  );
[0m23:29:12.209325 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m23:29:12.211888 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m23:29:12.212081 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.dim_stations"} */
alter table "airflow"."dim"."dim_stations__dbt_tmp" rename to "dim_stations"
[0m23:29:12.212370 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:29:12.218578 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: COMMIT
[0m23:29:12.218822 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m23:29:12.219141 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: COMMIT
[0m23:29:12.219915 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:29:12.222456 [debug] [Thread-1 (]: Applying DROP to: "airflow"."dim"."dim_stations__dbt_backup"
[0m23:29:12.224408 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m23:29:12.224595 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.dim_stations"} */
drop view if exists "airflow"."dim"."dim_stations__dbt_backup" cascade
[0m23:29:12.224847 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m23:29:12.225838 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: Close
[0m23:29:12.226574 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f253dea-570d-4233-ab79-a53b51598499', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae4a5110>]}
[0m23:29:12.226903 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dim.dim_stations .............................. [[32mCREATE VIEW[0m in 0.04s]
[0m23:29:12.227217 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.dim_stations
[0m23:29:12.227919 [debug] [MainThread]: Using postgres connection "master"
[0m23:29:12.228135 [debug] [MainThread]: On master: BEGIN
[0m23:29:12.228283 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:29:12.229516 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m23:29:12.229709 [debug] [MainThread]: On master: COMMIT
[0m23:29:12.229886 [debug] [MainThread]: Using postgres connection "master"
[0m23:29:12.230038 [debug] [MainThread]: On master: COMMIT
[0m23:29:12.230251 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:29:12.230407 [debug] [MainThread]: On master: Close
[0m23:29:12.230590 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:29:12.230726 [debug] [MainThread]: Connection 'model.etl_waterlevel.dim_stations' was properly closed.
[0m23:29:12.230871 [info ] [MainThread]: 
[0m23:29:12.231141 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.09 seconds (0.09s).
[0m23:29:12.231548 [debug] [MainThread]: Command end result
[0m23:29:12.243977 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m23:29:12.245088 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m23:29:12.247860 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m23:29:12.248039 [info ] [MainThread]: 
[0m23:29:12.248278 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:29:12.248475 [info ] [MainThread]: 
[0m23:29:12.248724 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:29:12.249224 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.32000992, "process_in_blocks": "0", "process_kernel_time": 0.062709, "process_mem_max_rss": "113760", "process_out_blocks": "1655", "process_user_time": 0.79233}
[0m23:29:12.249439 [debug] [MainThread]: Command `dbt run` succeeded at 23:29:12.249397 after 0.32 seconds
[0m23:29:12.249624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffafdbbf50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffafdbbe50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaff5dd50>]}
[0m23:29:12.249797 [debug] [MainThread]: Flushing usage events
[0m23:29:13.449894 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:30:15.459167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9343ec90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93656510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9343ded0>]}


============================== 23:30:15.460584 | 9d83848d-7350-48c3-90c2-70569d7605bc ==============================
[0m23:30:15.460584 [info ] [MainThread]: Running with dbt=1.9.0
[0m23:30:15.460944 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt compile -m dim_stations', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:30:15.520639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9d83848d-7350-48c3-90c2-70569d7605bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92869350>]}
[0m23:30:15.542247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9d83848d-7350-48c3-90c2-70569d7605bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95ec84d0>]}
[0m23:30:15.542617 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:30:15.567174 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m23:30:15.602735 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:30:15.603045 [debug] [MainThread]: Partial parsing: updated file: etl_waterlevel://macros/generate_schema_name.sql
[0m23:30:15.604012 [info ] [MainThread]: Unable to do partial parsing because change detected to override macro. Starting full parse.
[0m23:30:15.944800 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m23:30:15.947168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9d83848d-7350-48c3-90c2-70569d7605bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92800650>]}
[0m23:30:15.975031 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m23:30:15.976461 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m23:30:15.981300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9d83848d-7350-48c3-90c2-70569d7605bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92435410>]}
[0m23:30:15.981600 [info ] [MainThread]: Found 1 model, 434 macros
[0m23:30:15.981841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d83848d-7350-48c3-90c2-70569d7605bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92661c50>]}
[0m23:30:15.982561 [info ] [MainThread]: 
[0m23:30:15.982771 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:30:15.982977 [info ] [MainThread]: 
[0m23:30:15.983365 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:30:15.983844 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow_----     dim
----'
[0m23:30:15.998657 [debug] [ThreadPool]: Using postgres connection "list_airflow_----     dim
----"
[0m23:30:15.998930 [debug] [ThreadPool]: On list_airflow_----     dim
----: BEGIN
[0m23:30:15.999188 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:30:16.001435 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m23:30:16.001652 [debug] [ThreadPool]: Using postgres connection "list_airflow_----     dim
----"
[0m23:30:16.001849 [debug] [ThreadPool]: On list_airflow_----     dim
----: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_----     dim\n----"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike '----     dim
----'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike '----     dim
----'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike '----     dim
----'
  
[0m23:30:16.003233 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.001 seconds
[0m23:30:16.003797 [debug] [ThreadPool]: On list_airflow_----     dim
----: ROLLBACK
[0m23:30:16.004077 [debug] [ThreadPool]: On list_airflow_----     dim
----: Close
[0m23:30:16.006416 [debug] [MainThread]: Using postgres connection "master"
[0m23:30:16.006644 [debug] [MainThread]: On master: BEGIN
[0m23:30:16.006824 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:30:16.008291 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m23:30:16.008498 [debug] [MainThread]: Using postgres connection "master"
[0m23:30:16.008718 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:30:16.011520 [debug] [MainThread]: SQL status: SELECT 2 in 0.003 seconds
[0m23:30:16.012079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d83848d-7350-48c3-90c2-70569d7605bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91b1b950>]}
[0m23:30:16.012337 [debug] [MainThread]: On master: ROLLBACK
[0m23:30:16.012595 [debug] [MainThread]: On master: Close
[0m23:30:16.014182 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.dim_stations
[0m23:30:16.014455 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_----     dim
----, now model.etl_waterlevel.dim_stations)
[0m23:30:16.014665 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.dim_stations
[0m23:30:16.017649 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.dim_stations"
[0m23:30:16.018335 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.dim_stations
[0m23:30:16.018663 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.dim_stations
[0m23:30:16.019277 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:30:16.019457 [debug] [MainThread]: Connection 'model.etl_waterlevel.dim_stations' was properly closed.
[0m23:30:16.019737 [debug] [MainThread]: Command end result
[0m23:30:16.030861 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m23:30:16.031823 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m23:30:16.034853 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m23:30:16.035036 [info ] [MainThread]: Compiled node 'dim_stations' is:
-- models/dimensions/dim_stations.sql

with station_names as (
  select distinct
    "stationId"     as station_id,
    "stationName"   as station_name,
    "stationCode"   as station_code,
    "stationStatus" as station_status
  from raw.waterlevels
)

select * from station_names
[0m23:30:16.035620 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 0.59710324, "process_in_blocks": "0", "process_kernel_time": 0.061471, "process_mem_max_rss": "115080", "process_out_blocks": "2462", "process_user_time": 1.086338}
[0m23:30:16.035858 [debug] [MainThread]: Command `dbt compile` succeeded at 23:30:16.035813 after 0.60 seconds
[0m23:30:16.036045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97da5190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97da4890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97da5850>]}
[0m23:30:16.036240 [debug] [MainThread]: Flushing usage events
[0m23:30:17.353272 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:30:26.612749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89d8c610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89f3b450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89f38490>]}


============================== 23:30:26.614162 | d28c7ef0-1e56-4065-af4e-5d570b58d921 ==============================
[0m23:30:26.614162 [info ] [MainThread]: Running with dbt=1.9.0
[0m23:30:26.614551 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m23:30:26.673871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd28c7ef0-1e56-4065-af4e-5d570b58d921', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff893fc390>]}
[0m23:30:26.695751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd28c7ef0-1e56-4065-af4e-5d570b58d921', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ca388d0>]}
[0m23:30:26.696119 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:30:26.720258 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m23:30:26.755781 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:30:26.756006 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:30:26.758235 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m23:30:26.766933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd28c7ef0-1e56-4065-af4e-5d570b58d921', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89204350>]}
[0m23:30:26.793753 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m23:30:26.795142 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m23:30:26.801448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd28c7ef0-1e56-4065-af4e-5d570b58d921', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff892153d0>]}
[0m23:30:26.801721 [info ] [MainThread]: Found 1 model, 434 macros
[0m23:30:26.801959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd28c7ef0-1e56-4065-af4e-5d570b58d921', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89393c90>]}
[0m23:30:26.802725 [info ] [MainThread]: 
[0m23:30:26.802963 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:30:26.803213 [info ] [MainThread]: 
[0m23:30:26.803566 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:30:26.804067 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m23:30:26.818562 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m23:30:26.818807 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m23:30:26.818995 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:30:26.821452 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.002 seconds
[0m23:30:26.822052 [debug] [ThreadPool]: On list_airflow: Close
[0m23:30:26.822416 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now create_airflow_----     dim
----)
[0m23:30:26.822718 [debug] [ThreadPool]: Creating schema "database: "airflow"
schema: "----     dim\n----"
"
[0m23:30:26.825254 [debug] [ThreadPool]: Using postgres connection "create_airflow_----     dim
----"
[0m23:30:26.825472 [debug] [ThreadPool]: On create_airflow_----     dim
----: BEGIN
[0m23:30:26.825658 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:30:26.827063 [debug] [ThreadPool]: SQL status: BEGIN in 0.001 seconds
[0m23:30:26.827308 [debug] [ThreadPool]: Using postgres connection "create_airflow_----     dim
----"
[0m23:30:26.827552 [debug] [ThreadPool]: On create_airflow_----     dim
----: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "create_airflow_----     dim\n----"} */
create schema if not exists "----     dim
----"
[0m23:30:26.827935 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.000 seconds
[0m23:30:26.828335 [debug] [ThreadPool]: On create_airflow_----     dim
----: COMMIT
[0m23:30:26.828525 [debug] [ThreadPool]: Using postgres connection "create_airflow_----     dim
----"
[0m23:30:26.828693 [debug] [ThreadPool]: On create_airflow_----     dim
----: COMMIT
[0m23:30:26.829167 [debug] [ThreadPool]: SQL status: COMMIT in 0.000 seconds
[0m23:30:26.829340 [debug] [ThreadPool]: On create_airflow_----     dim
----: Close
[0m23:30:26.829943 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_airflow_----     dim
----, now list_airflow_----     dim
----)
[0m23:30:26.832424 [debug] [ThreadPool]: Using postgres connection "list_airflow_----     dim
----"
[0m23:30:26.832595 [debug] [ThreadPool]: On list_airflow_----     dim
----: BEGIN
[0m23:30:26.832721 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:30:26.833901 [debug] [ThreadPool]: SQL status: BEGIN in 0.001 seconds
[0m23:30:26.834075 [debug] [ThreadPool]: Using postgres connection "list_airflow_----     dim
----"
[0m23:30:26.834225 [debug] [ThreadPool]: On list_airflow_----     dim
----: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_----     dim\n----"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike '----     dim
----'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike '----     dim
----'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike '----     dim
----'
  
[0m23:30:26.835561 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.001 seconds
[0m23:30:26.836079 [debug] [ThreadPool]: On list_airflow_----     dim
----: ROLLBACK
[0m23:30:26.836296 [debug] [ThreadPool]: On list_airflow_----     dim
----: Close
[0m23:30:26.838148 [debug] [MainThread]: Using postgres connection "master"
[0m23:30:26.838349 [debug] [MainThread]: On master: BEGIN
[0m23:30:26.838496 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:30:26.839733 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m23:30:26.839947 [debug] [MainThread]: Using postgres connection "master"
[0m23:30:26.840171 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:30:26.842937 [debug] [MainThread]: SQL status: SELECT 2 in 0.002 seconds
[0m23:30:26.843505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd28c7ef0-1e56-4065-af4e-5d570b58d921', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff891fb990>]}
[0m23:30:26.843749 [debug] [MainThread]: On master: ROLLBACK
[0m23:30:26.844016 [debug] [MainThread]: Using postgres connection "master"
[0m23:30:26.844194 [debug] [MainThread]: On master: BEGIN
[0m23:30:26.844524 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:30:26.844723 [debug] [MainThread]: On master: COMMIT
[0m23:30:26.844896 [debug] [MainThread]: Using postgres connection "master"
[0m23:30:26.845068 [debug] [MainThread]: On master: COMMIT
[0m23:30:26.845304 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:30:26.845482 [debug] [MainThread]: On master: Close
[0m23:30:26.846676 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.dim_stations
[0m23:30:26.846967 [info ] [Thread-1 (]: 1 of 1 START sql view model ----     dim
----.dim_stations ..................... [RUN]
[0m23:30:26.847244 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_----     dim
----, now model.etl_waterlevel.dim_stations)
[0m23:30:26.847498 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.dim_stations
[0m23:30:26.850430 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.dim_stations"
[0m23:30:26.851116 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.dim_stations
[0m23:30:26.866583 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.dim_stations"
[0m23:30:26.867470 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m23:30:26.867680 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: BEGIN
[0m23:30:26.867868 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:30:26.869344 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m23:30:26.869592 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m23:30:26.869821 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.dim_stations"} */

  create view "airflow"."----     dim
----"."dim_stations__dbt_tmp"
    
    
  as (
    -- models/dimensions/dim_stations.sql

with station_names as (
  select distinct
    "stationId"     as station_id,
    "stationName"   as station_name,
    "stationCode"   as station_code,
    "stationStatus" as station_status
  from raw.waterlevels
)

select * from station_names
  );
[0m23:30:26.870751 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m23:30:26.873393 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m23:30:26.873608 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.dim_stations"} */
alter table "airflow"."----     dim
----"."dim_stations__dbt_tmp" rename to "dim_stations"
[0m23:30:26.873909 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:30:26.880278 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: COMMIT
[0m23:30:26.880545 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m23:30:26.880811 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: COMMIT
[0m23:30:26.881516 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:30:26.884034 [debug] [Thread-1 (]: Applying DROP to: "airflow"."----     dim
----"."dim_stations__dbt_backup"
[0m23:30:26.886055 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m23:30:26.886264 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.dim_stations"} */
drop view if exists "airflow"."----     dim
----"."dim_stations__dbt_backup" cascade
[0m23:30:26.886518 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m23:30:26.887505 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: Close
[0m23:30:26.888225 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd28c7ef0-1e56-4065-af4e-5d570b58d921', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88377e10>]}
[0m23:30:26.888550 [info ] [Thread-1 (]: 1 of 1 OK created sql view model ----     dim
----.dim_stations ................ [[32mCREATE VIEW[0m in 0.04s]
[0m23:30:26.888925 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.dim_stations
[0m23:30:26.889640 [debug] [MainThread]: Using postgres connection "master"
[0m23:30:26.889787 [debug] [MainThread]: On master: BEGIN
[0m23:30:26.889906 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:30:26.891218 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m23:30:26.891481 [debug] [MainThread]: On master: COMMIT
[0m23:30:26.891683 [debug] [MainThread]: Using postgres connection "master"
[0m23:30:26.891862 [debug] [MainThread]: On master: COMMIT
[0m23:30:26.892121 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:30:26.892297 [debug] [MainThread]: On master: Close
[0m23:30:26.892539 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:30:26.892700 [debug] [MainThread]: Connection 'model.etl_waterlevel.dim_stations' was properly closed.
[0m23:30:26.892898 [info ] [MainThread]: 
[0m23:30:26.893106 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.09 seconds (0.09s).
[0m23:30:26.893540 [debug] [MainThread]: Command end result
[0m23:30:26.906269 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m23:30:26.907186 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m23:30:26.910055 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m23:30:26.910218 [info ] [MainThread]: 
[0m23:30:26.910525 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:30:26.910720 [info ] [MainThread]: 
[0m23:30:26.910968 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:30:26.911444 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.31970137, "process_in_blocks": "0", "process_kernel_time": 0.072208, "process_mem_max_rss": "113732", "process_out_blocks": "1658", "process_user_time": 0.788271}
[0m23:30:26.911641 [debug] [MainThread]: Command `dbt run` succeeded at 23:30:26.911606 after 0.32 seconds
[0m23:30:26.911836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a152150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8aa3b790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e8e9490>]}
[0m23:30:26.911999 [debug] [MainThread]: Flushing usage events
[0m23:30:28.304320 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:35:34.691923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9673f210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96955e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99399a50>]}


============================== 23:35:34.693315 | 7d09fad9-1a66-4811-b857-3e1354b91057 ==============================
[0m23:35:34.693315 [info ] [MainThread]: Running with dbt=1.9.0
[0m23:35:34.693669 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:35:34.734516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7d09fad9-1a66-4811-b857-3e1354b91057', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96593f10>]}
[0m23:35:34.743123 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.07196246, "process_in_blocks": "0", "process_kernel_time": 0.064158, "process_mem_max_rss": "96212", "process_out_blocks": "3", "process_user_time": 0.593469}
[0m23:35:34.743498 [debug] [MainThread]: Command `dbt clean` succeeded at 23:35:34.743413 after 0.07 seconds
[0m23:35:34.743819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b095150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b095290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b094710>]}
[0m23:35:34.744102 [debug] [MainThread]: Flushing usage events
[0m23:35:35.922299 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:35:41.799839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86143150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8874fa90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff861431d0>]}


============================== 23:35:41.801251 | aac3968c-9ad4-4c3e-ae1d-e06550c7e183 ==============================
[0m23:35:41.801251 [info ] [MainThread]: Running with dbt=1.9.0
[0m23:35:41.801619 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:35:41.862588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aac3968c-9ad4-4c3e-ae1d-e06550c7e183', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85f95650>]}
[0m23:35:41.884145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aac3968c-9ad4-4c3e-ae1d-e06550c7e183', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88bd4bd0>]}
[0m23:35:41.884520 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:35:41.908865 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m23:35:41.909432 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m23:35:41.909686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'aac3968c-9ad4-4c3e-ae1d-e06550c7e183', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff852daad0>]}
[0m23:35:42.248109 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m23:35:42.250576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aac3968c-9ad4-4c3e-ae1d-e06550c7e183', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8536b290>]}
[0m23:35:42.303674 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m23:35:42.305222 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m23:35:42.311231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aac3968c-9ad4-4c3e-ae1d-e06550c7e183', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85216c90>]}
[0m23:35:42.311500 [info ] [MainThread]: Found 1 model, 434 macros
[0m23:35:42.311681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aac3968c-9ad4-4c3e-ae1d-e06550c7e183', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff851c3510>]}
[0m23:35:42.312474 [info ] [MainThread]: 
[0m23:35:42.312729 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:35:42.312968 [info ] [MainThread]: 
[0m23:35:42.313317 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:35:42.313825 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m23:35:42.329213 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m23:35:42.329485 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m23:35:42.329680 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:35:42.332386 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.003 seconds
[0m23:35:42.333005 [debug] [ThreadPool]: On list_airflow: Close
[0m23:35:42.333664 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_dim)
[0m23:35:42.336343 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m23:35:42.336559 [debug] [ThreadPool]: On list_airflow_dim: BEGIN
[0m23:35:42.336772 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:35:42.338251 [debug] [ThreadPool]: SQL status: BEGIN in 0.001 seconds
[0m23:35:42.338490 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m23:35:42.338728 [debug] [ThreadPool]: On list_airflow_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dim'
  
[0m23:35:42.340250 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m23:35:42.340825 [debug] [ThreadPool]: On list_airflow_dim: ROLLBACK
[0m23:35:42.341086 [debug] [ThreadPool]: On list_airflow_dim: Close
[0m23:35:42.343405 [debug] [MainThread]: Using postgres connection "master"
[0m23:35:42.343625 [debug] [MainThread]: On master: BEGIN
[0m23:35:42.343814 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:35:42.345455 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m23:35:42.345734 [debug] [MainThread]: Using postgres connection "master"
[0m23:35:42.346002 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:35:42.349010 [debug] [MainThread]: SQL status: SELECT 3 in 0.003 seconds
[0m23:35:42.349580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aac3968c-9ad4-4c3e-ae1d-e06550c7e183', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff851def10>]}
[0m23:35:42.349842 [debug] [MainThread]: On master: ROLLBACK
[0m23:35:42.350185 [debug] [MainThread]: Using postgres connection "master"
[0m23:35:42.350421 [debug] [MainThread]: On master: BEGIN
[0m23:35:42.350776 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:35:42.351035 [debug] [MainThread]: On master: COMMIT
[0m23:35:42.351249 [debug] [MainThread]: Using postgres connection "master"
[0m23:35:42.351435 [debug] [MainThread]: On master: COMMIT
[0m23:35:42.351703 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:35:42.351897 [debug] [MainThread]: On master: Close
[0m23:35:42.353232 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.dim_stations
[0m23:35:42.353537 [info ] [Thread-1 (]: 1 of 1 START sql view model dim.dim_stations ................................... [RUN]
[0m23:35:42.353868 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_dim, now model.etl_waterlevel.dim_stations)
[0m23:35:42.354112 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.dim_stations
[0m23:35:42.357128 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.dim_stations"
[0m23:35:42.359350 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.dim_stations
[0m23:35:42.375550 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.dim_stations"
[0m23:35:42.376959 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m23:35:42.377180 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: BEGIN
[0m23:35:42.377406 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:35:42.379114 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m23:35:42.379401 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m23:35:42.379581 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.dim_stations"} */

  create view "airflow"."dim"."dim_stations__dbt_tmp"
    
    
  as (
    -- models/dimensions/dim_stations.sql

with station_names as (
  select distinct
    "stationId"     as station_id,
    "stationName"   as station_name,
    "stationCode"   as station_code,
    "stationStatus" as station_status
  from raw.waterlevels
)

select * from station_names
  );
[0m23:35:42.380969 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m23:35:42.383684 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m23:35:42.383899 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.dim_stations"} */
alter table "airflow"."dim"."dim_stations" rename to "dim_stations__dbt_backup"
[0m23:35:42.384237 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:35:42.385449 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m23:35:42.385646 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.dim_stations"} */
alter table "airflow"."dim"."dim_stations__dbt_tmp" rename to "dim_stations"
[0m23:35:42.385933 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:35:42.392949 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: COMMIT
[0m23:35:42.393207 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m23:35:42.393418 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: COMMIT
[0m23:35:42.394047 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m23:35:42.397247 [debug] [Thread-1 (]: Applying DROP to: "airflow"."dim"."dim_stations__dbt_backup"
[0m23:35:42.399312 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m23:35:42.399519 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.dim_stations"} */
drop view if exists "airflow"."dim"."dim_stations__dbt_backup" cascade
[0m23:35:42.400457 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:35:42.401476 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: Close
[0m23:35:42.402269 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aac3968c-9ad4-4c3e-ae1d-e06550c7e183', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85240c50>]}
[0m23:35:42.402607 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dim.dim_stations .............................. [[32mCREATE VIEW[0m in 0.05s]
[0m23:35:42.402952 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.dim_stations
[0m23:35:42.403697 [debug] [MainThread]: Using postgres connection "master"
[0m23:35:42.403893 [debug] [MainThread]: On master: BEGIN
[0m23:35:42.404035 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:35:42.405413 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m23:35:42.405618 [debug] [MainThread]: On master: COMMIT
[0m23:35:42.405777 [debug] [MainThread]: Using postgres connection "master"
[0m23:35:42.405922 [debug] [MainThread]: On master: COMMIT
[0m23:35:42.406117 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:35:42.406280 [debug] [MainThread]: On master: Close
[0m23:35:42.406470 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:35:42.406622 [debug] [MainThread]: Connection 'model.etl_waterlevel.dim_stations' was properly closed.
[0m23:35:42.406772 [info ] [MainThread]: 
[0m23:35:42.406955 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.09 seconds (0.09s).
[0m23:35:42.407361 [debug] [MainThread]: Command end result
[0m23:35:42.419720 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m23:35:42.420700 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m23:35:42.423507 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m23:35:42.423718 [info ] [MainThread]: 
[0m23:35:42.423993 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:35:42.424186 [info ] [MainThread]: 
[0m23:35:42.424397 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:35:42.424902 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.646062, "process_in_blocks": "0", "process_kernel_time": 0.078025, "process_mem_max_rss": "115792", "process_out_blocks": "2472", "process_user_time": 1.120732}
[0m23:35:42.425112 [debug] [MainThread]: Command `dbt run` succeeded at 23:35:42.425077 after 0.65 seconds
[0m23:35:42.425296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8615df10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85fb3dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86c43790>]}
[0m23:35:42.425484 [debug] [MainThread]: Flushing usage events
[0m23:35:43.695237 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:37:54.827263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8883cd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff889361d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88a55ed0>]}


============================== 23:37:54.828670 | 7cba5618-5d03-43d9-ae88-3725d56e9d70 ==============================
[0m23:37:54.828670 [info ] [MainThread]: Running with dbt=1.9.0
[0m23:37:54.829196 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select dim_stations', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:37:54.888339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7cba5618-5d03-43d9-ae88-3725d56e9d70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87c93990>]}
[0m23:37:54.910309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7cba5618-5d03-43d9-ae88-3725d56e9d70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b2c8410>]}
[0m23:37:54.910701 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:37:54.934935 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m23:37:54.971793 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:37:54.972017 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:37:54.974261 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m23:37:54.982934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7cba5618-5d03-43d9-ae88-3725d56e9d70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87aa05d0>]}
[0m23:37:55.010560 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m23:37:55.011950 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m23:37:55.017248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7cba5618-5d03-43d9-ae88-3725d56e9d70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87c64510>]}
[0m23:37:55.017473 [info ] [MainThread]: Found 1 model, 434 macros
[0m23:37:55.017655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7cba5618-5d03-43d9-ae88-3725d56e9d70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87a06250>]}
[0m23:37:55.018269 [info ] [MainThread]: 
[0m23:37:55.018545 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:37:55.018817 [info ] [MainThread]: 
[0m23:37:55.019176 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:37:55.019736 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m23:37:55.034283 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m23:37:55.034522 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m23:37:55.034739 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:37:55.037097 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.002 seconds
[0m23:37:55.037669 [debug] [ThreadPool]: On list_airflow: Close
[0m23:37:55.038305 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_dim)
[0m23:37:55.041051 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m23:37:55.041300 [debug] [ThreadPool]: On list_airflow_dim: BEGIN
[0m23:37:55.041481 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:37:55.042959 [debug] [ThreadPool]: SQL status: BEGIN in 0.001 seconds
[0m23:37:55.043217 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m23:37:55.043416 [debug] [ThreadPool]: On list_airflow_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dim'
  
[0m23:37:55.044670 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m23:37:55.045242 [debug] [ThreadPool]: On list_airflow_dim: ROLLBACK
[0m23:37:55.045505 [debug] [ThreadPool]: On list_airflow_dim: Close
[0m23:37:55.047404 [debug] [MainThread]: Using postgres connection "master"
[0m23:37:55.047598 [debug] [MainThread]: On master: BEGIN
[0m23:37:55.047827 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:37:55.049191 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m23:37:55.049417 [debug] [MainThread]: Using postgres connection "master"
[0m23:37:55.049639 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:37:55.052467 [debug] [MainThread]: SQL status: SELECT 2 in 0.003 seconds
[0m23:37:55.053067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7cba5618-5d03-43d9-ae88-3725d56e9d70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff878d6c50>]}
[0m23:37:55.053317 [debug] [MainThread]: On master: ROLLBACK
[0m23:37:55.053577 [debug] [MainThread]: Using postgres connection "master"
[0m23:37:55.053723 [debug] [MainThread]: On master: BEGIN
[0m23:37:55.054040 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:37:55.054276 [debug] [MainThread]: On master: COMMIT
[0m23:37:55.054455 [debug] [MainThread]: Using postgres connection "master"
[0m23:37:55.054621 [debug] [MainThread]: On master: COMMIT
[0m23:37:55.054888 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:37:55.055056 [debug] [MainThread]: On master: Close
[0m23:37:55.056279 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.dim_stations
[0m23:37:55.056566 [info ] [Thread-1 (]: 1 of 1 START sql view model dim.dim_stations ................................... [RUN]
[0m23:37:55.056895 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_dim, now model.etl_waterlevel.dim_stations)
[0m23:37:55.057109 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.dim_stations
[0m23:37:55.060010 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.dim_stations"
[0m23:37:55.060795 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.dim_stations
[0m23:37:55.076663 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.dim_stations"
[0m23:37:55.077453 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m23:37:55.077667 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: BEGIN
[0m23:37:55.077881 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:37:55.079452 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m23:37:55.079724 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m23:37:55.079947 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.dim_stations"} */

  create view "airflow"."dim"."dim_stations__dbt_tmp"
    
    
  as (
    -- models/dimensions/dim_stations.sql

with station_names as (
  select distinct
    "stationId"     as station_id,
    "stationName"   as station_name,
    "stationCode"   as station_code,
    "stationStatus" as station_status
  from raw.waterlevels
)

select * from station_names
  );
[0m23:37:55.081075 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m23:37:55.083733 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m23:37:55.083934 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.dim_stations"} */
alter table "airflow"."dim"."dim_stations" rename to "dim_stations__dbt_backup"
[0m23:37:55.084257 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:37:55.085536 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m23:37:55.085738 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.dim_stations"} */
alter table "airflow"."dim"."dim_stations__dbt_tmp" rename to "dim_stations"
[0m23:37:55.086057 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:37:55.092947 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: COMMIT
[0m23:37:55.093143 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m23:37:55.093310 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: COMMIT
[0m23:37:55.093737 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m23:37:55.096318 [debug] [Thread-1 (]: Applying DROP to: "airflow"."dim"."dim_stations__dbt_backup"
[0m23:37:55.098318 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m23:37:55.098501 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.dim_stations"} */
drop view if exists "airflow"."dim"."dim_stations__dbt_backup" cascade
[0m23:37:55.099085 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m23:37:55.100124 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: Close
[0m23:37:55.100907 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7cba5618-5d03-43d9-ae88-3725d56e9d70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86ca5a10>]}
[0m23:37:55.101241 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dim.dim_stations .............................. [[32mCREATE VIEW[0m in 0.04s]
[0m23:37:55.101556 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.dim_stations
[0m23:37:55.102284 [debug] [MainThread]: Using postgres connection "master"
[0m23:37:55.102481 [debug] [MainThread]: On master: BEGIN
[0m23:37:55.102643 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:37:55.103929 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m23:37:55.104126 [debug] [MainThread]: On master: COMMIT
[0m23:37:55.104291 [debug] [MainThread]: Using postgres connection "master"
[0m23:37:55.104437 [debug] [MainThread]: On master: COMMIT
[0m23:37:55.104622 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:37:55.104786 [debug] [MainThread]: On master: Close
[0m23:37:55.104981 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:37:55.105117 [debug] [MainThread]: Connection 'model.etl_waterlevel.dim_stations' was properly closed.
[0m23:37:55.105264 [info ] [MainThread]: 
[0m23:37:55.105499 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.09 seconds (0.09s).
[0m23:37:55.105843 [debug] [MainThread]: Command end result
[0m23:37:55.117976 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m23:37:55.118922 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m23:37:55.121670 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m23:37:55.121869 [info ] [MainThread]: 
[0m23:37:55.122148 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:37:55.122382 [info ] [MainThread]: 
[0m23:37:55.122611 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:37:55.123185 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.31685764, "process_in_blocks": "0", "process_kernel_time": 0.069731, "process_mem_max_rss": "113616", "process_out_blocks": "1654", "process_user_time": 0.788967}
[0m23:37:55.123388 [debug] [MainThread]: Command `dbt run` succeeded at 23:37:55.123353 after 0.32 seconds
[0m23:37:55.123559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8883ef50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8883ff50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8883e950>]}
[0m23:37:55.123739 [debug] [MainThread]: Flushing usage events
[0m23:37:56.318602 [debug] [MainThread]: An error was encountered while trying to flush usage events
