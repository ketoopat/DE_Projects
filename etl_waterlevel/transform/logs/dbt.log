[0m13:42:43.567466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb494190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb495f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb4955d0>]}


============================== 13:42:43.575176 | e98740eb-205d-4368-9d8d-2463a64ef625 ==============================
[0m13:42:43.575176 [info ] [MainThread]: Running with dbt=1.9.0
[0m13:42:43.576087 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/logs', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt init dbt_project', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:42:43.582351 [warn ] [MainThread]: [ConfigFolderDirectory]: Unable to parse logging event dictionary. Failed to parse dir field: expected string or bytes-like object, got 'PosixPath'.. Dictionary: {'dir': PosixPath('/root/.dbt')}
[0m13:42:43.582827 [info ] [MainThread]: Creating dbt configuration folder at 
[0m13:42:43.586380 [info ] [MainThread]: Setting up your profile.
[0m13:45:26.273293 [error] [MainThread]: Encountered an error:

[0m13:45:26.284671 [error] [MainThread]: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/main.py", line 477, in init
    results = task.run()
              ^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/init.py", line 320, in run
    self.setup_profile(profile_name)
  File "/usr/local/lib/python3.11/site-packages/dbt/task/init.py", line 262, in setup_profile
    self.create_profile_from_target(adapter, profile_name=profile_name)
  File "/usr/local/lib/python3.11/site-packages/dbt/task/init.py", line 179, in create_profile_from_target
    self.create_profile_from_profile_template(profile_template, profile_name)
  File "/usr/local/lib/python3.11/site-packages/dbt/task/init.py", line 163, in create_profile_from_profile_template
    target = self.generate_target_from_input(prompts, initial_target)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/init.py", line 129, in generate_target_from_input
    target[key] = click.prompt(
                  ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/click/termui.py", line 164, in prompt
    value = prompt_func(prompt)
            ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/click/termui.py", line 147, in prompt_func
    raise Abort() from None
click.exceptions.Abort

[0m13:45:26.289988 [debug] [MainThread]: Resource report: {"command_name": "init", "command_success": false, "command_wall_clock_time": 162.76894, "process_in_blocks": "216", "process_kernel_time": 0.086099, "process_mem_max_rss": "121972", "process_out_blocks": "78", "process_user_time": 1.149331}
[0m13:45:26.291973 [debug] [MainThread]: Command `dbt init` failed at 13:45:26.291499 after 162.77 seconds
[0m13:45:26.293416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb497850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb4e7790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffed4d090>]}
[0m13:45:26.294442 [debug] [MainThread]: Flushing usage events
[0m13:45:28.106733 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:47:02.979037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1602d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb181a850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1903790>]}


============================== 13:47:02.980429 | 2e0e95bd-fff7-4dc1-a7b2-1e94ac3a28d3 ==============================
[0m13:47:02.980429 [info ] [MainThread]: Running with dbt=1.9.0
[0m13:47:02.980901 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt init dbt_project', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:47:02.984413 [warn ] [MainThread]: [ConfigFolderDirectory]: Unable to parse logging event dictionary. Failed to parse dir field: expected string or bytes-like object, got 'PosixPath'.. Dictionary: {'dir': PosixPath('/root/.dbt')}
[0m13:47:02.984712 [info ] [MainThread]: Creating dbt configuration folder at 
[0m13:47:02.987205 [info ] [MainThread]: Setting up your profile.
[0m13:48:15.079400 [info ] [MainThread]: Profile snowflake written to /root/.dbt/profiles.yml using target's profile_template.yml and your supplied values. Run 'dbt debug' to validate the connection.
[0m13:48:15.082810 [debug] [MainThread]: Resource report: {"command_name": "init", "command_success": true, "command_wall_clock_time": 72.12278, "process_in_blocks": "0", "process_kernel_time": 0.063037, "process_mem_max_rss": "98416", "process_out_blocks": "11", "process_user_time": 0.593355}
[0m13:48:15.084007 [debug] [MainThread]: Command `dbt init` succeeded at 13:48:15.083824 after 72.12 seconds
[0m13:48:15.084851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb160c0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb14321d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2103650>]}
[0m13:48:15.085767 [debug] [MainThread]: Flushing usage events
[0m13:48:16.489773 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:48:29.557018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa83a550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa687990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa6879d0>]}


============================== 13:48:29.558399 | edcbcf64-6fb8-445c-81bd-5c63d662ca6b ==============================
[0m13:48:29.558399 [info ] [MainThread]: Running with dbt=1.9.0
[0m13:48:29.558757 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:48:29.562495 [info ] [MainThread]: dbt version: 1.9.0
[0m13:48:29.562770 [info ] [MainThread]: python version: 3.11.11
[0m13:48:29.563086 [info ] [MainThread]: python path: /usr/local/bin/python3.11
[0m13:48:29.563325 [info ] [MainThread]: os info: Linux-6.10.14-linuxkit-aarch64-with-glibc2.36
[0m13:48:29.582630 [info ] [MainThread]: Using profiles dir at /root/.dbt
[0m13:48:29.582918 [info ] [MainThread]: Using profiles.yml file at /root/.dbt/profiles.yml
[0m13:48:29.583165 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt_project.yml
[0m13:48:29.583499 [info ] [MainThread]: adapter type: postgres
[0m13:48:29.583750 [info ] [MainThread]: adapter version: 1.9.0
[0m13:48:29.620660 [info ] [MainThread]: Configuration:
[0m13:48:29.620930 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m13:48:29.621145 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m13:48:29.621362 [info ] [MainThread]: Required dependencies:
[0m13:48:29.621559 [debug] [MainThread]: Executing "git --help"
[0m13:48:29.622105 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m13:48:29.622340 [info ] [MainThread]: Connection:
[0m13:48:29.622596 [info ] [MainThread]:   host: postgres
[0m13:48:29.622808 [info ] [MainThread]:   port: 5432
[0m13:48:29.623058 [info ] [MainThread]:   user: airflow
[0m13:48:29.623344 [info ] [MainThread]:   database: airflow
[0m13:48:29.623567 [info ] [MainThread]:   schema: staging
[0m13:48:29.623831 [info ] [MainThread]:   connect_timeout: 10
[0m13:48:29.624028 [info ] [MainThread]:   role: None
[0m13:48:29.624228 [info ] [MainThread]:   search_path: None
[0m13:48:29.624449 [info ] [MainThread]:   keepalives_idle: 0
[0m13:48:29.624661 [info ] [MainThread]:   sslmode: None
[0m13:48:29.624929 [info ] [MainThread]:   sslcert: None
[0m13:48:29.625122 [info ] [MainThread]:   sslkey: None
[0m13:48:29.625379 [info ] [MainThread]:   sslrootcert: None
[0m13:48:29.625554 [info ] [MainThread]:   application_name: dbt
[0m13:48:29.625768 [info ] [MainThread]:   retries: 1
[0m13:48:29.626136 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:48:29.652459 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m13:48:29.662208 [debug] [MainThread]: Using postgres connection "debug"
[0m13:48:29.662435 [debug] [MainThread]: On debug: select 1 as id
[0m13:48:29.662640 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:48:29.665659 [debug] [MainThread]: SQL status: SELECT 1 in 0.003 seconds
[0m13:48:29.666077 [debug] [MainThread]: On debug: Close
[0m13:48:29.666247 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m13:48:29.666430 [info ] [MainThread]: [31m1 check failed:[0m
[0m13:48:29.666650 [info ] [MainThread]: Error from git --help: Could not find command, ensure it is in the user's PATH: "git"

[0m13:48:29.667216 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.13090076, "process_in_blocks": "40", "process_kernel_time": 0.062929, "process_mem_max_rss": "108216", "process_out_blocks": "48", "process_user_time": 0.633291}
[0m13:48:29.667449 [debug] [MainThread]: Command `dbt debug` failed at 13:48:29.667395 after 0.13 seconds
[0m13:48:29.667636 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m13:48:29.667802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa83bd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa6b4f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa6b7550>]}
[0m13:48:29.668035 [debug] [MainThread]: Flushing usage events
[0m13:48:30.995154 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:58:47.754316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84a372d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84a37890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84a36f90>]}


============================== 13:58:47.756373 | 459d0d81-d590-418b-b1da-ad7bd1977367 ==============================
[0m13:58:47.756373 [info ] [MainThread]: Running with dbt=1.9.0
[0m13:58:47.756820 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:58:47.761120 [info ] [MainThread]: dbt version: 1.9.0
[0m13:58:47.761437 [info ] [MainThread]: python version: 3.11.11
[0m13:58:47.761755 [info ] [MainThread]: python path: /usr/local/bin/python3.11
[0m13:58:47.762064 [info ] [MainThread]: os info: Linux-6.10.14-linuxkit-aarch64-with-glibc2.36
[0m13:58:47.783653 [info ] [MainThread]: Using profiles dir at /root/.dbt
[0m13:58:47.784048 [info ] [MainThread]: Using profiles.yml file at /root/.dbt/profiles.yml
[0m13:58:47.784324 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt_project.yml
[0m13:58:47.784644 [info ] [MainThread]: adapter type: postgres
[0m13:58:47.784857 [info ] [MainThread]: adapter version: 1.9.0
[0m13:58:47.822873 [info ] [MainThread]: Configuration:
[0m13:58:47.823177 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m13:58:47.823437 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m13:58:47.823686 [info ] [MainThread]: Required dependencies:
[0m13:58:47.823971 [debug] [MainThread]: Executing "git --help"
[0m13:58:47.824434 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m13:58:47.824652 [info ] [MainThread]: Connection:
[0m13:58:47.824906 [info ] [MainThread]:   host: postgres
[0m13:58:47.825157 [info ] [MainThread]:   port: 5432
[0m13:58:47.825384 [info ] [MainThread]:   user: airflow
[0m13:58:47.825653 [info ] [MainThread]:   database: airflow
[0m13:58:47.825869 [info ] [MainThread]:   schema: staging
[0m13:58:47.826125 [info ] [MainThread]:   connect_timeout: 10
[0m13:58:47.826395 [info ] [MainThread]:   role: None
[0m13:58:47.826603 [info ] [MainThread]:   search_path: None
[0m13:58:47.826821 [info ] [MainThread]:   keepalives_idle: 0
[0m13:58:47.827047 [info ] [MainThread]:   sslmode: None
[0m13:58:47.827288 [info ] [MainThread]:   sslcert: None
[0m13:58:47.827546 [info ] [MainThread]:   sslkey: None
[0m13:58:47.827782 [info ] [MainThread]:   sslrootcert: None
[0m13:58:47.828026 [info ] [MainThread]:   application_name: dbt
[0m13:58:47.828218 [info ] [MainThread]:   retries: 1
[0m13:58:47.828544 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:58:47.852175 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m13:58:47.863526 [debug] [MainThread]: Using postgres connection "debug"
[0m13:58:47.863774 [debug] [MainThread]: On debug: select 1 as id
[0m13:58:47.863979 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:58:47.867854 [debug] [MainThread]: SQL status: SELECT 1 in 0.004 seconds
[0m13:58:47.868430 [debug] [MainThread]: On debug: Close
[0m13:58:47.868649 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m13:58:47.868891 [info ] [MainThread]: [31m1 check failed:[0m
[0m13:58:47.869356 [info ] [MainThread]: Error from git --help: Could not find command, ensure it is in the user's PATH: "git"

[0m13:58:47.869976 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.13755909, "process_in_blocks": "0", "process_kernel_time": 0.093943, "process_mem_max_rss": "108048", "process_out_blocks": "8", "process_user_time": 0.665601}
[0m13:58:47.870273 [debug] [MainThread]: Command `dbt debug` failed at 13:58:47.870221 after 0.14 seconds
[0m13:58:47.870483 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m13:58:47.870699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8488ccd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85537690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83e11e50>]}
[0m13:58:47.870942 [debug] [MainThread]: Flushing usage events
[0m13:58:49.403157 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:19:42.753175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e933ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e783710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ea68890>]}


============================== 14:19:42.754798 | 05a1bfb2-55b9-41ac-bcce-3d3517b01e0d ==============================
[0m14:19:42.754798 [info ] [MainThread]: Running with dbt=1.9.0
[0m14:19:42.755198 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:19:42.759000 [info ] [MainThread]: dbt version: 1.9.0
[0m14:19:42.759264 [info ] [MainThread]: python version: 3.11.11
[0m14:19:42.759526 [info ] [MainThread]: python path: /usr/local/bin/python3.11
[0m14:19:42.759759 [info ] [MainThread]: os info: Linux-6.10.14-linuxkit-aarch64-with-glibc2.36
[0m14:19:42.761443 [info ] [MainThread]: Using profiles dir at /root/.dbt
[0m14:19:42.761654 [info ] [MainThread]: Using profiles.yml file at /root/.dbt/profiles.yml
[0m14:19:42.761891 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt_project.yml
[0m14:19:42.801211 [info ] [MainThread]: Configuration:
[0m14:19:42.801525 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m14:19:42.801847 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m14:19:42.802041 [info ] [MainThread]: Required dependencies:
[0m14:19:42.802277 [debug] [MainThread]: Executing "git --help"
[0m14:19:42.802831 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m14:19:42.803071 [info ] [MainThread]: Connection test skipped since no profile was found
[0m14:19:42.803449 [info ] [MainThread]: [31m2 checks failed:[0m
[0m14:19:42.803642 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  Could not find profile named 'snowflake'


[0m14:19:42.803886 [info ] [MainThread]: Error from git --help: Could not find command, ensure it is in the user's PATH: "git"

[0m14:19:42.804474 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.07329633, "process_in_blocks": "0", "process_kernel_time": 0.061047, "process_mem_max_rss": "96652", "process_out_blocks": "5", "process_user_time": 0.597465}
[0m14:19:42.804728 [debug] [MainThread]: Command `dbt debug` failed at 14:19:42.804668 after 0.07 seconds
[0m14:19:42.804963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ea1acd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e75e610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83309110>]}
[0m14:19:42.805192 [debug] [MainThread]: Flushing usage events
[0m14:19:44.038546 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:22:06.022898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81d36dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81f4e010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81d36ad0>]}


============================== 14:22:06.024297 | 4e2ff07f-fd48-4033-8789-a8dd4f81318f ==============================
[0m14:22:06.024297 [info ] [MainThread]: Running with dbt=1.9.0
[0m14:22:06.024705 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt debug', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:22:06.028320 [info ] [MainThread]: dbt version: 1.9.0
[0m14:22:06.028574 [info ] [MainThread]: python version: 3.11.11
[0m14:22:06.028923 [info ] [MainThread]: python path: /usr/local/bin/python3.11
[0m14:22:06.029155 [info ] [MainThread]: os info: Linux-6.10.14-linuxkit-aarch64-with-glibc2.36
[0m14:22:06.049934 [info ] [MainThread]: Using profiles dir at /root/.dbt
[0m14:22:06.050224 [info ] [MainThread]: Using profiles.yml file at /root/.dbt/profiles.yml
[0m14:22:06.050459 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt_project.yml
[0m14:22:06.050759 [info ] [MainThread]: adapter type: postgres
[0m14:22:06.050993 [info ] [MainThread]: adapter version: 1.9.0
[0m14:22:06.087739 [info ] [MainThread]: Configuration:
[0m14:22:06.088013 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m14:22:06.088267 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m14:22:06.088550 [info ] [MainThread]: Required dependencies:
[0m14:22:06.088788 [debug] [MainThread]: Executing "git --help"
[0m14:22:06.089298 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m14:22:06.089534 [info ] [MainThread]: Connection:
[0m14:22:06.089777 [info ] [MainThread]:   host: postgres
[0m14:22:06.090019 [info ] [MainThread]:   port: 5432
[0m14:22:06.090292 [info ] [MainThread]:   user: airflow
[0m14:22:06.090511 [info ] [MainThread]:   database: airflow
[0m14:22:06.090746 [info ] [MainThread]:   schema: staging
[0m14:22:06.090984 [info ] [MainThread]:   connect_timeout: 10
[0m14:22:06.091241 [info ] [MainThread]:   role: None
[0m14:22:06.091457 [info ] [MainThread]:   search_path: None
[0m14:22:06.091679 [info ] [MainThread]:   keepalives_idle: 0
[0m14:22:06.091885 [info ] [MainThread]:   sslmode: None
[0m14:22:06.092782 [info ] [MainThread]:   sslcert: None
[0m14:22:06.093105 [info ] [MainThread]:   sslkey: None
[0m14:22:06.093317 [info ] [MainThread]:   sslrootcert: None
[0m14:22:06.093545 [info ] [MainThread]:   application_name: dbt
[0m14:22:06.093757 [info ] [MainThread]:   retries: 1
[0m14:22:06.094340 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:22:06.120519 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m14:22:06.132148 [debug] [MainThread]: Using postgres connection "debug"
[0m14:22:06.132391 [debug] [MainThread]: On debug: select 1 as id
[0m14:22:06.132609 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:22:06.135317 [debug] [MainThread]: SQL status: SELECT 1 in 0.003 seconds
[0m14:22:06.135740 [debug] [MainThread]: On debug: Close
[0m14:22:06.135956 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m14:22:06.136191 [info ] [MainThread]: [31m1 check failed:[0m
[0m14:22:06.136535 [info ] [MainThread]: Error from git --help: Could not find command, ensure it is in the user's PATH: "git"

[0m14:22:06.137150 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.13653366, "process_in_blocks": "0", "process_kernel_time": 0.070564, "process_mem_max_rss": "108152", "process_out_blocks": "40", "process_user_time": 0.636071}
[0m14:22:06.137418 [debug] [MainThread]: Command `dbt debug` failed at 14:22:06.137368 after 0.14 seconds
[0m14:22:06.137626 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m14:22:06.137850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81b61250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81b61110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81163510>]}
[0m14:22:06.138093 [debug] [MainThread]: Flushing usage events
[0m14:22:07.704842 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:22:34.385774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a943610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a797ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a9434d0>]}


============================== 14:22:34.387244 | 0da60d1e-3211-464c-8df4-3555777ac716 ==============================
[0m14:22:34.387244 [info ] [MainThread]: Running with dbt=1.9.0
[0m14:22:34.387603 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:22:34.391569 [info ] [MainThread]: dbt version: 1.9.0
[0m14:22:34.391863 [info ] [MainThread]: python version: 3.11.11
[0m14:22:34.392175 [info ] [MainThread]: python path: /usr/local/bin/python3.11
[0m14:22:34.392473 [info ] [MainThread]: os info: Linux-6.10.14-linuxkit-aarch64-with-glibc2.36
[0m14:22:34.413445 [info ] [MainThread]: Using profiles dir at /root/.dbt
[0m14:22:34.413765 [info ] [MainThread]: Using profiles.yml file at /root/.dbt/profiles.yml
[0m14:22:34.414065 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt_project.yml
[0m14:22:34.414437 [info ] [MainThread]: adapter type: postgres
[0m14:22:34.414766 [info ] [MainThread]: adapter version: 1.9.0
[0m14:22:34.453450 [info ] [MainThread]: Configuration:
[0m14:22:34.453770 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m14:22:34.454164 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m14:22:34.454460 [info ] [MainThread]: Required dependencies:
[0m14:22:34.454753 [debug] [MainThread]: Executing "git --help"
[0m14:22:34.455329 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m14:22:34.455546 [info ] [MainThread]: Connection:
[0m14:22:34.455786 [info ] [MainThread]:   host: postgres
[0m14:22:34.456022 [info ] [MainThread]:   port: 5432
[0m14:22:34.456267 [info ] [MainThread]:   user: airflow
[0m14:22:34.456509 [info ] [MainThread]:   database: airflow
[0m14:22:34.456788 [info ] [MainThread]:   schema: staging
[0m14:22:34.457028 [info ] [MainThread]:   connect_timeout: 10
[0m14:22:34.457261 [info ] [MainThread]:   role: None
[0m14:22:34.457513 [info ] [MainThread]:   search_path: None
[0m14:22:34.457726 [info ] [MainThread]:   keepalives_idle: 0
[0m14:22:34.457940 [info ] [MainThread]:   sslmode: None
[0m14:22:34.458172 [info ] [MainThread]:   sslcert: None
[0m14:22:34.458399 [info ] [MainThread]:   sslkey: None
[0m14:22:34.458648 [info ] [MainThread]:   sslrootcert: None
[0m14:22:34.458869 [info ] [MainThread]:   application_name: dbt
[0m14:22:34.459088 [info ] [MainThread]:   retries: 1
[0m14:22:34.459391 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:22:34.486214 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m14:22:34.496647 [debug] [MainThread]: Using postgres connection "debug"
[0m14:22:34.496899 [debug] [MainThread]: On debug: select 1 as id
[0m14:22:34.497105 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:22:34.499568 [debug] [MainThread]: SQL status: SELECT 1 in 0.002 seconds
[0m14:22:34.500019 [debug] [MainThread]: On debug: Close
[0m14:22:34.500230 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m14:22:34.500458 [info ] [MainThread]: [31m1 check failed:[0m
[0m14:22:34.500770 [info ] [MainThread]: Error from git --help: Could not find command, ensure it is in the user's PATH: "git"

[0m14:22:34.501356 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.13683592, "process_in_blocks": "0", "process_kernel_time": 0.077761, "process_mem_max_rss": "108088", "process_out_blocks": "40", "process_user_time": 0.646015}
[0m14:22:34.501609 [debug] [MainThread]: Command `dbt debug` failed at 14:22:34.501565 after 0.14 seconds
[0m14:22:34.501808 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m14:22:34.502038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a943e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a941110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f2a8f50>]}
[0m14:22:34.502291 [debug] [MainThread]: Flushing usage events
[0m14:22:35.721694 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:23:10.968561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99d0f7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99e445d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99d0ed10>]}


============================== 14:23:10.970019 | 81b31eff-4f2d-49ad-8d20-9fa1faf5243e ==============================
[0m14:23:10.970019 [info ] [MainThread]: Running with dbt=1.9.0
[0m14:23:10.970405 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:23:10.974105 [info ] [MainThread]: dbt version: 1.9.0
[0m14:23:10.974399 [info ] [MainThread]: python version: 3.11.11
[0m14:23:10.974711 [info ] [MainThread]: python path: /usr/local/bin/python3.11
[0m14:23:10.974957 [info ] [MainThread]: os info: Linux-6.10.14-linuxkit-aarch64-with-glibc2.36
[0m14:23:10.976838 [info ] [MainThread]: Using profiles dir at /root/.dbt
[0m14:23:10.977052 [info ] [MainThread]: Using profiles.yml file at /root/.dbt/profiles.yml
[0m14:23:10.977367 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt_project.yml
[0m14:23:11.014464 [info ] [MainThread]: Configuration:
[0m14:23:11.014728 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m14:23:11.015015 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m14:23:11.015249 [info ] [MainThread]: Required dependencies:
[0m14:23:11.015540 [debug] [MainThread]: Executing "git --help"
[0m14:23:11.016077 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m14:23:11.016377 [info ] [MainThread]: Connection test skipped since no profile was found
[0m14:23:11.016622 [info ] [MainThread]: [31m2 checks failed:[0m
[0m14:23:11.016867 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  Could not find profile named 'snowflake'


[0m14:23:11.017110 [info ] [MainThread]: Error from git --help: Could not find command, ensure it is in the user's PATH: "git"

[0m14:23:11.017675 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.070685126, "process_in_blocks": "0", "process_kernel_time": 0.058904, "process_mem_max_rss": "96664", "process_out_blocks": "5", "process_user_time": 0.589048}
[0m14:23:11.017904 [debug] [MainThread]: Command `dbt debug` failed at 14:23:11.017864 after 0.07 seconds
[0m14:23:11.018114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99b3a110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99b3af50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99b398d0>]}
[0m14:23:11.018346 [debug] [MainThread]: Flushing usage events
[0m14:23:12.321742 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:23:43.662680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e747390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e597f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e597b10>]}


============================== 14:23:43.664090 | ed0a7903-af7a-420f-a860-087829e4277f ==============================
[0m14:23:43.664090 [info ] [MainThread]: Running with dbt=1.9.0
[0m14:23:43.664505 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m14:23:43.668089 [info ] [MainThread]: dbt version: 1.9.0
[0m14:23:43.668429 [info ] [MainThread]: python version: 3.11.11
[0m14:23:43.668740 [info ] [MainThread]: python path: /usr/local/bin/python3.11
[0m14:23:43.668997 [info ] [MainThread]: os info: Linux-6.10.14-linuxkit-aarch64-with-glibc2.36
[0m14:23:43.670997 [info ] [MainThread]: Using profiles dir at /root/.dbt
[0m14:23:43.671227 [info ] [MainThread]: Using profiles.yml file at /root/.dbt/profiles.yml
[0m14:23:43.671479 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt_project.yml
[0m14:23:43.708001 [info ] [MainThread]: Configuration:
[0m14:23:43.708245 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m14:23:43.708496 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m14:23:43.708749 [info ] [MainThread]: Required dependencies:
[0m14:23:43.709002 [debug] [MainThread]: Executing "git --help"
[0m14:23:43.709471 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m14:23:43.709675 [info ] [MainThread]: Connection test skipped since no profile was found
[0m14:23:43.709983 [info ] [MainThread]: [31m2 checks failed:[0m
[0m14:23:43.710214 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  Could not find profile named 'airflow'


[0m14:23:43.710460 [info ] [MainThread]: Error from git --help: Could not find command, ensure it is in the user's PATH: "git"

[0m14:23:43.710979 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.06921579, "process_in_blocks": "0", "process_kernel_time": 0.055221, "process_mem_max_rss": "96676", "process_out_blocks": "5", "process_user_time": 0.583334}
[0m14:23:43.711234 [debug] [MainThread]: Command `dbt debug` failed at 14:23:43.711187 after 0.07 seconds
[0m14:23:43.711440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e597d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e572c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3055150>]}
[0m14:23:43.711677 [debug] [MainThread]: Flushing usage events
[0m14:23:45.294167 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:24:49.346525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89d3ab10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89d38450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89d3b910>]}


============================== 14:24:49.347929 | edd29d4e-5e5c-4b87-ba6d-29344a3bbc3d ==============================
[0m14:24:49.347929 [info ] [MainThread]: Running with dbt=1.9.0
[0m14:24:49.348334 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select dimensions.dim_district', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:24:49.407994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'edd29d4e-5e5c-4b87-ba6d-29344a3bbc3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c0b6550>]}
[0m14:24:49.429840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'edd29d4e-5e5c-4b87-ba6d-29344a3bbc3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c82ee90>]}
[0m14:24:49.430205 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:24:49.454645 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m14:24:49.455211 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:24:49.455474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'edd29d4e-5e5c-4b87-ba6d-29344a3bbc3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88f32910>]}
[0m14:24:49.796510 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.etl_waterlevel.example
- models.etl_waterlevel.staging
[0m14:24:49.798912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'edd29d4e-5e5c-4b87-ba6d-29344a3bbc3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8908a7d0>]}
[0m14:24:49.852811 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m14:24:49.854729 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m14:24:49.865098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'edd29d4e-5e5c-4b87-ba6d-29344a3bbc3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89010750>]}
[0m14:24:49.865388 [info ] [MainThread]: Found 1 model, 433 macros
[0m14:24:49.865616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'edd29d4e-5e5c-4b87-ba6d-29344a3bbc3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89025b50>]}
[0m14:24:49.866464 [info ] [MainThread]: 
[0m14:24:49.866721 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:24:49.867002 [info ] [MainThread]: 
[0m14:24:49.867414 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:24:49.867923 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m14:24:49.882607 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m14:24:49.882917 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m14:24:49.883137 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:24:49.885751 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.003 seconds
[0m14:24:49.886412 [debug] [ThreadPool]: On list_airflow: Close
[0m14:24:49.886803 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now create_airflow_staging_dim)
[0m14:24:49.887098 [debug] [ThreadPool]: Creating schema "database: "airflow"
schema: "staging_dim"
"
[0m14:24:49.889523 [debug] [ThreadPool]: Using postgres connection "create_airflow_staging_dim"
[0m14:24:49.889743 [debug] [ThreadPool]: On create_airflow_staging_dim: BEGIN
[0m14:24:49.889936 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:24:49.892069 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m14:24:49.892359 [debug] [ThreadPool]: Using postgres connection "create_airflow_staging_dim"
[0m14:24:49.892596 [debug] [ThreadPool]: On create_airflow_staging_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "create_airflow_staging_dim"} */
create schema if not exists "staging_dim"
[0m14:24:49.894411 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.002 seconds
[0m14:24:49.894901 [debug] [ThreadPool]: On create_airflow_staging_dim: COMMIT
[0m14:24:49.895076 [debug] [ThreadPool]: Using postgres connection "create_airflow_staging_dim"
[0m14:24:49.895213 [debug] [ThreadPool]: On create_airflow_staging_dim: COMMIT
[0m14:24:49.895563 [debug] [ThreadPool]: SQL status: COMMIT in 0.000 seconds
[0m14:24:49.895715 [debug] [ThreadPool]: On create_airflow_staging_dim: Close
[0m14:24:49.896318 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_airflow_staging_dim, now list_airflow_staging_dim)
[0m14:24:49.898903 [debug] [ThreadPool]: Using postgres connection "list_airflow_staging_dim"
[0m14:24:49.899127 [debug] [ThreadPool]: On list_airflow_staging_dim: BEGIN
[0m14:24:49.899290 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:24:49.900665 [debug] [ThreadPool]: SQL status: BEGIN in 0.001 seconds
[0m14:24:49.900920 [debug] [ThreadPool]: Using postgres connection "list_airflow_staging_dim"
[0m14:24:49.901133 [debug] [ThreadPool]: On list_airflow_staging_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_staging_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_dim'
  
[0m14:24:49.904330 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m14:24:49.904862 [debug] [ThreadPool]: On list_airflow_staging_dim: ROLLBACK
[0m14:24:49.905150 [debug] [ThreadPool]: On list_airflow_staging_dim: Close
[0m14:24:49.907168 [debug] [MainThread]: Using postgres connection "master"
[0m14:24:49.907398 [debug] [MainThread]: On master: BEGIN
[0m14:24:49.907567 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:24:49.908849 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m14:24:49.909124 [debug] [MainThread]: Using postgres connection "master"
[0m14:24:49.909341 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:24:49.911408 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m14:24:49.911956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'edd29d4e-5e5c-4b87-ba6d-29344a3bbc3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff885e0a50>]}
[0m14:24:49.912203 [debug] [MainThread]: On master: ROLLBACK
[0m14:24:49.912397 [debug] [MainThread]: Using postgres connection "master"
[0m14:24:49.912525 [debug] [MainThread]: On master: BEGIN
[0m14:24:49.912755 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:24:49.913144 [debug] [MainThread]: On master: COMMIT
[0m14:24:49.913327 [debug] [MainThread]: Using postgres connection "master"
[0m14:24:49.913488 [debug] [MainThread]: On master: COMMIT
[0m14:24:49.913682 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:24:49.913816 [debug] [MainThread]: On master: Close
[0m14:24:49.914825 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.dim_district
[0m14:24:49.915119 [info ] [Thread-1 (]: 1 of 1 START sql view model staging_dim.dim_district ........................... [RUN]
[0m14:24:49.915372 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_staging_dim, now model.etl_waterlevel.dim_district)
[0m14:24:49.915561 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.dim_district
[0m14:24:49.918535 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.dim_district"
[0m14:24:49.919668 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.dim_district
[0m14:24:49.935978 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.dim_district"
[0m14:24:49.937453 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_district"
[0m14:24:49.937674 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_district: BEGIN
[0m14:24:49.937879 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:24:49.939655 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m14:24:49.939919 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_district"
[0m14:24:49.940174 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_district: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.dim_district"} */

  create view "airflow"."staging_dim"."dim_district__dbt_tmp"
    
    
  as (
    -- models/dimensions/dim_district.sql

with source as (
  select distinct
    district_id
  from raw.waterlevels
),

add_names as (
  select
    district_id,
    case district_id
      when 101 then 'Petaling'
      when 102 then 'Klang'
      when 103 then 'Gombak'
      when 104 then 'Hulu Langat'
      when 105 then 'Kuala Selangor'
      when 106 then 'Hulu Selangor'
      when 107 then 'Sabak Bernam'
      when 108 then 'Kuala Langat'
      when 109 then 'Sepang'
      else 'Unknown'
    end as district_name
  from source
)

select * from add_names
  );
[0m14:24:49.940623 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "district_id" does not exist
LINE 11:     district_id
             ^

[0m14:24:49.940871 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_district: ROLLBACK
[0m14:24:49.941130 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_district: Close
[0m14:24:49.942932 [debug] [Thread-1 (]: Database Error in model dim_district (models/dimensions/dim_district.sql)
  column "district_id" does not exist
  LINE 11:     district_id
               ^
  compiled code at target/run/etl_waterlevel/models/dimensions/dim_district.sql
[0m14:24:49.943788 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'edd29d4e-5e5c-4b87-ba6d-29344a3bbc3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff889c9410>]}
[0m14:24:49.944140 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model staging_dim.dim_district .................. [[31mERROR[0m in 0.03s]
[0m14:24:49.944514 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.dim_district
[0m14:24:49.945009 [debug] [Thread-7 (]: Marking all children of 'model.etl_waterlevel.dim_district' to be skipped because of status 'error'.  Reason: Database Error in model dim_district (models/dimensions/dim_district.sql)
  column "district_id" does not exist
  LINE 11:     district_id
               ^
  compiled code at target/run/etl_waterlevel/models/dimensions/dim_district.sql.
[0m14:24:49.946257 [debug] [MainThread]: Using postgres connection "master"
[0m14:24:49.946445 [debug] [MainThread]: On master: BEGIN
[0m14:24:49.946617 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:24:49.948157 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m14:24:49.948383 [debug] [MainThread]: On master: COMMIT
[0m14:24:49.948550 [debug] [MainThread]: Using postgres connection "master"
[0m14:24:49.948715 [debug] [MainThread]: On master: COMMIT
[0m14:24:49.948938 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:24:49.949161 [debug] [MainThread]: On master: Close
[0m14:24:49.949427 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:24:49.949595 [debug] [MainThread]: Connection 'model.etl_waterlevel.dim_district' was properly closed.
[0m14:24:49.949806 [info ] [MainThread]: 
[0m14:24:49.950016 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.08 seconds (0.08s).
[0m14:24:49.950530 [debug] [MainThread]: Command end result
[0m14:24:49.964503 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m14:24:49.965622 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m14:24:49.968649 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m14:24:49.968828 [info ] [MainThread]: 
[0m14:24:49.969096 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:24:49.969342 [info ] [MainThread]: 
[0m14:24:49.969601 [error] [MainThread]:   Database Error in model dim_district (models/dimensions/dim_district.sql)
  column "district_id" does not exist
  LINE 11:     district_id
               ^
  compiled code at target/run/etl_waterlevel/models/dimensions/dim_district.sql
[0m14:24:49.969763 [info ] [MainThread]: 
[0m14:24:49.970043 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:24:49.970590 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.64604294, "process_in_blocks": "0", "process_kernel_time": 0.08606, "process_mem_max_rss": "116312", "process_out_blocks": "2594", "process_user_time": 1.104779}
[0m14:24:49.970792 [debug] [MainThread]: Command `dbt run` failed at 14:24:49.970755 after 0.65 seconds
[0m14:24:49.970984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89b66690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89b67150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89b66ed0>]}
[0m14:24:49.971170 [debug] [MainThread]: Flushing usage events
[0m14:24:51.139858 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:39:36.638198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8630b690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff864408d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8615c1d0>]}


============================== 14:39:36.640402 | aa10e567-fddc-4b94-ba4c-9d34a6633f57 ==============================
[0m14:39:36.640402 [info ] [MainThread]: Running with dbt=1.9.0
[0m14:39:36.640766 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --select dimensions.dim_station', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:39:36.702424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aa10e567-fddc-4b94-ba4c-9d34a6633f57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8615f5d0>]}
[0m14:39:36.725831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aa10e567-fddc-4b94-ba4c-9d34a6633f57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88d45090>]}
[0m14:39:36.726226 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:39:36.751067 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m14:39:36.786750 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m14:39:36.787037 [debug] [MainThread]: Partial parsing: added file: etl_waterlevel://models/dimensions/dim_stations.sql
[0m14:39:36.787243 [debug] [MainThread]: Partial parsing: deleted file: etl_waterlevel://models/dimensions/dim_district.sql
[0m14:39:36.874091 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.etl_waterlevel.staging
- models.etl_waterlevel.example
[0m14:39:36.876333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aa10e567-fddc-4b94-ba4c-9d34a6633f57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff852def10>]}
[0m14:39:36.902669 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m14:39:36.904343 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m14:39:36.910377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aa10e567-fddc-4b94-ba4c-9d34a6633f57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84fe7e90>]}
[0m14:39:36.910619 [info ] [MainThread]: Found 1 model, 433 macros
[0m14:39:36.910840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aa10e567-fddc-4b94-ba4c-9d34a6633f57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85498f10>]}
[0m14:39:36.911188 [warn ] [MainThread]: The selection criterion 'dimensions.dim_station' does not match any enabled nodes
[0m14:39:36.911717 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m14:39:36.912031 [debug] [MainThread]: Command end result
[0m14:39:36.922512 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m14:39:36.923425 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m14:39:36.924903 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m14:39:36.925373 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.3085096, "process_in_blocks": "0", "process_kernel_time": 0.09034, "process_mem_max_rss": "109464", "process_out_blocks": "2442", "process_user_time": 0.82411}
[0m14:39:36.925586 [debug] [MainThread]: Command `dbt run` succeeded at 14:39:36.925543 after 0.31 seconds
[0m14:39:36.925773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8615ee50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86181c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8527a010>]}
[0m14:39:36.925949 [debug] [MainThread]: Flushing usage events
[0m14:39:38.366991 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:41:12.831316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bd43e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bd5e510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bd43310>]}


============================== 14:41:12.832717 | 9e8f41b2-f919-4722-b39f-bcdc7bcd0f48 ==============================
[0m14:41:12.832717 [info ] [MainThread]: Running with dbt=1.9.0
[0m14:41:12.833155 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --select dimensions.dim_stations', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:41:12.892460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9e8f41b2-f919-4722-b39f-bcdc7bcd0f48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b0e9f10>]}
[0m14:41:12.914310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9e8f41b2-f919-4722-b39f-bcdc7bcd0f48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e774c50>]}
[0m14:41:12.914675 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:41:12.939104 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m14:41:12.977463 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:41:12.977700 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:41:12.979984 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.etl_waterlevel.staging
- models.etl_waterlevel.example
[0m14:41:12.988793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9e8f41b2-f919-4722-b39f-bcdc7bcd0f48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bb94390>]}
[0m14:41:13.016914 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m14:41:13.018401 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m14:41:13.023769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9e8f41b2-f919-4722-b39f-bcdc7bcd0f48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ae798d0>]}
[0m14:41:13.024016 [info ] [MainThread]: Found 1 model, 433 macros
[0m14:41:13.024231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9e8f41b2-f919-4722-b39f-bcdc7bcd0f48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bd33dd0>]}
[0m14:41:13.024893 [info ] [MainThread]: 
[0m14:41:13.025146 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:41:13.025340 [info ] [MainThread]: 
[0m14:41:13.025656 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:41:13.026169 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m14:41:13.041925 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m14:41:13.042160 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m14:41:13.042348 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:41:13.045127 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.003 seconds
[0m14:41:13.045699 [debug] [ThreadPool]: On list_airflow: Close
[0m14:41:13.046341 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_staging_dim)
[0m14:41:13.049100 [debug] [ThreadPool]: Using postgres connection "list_airflow_staging_dim"
[0m14:41:13.049297 [debug] [ThreadPool]: On list_airflow_staging_dim: BEGIN
[0m14:41:13.049475 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:41:13.050946 [debug] [ThreadPool]: SQL status: BEGIN in 0.001 seconds
[0m14:41:13.051141 [debug] [ThreadPool]: Using postgres connection "list_airflow_staging_dim"
[0m14:41:13.051330 [debug] [ThreadPool]: On list_airflow_staging_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_staging_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_dim'
  
[0m14:41:13.052705 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.001 seconds
[0m14:41:13.053240 [debug] [ThreadPool]: On list_airflow_staging_dim: ROLLBACK
[0m14:41:13.053506 [debug] [ThreadPool]: On list_airflow_staging_dim: Close
[0m14:41:13.055385 [debug] [MainThread]: Using postgres connection "master"
[0m14:41:13.055582 [debug] [MainThread]: On master: BEGIN
[0m14:41:13.055754 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:41:13.057133 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m14:41:13.057369 [debug] [MainThread]: Using postgres connection "master"
[0m14:41:13.057608 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:41:13.059018 [debug] [MainThread]: SQL status: SELECT 0 in 0.001 seconds
[0m14:41:13.059526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9e8f41b2-f919-4722-b39f-bcdc7bcd0f48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ae87110>]}
[0m14:41:13.059771 [debug] [MainThread]: On master: ROLLBACK
[0m14:41:13.060066 [debug] [MainThread]: Using postgres connection "master"
[0m14:41:13.060256 [debug] [MainThread]: On master: BEGIN
[0m14:41:13.060596 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:41:13.060824 [debug] [MainThread]: On master: COMMIT
[0m14:41:13.061025 [debug] [MainThread]: Using postgres connection "master"
[0m14:41:13.061199 [debug] [MainThread]: On master: COMMIT
[0m14:41:13.061449 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:41:13.061626 [debug] [MainThread]: On master: Close
[0m14:41:13.062874 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.dim_stations
[0m14:41:13.063164 [info ] [Thread-1 (]: 1 of 1 START sql view model staging_dim.dim_stations ........................... [RUN]
[0m14:41:13.063425 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_staging_dim, now model.etl_waterlevel.dim_stations)
[0m14:41:13.063655 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.dim_stations
[0m14:41:13.066487 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.dim_stations"
[0m14:41:13.067294 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.dim_stations
[0m14:41:13.083198 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.dim_stations"
[0m14:41:13.084004 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m14:41:13.084215 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: BEGIN
[0m14:41:13.084412 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:41:13.085938 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m14:41:13.086245 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m14:41:13.086493 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.dim_stations"} */

  create view "airflow"."staging_dim"."dim_stations__dbt_tmp"
    
    
  as (
    -- models/dimensions/dim_station.sql

with station_names as (
  select distinct
    "stationId"     as station_id,
    "stationName"   as station_name,
    "stationCode"   as station_code,
    "stationStatus" as station_status
  from raw.waterlevels
)

select * from station_names
  );
[0m14:41:13.144099 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.057 seconds
[0m14:41:13.147012 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m14:41:13.147225 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.dim_stations"} */
alter table "airflow"."staging_dim"."dim_stations__dbt_tmp" rename to "dim_stations"
[0m14:41:13.150309 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m14:41:13.156203 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: COMMIT
[0m14:41:13.156428 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m14:41:13.156636 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: COMMIT
[0m14:41:13.157165 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m14:41:13.159779 [debug] [Thread-1 (]: Applying DROP to: "airflow"."staging_dim"."dim_stations__dbt_backup"
[0m14:41:13.161713 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m14:41:13.161900 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.dim_stations"} */
drop view if exists "airflow"."staging_dim"."dim_stations__dbt_backup" cascade
[0m14:41:13.162169 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m14:41:13.163177 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: Close
[0m14:41:13.163975 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e8f41b2-f919-4722-b39f-bcdc7bcd0f48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8af62610>]}
[0m14:41:13.164316 [info ] [Thread-1 (]: 1 of 1 OK created sql view model staging_dim.dim_stations ...................... [[32mCREATE VIEW[0m in 0.10s]
[0m14:41:13.164679 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.dim_stations
[0m14:41:13.165423 [debug] [MainThread]: Using postgres connection "master"
[0m14:41:13.165624 [debug] [MainThread]: On master: BEGIN
[0m14:41:13.165763 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:41:13.167349 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m14:41:13.167595 [debug] [MainThread]: On master: COMMIT
[0m14:41:13.167772 [debug] [MainThread]: Using postgres connection "master"
[0m14:41:13.167983 [debug] [MainThread]: On master: COMMIT
[0m14:41:13.168236 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:41:13.168417 [debug] [MainThread]: On master: Close
[0m14:41:13.168650 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:41:13.168836 [debug] [MainThread]: Connection 'model.etl_waterlevel.dim_stations' was properly closed.
[0m14:41:13.169042 [info ] [MainThread]: 
[0m14:41:13.169228 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.14 seconds (0.14s).
[0m14:41:13.169670 [debug] [MainThread]: Command end result
[0m14:41:13.182077 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m14:41:13.183028 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m14:41:13.185865 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m14:41:13.186052 [info ] [MainThread]: 
[0m14:41:13.186274 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:41:13.186475 [info ] [MainThread]: 
[0m14:41:13.186720 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:41:13.187246 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.3772199, "process_in_blocks": "0", "process_kernel_time": 0.085017, "process_mem_max_rss": "113892", "process_out_blocks": "1652", "process_user_time": 0.773158}
[0m14:41:13.187443 [debug] [MainThread]: Command `dbt run` succeeded at 14:41:13.187410 after 0.38 seconds
[0m14:41:13.187613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d6f9610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bb94450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bd5dfd0>]}
[0m14:41:13.187780 [debug] [MainThread]: Flushing usage events
[0m14:41:14.583224 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:48:58.752533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae5429d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae5434d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae543650>]}


============================== 14:48:58.753931 | 68d01f77-bf1a-486c-bbf9-3e19858958f7 ==============================
[0m14:48:58.753931 [info ] [MainThread]: Running with dbt=1.9.0
[0m14:48:58.754393 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --select dimensions.dim_stations', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:48:58.817226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '68d01f77-bf1a-486c-bbf9-3e19858958f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad93bc90>]}
[0m14:48:58.839540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '68d01f77-bf1a-486c-bbf9-3e19858958f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0fd5510>]}
[0m14:48:58.839993 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:48:58.865242 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m14:48:58.899472 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:48:58.899711 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:48:58.901982 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.etl_waterlevel.example
- models.etl_waterlevel.staging
[0m14:48:58.910704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '68d01f77-bf1a-486c-bbf9-3e19858958f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad7c4810>]}
[0m14:48:58.937487 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m14:48:58.938919 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m14:48:58.944227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '68d01f77-bf1a-486c-bbf9-3e19858958f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad6c9110>]}
[0m14:48:58.944495 [info ] [MainThread]: Found 1 model, 433 macros
[0m14:48:58.944755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '68d01f77-bf1a-486c-bbf9-3e19858958f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae638090>]}
[0m14:48:58.945457 [info ] [MainThread]: 
[0m14:48:58.945749 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:48:58.945933 [info ] [MainThread]: 
[0m14:48:58.946287 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:48:58.946819 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m14:48:58.961648 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m14:48:58.961902 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m14:48:58.962123 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:48:58.964706 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.003 seconds
[0m14:48:58.965416 [debug] [ThreadPool]: On list_airflow: Close
[0m14:48:58.966174 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_staging_dim)
[0m14:48:58.969248 [debug] [ThreadPool]: Using postgres connection "list_airflow_staging_dim"
[0m14:48:58.969471 [debug] [ThreadPool]: On list_airflow_staging_dim: BEGIN
[0m14:48:58.969661 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:48:58.971323 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m14:48:58.971580 [debug] [ThreadPool]: Using postgres connection "list_airflow_staging_dim"
[0m14:48:58.971788 [debug] [ThreadPool]: On list_airflow_staging_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_staging_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_dim'
  
[0m14:48:58.973122 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m14:48:58.973758 [debug] [ThreadPool]: On list_airflow_staging_dim: ROLLBACK
[0m14:48:58.974044 [debug] [ThreadPool]: On list_airflow_staging_dim: Close
[0m14:48:58.978857 [debug] [MainThread]: Using postgres connection "master"
[0m14:48:58.980313 [debug] [MainThread]: On master: BEGIN
[0m14:48:58.981086 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:48:58.985035 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m14:48:58.985440 [debug] [MainThread]: Using postgres connection "master"
[0m14:48:58.985745 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:48:58.991353 [debug] [MainThread]: SQL status: SELECT 1 in 0.005 seconds
[0m14:48:58.992079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '68d01f77-bf1a-486c-bbf9-3e19858958f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad94dcd0>]}
[0m14:48:58.992352 [debug] [MainThread]: On master: ROLLBACK
[0m14:48:58.992591 [debug] [MainThread]: Using postgres connection "master"
[0m14:48:58.992732 [debug] [MainThread]: On master: BEGIN
[0m14:48:58.992999 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:48:58.993257 [debug] [MainThread]: On master: COMMIT
[0m14:48:58.993407 [debug] [MainThread]: Using postgres connection "master"
[0m14:48:58.993564 [debug] [MainThread]: On master: COMMIT
[0m14:48:58.993806 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:48:58.993980 [debug] [MainThread]: On master: Close
[0m14:48:58.995444 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.dim_stations
[0m14:48:58.995781 [info ] [Thread-1 (]: 1 of 1 START sql view model staging_dim.dim_stations ........................... [RUN]
[0m14:48:58.996092 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_staging_dim, now model.etl_waterlevel.dim_stations)
[0m14:48:58.996391 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.dim_stations
[0m14:48:59.000077 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.dim_stations"
[0m14:48:59.001302 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.dim_stations
[0m14:48:59.019877 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.dim_stations"
[0m14:48:59.020911 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m14:48:59.021187 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: BEGIN
[0m14:48:59.021434 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:48:59.023517 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m14:48:59.023805 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m14:48:59.024058 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.dim_stations"} */

  create view "airflow"."staging_dim"."dim_stations__dbt_tmp"
    
    
  as (
    -- models/dimensions/dim_station.sql

with station_names as (
  select distinct
    "stationId"     as station_id,
    "stationName"   as station_name,
    "stationCode"   as station_code,
    "stationStatus" as station_status
  from raw.waterlevels
)

select * from station_names
  );
[0m14:48:59.025738 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m14:48:59.028585 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m14:48:59.028789 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.dim_stations"} */
alter table "airflow"."staging_dim"."dim_stations" rename to "dim_stations__dbt_backup"
[0m14:48:59.029098 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:48:59.030360 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m14:48:59.030539 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.dim_stations"} */
alter table "airflow"."staging_dim"."dim_stations__dbt_tmp" rename to "dim_stations"
[0m14:48:59.030825 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:48:59.038214 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: COMMIT
[0m14:48:59.038470 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m14:48:59.038686 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: COMMIT
[0m14:48:59.039470 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m14:48:59.042143 [debug] [Thread-1 (]: Applying DROP to: "airflow"."staging_dim"."dim_stations__dbt_backup"
[0m14:48:59.044155 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m14:48:59.044351 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.dim_stations"} */
drop view if exists "airflow"."staging_dim"."dim_stations__dbt_backup" cascade
[0m14:48:59.046413 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m14:48:59.047481 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: Close
[0m14:48:59.048280 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '68d01f77-bf1a-486c-bbf9-3e19858958f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac93ad10>]}
[0m14:48:59.048633 [info ] [Thread-1 (]: 1 of 1 OK created sql view model staging_dim.dim_stations ...................... [[32mCREATE VIEW[0m in 0.05s]
[0m14:48:59.048940 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.dim_stations
[0m14:48:59.049736 [debug] [MainThread]: Using postgres connection "master"
[0m14:48:59.049934 [debug] [MainThread]: On master: BEGIN
[0m14:48:59.050088 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:48:59.051495 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m14:48:59.051718 [debug] [MainThread]: On master: COMMIT
[0m14:48:59.051913 [debug] [MainThread]: Using postgres connection "master"
[0m14:48:59.052081 [debug] [MainThread]: On master: COMMIT
[0m14:48:59.052270 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:48:59.052424 [debug] [MainThread]: On master: Close
[0m14:48:59.052627 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:48:59.052769 [debug] [MainThread]: Connection 'model.etl_waterlevel.dim_stations' was properly closed.
[0m14:48:59.052946 [info ] [MainThread]: 
[0m14:48:59.053116 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.11 seconds (0.11s).
[0m14:48:59.053546 [debug] [MainThread]: Command end result
[0m14:48:59.065723 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m14:48:59.066724 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m14:48:59.069693 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m14:48:59.069879 [info ] [MainThread]: 
[0m14:48:59.070143 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:48:59.070356 [info ] [MainThread]: 
[0m14:48:59.070614 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:48:59.071116 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.33937582, "process_in_blocks": "0", "process_kernel_time": 0.086126, "process_mem_max_rss": "113864", "process_out_blocks": "1653", "process_user_time": 0.827434}
[0m14:48:59.071350 [debug] [MainThread]: Command `dbt run` succeeded at 14:48:59.071297 after 0.34 seconds
[0m14:48:59.071547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae3bbd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae55dbd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae36f350>]}
[0m14:48:59.071721 [debug] [MainThread]: Flushing usage events
[0m14:49:00.336566 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:23:20.999666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051fee50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105272e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105273a10>]}


============================== 06:23:21.001885 | 90c4074c-b1b5-46d4-9b20-4c8cf68dc43d ==============================
[0m06:23:21.001885 [info ] [MainThread]: Running with dbt=1.9.3
[0m06:23:21.002211 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/aiman/DE_Projects/etl_waterlevel/transform/logs', 'version_check': 'True', 'profiles_dir': '/Users/aiman/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select dim_stations', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:23:21.003628 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'etl_waterlevel'
[0m06:23:21.004765 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.035954416, "process_in_blocks": "0", "process_kernel_time": 0.075048, "process_mem_max_rss": "103448576", "process_out_blocks": "0", "process_user_time": 0.54866}
[0m06:23:21.004978 [debug] [MainThread]: Command `dbt run` failed at 06:23:21.004931 after 0.04 seconds
[0m06:23:21.005153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10524bb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1002affd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100350a50>]}
[0m06:23:21.005321 [debug] [MainThread]: Flushing usage events
[0m06:23:22.313244 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:30:53.866169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84743a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84743690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84743a50>]}


============================== 22:30:53.867649 | 45ff69ca-0996-45d4-b9c4-ecbf1177db01 ==============================
[0m22:30:53.867649 [info ] [MainThread]: Running with dbt=1.9.0
[0m22:30:53.867967 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:30:53.872354 [info ] [MainThread]: dbt version: 1.9.0
[0m22:30:53.872600 [info ] [MainThread]: python version: 3.11.11
[0m22:30:53.872896 [info ] [MainThread]: python path: /usr/local/bin/python3.11
[0m22:30:53.873129 [info ] [MainThread]: os info: Linux-6.10.14-linuxkit-aarch64-with-glibc2.36
[0m22:30:53.914504 [info ] [MainThread]: Using profiles dir at /root/.dbt
[0m22:30:53.914884 [info ] [MainThread]: Using profiles.yml file at /root/.dbt/profiles.yml
[0m22:30:53.915095 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt_project.yml
[0m22:30:53.915445 [info ] [MainThread]: adapter type: postgres
[0m22:30:53.915667 [info ] [MainThread]: adapter version: 1.9.0
[0m22:30:53.952538 [info ] [MainThread]: Configuration:
[0m22:30:53.952790 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m22:30:53.953066 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m22:30:53.953317 [info ] [MainThread]: Required dependencies:
[0m22:30:53.953549 [debug] [MainThread]: Executing "git --help"
[0m22:30:53.954112 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m22:30:53.954379 [info ] [MainThread]: Connection:
[0m22:30:53.954608 [info ] [MainThread]:   host: postgres
[0m22:30:53.954834 [info ] [MainThread]:   port: 5432
[0m22:30:53.955131 [info ] [MainThread]:   user: airflow
[0m22:30:53.955338 [info ] [MainThread]:   database: airflow
[0m22:30:53.955554 [info ] [MainThread]:   schema: staging
[0m22:30:53.955785 [info ] [MainThread]:   connect_timeout: 10
[0m22:30:53.956007 [info ] [MainThread]:   role: None
[0m22:30:53.956215 [info ] [MainThread]:   search_path: None
[0m22:30:53.956398 [info ] [MainThread]:   keepalives_idle: 0
[0m22:30:53.956598 [info ] [MainThread]:   sslmode: None
[0m22:30:53.956812 [info ] [MainThread]:   sslcert: None
[0m22:30:53.957026 [info ] [MainThread]:   sslkey: None
[0m22:30:53.957249 [info ] [MainThread]:   sslrootcert: None
[0m22:30:53.957460 [info ] [MainThread]:   application_name: dbt
[0m22:30:53.957677 [info ] [MainThread]:   retries: 1
[0m22:30:53.957987 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:30:53.990390 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m22:30:54.007097 [debug] [MainThread]: Using postgres connection "debug"
[0m22:30:54.007282 [debug] [MainThread]: On debug: select 1 as id
[0m22:30:54.007422 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:30:54.014302 [debug] [MainThread]: SQL status: SELECT 1 in 0.007 seconds
[0m22:30:54.014746 [debug] [MainThread]: On debug: Close
[0m22:30:54.014945 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m22:30:54.015289 [info ] [MainThread]: [31m1 check failed:[0m
[0m22:30:54.015510 [info ] [MainThread]: Error from git --help: Could not find command, ensure it is in the user's PATH: "git"

[0m22:30:54.016066 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.17228626, "process_in_blocks": "18696", "process_kernel_time": 0.084807, "process_mem_max_rss": "107840", "process_out_blocks": "40", "process_user_time": 0.634558}
[0m22:30:54.016298 [debug] [MainThread]: Command `dbt debug` failed at 22:30:54.016248 after 0.17 seconds
[0m22:30:54.016482 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m22:30:54.016648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84597e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83a3f310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff845977d0>]}
[0m22:30:54.016836 [debug] [MainThread]: Flushing usage events
[0m22:30:55.329323 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:30:59.873058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86b46e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86b45c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86b45550>]}


============================== 22:30:59.874465 | 6c2cf33a-9631-413e-8695-6f1c66adc1b2 ==============================
[0m22:30:59.874465 [info ] [MainThread]: Running with dbt=1.9.0
[0m22:30:59.874828 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:30:59.934213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6c2cf33a-9631-413e-8695-6f1c66adc1b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85f9e390>]}
[0m22:30:59.956022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6c2cf33a-9631-413e-8695-6f1c66adc1b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff895b09d0>]}
[0m22:30:59.956392 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:30:59.982727 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m22:31:00.025820 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:31:00.026018 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:31:00.028208 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.etl_waterlevel.example
- models.etl_waterlevel.staging
[0m22:31:00.036993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6c2cf33a-9631-413e-8695-6f1c66adc1b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85e178d0>]}
[0m22:31:00.062450 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m22:31:00.064340 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m22:31:00.075919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6c2cf33a-9631-413e-8695-6f1c66adc1b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85c9f510>]}
[0m22:31:00.076168 [info ] [MainThread]: Found 1 model, 433 macros
[0m22:31:00.076422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6c2cf33a-9631-413e-8695-6f1c66adc1b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85cf9b90>]}
[0m22:31:00.077191 [info ] [MainThread]: 
[0m22:31:00.077420 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:31:00.077635 [info ] [MainThread]: 
[0m22:31:00.077970 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:31:00.078478 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m22:31:00.093007 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m22:31:00.093229 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m22:31:00.093437 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:31:00.095786 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.002 seconds
[0m22:31:00.096374 [debug] [ThreadPool]: On list_airflow: Close
[0m22:31:00.097020 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_staging_dim)
[0m22:31:00.099850 [debug] [ThreadPool]: Using postgres connection "list_airflow_staging_dim"
[0m22:31:00.100086 [debug] [ThreadPool]: On list_airflow_staging_dim: BEGIN
[0m22:31:00.100308 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:31:00.101833 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m22:31:00.102147 [debug] [ThreadPool]: Using postgres connection "list_airflow_staging_dim"
[0m22:31:00.102344 [debug] [ThreadPool]: On list_airflow_staging_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_staging_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_dim'
  
[0m22:31:00.104114 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m22:31:00.104704 [debug] [ThreadPool]: On list_airflow_staging_dim: ROLLBACK
[0m22:31:00.104975 [debug] [ThreadPool]: On list_airflow_staging_dim: Close
[0m22:31:00.106996 [debug] [MainThread]: Using postgres connection "master"
[0m22:31:00.107159 [debug] [MainThread]: On master: BEGIN
[0m22:31:00.107291 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:31:00.108499 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m22:31:00.108696 [debug] [MainThread]: Using postgres connection "master"
[0m22:31:00.108909 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:31:00.113657 [debug] [MainThread]: SQL status: SELECT 1 in 0.004 seconds
[0m22:31:00.114188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6c2cf33a-9631-413e-8695-6f1c66adc1b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85b53010>]}
[0m22:31:00.114407 [debug] [MainThread]: On master: ROLLBACK
[0m22:31:00.114623 [debug] [MainThread]: Using postgres connection "master"
[0m22:31:00.114791 [debug] [MainThread]: On master: BEGIN
[0m22:31:00.115039 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m22:31:00.115230 [debug] [MainThread]: On master: COMMIT
[0m22:31:00.115375 [debug] [MainThread]: Using postgres connection "master"
[0m22:31:00.115501 [debug] [MainThread]: On master: COMMIT
[0m22:31:00.115679 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:31:00.115809 [debug] [MainThread]: On master: Close
[0m22:31:00.116748 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.dim_stations
[0m22:31:00.117043 [info ] [Thread-1 (]: 1 of 1 START sql view model staging_dim.dim_stations ........................... [RUN]
[0m22:31:00.117323 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_staging_dim, now model.etl_waterlevel.dim_stations)
[0m22:31:00.117529 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.dim_stations
[0m22:31:00.120491 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.dim_stations"
[0m22:31:00.121699 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.dim_stations
[0m22:31:00.137562 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.dim_stations"
[0m22:31:00.138515 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m22:31:00.138722 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: BEGIN
[0m22:31:00.138922 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:31:00.140528 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m22:31:00.140762 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m22:31:00.141021 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.dim_stations"} */

  create view "airflow"."staging_dim"."dim_stations__dbt_tmp"
    
    
  as (
    -- models/dimensions/dim_station.sql

with station_names as (
  select distinct
    "stationId"     as station_id,
    "stationName"   as station_name,
    "stationCode"   as station_code,
    "stationStatus" as station_status
  from raw.waterlevels
)

select * from station_names
  );
[0m22:31:00.146425 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m22:31:00.149067 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m22:31:00.149248 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.dim_stations"} */
alter table "airflow"."staging_dim"."dim_stations" rename to "dim_stations__dbt_backup"
[0m22:31:00.149945 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:31:00.151348 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m22:31:00.151536 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.dim_stations"} */
alter table "airflow"."staging_dim"."dim_stations__dbt_tmp" rename to "dim_stations"
[0m22:31:00.151822 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:31:00.158623 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: COMMIT
[0m22:31:00.158817 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m22:31:00.158974 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: COMMIT
[0m22:31:00.159392 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m22:31:00.161977 [debug] [Thread-1 (]: Applying DROP to: "airflow"."staging_dim"."dim_stations__dbt_backup"
[0m22:31:00.163937 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m22:31:00.164125 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.dim_stations"} */
drop view if exists "airflow"."staging_dim"."dim_stations__dbt_backup" cascade
[0m22:31:00.165160 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m22:31:00.166175 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: Close
[0m22:31:00.167153 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c2cf33a-9631-413e-8695-6f1c66adc1b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84fd0e10>]}
[0m22:31:00.167470 [info ] [Thread-1 (]: 1 of 1 OK created sql view model staging_dim.dim_stations ...................... [[32mCREATE VIEW[0m in 0.05s]
[0m22:31:00.167790 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.dim_stations
[0m22:31:00.168476 [debug] [MainThread]: Using postgres connection "master"
[0m22:31:00.168664 [debug] [MainThread]: On master: BEGIN
[0m22:31:00.168808 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:31:00.170082 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m22:31:00.170262 [debug] [MainThread]: On master: COMMIT
[0m22:31:00.170419 [debug] [MainThread]: Using postgres connection "master"
[0m22:31:00.170596 [debug] [MainThread]: On master: COMMIT
[0m22:31:00.170797 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:31:00.170956 [debug] [MainThread]: On master: Close
[0m22:31:00.171143 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:31:00.171281 [debug] [MainThread]: Connection 'model.etl_waterlevel.dim_stations' was properly closed.
[0m22:31:00.171426 [info ] [MainThread]: 
[0m22:31:00.171630 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.09 seconds (0.09s).
[0m22:31:00.172097 [debug] [MainThread]: Command end result
[0m22:31:00.183435 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m22:31:00.184417 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m22:31:00.187017 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m22:31:00.187242 [info ] [MainThread]: 
[0m22:31:00.187620 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:31:00.187801 [info ] [MainThread]: 
[0m22:31:00.188062 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m22:31:00.188590 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.33637932, "process_in_blocks": "1872", "process_kernel_time": 0.068434, "process_mem_max_rss": "114268", "process_out_blocks": "1773", "process_user_time": 0.794432}
[0m22:31:00.188815 [debug] [MainThread]: Command `dbt run` succeeded at 22:31:00.188775 after 0.34 seconds
[0m22:31:00.189003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b454fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b4546d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b455150>]}
[0m22:31:00.189187 [debug] [MainThread]: Flushing usage events
[0m22:31:01.474733 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:41:01.021823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6b374d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6c6c7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6b34450>]}


============================== 22:41:01.023210 | 6211dc19-c674-4650-8881-e56d515a84fb ==============================
[0m22:41:01.023210 [info ] [MainThread]: Running with dbt=1.9.0
[0m22:41:01.023630 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m22:41:01.064741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6211dc19-c674-4650-8881-e56d515a84fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6a56ad0>]}
[0m22:41:01.074223 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.073484, "process_in_blocks": "16", "process_kernel_time": 0.056086, "process_mem_max_rss": "96184", "process_out_blocks": "3", "process_user_time": 0.572887}
[0m22:41:01.074471 [debug] [MainThread]: Command `dbt clean` succeeded at 22:41:01.074428 after 0.07 seconds
[0m22:41:01.074700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbb474fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbb474710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7637610>]}
[0m22:41:01.074987 [debug] [MainThread]: Flushing usage events
[0m22:41:02.561371 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:41:14.310628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96a3fa50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96c56210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96a3e710>]}


============================== 22:41:14.312023 | a915036d-1321-4837-a730-489690dc59aa ==============================
[0m22:41:14.312023 [info ] [MainThread]: Running with dbt=1.9.0
[0m22:41:14.312476 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select dim_stations', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:41:14.371375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a915036d-1321-4837-a730-489690dc59aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff968b7d90>]}
[0m22:41:14.393052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a915036d-1321-4837-a730-489690dc59aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff994c9f10>]}
[0m22:41:14.393434 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:41:14.417739 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m22:41:14.418307 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:41:14.418598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a915036d-1321-4837-a730-489690dc59aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff968d77d0>]}
[0m22:41:14.760517 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m22:41:14.762776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a915036d-1321-4837-a730-489690dc59aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95c6b9d0>]}
[0m22:41:14.812717 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m22:41:14.814369 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m22:41:14.820131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a915036d-1321-4837-a730-489690dc59aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95af02d0>]}
[0m22:41:14.820408 [info ] [MainThread]: Found 1 model, 433 macros
[0m22:41:14.820661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a915036d-1321-4837-a730-489690dc59aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95aad550>]}
[0m22:41:14.821342 [info ] [MainThread]: 
[0m22:41:14.821651 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:41:14.821916 [info ] [MainThread]: 
[0m22:41:14.822316 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:41:14.822890 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m22:41:14.836692 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m22:41:14.836924 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m22:41:14.837122 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:41:14.839737 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.003 seconds
[0m22:41:14.840332 [debug] [ThreadPool]: On list_airflow: Close
[0m22:41:14.840950 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_staging_dim)
[0m22:41:14.843656 [debug] [ThreadPool]: Using postgres connection "list_airflow_staging_dim"
[0m22:41:14.843857 [debug] [ThreadPool]: On list_airflow_staging_dim: BEGIN
[0m22:41:14.844043 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:41:14.845478 [debug] [ThreadPool]: SQL status: BEGIN in 0.001 seconds
[0m22:41:14.845739 [debug] [ThreadPool]: Using postgres connection "list_airflow_staging_dim"
[0m22:41:14.845956 [debug] [ThreadPool]: On list_airflow_staging_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_staging_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_dim'
  
[0m22:41:14.847195 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m22:41:14.847797 [debug] [ThreadPool]: On list_airflow_staging_dim: ROLLBACK
[0m22:41:14.848074 [debug] [ThreadPool]: On list_airflow_staging_dim: Close
[0m22:41:14.850026 [debug] [MainThread]: Using postgres connection "master"
[0m22:41:14.850224 [debug] [MainThread]: On master: BEGIN
[0m22:41:14.850416 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:41:14.851769 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m22:41:14.852011 [debug] [MainThread]: Using postgres connection "master"
[0m22:41:14.852238 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:41:14.855080 [debug] [MainThread]: SQL status: SELECT 1 in 0.002 seconds
[0m22:41:14.855630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a915036d-1321-4837-a730-489690dc59aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95af21d0>]}
[0m22:41:14.855880 [debug] [MainThread]: On master: ROLLBACK
[0m22:41:14.856147 [debug] [MainThread]: Using postgres connection "master"
[0m22:41:14.856330 [debug] [MainThread]: On master: BEGIN
[0m22:41:14.856649 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m22:41:14.856856 [debug] [MainThread]: On master: COMMIT
[0m22:41:14.857029 [debug] [MainThread]: Using postgres connection "master"
[0m22:41:14.857194 [debug] [MainThread]: On master: COMMIT
[0m22:41:14.857448 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:41:14.857625 [debug] [MainThread]: On master: Close
[0m22:41:14.858867 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.dim_stations
[0m22:41:14.859168 [info ] [Thread-1 (]: 1 of 1 START sql view model staging_dim.dim_stations ........................... [RUN]
[0m22:41:14.859485 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_staging_dim, now model.etl_waterlevel.dim_stations)
[0m22:41:14.859724 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.dim_stations
[0m22:41:14.862663 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.dim_stations"
[0m22:41:14.864100 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.dim_stations
[0m22:41:14.880359 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.dim_stations"
[0m22:41:14.881767 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m22:41:14.881968 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: BEGIN
[0m22:41:14.882165 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:41:14.883610 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m22:41:14.883833 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m22:41:14.884023 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.dim_stations"} */

  create view "airflow"."staging_dim"."dim_stations__dbt_tmp"
    
    
  as (
    -- models/dimensions/dim_station.sql

with station_names as (
  select distinct
    "stationId"     as station_id,
    "stationName"   as station_name,
    "stationCode"   as station_code,
    "stationStatus" as station_status
  from raw.waterlevels
)

select * from station_names
  );
[0m22:41:14.884977 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m22:41:14.887607 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m22:41:14.887790 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.dim_stations"} */
alter table "airflow"."staging_dim"."dim_stations" rename to "dim_stations__dbt_backup"
[0m22:41:14.888091 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:41:14.889380 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m22:41:14.889571 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.dim_stations"} */
alter table "airflow"."staging_dim"."dim_stations__dbt_tmp" rename to "dim_stations"
[0m22:41:14.889866 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:41:14.896966 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: COMMIT
[0m22:41:14.897187 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m22:41:14.897396 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: COMMIT
[0m22:41:14.898077 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m22:41:14.901275 [debug] [Thread-1 (]: Applying DROP to: "airflow"."staging_dim"."dim_stations__dbt_backup"
[0m22:41:14.903285 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m22:41:14.903484 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.dim_stations"} */
drop view if exists "airflow"."staging_dim"."dim_stations__dbt_backup" cascade
[0m22:41:14.904102 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m22:41:14.905162 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: Close
[0m22:41:14.905936 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a915036d-1321-4837-a730-489690dc59aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff951e3910>]}
[0m22:41:14.906267 [info ] [Thread-1 (]: 1 of 1 OK created sql view model staging_dim.dim_stations ...................... [[32mCREATE VIEW[0m in 0.05s]
[0m22:41:14.906590 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.dim_stations
[0m22:41:14.907321 [debug] [MainThread]: Using postgres connection "master"
[0m22:41:14.907491 [debug] [MainThread]: On master: BEGIN
[0m22:41:14.907641 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:41:14.908931 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m22:41:14.909121 [debug] [MainThread]: On master: COMMIT
[0m22:41:14.909286 [debug] [MainThread]: Using postgres connection "master"
[0m22:41:14.909435 [debug] [MainThread]: On master: COMMIT
[0m22:41:14.909641 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:41:14.909778 [debug] [MainThread]: On master: Close
[0m22:41:14.909962 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:41:14.910098 [debug] [MainThread]: Connection 'model.etl_waterlevel.dim_stations' was properly closed.
[0m22:41:14.910242 [info ] [MainThread]: 
[0m22:41:14.910417 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.09 seconds (0.09s).
[0m22:41:14.910773 [debug] [MainThread]: Command end result
[0m22:41:14.922340 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m22:41:14.923299 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m22:41:14.926308 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m22:41:14.926467 [info ] [MainThread]: 
[0m22:41:14.926671 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:41:14.926876 [info ] [MainThread]: 
[0m22:41:14.927106 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m22:41:14.927605 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.6395088, "process_in_blocks": "136", "process_kernel_time": 0.084688, "process_mem_max_rss": "115620", "process_out_blocks": "2469", "process_user_time": 1.078029}
[0m22:41:14.927851 [debug] [MainThread]: Command `dbt run` succeeded at 22:41:14.927810 after 0.64 seconds
[0m22:41:14.928035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b4d56d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9753b950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b3a5190>]}
[0m22:41:14.928211 [debug] [MainThread]: Flushing usage events
[0m22:41:16.078113 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:43:37.436825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8153ac10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81670890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff815383d0>]}


============================== 22:43:37.438208 | 6a2c9d1b-1c17-4329-9ca8-2969d4f5dcf5 ==============================
[0m22:43:37.438208 [info ] [MainThread]: Running with dbt=1.9.0
[0m22:43:37.438636 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:43:37.479558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6a2c9d1b-1c17-4329-9ca8-2969d4f5dcf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81423150>]}
[0m22:43:37.488617 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.07358146, "process_in_blocks": "0", "process_kernel_time": 0.056958, "process_mem_max_rss": "96160", "process_out_blocks": "3", "process_user_time": 0.587569}
[0m22:43:37.488880 [debug] [MainThread]: Command `dbt clean` succeeded at 22:43:37.488824 after 0.07 seconds
[0m22:43:37.489114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81544150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81390ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff813929d0>]}
[0m22:43:37.489336 [debug] [MainThread]: Flushing usage events
[0m22:43:38.720328 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:43:47.359511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99707a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff999cffd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99707690>]}


============================== 22:43:47.360916 | 6534e782-e85b-4678-b30e-63c69fb70136 ==============================
[0m22:43:47.360916 [info ] [MainThread]: Running with dbt=1.9.0
[0m22:43:47.361382 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select dim_stations', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:43:47.421035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6534e782-e85b-4678-b30e-63c69fb70136', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9955a190>]}
[0m22:43:47.442795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6534e782-e85b-4678-b30e-63c69fb70136', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c148110>]}
[0m22:43:47.443175 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:43:47.471187 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m22:43:47.471890 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:43:47.472195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6534e782-e85b-4678-b30e-63c69fb70136', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff988675d0>]}
[0m22:43:47.814713 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m22:43:47.817014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6534e782-e85b-4678-b30e-63c69fb70136', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98b3d190>]}
[0m22:43:47.867226 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m22:43:47.868724 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m22:43:47.879325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6534e782-e85b-4678-b30e-63c69fb70136', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98939cd0>]}
[0m22:43:47.879585 [info ] [MainThread]: Found 1 model, 433 macros
[0m22:43:47.879796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6534e782-e85b-4678-b30e-63c69fb70136', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9890a650>]}
[0m22:43:47.880523 [info ] [MainThread]: 
[0m22:43:47.880802 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:43:47.881081 [info ] [MainThread]: 
[0m22:43:47.881534 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:43:47.882010 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m22:43:47.896550 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m22:43:47.896772 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m22:43:47.896954 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:43:47.899312 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.002 seconds
[0m22:43:47.899876 [debug] [ThreadPool]: On list_airflow: Close
[0m22:43:47.900485 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_staging_dim)
[0m22:43:47.903006 [debug] [ThreadPool]: Using postgres connection "list_airflow_staging_dim"
[0m22:43:47.903215 [debug] [ThreadPool]: On list_airflow_staging_dim: BEGIN
[0m22:43:47.903452 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:43:47.904952 [debug] [ThreadPool]: SQL status: BEGIN in 0.001 seconds
[0m22:43:47.905179 [debug] [ThreadPool]: Using postgres connection "list_airflow_staging_dim"
[0m22:43:47.905370 [debug] [ThreadPool]: On list_airflow_staging_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_staging_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_dim'
  
[0m22:43:47.906603 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m22:43:47.907198 [debug] [ThreadPool]: On list_airflow_staging_dim: ROLLBACK
[0m22:43:47.907467 [debug] [ThreadPool]: On list_airflow_staging_dim: Close
[0m22:43:47.909416 [debug] [MainThread]: Using postgres connection "master"
[0m22:43:47.909611 [debug] [MainThread]: On master: BEGIN
[0m22:43:47.909788 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:43:47.911169 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m22:43:47.911342 [debug] [MainThread]: Using postgres connection "master"
[0m22:43:47.911565 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:43:47.914300 [debug] [MainThread]: SQL status: SELECT 1 in 0.002 seconds
[0m22:43:47.914897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6534e782-e85b-4678-b30e-63c69fb70136', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9894b4d0>]}
[0m22:43:47.915154 [debug] [MainThread]: On master: ROLLBACK
[0m22:43:47.915416 [debug] [MainThread]: Using postgres connection "master"
[0m22:43:47.915590 [debug] [MainThread]: On master: BEGIN
[0m22:43:47.915920 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m22:43:47.916176 [debug] [MainThread]: On master: COMMIT
[0m22:43:47.916348 [debug] [MainThread]: Using postgres connection "master"
[0m22:43:47.916523 [debug] [MainThread]: On master: COMMIT
[0m22:43:47.916772 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:43:47.916954 [debug] [MainThread]: On master: Close
[0m22:43:47.918167 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.dim_stations
[0m22:43:47.918468 [info ] [Thread-1 (]: 1 of 1 START sql view model staging_dim.dim_stations ........................... [RUN]
[0m22:43:47.918767 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_staging_dim, now model.etl_waterlevel.dim_stations)
[0m22:43:47.919016 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.dim_stations
[0m22:43:47.921943 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.dim_stations"
[0m22:43:47.923389 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.dim_stations
[0m22:43:47.939284 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.dim_stations"
[0m22:43:47.940670 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m22:43:47.940877 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: BEGIN
[0m22:43:47.941055 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:43:47.942477 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m22:43:47.942705 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m22:43:47.942895 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.dim_stations"} */

  create view "airflow"."staging_dim"."dim_stations__dbt_tmp"
    
    
  as (
    -- models/dimensions/dim_station.sql

with station_names as (
  select distinct
    "stationId"     as station_id,
    "stationName"   as station_name,
    "stationCode"   as station_code,
    "stationStatus" as station_status
  from raw.waterlevels
)

select * from station_names
  );
[0m22:43:47.943949 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m22:43:47.946582 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m22:43:47.946792 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.dim_stations"} */
alter table "airflow"."staging_dim"."dim_stations" rename to "dim_stations__dbt_backup"
[0m22:43:47.947113 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:43:47.948348 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m22:43:47.948519 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.dim_stations"} */
alter table "airflow"."staging_dim"."dim_stations__dbt_tmp" rename to "dim_stations"
[0m22:43:47.948774 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:43:47.955848 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: COMMIT
[0m22:43:47.956056 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m22:43:47.956230 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: COMMIT
[0m22:43:47.956653 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m22:43:47.959815 [debug] [Thread-1 (]: Applying DROP to: "airflow"."staging_dim"."dim_stations__dbt_backup"
[0m22:43:47.961820 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m22:43:47.962013 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.dim_stations"} */
drop view if exists "airflow"."staging_dim"."dim_stations__dbt_backup" cascade
[0m22:43:47.962573 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m22:43:47.963594 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: Close
[0m22:43:47.964345 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6534e782-e85b-4678-b30e-63c69fb70136', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97b84650>]}
[0m22:43:47.964663 [info ] [Thread-1 (]: 1 of 1 OK created sql view model staging_dim.dim_stations ...................... [[32mCREATE VIEW[0m in 0.05s]
[0m22:43:47.964967 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.dim_stations
[0m22:43:47.965659 [debug] [MainThread]: Using postgres connection "master"
[0m22:43:47.965822 [debug] [MainThread]: On master: BEGIN
[0m22:43:47.965948 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:43:47.967150 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m22:43:47.967344 [debug] [MainThread]: On master: COMMIT
[0m22:43:47.967504 [debug] [MainThread]: Using postgres connection "master"
[0m22:43:47.967650 [debug] [MainThread]: On master: COMMIT
[0m22:43:47.967836 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:43:47.967970 [debug] [MainThread]: On master: Close
[0m22:43:47.968159 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:43:47.968296 [debug] [MainThread]: Connection 'model.etl_waterlevel.dim_stations' was properly closed.
[0m22:43:47.968452 [info ] [MainThread]: 
[0m22:43:47.968637 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.09 seconds (0.09s).
[0m22:43:47.969042 [debug] [MainThread]: Command end result
[0m22:43:47.980187 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m22:43:47.981116 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m22:43:47.983890 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m22:43:47.984064 [info ] [MainThread]: 
[0m22:43:47.984273 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:43:47.984514 [info ] [MainThread]: 
[0m22:43:47.984769 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m22:43:47.985268 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.646948, "process_in_blocks": "0", "process_kernel_time": 0.069193, "process_mem_max_rss": "115644", "process_out_blocks": "2621", "process_user_time": 1.113114}
[0m22:43:47.985493 [debug] [MainThread]: Command `dbt run` succeeded at 22:43:47.985451 after 0.65 seconds
[0m22:43:47.985695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99558450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff995581d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9955b450>]}
[0m22:43:47.985875 [debug] [MainThread]: Flushing usage events
[0m22:43:49.031766 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:52:09.595507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d913590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9dc13650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d92e510>]}


============================== 22:52:09.597022 | 3036afe7-1b76-42f0-b1e2-d6897d66de0b ==============================
[0m22:52:09.597022 [info ] [MainThread]: Running with dbt=1.9.0
[0m22:52:09.597403 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt ls --select dim_stations --output path', 'send_anonymous_usage_stats': 'True'}
[0m22:52:09.657276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3036afe7-1b76-42f0-b1e2-d6897d66de0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ccb7fd0>]}
[0m22:52:09.679088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3036afe7-1b76-42f0-b1e2-d6897d66de0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0346e10>]}
[0m22:52:09.679483 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:52:09.704222 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m22:52:09.740487 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:52:09.740716 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:52:09.742853 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m22:52:09.751688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3036afe7-1b76-42f0-b1e2-d6897d66de0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cb440d0>]}
[0m22:52:09.779551 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m22:52:09.781072 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m22:52:09.786331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3036afe7-1b76-42f0-b1e2-d6897d66de0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ca4b090>]}
[0m22:52:09.786584 [info ] [MainThread]: Found 1 model, 433 macros
[0m22:52:09.786770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3036afe7-1b76-42f0-b1e2-d6897d66de0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ccf2c90>]}
[0m22:52:09.787085 [info ] [MainThread]: models/dimensions/dim_stations.sql
[0m22:52:09.787626 [debug] [MainThread]: Resource report: {"command_name": "list", "command_success": true, "command_wall_clock_time": 0.21491534, "process_in_blocks": "24", "process_kernel_time": 0.075991, "process_mem_max_rss": "105072", "process_out_blocks": "816", "process_user_time": 0.720923}
[0m22:52:09.787880 [debug] [MainThread]: Command `dbt ls` succeeded at 22:52:09.787835 after 0.22 seconds
[0m22:52:09.788068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cb2cdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cb2d690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2209390>]}
[0m22:52:09.788265 [debug] [MainThread]: Flushing usage events
[0m22:52:10.967347 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:53:03.230451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98707a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99203550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9891e510>]}


============================== 22:53:03.231834 | 4c00c970-7e25-4fba-83e9-70503f6c29f8 ==============================
[0m22:53:03.231834 [info ] [MainThread]: Running with dbt=1.9.0
[0m22:53:03.232257 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt ls --select dim_stations --output name', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:53:03.291322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4c00c970-7e25-4fba-83e9-70503f6c29f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97ad3810>]}
[0m22:53:03.313587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4c00c970-7e25-4fba-83e9-70503f6c29f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff979be750>]}
[0m22:53:03.314046 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:53:03.344211 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m22:53:03.381034 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:53:03.381313 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:53:03.383558 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m22:53:03.392301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4c00c970-7e25-4fba-83e9-70503f6c29f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff977bc1d0>]}
[0m22:53:03.419366 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m22:53:03.420806 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m22:53:03.425331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4c00c970-7e25-4fba-83e9-70503f6c29f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff979313d0>]}
[0m22:53:03.425576 [info ] [MainThread]: Found 1 model, 433 macros
[0m22:53:03.425775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4c00c970-7e25-4fba-83e9-70503f6c29f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff978ddf50>]}
[0m22:53:03.426136 [info ] [MainThread]: dim_stations
[0m22:53:03.426639 [debug] [MainThread]: Resource report: {"command_name": "list", "command_success": true, "command_wall_clock_time": 0.2172713, "process_in_blocks": "0", "process_kernel_time": 0.068839, "process_mem_max_rss": "105108", "process_out_blocks": "816", "process_user_time": 0.727303}
[0m22:53:03.426880 [debug] [MainThread]: Command `dbt ls` succeeded at 22:53:03.426842 after 0.22 seconds
[0m22:53:03.427052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98710150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98707b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98706ed0>]}
[0m22:53:03.427223 [debug] [MainThread]: Flushing usage events
[0m22:53:04.450302 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:53:25.700593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2a47090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2a47510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2a47390>]}


============================== 22:53:25.701977 | fc14aae6-2977-4992-a271-34ec7e878741 ==============================
[0m22:53:25.701977 [info ] [MainThread]: Running with dbt=1.9.0
[0m22:53:25.702422 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug --config-dir', 'send_anonymous_usage_stats': 'True'}
[0m22:53:25.706091 [info ] [MainThread]: To view your profiles.yml file, run:

xdg-open /root/.dbt
[0m22:53:25.706630 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.026874125, "process_in_blocks": "0", "process_kernel_time": 0.043035, "process_mem_max_rss": "94752", "process_out_blocks": "2", "process_user_time": 0.557453}
[0m22:53:25.706935 [debug] [MainThread]: Command `dbt debug` succeeded at 22:53:25.706886 after 0.03 seconds
[0m22:53:25.707164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7365410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb73652d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2a37610>]}
[0m22:53:25.707410 [debug] [MainThread]: Flushing usage events
[0m22:53:26.836493 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:53:39.719648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ab43310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ab5e510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a991ad0>]}


============================== 22:53:39.721043 | d7fd7903-5f0f-4678-9120-5372f7e2b255 ==============================
[0m22:53:39.721043 [info ] [MainThread]: Running with dbt=1.9.0
[0m22:53:39.721378 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ls --select dim_stations --output path', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:53:39.780596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd7fd7903-5f0f-4678-9120-5372f7e2b255', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a02e410>]}
[0m22:53:39.802260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd7fd7903-5f0f-4678-9120-5372f7e2b255', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d606d10>]}
[0m22:53:39.802643 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:53:39.826984 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m22:53:39.861613 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:53:39.861857 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:53:39.864043 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m22:53:39.872711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd7fd7903-5f0f-4678-9120-5372f7e2b255', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89df4110>]}
[0m22:53:39.899310 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m22:53:39.900696 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m22:53:39.904910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd7fd7903-5f0f-4678-9120-5372f7e2b255', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89c26fd0>]}
[0m22:53:39.905167 [info ] [MainThread]: Found 1 model, 433 macros
[0m22:53:39.905361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd7fd7903-5f0f-4678-9120-5372f7e2b255', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89c5bd10>]}
[0m22:53:39.905704 [info ] [MainThread]: models/dimensions/dim_stations.sql
[0m22:53:39.906192 [debug] [MainThread]: Resource report: {"command_name": "list", "command_success": true, "command_wall_clock_time": 0.20752046, "process_in_blocks": "0", "process_kernel_time": 0.067052, "process_mem_max_rss": "105084", "process_out_blocks": "816", "process_user_time": 0.701552}
[0m22:53:39.906394 [debug] [MainThread]: Command `dbt ls` succeeded at 22:53:39.906357 after 0.21 seconds
[0m22:53:39.906564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a9913d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ab4c050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a9b23d0>]}
[0m22:53:39.906732 [debug] [MainThread]: Flushing usage events
[0m22:53:41.264151 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:57:00.218734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5d3de50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5d3f7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5d3f250>]}


============================== 22:57:00.220092 | 1339361b-244d-4746-9451-af29e616d2e6 ==============================
[0m22:57:00.220092 [info ] [MainThread]: Running with dbt=1.9.0
[0m22:57:00.220537 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:57:00.261131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1339361b-244d-4746-9451-af29e616d2e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5c52950>]}
[0m22:57:00.269713 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.07173017, "process_in_blocks": "0", "process_kernel_time": 0.048022, "process_mem_max_rss": "96192", "process_out_blocks": "3", "process_user_time": 0.593275}
[0m22:57:00.269969 [debug] [MainThread]: Command `dbt clean` succeeded at 22:57:00.269909 after 0.07 seconds
[0m22:57:00.270208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5b920d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5b91f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5c2f7d0>]}
[0m22:57:00.270439 [debug] [MainThread]: Flushing usage events
[0m22:57:01.460846 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:57:09.516839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a112b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a12e510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89f5bd90>]}


============================== 22:57:09.518215 | 9ca1c92a-0999-453a-a081-bc2e69391b54 ==============================
[0m22:57:09.518215 [info ] [MainThread]: Running with dbt=1.9.0
[0m22:57:09.518604 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select dim_stations', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:57:09.578394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9ca1c92a-0999-453a-a081-bc2e69391b54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff894bfb10>]}
[0m22:57:09.600162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9ca1c92a-0999-453a-a081-bc2e69391b54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cb4dc90>]}
[0m22:57:09.600582 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:57:09.624816 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m22:57:09.625554 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:57:09.625824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9ca1c92a-0999-453a-a081-bc2e69391b54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8925ad10>]}
[0m22:57:09.967974 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m22:57:09.970384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9ca1c92a-0999-453a-a081-bc2e69391b54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ae565d0>]}
[0m22:57:10.022190 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m22:57:10.023860 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m22:57:10.029858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9ca1c92a-0999-453a-a081-bc2e69391b54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff891978d0>]}
[0m22:57:10.030151 [info ] [MainThread]: Found 1 model, 433 macros
[0m22:57:10.030413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9ca1c92a-0999-453a-a081-bc2e69391b54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8910b110>]}
[0m22:57:10.031113 [info ] [MainThread]: 
[0m22:57:10.031424 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:57:10.031687 [info ] [MainThread]: 
[0m22:57:10.032105 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:57:10.032610 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m22:57:10.047878 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m22:57:10.048202 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m22:57:10.048428 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:57:10.050924 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.002 seconds
[0m22:57:10.051530 [debug] [ThreadPool]: On list_airflow: Close
[0m22:57:10.052215 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_staging_dim)
[0m22:57:10.055010 [debug] [ThreadPool]: Using postgres connection "list_airflow_staging_dim"
[0m22:57:10.055230 [debug] [ThreadPool]: On list_airflow_staging_dim: BEGIN
[0m22:57:10.055418 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:57:10.056932 [debug] [ThreadPool]: SQL status: BEGIN in 0.001 seconds
[0m22:57:10.057189 [debug] [ThreadPool]: Using postgres connection "list_airflow_staging_dim"
[0m22:57:10.057387 [debug] [ThreadPool]: On list_airflow_staging_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_staging_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_dim'
  
[0m22:57:10.058738 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m22:57:10.059343 [debug] [ThreadPool]: On list_airflow_staging_dim: ROLLBACK
[0m22:57:10.059681 [debug] [ThreadPool]: On list_airflow_staging_dim: Close
[0m22:57:10.061760 [debug] [MainThread]: Using postgres connection "master"
[0m22:57:10.061996 [debug] [MainThread]: On master: BEGIN
[0m22:57:10.062188 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:57:10.063747 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m22:57:10.063981 [debug] [MainThread]: Using postgres connection "master"
[0m22:57:10.064213 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:57:10.067070 [debug] [MainThread]: SQL status: SELECT 1 in 0.003 seconds
[0m22:57:10.067622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9ca1c92a-0999-453a-a081-bc2e69391b54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a3b14d0>]}
[0m22:57:10.067875 [debug] [MainThread]: On master: ROLLBACK
[0m22:57:10.068163 [debug] [MainThread]: Using postgres connection "master"
[0m22:57:10.068346 [debug] [MainThread]: On master: BEGIN
[0m22:57:10.068671 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m22:57:10.068880 [debug] [MainThread]: On master: COMMIT
[0m22:57:10.069032 [debug] [MainThread]: Using postgres connection "master"
[0m22:57:10.069197 [debug] [MainThread]: On master: COMMIT
[0m22:57:10.069445 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:57:10.069634 [debug] [MainThread]: On master: Close
[0m22:57:10.070899 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.dim_stations
[0m22:57:10.071206 [info ] [Thread-1 (]: 1 of 1 START sql view model staging_dim.dim_stations ........................... [RUN]
[0m22:57:10.071488 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_staging_dim, now model.etl_waterlevel.dim_stations)
[0m22:57:10.071776 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.dim_stations
[0m22:57:10.074675 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.dim_stations"
[0m22:57:10.076165 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.dim_stations
[0m22:57:10.092253 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.dim_stations"
[0m22:57:10.093698 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m22:57:10.093913 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: BEGIN
[0m22:57:10.094143 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:57:10.095621 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m22:57:10.095839 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m22:57:10.096031 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.dim_stations"} */

  create view "airflow"."staging_dim"."dim_stations__dbt_tmp"
    
    
  as (
    -- models/dimensions/dim_stations.sql

with station_names as (
  select distinct
    "stationId"     as station_id,
    "stationName"   as station_name,
    "stationCode"   as station_code,
    "stationStatus" as station_status
  from raw.waterlevels
)

select * from station_names
  );
[0m22:57:10.097498 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m22:57:10.100082 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m22:57:10.100284 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.dim_stations"} */
alter table "airflow"."staging_dim"."dim_stations" rename to "dim_stations__dbt_backup"
[0m22:57:10.100569 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:57:10.101750 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m22:57:10.101918 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.dim_stations"} */
alter table "airflow"."staging_dim"."dim_stations__dbt_tmp" rename to "dim_stations"
[0m22:57:10.102182 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:57:10.109274 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: COMMIT
[0m22:57:10.109510 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m22:57:10.109715 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: COMMIT
[0m22:57:10.110328 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m22:57:10.113611 [debug] [Thread-1 (]: Applying DROP to: "airflow"."staging_dim"."dim_stations__dbt_backup"
[0m22:57:10.115632 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m22:57:10.115823 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.dim_stations"} */
drop view if exists "airflow"."staging_dim"."dim_stations__dbt_backup" cascade
[0m22:57:10.116642 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m22:57:10.117656 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: Close
[0m22:57:10.118410 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ca1c92a-0999-453a-a081-bc2e69391b54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8905aed0>]}
[0m22:57:10.118724 [info ] [Thread-1 (]: 1 of 1 OK created sql view model staging_dim.dim_stations ...................... [[32mCREATE VIEW[0m in 0.05s]
[0m22:57:10.119100 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.dim_stations
[0m22:57:10.119803 [debug] [MainThread]: Using postgres connection "master"
[0m22:57:10.119970 [debug] [MainThread]: On master: BEGIN
[0m22:57:10.120165 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:57:10.121471 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m22:57:10.121662 [debug] [MainThread]: On master: COMMIT
[0m22:57:10.121815 [debug] [MainThread]: Using postgres connection "master"
[0m22:57:10.121967 [debug] [MainThread]: On master: COMMIT
[0m22:57:10.122172 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:57:10.122306 [debug] [MainThread]: On master: Close
[0m22:57:10.122488 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:57:10.122623 [debug] [MainThread]: Connection 'model.etl_waterlevel.dim_stations' was properly closed.
[0m22:57:10.122764 [info ] [MainThread]: 
[0m22:57:10.122959 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.09 seconds (0.09s).
[0m22:57:10.123377 [debug] [MainThread]: Command end result
[0m22:57:10.135009 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m22:57:10.135937 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m22:57:10.138727 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m22:57:10.138887 [info ] [MainThread]: 
[0m22:57:10.139203 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:57:10.139381 [info ] [MainThread]: 
[0m22:57:10.139607 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m22:57:10.140091 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.6440561, "process_in_blocks": "0", "process_kernel_time": 0.070662, "process_mem_max_rss": "115648", "process_out_blocks": "2469", "process_user_time": 1.114673}
[0m22:57:10.140318 [debug] [MainThread]: Command `dbt run` succeeded at 22:57:10.140263 after 0.64 seconds
[0m22:57:10.140518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ac0f910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ea09250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ea09310>]}
[0m22:57:10.140692 [debug] [MainThread]: Flushing usage events
[0m22:57:11.393665 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:58:32.460573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7136c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa734e510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa71378d0>]}


============================== 22:58:32.462033 | 92e31f2f-69a5-42e6-913b-d84dc2b2b344 ==============================
[0m22:58:32.462033 [info ] [MainThread]: Running with dbt=1.9.0
[0m22:58:32.462503 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt ls --select dim_stations --output path', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:58:32.521841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '92e31f2f-69a5-42e6-913b-d84dc2b2b344', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa65c0110>]}
[0m22:58:32.543668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '92e31f2f-69a5-42e6-913b-d84dc2b2b344', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa63f9fd0>]}
[0m22:58:32.544040 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:58:32.568180 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m22:58:32.604219 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:58:32.604450 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:58:32.606643 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m22:58:32.615524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '92e31f2f-69a5-42e6-913b-d84dc2b2b344', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6fced10>]}
[0m22:58:32.642280 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m22:58:32.643650 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m22:58:32.647962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '92e31f2f-69a5-42e6-913b-d84dc2b2b344', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa62e0890>]}
[0m22:58:32.648199 [info ] [MainThread]: Found 1 model, 433 macros
[0m22:58:32.648379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '92e31f2f-69a5-42e6-913b-d84dc2b2b344', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa653de50>]}
[0m22:58:32.648788 [info ] [MainThread]: models/dimensions/dim_stations.sql
[0m22:58:32.649360 [debug] [MainThread]: Resource report: {"command_name": "list", "command_success": true, "command_wall_clock_time": 0.21016476, "process_in_blocks": "0", "process_kernel_time": 0.068031, "process_mem_max_rss": "105120", "process_out_blocks": "816", "process_user_time": 0.68131}
[0m22:58:32.649614 [debug] [MainThread]: Command `dbt ls` succeeded at 22:58:32.649574 after 0.21 seconds
[0m22:58:32.649811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaba952d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaba95810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa62e2650>]}
[0m22:58:32.650005 [debug] [MainThread]: Flushing usage events
[0m22:58:33.925762 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:59:25.799596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c83dcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c6927d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c690c90>]}


============================== 22:59:25.801037 | 1af78d8f-15ae-4609-9003-08dc34d0c12b ==============================
[0m22:59:25.801037 [info ] [MainThread]: Running with dbt=1.9.0
[0m22:59:25.801469 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --select dim_stations', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:59:25.861543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1af78d8f-15ae-4609-9003-08dc34d0c12b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bc9eed0>]}
[0m22:59:25.883496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1af78d8f-15ae-4609-9003-08dc34d0c12b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f2c9a90>]}
[0m22:59:25.883872 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:59:25.908597 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m22:59:25.944885 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:59:25.945123 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:59:25.947319 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m22:59:25.955979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1af78d8f-15ae-4609-9003-08dc34d0c12b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d5d7950>]}
[0m22:59:25.982621 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m22:59:25.984189 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m22:59:25.991077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1af78d8f-15ae-4609-9003-08dc34d0c12b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ba9a390>]}
[0m22:59:25.991401 [info ] [MainThread]: Found 1 model, 433 macros
[0m22:59:25.991691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1af78d8f-15ae-4609-9003-08dc34d0c12b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c82fd90>]}
[0m22:59:25.992388 [info ] [MainThread]: 
[0m22:59:25.992634 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:59:25.992887 [info ] [MainThread]: 
[0m22:59:25.993238 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:59:25.993840 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m22:59:26.008758 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m22:59:26.008997 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m22:59:26.009201 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:59:26.011721 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.003 seconds
[0m22:59:26.012308 [debug] [ThreadPool]: On list_airflow: Close
[0m22:59:26.012985 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_staging_dim)
[0m22:59:26.015703 [debug] [ThreadPool]: Using postgres connection "list_airflow_staging_dim"
[0m22:59:26.015906 [debug] [ThreadPool]: On list_airflow_staging_dim: BEGIN
[0m22:59:26.016099 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:59:26.017578 [debug] [ThreadPool]: SQL status: BEGIN in 0.001 seconds
[0m22:59:26.017792 [debug] [ThreadPool]: Using postgres connection "list_airflow_staging_dim"
[0m22:59:26.018035 [debug] [ThreadPool]: On list_airflow_staging_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_staging_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_dim'
  
[0m22:59:26.019381 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m22:59:26.019966 [debug] [ThreadPool]: On list_airflow_staging_dim: ROLLBACK
[0m22:59:26.020239 [debug] [ThreadPool]: On list_airflow_staging_dim: Close
[0m22:59:26.022231 [debug] [MainThread]: Using postgres connection "master"
[0m22:59:26.022453 [debug] [MainThread]: On master: BEGIN
[0m22:59:26.022633 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:59:26.024025 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m22:59:26.024273 [debug] [MainThread]: Using postgres connection "master"
[0m22:59:26.024500 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:59:26.027376 [debug] [MainThread]: SQL status: SELECT 1 in 0.003 seconds
[0m22:59:26.027955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1af78d8f-15ae-4609-9003-08dc34d0c12b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bc1b9d0>]}
[0m22:59:26.028281 [debug] [MainThread]: On master: ROLLBACK
[0m22:59:26.028544 [debug] [MainThread]: Using postgres connection "master"
[0m22:59:26.028726 [debug] [MainThread]: On master: BEGIN
[0m22:59:26.029075 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m22:59:26.029317 [debug] [MainThread]: On master: COMMIT
[0m22:59:26.029490 [debug] [MainThread]: Using postgres connection "master"
[0m22:59:26.029657 [debug] [MainThread]: On master: COMMIT
[0m22:59:26.029906 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:59:26.030124 [debug] [MainThread]: On master: Close
[0m22:59:26.031396 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.dim_stations
[0m22:59:26.031690 [info ] [Thread-1 (]: 1 of 1 START sql view model staging_dim.dim_stations ........................... [RUN]
[0m22:59:26.031936 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_staging_dim, now model.etl_waterlevel.dim_stations)
[0m22:59:26.032208 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.dim_stations
[0m22:59:26.035138 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.dim_stations"
[0m22:59:26.036271 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.dim_stations
[0m22:59:26.052195 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.dim_stations"
[0m22:59:26.052971 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m22:59:26.053204 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: BEGIN
[0m22:59:26.053390 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:59:26.054837 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m22:59:26.055091 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m22:59:26.055294 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.dim_stations"} */

  create view "airflow"."staging_dim"."dim_stations__dbt_tmp"
    
    
  as (
    -- models/dimensions/dim_stations.sql

with station_names as (
  select distinct
    "stationId"     as station_id,
    "stationName"   as station_name,
    "stationCode"   as station_code,
    "stationStatus" as station_status
  from raw.waterlevels
)

select * from station_names
  );
[0m22:59:26.056246 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m22:59:26.058868 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m22:59:26.059072 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.dim_stations"} */
alter table "airflow"."staging_dim"."dim_stations" rename to "dim_stations__dbt_backup"
[0m22:59:26.059395 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:59:26.060629 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m22:59:26.060804 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.dim_stations"} */
alter table "airflow"."staging_dim"."dim_stations__dbt_tmp" rename to "dim_stations"
[0m22:59:26.061076 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:59:26.068394 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: COMMIT
[0m22:59:26.068619 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m22:59:26.068816 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: COMMIT
[0m22:59:26.069539 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m22:59:26.072082 [debug] [Thread-1 (]: Applying DROP to: "airflow"."staging_dim"."dim_stations__dbt_backup"
[0m22:59:26.074144 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m22:59:26.074364 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.dim_stations"} */
drop view if exists "airflow"."staging_dim"."dim_stations__dbt_backup" cascade
[0m22:59:26.075001 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m22:59:26.076004 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: Close
[0m22:59:26.076803 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1af78d8f-15ae-4609-9003-08dc34d0c12b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bc6fb10>]}
[0m22:59:26.077159 [info ] [Thread-1 (]: 1 of 1 OK created sql view model staging_dim.dim_stations ...................... [[32mCREATE VIEW[0m in 0.04s]
[0m22:59:26.077496 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.dim_stations
[0m22:59:26.078255 [debug] [MainThread]: Using postgres connection "master"
[0m22:59:26.078442 [debug] [MainThread]: On master: BEGIN
[0m22:59:26.078597 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:59:26.079891 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m22:59:26.080133 [debug] [MainThread]: On master: COMMIT
[0m22:59:26.080282 [debug] [MainThread]: Using postgres connection "master"
[0m22:59:26.080429 [debug] [MainThread]: On master: COMMIT
[0m22:59:26.080627 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:59:26.080763 [debug] [MainThread]: On master: Close
[0m22:59:26.080952 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:59:26.081086 [debug] [MainThread]: Connection 'model.etl_waterlevel.dim_stations' was properly closed.
[0m22:59:26.081252 [info ] [MainThread]: 
[0m22:59:26.081435 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.09 seconds (0.09s).
[0m22:59:26.081826 [debug] [MainThread]: Command end result
[0m22:59:26.093866 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m22:59:26.094829 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m22:59:26.097584 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m22:59:26.097751 [info ] [MainThread]: 
[0m22:59:26.097983 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:59:26.098186 [info ] [MainThread]: 
[0m22:59:26.098422 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m22:59:26.098902 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.32045817, "process_in_blocks": "0", "process_kernel_time": 0.098854, "process_mem_max_rss": "113620", "process_out_blocks": "1653", "process_user_time": 0.808812}
[0m22:59:26.099152 [debug] [MainThread]: Command `dbt run` succeeded at 22:59:26.099112 after 0.32 seconds
[0m22:59:26.099334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c690950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff811a5190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff811a5310>]}
[0m22:59:26.099503 [debug] [MainThread]: Flushing usage events
[0m22:59:27.195695 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:01:40.605196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80f3ccd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81155f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81156510>]}


============================== 23:01:40.606880 | 4441b8e3-8d2c-400b-b598-33c9c8bb10dd ==============================
[0m23:01:40.606880 [info ] [MainThread]: Running with dbt=1.9.0
[0m23:01:40.607266 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt compile -m dim_stations', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:01:40.666894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4441b8e3-8d2c-400b-b598-33c9c8bb10dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80d95f50>]}
[0m23:01:40.688735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4441b8e3-8d2c-400b-b598-33c9c8bb10dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff839d9b10>]}
[0m23:01:40.689129 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:01:40.713438 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m23:01:40.749571 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:01:40.749800 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:01:40.752031 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m23:01:40.760643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4441b8e3-8d2c-400b-b598-33c9c8bb10dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8003c350>]}
[0m23:01:40.786298 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m23:01:40.787573 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m23:01:40.792297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4441b8e3-8d2c-400b-b598-33c9c8bb10dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff800c1bd0>]}
[0m23:01:40.792544 [info ] [MainThread]: Found 1 model, 433 macros
[0m23:01:40.792832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4441b8e3-8d2c-400b-b598-33c9c8bb10dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff801b7dd0>]}
[0m23:01:40.793569 [info ] [MainThread]: 
[0m23:01:40.793774 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:01:40.794054 [info ] [MainThread]: 
[0m23:01:40.794360 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:01:40.794800 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow_staging_dim'
[0m23:01:40.811008 [debug] [ThreadPool]: Using postgres connection "list_airflow_staging_dim"
[0m23:01:40.811314 [debug] [ThreadPool]: On list_airflow_staging_dim: BEGIN
[0m23:01:40.811524 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:01:40.813861 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m23:01:40.814116 [debug] [ThreadPool]: Using postgres connection "list_airflow_staging_dim"
[0m23:01:40.814353 [debug] [ThreadPool]: On list_airflow_staging_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_staging_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_dim'
  
[0m23:01:40.815723 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m23:01:40.816364 [debug] [ThreadPool]: On list_airflow_staging_dim: ROLLBACK
[0m23:01:40.816684 [debug] [ThreadPool]: On list_airflow_staging_dim: Close
[0m23:01:40.819111 [debug] [MainThread]: Using postgres connection "master"
[0m23:01:40.819333 [debug] [MainThread]: On master: BEGIN
[0m23:01:40.819516 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:01:40.821147 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m23:01:40.821418 [debug] [MainThread]: Using postgres connection "master"
[0m23:01:40.821677 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:01:40.824471 [debug] [MainThread]: SQL status: SELECT 1 in 0.003 seconds
[0m23:01:40.825089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4441b8e3-8d2c-400b-b598-33c9c8bb10dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ff58550>]}
[0m23:01:40.825339 [debug] [MainThread]: On master: ROLLBACK
[0m23:01:40.825614 [debug] [MainThread]: On master: Close
[0m23:01:40.827241 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.dim_stations
[0m23:01:40.827579 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_staging_dim, now model.etl_waterlevel.dim_stations)
[0m23:01:40.827813 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.dim_stations
[0m23:01:40.831174 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.dim_stations"
[0m23:01:40.831890 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.dim_stations
[0m23:01:40.832231 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.dim_stations
[0m23:01:40.832893 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:01:40.833136 [debug] [MainThread]: Connection 'model.etl_waterlevel.dim_stations' was properly closed.
[0m23:01:40.833471 [debug] [MainThread]: Command end result
[0m23:01:40.843833 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m23:01:40.844849 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m23:01:40.847813 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m23:01:40.847994 [info ] [MainThread]: Compiled node 'dim_stations' is:
-- models/dimensions/dim_stations.sql

with station_names as (
  select distinct
    "stationId"     as station_id,
    "stationName"   as station_name,
    "stationCode"   as station_code,
    "stationStatus" as station_status
  from raw.waterlevels
)

select * from station_names
[0m23:01:40.848541 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 0.2651643, "process_in_blocks": "0", "process_kernel_time": 0.075847, "process_mem_max_rss": "112736", "process_out_blocks": "1640", "process_user_time": 0.759474}
[0m23:01:40.848798 [debug] [MainThread]: Command `dbt compile` succeeded at 23:01:40.848746 after 0.27 seconds
[0m23:01:40.849005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80db2190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80d95e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80d969d0>]}
[0m23:01:40.849194 [debug] [MainThread]: Flushing usage events
[0m23:01:42.139133 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:09:59.475430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bc3f590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e901a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bc3ef50>]}


============================== 23:09:59.476873 | 84160041-59d0-4b65-8eb2-8d010134d1e9 ==============================
[0m23:09:59.476873 [info ] [MainThread]: Running with dbt=1.9.0
[0m23:09:59.477227 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:09:59.518195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '84160041-59d0-4b65-8eb2-8d010134d1e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ba6ae10>]}
[0m23:09:59.526589 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.07222112, "process_in_blocks": "0", "process_kernel_time": 0.05206, "process_mem_max_rss": "96160", "process_out_blocks": "3", "process_user_time": 0.58969}
[0m23:09:59.526994 [debug] [MainThread]: Command `dbt clean` succeeded at 23:09:59.526952 after 0.07 seconds
[0m23:09:59.527202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ba94ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ba96210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ba967d0>]}
[0m23:09:59.527421 [debug] [MainThread]: Flushing usage events
[0m23:10:00.830993 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:10:53.000026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1e47510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1f7c610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1e47bd0>]}


============================== 23:10:53.001422 | a1e3556e-b31b-483e-a1b1-c0e7fb8b1e80 ==============================
[0m23:10:53.001422 [info ] [MainThread]: Running with dbt=1.9.0
[0m23:10:53.001843 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:10:53.061002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a1e3556e-b31b-483e-a1b1-c0e7fb8b1e80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1291450>]}
[0m23:10:53.082762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a1e3556e-b31b-483e-a1b1-c0e7fb8b1e80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4920b50>]}
[0m23:10:53.083129 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:10:53.107356 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m23:10:53.107949 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m23:10:53.108277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a1e3556e-b31b-483e-a1b1-c0e7fb8b1e80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1023010>]}
[0m23:10:53.447205 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m23:10:53.449861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a1e3556e-b31b-483e-a1b1-c0e7fb8b1e80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb10c5650>]}
[0m23:10:53.501623 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m23:10:53.503218 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m23:10:53.509207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a1e3556e-b31b-483e-a1b1-c0e7fb8b1e80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb10a3550>]}
[0m23:10:53.509525 [info ] [MainThread]: Found 1 model, 433 macros
[0m23:10:53.509758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a1e3556e-b31b-483e-a1b1-c0e7fb8b1e80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0edb110>]}
[0m23:10:53.510588 [info ] [MainThread]: 
[0m23:10:53.510842 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:10:53.511095 [info ] [MainThread]: 
[0m23:10:53.511550 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:10:53.512054 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m23:10:53.526004 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m23:10:53.526261 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m23:10:53.526460 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:10:53.528926 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.002 seconds
[0m23:10:53.529583 [debug] [ThreadPool]: On list_airflow: Close
[0m23:10:53.530245 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_staging_dim)
[0m23:10:53.533051 [debug] [ThreadPool]: Using postgres connection "list_airflow_staging_dim"
[0m23:10:53.533267 [debug] [ThreadPool]: On list_airflow_staging_dim: BEGIN
[0m23:10:53.533461 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:10:53.535016 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m23:10:53.535265 [debug] [ThreadPool]: Using postgres connection "list_airflow_staging_dim"
[0m23:10:53.535466 [debug] [ThreadPool]: On list_airflow_staging_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_staging_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_dim'
  
[0m23:10:53.536707 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m23:10:53.537300 [debug] [ThreadPool]: On list_airflow_staging_dim: ROLLBACK
[0m23:10:53.537566 [debug] [ThreadPool]: On list_airflow_staging_dim: Close
[0m23:10:53.539610 [debug] [MainThread]: Using postgres connection "master"
[0m23:10:53.539808 [debug] [MainThread]: On master: BEGIN
[0m23:10:53.539983 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:10:53.541343 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m23:10:53.541646 [debug] [MainThread]: Using postgres connection "master"
[0m23:10:53.541893 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:10:53.544758 [debug] [MainThread]: SQL status: SELECT 1 in 0.003 seconds
[0m23:10:53.545326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a1e3556e-b31b-483e-a1b1-c0e7fb8b1e80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0210cd0>]}
[0m23:10:53.545578 [debug] [MainThread]: On master: ROLLBACK
[0m23:10:53.545877 [debug] [MainThread]: Using postgres connection "master"
[0m23:10:53.546084 [debug] [MainThread]: On master: BEGIN
[0m23:10:53.546476 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:10:53.546742 [debug] [MainThread]: On master: COMMIT
[0m23:10:53.547003 [debug] [MainThread]: Using postgres connection "master"
[0m23:10:53.547225 [debug] [MainThread]: On master: COMMIT
[0m23:10:53.547523 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:10:53.547713 [debug] [MainThread]: On master: Close
[0m23:10:53.548971 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.dim_stations
[0m23:10:53.549305 [info ] [Thread-1 (]: 1 of 1 START sql view model staging_dim.dim_stations ........................... [RUN]
[0m23:10:53.549576 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_staging_dim, now model.etl_waterlevel.dim_stations)
[0m23:10:53.549824 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.dim_stations
[0m23:10:53.552815 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.dim_stations"
[0m23:10:53.554300 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.dim_stations
[0m23:10:53.570799 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.dim_stations"
[0m23:10:53.572270 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m23:10:53.572523 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: BEGIN
[0m23:10:53.572737 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:10:53.574476 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m23:10:53.574762 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m23:10:53.574958 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.dim_stations"} */

  create view "airflow"."staging_dim"."dim_stations__dbt_tmp"
    
    
  as (
    -- models/dimensions/dim_stations.sql

with station_names as (
  select distinct
    "stationId"     as station_id,
    "stationName"   as station_name,
    "stationCode"   as station_code,
    "stationStatus" as station_status
  from raw.waterlevels
)

select * from station_names
  );
[0m23:10:53.576080 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m23:10:53.578823 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m23:10:53.579036 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.dim_stations"} */
alter table "airflow"."staging_dim"."dim_stations" rename to "dim_stations__dbt_backup"
[0m23:10:53.579382 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:10:53.580615 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m23:10:53.580808 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.dim_stations"} */
alter table "airflow"."staging_dim"."dim_stations__dbt_tmp" rename to "dim_stations"
[0m23:10:53.581090 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:10:53.588539 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: COMMIT
[0m23:10:53.588812 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m23:10:53.589040 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: COMMIT
[0m23:10:53.589547 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m23:10:53.592754 [debug] [Thread-1 (]: Applying DROP to: "airflow"."staging_dim"."dim_stations__dbt_backup"
[0m23:10:53.594873 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m23:10:53.595063 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.dim_stations"} */
drop view if exists "airflow"."staging_dim"."dim_stations__dbt_backup" cascade
[0m23:10:53.595692 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m23:10:53.596801 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: Close
[0m23:10:53.597600 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a1e3556e-b31b-483e-a1b1-c0e7fb8b1e80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb02dd210>]}
[0m23:10:53.597930 [info ] [Thread-1 (]: 1 of 1 OK created sql view model staging_dim.dim_stations ...................... [[32mCREATE VIEW[0m in 0.05s]
[0m23:10:53.598245 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.dim_stations
[0m23:10:53.599003 [debug] [MainThread]: Using postgres connection "master"
[0m23:10:53.599209 [debug] [MainThread]: On master: BEGIN
[0m23:10:53.599355 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:10:53.600713 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m23:10:53.600913 [debug] [MainThread]: On master: COMMIT
[0m23:10:53.601061 [debug] [MainThread]: Using postgres connection "master"
[0m23:10:53.601215 [debug] [MainThread]: On master: COMMIT
[0m23:10:53.601426 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:10:53.601567 [debug] [MainThread]: On master: Close
[0m23:10:53.601753 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:10:53.601888 [debug] [MainThread]: Connection 'model.etl_waterlevel.dim_stations' was properly closed.
[0m23:10:53.602034 [info ] [MainThread]: 
[0m23:10:53.602225 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.09 seconds (0.09s).
[0m23:10:53.602615 [debug] [MainThread]: Command end result
[0m23:10:53.613982 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m23:10:53.614915 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m23:10:53.617581 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m23:10:53.617739 [info ] [MainThread]: 
[0m23:10:53.617998 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:10:53.618194 [info ] [MainThread]: 
[0m23:10:53.618576 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:10:53.619091 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.6400153, "process_in_blocks": "0", "process_kernel_time": 0.079844, "process_mem_max_rss": "115648", "process_out_blocks": "2469", "process_user_time": 1.099854}
[0m23:10:53.619329 [debug] [MainThread]: Command `dbt run` succeeded at 23:10:53.619283 after 0.64 seconds
[0m23:10:53.619531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1cbffd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1cbff10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb29475d0>]}
[0m23:10:53.619712 [debug] [MainThread]: Flushing usage events
[0m23:10:54.897067 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:11:08.903827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91533090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91383e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91533c90>]}


============================== 23:11:08.905245 | 09bd25d3-29c3-4881-bb6d-ca22a3f2fda5 ==============================
[0m23:11:08.905245 [info ] [MainThread]: Running with dbt=1.9.0
[0m23:11:08.905636 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:11:08.923100 [error] [MainThread]: Encountered an error:
Runtime Error
  Credentials in profile "etl_waterlevel", target "dev" invalid: None is not of type 'string'
[0m23:11:08.923775 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.041203916, "process_in_blocks": "0", "process_kernel_time": 0.051995, "process_mem_max_rss": "97928", "process_out_blocks": "2", "process_user_time": 0.558951}
[0m23:11:08.924069 [debug] [MainThread]: Command `dbt run` failed at 23:11:08.924011 after 0.04 seconds
[0m23:11:08.924339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9153c050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff913abd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91384690>]}
[0m23:11:08.924603 [debug] [MainThread]: Flushing usage events
[0m23:11:10.154807 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:11:26.451669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb573f950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb573f710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb573f110>]}


============================== 23:11:26.453214 | 5408bf74-076f-4353-afd7-9835c92b9878 ==============================
[0m23:11:26.453214 [info ] [MainThread]: Running with dbt=1.9.0
[0m23:11:26.453608 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m23:11:26.472362 [error] [MainThread]: Encountered an error:
Runtime Error
  Credentials in profile "etl_waterlevel", target "dev" invalid: 'schema' is a required property
[0m23:11:26.472982 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.04327679, "process_in_blocks": "0", "process_kernel_time": 0.051945, "process_mem_max_rss": "97944", "process_out_blocks": "2", "process_user_time": 0.561415}
[0m23:11:26.473260 [debug] [MainThread]: Command `dbt run` failed at 23:11:26.473199 after 0.04 seconds
[0m23:11:26.473500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb55b4490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba1c5590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba055150>]}
[0m23:11:26.473743 [debug] [MainThread]: Flushing usage events
[0m23:11:27.869740 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:14:53.626021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b943390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b95de50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ba788d0>]}


============================== 23:14:53.627425 | b3d07bf2-6a3a-49be-ba4b-1c56d4cee92e ==============================
[0m23:14:53.627425 [info ] [MainThread]: Running with dbt=1.9.0
[0m23:14:53.627801 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:14:53.687150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b3d07bf2-6a3a-49be-ba4b-1c56d4cee92e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9dfdf990>]}
[0m23:14:53.709108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b3d07bf2-6a3a-49be-ba4b-1c56d4cee92e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e3789d0>]}
[0m23:14:53.709473 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:14:53.733597 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m23:14:53.760610 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m23:14:53.760972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b3d07bf2-6a3a-49be-ba4b-1c56d4cee92e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ad893d0>]}
[0m23:14:54.017589 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.etl_waterlevel.dimensions
- models.etl_waterlevel.staging
[0m23:14:54.019920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b3d07bf2-6a3a-49be-ba4b-1c56d4cee92e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ab5ae50>]}
[0m23:14:54.039132 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m23:14:54.040430 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m23:14:54.072574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b3d07bf2-6a3a-49be-ba4b-1c56d4cee92e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9aa6fa50>]}
[0m23:14:54.072954 [info ] [MainThread]: Found 433 macros
[0m23:14:54.073223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b3d07bf2-6a3a-49be-ba4b-1c56d4cee92e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a9e6b90>]}
[0m23:14:54.074051 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m23:14:54.074423 [debug] [MainThread]: Command end result
[0m23:14:54.086699 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m23:14:54.087714 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m23:14:54.089343 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m23:14:54.089845 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.4857547, "process_in_blocks": "0", "process_kernel_time": 0.06438, "process_mem_max_rss": "105604", "process_out_blocks": "2426", "process_user_time": 0.97577}
[0m23:14:54.090054 [debug] [MainThread]: Command `dbt run` succeeded at 23:14:54.090014 after 0.49 seconds
[0m23:14:54.090237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0229490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0228650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0229610>]}
[0m23:14:54.090441 [debug] [MainThread]: Flushing usage events
[0m23:14:55.434697 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:15:17.683506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaec3f0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaec3f510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaec3c050>]}


============================== 23:15:17.684915 | 915f91ec-e114-446a-853b-d9af10fd6b83 ==============================
[0m23:15:17.684915 [info ] [MainThread]: Running with dbt=1.9.0
[0m23:15:17.685328 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:15:17.727446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '915f91ec-e114-446a-853b-d9af10fd6b83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaeb271d0>]}
[0m23:15:17.736011 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.07375533, "process_in_blocks": "0", "process_kernel_time": 0.068991, "process_mem_max_rss": "96164", "process_out_blocks": "3", "process_user_time": 0.582931}
[0m23:15:17.736326 [debug] [MainThread]: Command `dbt clean` succeeded at 23:15:17.736254 after 0.07 seconds
[0m23:15:17.736668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaea6b910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaea6ab50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaea69390>]}
[0m23:15:17.736988 [debug] [MainThread]: Flushing usage events
[0m23:15:18.781124 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:15:21.156098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3942b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3797b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3a380d0>]}


============================== 23:15:21.157497 | 324cf830-ccd4-42ee-bb25-3340026ec353 ==============================
[0m23:15:21.157497 [info ] [MainThread]: Running with dbt=1.9.0
[0m23:15:21.157941 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:15:21.217714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '324cf830-ccd4-42ee-bb25-3340026ec353', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb37d9010>]}
[0m23:15:21.239777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '324cf830-ccd4-42ee-bb25-3340026ec353', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb637a590>]}
[0m23:15:21.240171 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:15:21.269115 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m23:15:21.269666 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m23:15:21.269911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '324cf830-ccd4-42ee-bb25-3340026ec353', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2a8f610>]}
[0m23:15:21.526950 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.etl_waterlevel.dimensions
- models.etl_waterlevel.staging
[0m23:15:21.529227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '324cf830-ccd4-42ee-bb25-3340026ec353', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2b69d90>]}
[0m23:15:21.549984 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m23:15:21.551483 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m23:15:21.561032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '324cf830-ccd4-42ee-bb25-3340026ec353', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2a22310>]}
[0m23:15:21.561262 [info ] [MainThread]: Found 433 macros
[0m23:15:21.561470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '324cf830-ccd4-42ee-bb25-3340026ec353', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2980ed0>]}
[0m23:15:21.562104 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m23:15:21.562473 [debug] [MainThread]: Command end result
[0m23:15:21.573339 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m23:15:21.574052 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m23:15:21.575618 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m23:15:21.576093 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.44097295, "process_in_blocks": "0", "process_kernel_time": 0.070894, "process_mem_max_rss": "106196", "process_out_blocks": "2579", "process_user_time": 0.922626}
[0m23:15:21.576493 [debug] [MainThread]: Command `dbt run` succeeded at 23:15:21.576341 after 0.44 seconds
[0m23:15:21.576775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2b323d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb29e4250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb82290d0>]}
[0m23:15:21.577038 [debug] [MainThread]: Flushing usage events
[0m23:15:22.790004 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:18:06.334523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ae2f710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b046510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ae2f1d0>]}


============================== 23:18:06.335918 | bf33b3dc-3723-44f8-84de-67fbca80e22c ==============================
[0m23:18:06.335918 [info ] [MainThread]: Running with dbt=1.9.0
[0m23:18:06.336312 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:18:06.395813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bf33b3dc-3723-44f8-84de-67fbca80e22c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ae2c5d0>]}
[0m23:18:06.417578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bf33b3dc-3723-44f8-84de-67fbca80e22c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d890e50>]}
[0m23:18:06.417939 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:18:06.442059 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m23:18:06.460296 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m23:18:06.460640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'bf33b3dc-3723-44f8-84de-67fbca80e22c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ba542d0>]}
[0m23:18:06.829068 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m23:18:06.831513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bf33b3dc-3723-44f8-84de-67fbca80e22c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a06b9d0>]}
[0m23:18:06.861172 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m23:18:06.862798 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m23:18:06.868517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bf33b3dc-3723-44f8-84de-67fbca80e22c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79e2cfd0>]}
[0m23:18:06.868769 [info ] [MainThread]: Found 1 model, 433 macros
[0m23:18:06.868944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bf33b3dc-3723-44f8-84de-67fbca80e22c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79fb72d0>]}
[0m23:18:06.869728 [info ] [MainThread]: 
[0m23:18:06.869951 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:18:06.870156 [info ] [MainThread]: 
[0m23:18:06.870475 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:18:06.870952 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m23:18:06.886534 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m23:18:06.886798 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m23:18:06.887002 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:18:06.889466 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.002 seconds
[0m23:18:06.890049 [debug] [ThreadPool]: On list_airflow: Close
[0m23:18:06.890699 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_staging_dim)
[0m23:18:06.893664 [debug] [ThreadPool]: Using postgres connection "list_airflow_staging_dim"
[0m23:18:06.893927 [debug] [ThreadPool]: On list_airflow_staging_dim: BEGIN
[0m23:18:06.894139 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:18:06.896016 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m23:18:06.896396 [debug] [ThreadPool]: Using postgres connection "list_airflow_staging_dim"
[0m23:18:06.896653 [debug] [ThreadPool]: On list_airflow_staging_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_staging_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_dim'
  
[0m23:18:06.898027 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m23:18:06.898681 [debug] [ThreadPool]: On list_airflow_staging_dim: ROLLBACK
[0m23:18:06.898962 [debug] [ThreadPool]: On list_airflow_staging_dim: Close
[0m23:18:06.901159 [debug] [MainThread]: Using postgres connection "master"
[0m23:18:06.901358 [debug] [MainThread]: On master: BEGIN
[0m23:18:06.901531 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:18:06.903134 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m23:18:06.903390 [debug] [MainThread]: Using postgres connection "master"
[0m23:18:06.903655 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:18:06.906495 [debug] [MainThread]: SQL status: SELECT 1 in 0.003 seconds
[0m23:18:06.907060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bf33b3dc-3723-44f8-84de-67fbca80e22c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a2117d0>]}
[0m23:18:06.907351 [debug] [MainThread]: On master: ROLLBACK
[0m23:18:06.907622 [debug] [MainThread]: Using postgres connection "master"
[0m23:18:06.907822 [debug] [MainThread]: On master: BEGIN
[0m23:18:06.908253 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:18:06.908725 [debug] [MainThread]: On master: COMMIT
[0m23:18:06.908945 [debug] [MainThread]: Using postgres connection "master"
[0m23:18:06.909147 [debug] [MainThread]: On master: COMMIT
[0m23:18:06.909500 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:18:06.909715 [debug] [MainThread]: On master: Close
[0m23:18:06.911071 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.dim_stations
[0m23:18:06.911426 [info ] [Thread-1 (]: 1 of 1 START sql view model staging_dim.dim_stations ........................... [RUN]
[0m23:18:06.911776 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_staging_dim, now model.etl_waterlevel.dim_stations)
[0m23:18:06.912006 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.dim_stations
[0m23:18:06.915098 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.dim_stations"
[0m23:18:06.916641 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.dim_stations
[0m23:18:06.934079 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.dim_stations"
[0m23:18:06.935671 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m23:18:06.935862 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: BEGIN
[0m23:18:06.936016 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:18:06.937753 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m23:18:06.937989 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m23:18:06.938189 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.dim_stations"} */

  create view "airflow"."staging_dim"."dim_stations__dbt_tmp"
    
    
  as (
    -- models/dimensions/dim_stations.sql

with station_names as (
  select distinct
    "stationId"     as station_id,
    "stationName"   as station_name,
    "stationCode"   as station_code,
    "stationStatus" as station_status
  from raw.waterlevels
)

select * from station_names
  );
[0m23:18:06.939321 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m23:18:06.942083 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m23:18:06.942323 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.dim_stations"} */
alter table "airflow"."staging_dim"."dim_stations" rename to "dim_stations__dbt_backup"
[0m23:18:06.942686 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:18:06.944004 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m23:18:06.944219 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.dim_stations"} */
alter table "airflow"."staging_dim"."dim_stations__dbt_tmp" rename to "dim_stations"
[0m23:18:06.944599 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:18:06.951762 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: COMMIT
[0m23:18:06.952001 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m23:18:06.952217 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: COMMIT
[0m23:18:06.952901 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m23:18:06.955579 [debug] [Thread-1 (]: Applying DROP to: "airflow"."staging_dim"."dim_stations__dbt_backup"
[0m23:18:06.957618 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m23:18:06.957810 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.dim_stations"} */
drop view if exists "airflow"."staging_dim"."dim_stations__dbt_backup" cascade
[0m23:18:06.958493 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m23:18:06.959584 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: Close
[0m23:18:06.960436 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf33b3dc-3723-44f8-84de-67fbca80e22c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d31a150>]}
[0m23:18:06.960764 [info ] [Thread-1 (]: 1 of 1 OK created sql view model staging_dim.dim_stations ...................... [[32mCREATE VIEW[0m in 0.05s]
[0m23:18:06.961040 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.dim_stations
[0m23:18:06.961834 [debug] [MainThread]: Using postgres connection "master"
[0m23:18:06.962039 [debug] [MainThread]: On master: BEGIN
[0m23:18:06.962200 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:18:06.963562 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m23:18:06.963758 [debug] [MainThread]: On master: COMMIT
[0m23:18:06.963929 [debug] [MainThread]: Using postgres connection "master"
[0m23:18:06.964083 [debug] [MainThread]: On master: COMMIT
[0m23:18:06.964308 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:18:06.964488 [debug] [MainThread]: On master: Close
[0m23:18:06.964685 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:18:06.964827 [debug] [MainThread]: Connection 'model.etl_waterlevel.dim_stations' was properly closed.
[0m23:18:06.964976 [info ] [MainThread]: 
[0m23:18:06.965179 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.09 seconds (0.09s).
[0m23:18:06.965575 [debug] [MainThread]: Command end result
[0m23:18:06.978330 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m23:18:06.979160 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m23:18:06.981965 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m23:18:06.982133 [info ] [MainThread]: 
[0m23:18:06.982399 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:18:06.982593 [info ] [MainThread]: 
[0m23:18:06.982829 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:18:06.983507 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.6698799, "process_in_blocks": "0", "process_kernel_time": 0.061185, "process_mem_max_rss": "115952", "process_out_blocks": "2469", "process_user_time": 1.132436}
[0m23:18:06.983706 [debug] [MainThread]: Command `dbt run` succeeded at 23:18:06.983670 after 0.67 seconds
[0m23:18:06.983882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7aca43d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7aca6510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f708650>]}
[0m23:18:06.984047 [debug] [MainThread]: Flushing usage events
[0m23:18:08.458889 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:19:20.269551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9b3b950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9d56510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa996f310>]}


============================== 23:19:20.270903 | e30d3ac9-f93c-4c99-8cdc-f288da1c0645 ==============================
[0m23:19:20.270903 [info ] [MainThread]: Running with dbt=1.9.0
[0m23:19:20.271308 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt compile -m dim_stations', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:19:20.330785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e30d3ac9-f93c-4c99-8cdc-f288da1c0645', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8f10d90>]}
[0m23:19:20.352696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e30d3ac9-f93c-4c99-8cdc-f288da1c0645', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac5de290>]}
[0m23:19:20.353068 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:19:20.377254 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m23:19:20.413505 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:19:20.413735 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:19:20.416007 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m23:19:20.424636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e30d3ac9-f93c-4c99-8cdc-f288da1c0645', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8bbd4d0>]}
[0m23:19:20.452356 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m23:19:20.453842 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m23:19:20.458353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e30d3ac9-f93c-4c99-8cdc-f288da1c0645', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8eed610>]}
[0m23:19:20.458602 [info ] [MainThread]: Found 1 model, 433 macros
[0m23:19:20.458863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e30d3ac9-f93c-4c99-8cdc-f288da1c0645', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8d24910>]}
[0m23:19:20.459600 [info ] [MainThread]: 
[0m23:19:20.459831 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:19:20.460062 [info ] [MainThread]: 
[0m23:19:20.460395 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:19:20.460807 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow_staging_dim'
[0m23:19:20.475493 [debug] [ThreadPool]: Using postgres connection "list_airflow_staging_dim"
[0m23:19:20.475721 [debug] [ThreadPool]: On list_airflow_staging_dim: BEGIN
[0m23:19:20.475905 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:19:20.478045 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m23:19:20.478313 [debug] [ThreadPool]: Using postgres connection "list_airflow_staging_dim"
[0m23:19:20.478535 [debug] [ThreadPool]: On list_airflow_staging_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_staging_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_dim'
  
[0m23:19:20.479836 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m23:19:20.480432 [debug] [ThreadPool]: On list_airflow_staging_dim: ROLLBACK
[0m23:19:20.480711 [debug] [ThreadPool]: On list_airflow_staging_dim: Close
[0m23:19:20.482877 [debug] [MainThread]: Using postgres connection "master"
[0m23:19:20.483098 [debug] [MainThread]: On master: BEGIN
[0m23:19:20.483256 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:19:20.484705 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m23:19:20.484944 [debug] [MainThread]: Using postgres connection "master"
[0m23:19:20.485165 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:19:20.487911 [debug] [MainThread]: SQL status: SELECT 1 in 0.003 seconds
[0m23:19:20.488502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e30d3ac9-f93c-4c99-8cdc-f288da1c0645', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8d66b90>]}
[0m23:19:20.488744 [debug] [MainThread]: On master: ROLLBACK
[0m23:19:20.488997 [debug] [MainThread]: On master: Close
[0m23:19:20.490557 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.dim_stations
[0m23:19:20.490822 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_staging_dim, now model.etl_waterlevel.dim_stations)
[0m23:19:20.491030 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.dim_stations
[0m23:19:20.494365 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.dim_stations"
[0m23:19:20.495159 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.dim_stations
[0m23:19:20.495510 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.dim_stations
[0m23:19:20.496126 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:19:20.496306 [debug] [MainThread]: Connection 'model.etl_waterlevel.dim_stations' was properly closed.
[0m23:19:20.496622 [debug] [MainThread]: Command end result
[0m23:19:20.506871 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m23:19:20.507891 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m23:19:20.510807 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m23:19:20.510996 [info ] [MainThread]: Compiled node 'dim_stations' is:
-- models/dimensions/dim_stations.sql

with station_names as (
  select distinct
    "stationId"     as station_id,
    "stationName"   as station_name,
    "stationCode"   as station_code,
    "stationStatus" as station_status
  from raw.waterlevels
)

select * from station_names
[0m23:19:20.511511 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 0.2629539, "process_in_blocks": "0", "process_kernel_time": 0.070497, "process_mem_max_rss": "112580", "process_out_blocks": "1641", "process_user_time": 0.738738}
[0m23:19:20.511727 [debug] [MainThread]: Command `dbt compile` succeeded at 23:19:20.511683 after 0.26 seconds
[0m23:19:20.511909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9d41e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa63b550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9e18290>]}
[0m23:19:20.512091 [debug] [MainThread]: Flushing usage events
[0m23:19:21.734147 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:19:45.070986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a28a310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ceb9190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a56c810>]}


============================== 23:19:45.072416 | 13c00a52-3af8-48f6-9a30-0aaed3d3ceff ==============================
[0m23:19:45.072416 [info ] [MainThread]: Running with dbt=1.9.0
[0m23:19:45.072852 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:19:45.132883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '13c00a52-3af8-48f6-9a30-0aaed3d3ceff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff898c6ad0>]}
[0m23:19:45.154711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '13c00a52-3af8-48f6-9a30-0aaed3d3ceff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cec90d0>]}
[0m23:19:45.155076 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:19:45.179264 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m23:19:45.213906 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:19:45.214137 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:19:45.216399 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m23:19:45.225055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '13c00a52-3af8-48f6-9a30-0aaed3d3ceff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff894fdd10>]}
[0m23:19:45.251801 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m23:19:45.253162 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m23:19:45.258353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '13c00a52-3af8-48f6-9a30-0aaed3d3ceff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff895fa6d0>]}
[0m23:19:45.258584 [info ] [MainThread]: Found 1 model, 433 macros
[0m23:19:45.258791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '13c00a52-3af8-48f6-9a30-0aaed3d3ceff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89682c90>]}
[0m23:19:45.259536 [info ] [MainThread]: 
[0m23:19:45.259805 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:19:45.260029 [info ] [MainThread]: 
[0m23:19:45.260365 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:19:45.260936 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m23:19:45.275369 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m23:19:45.275583 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m23:19:45.275801 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:19:45.278149 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.002 seconds
[0m23:19:45.278728 [debug] [ThreadPool]: On list_airflow: Close
[0m23:19:45.279353 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_staging_dim)
[0m23:19:45.282161 [debug] [ThreadPool]: Using postgres connection "list_airflow_staging_dim"
[0m23:19:45.282366 [debug] [ThreadPool]: On list_airflow_staging_dim: BEGIN
[0m23:19:45.282549 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:19:45.283971 [debug] [ThreadPool]: SQL status: BEGIN in 0.001 seconds
[0m23:19:45.284221 [debug] [ThreadPool]: Using postgres connection "list_airflow_staging_dim"
[0m23:19:45.284422 [debug] [ThreadPool]: On list_airflow_staging_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_staging_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_dim'
  
[0m23:19:45.285625 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m23:19:45.286210 [debug] [ThreadPool]: On list_airflow_staging_dim: ROLLBACK
[0m23:19:45.286508 [debug] [ThreadPool]: On list_airflow_staging_dim: Close
[0m23:19:45.288499 [debug] [MainThread]: Using postgres connection "master"
[0m23:19:45.288712 [debug] [MainThread]: On master: BEGIN
[0m23:19:45.288891 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:19:45.290260 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m23:19:45.290478 [debug] [MainThread]: Using postgres connection "master"
[0m23:19:45.290724 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:19:45.293476 [debug] [MainThread]: SQL status: SELECT 1 in 0.003 seconds
[0m23:19:45.294019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '13c00a52-3af8-48f6-9a30-0aaed3d3ceff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89705710>]}
[0m23:19:45.294269 [debug] [MainThread]: On master: ROLLBACK
[0m23:19:45.294529 [debug] [MainThread]: Using postgres connection "master"
[0m23:19:45.294693 [debug] [MainThread]: On master: BEGIN
[0m23:19:45.295026 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:19:45.295239 [debug] [MainThread]: On master: COMMIT
[0m23:19:45.295414 [debug] [MainThread]: Using postgres connection "master"
[0m23:19:45.295582 [debug] [MainThread]: On master: COMMIT
[0m23:19:45.295832 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:19:45.296008 [debug] [MainThread]: On master: Close
[0m23:19:45.297233 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.dim_stations
[0m23:19:45.297531 [info ] [Thread-1 (]: 1 of 1 START sql view model staging_dim.dim_stations ........................... [RUN]
[0m23:19:45.297892 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_staging_dim, now model.etl_waterlevel.dim_stations)
[0m23:19:45.298141 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.dim_stations
[0m23:19:45.301021 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.dim_stations"
[0m23:19:45.301711 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.dim_stations
[0m23:19:45.317352 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.dim_stations"
[0m23:19:45.318270 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m23:19:45.318481 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: BEGIN
[0m23:19:45.318692 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:19:45.320143 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m23:19:45.320355 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m23:19:45.320551 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.dim_stations"} */

  create view "airflow"."staging_dim"."dim_stations__dbt_tmp"
    
    
  as (
    -- models/dimensions/dim_stations.sql

with station_names as (
  select distinct
    "stationId"     as station_id,
    "stationName"   as station_name,
    "stationCode"   as station_code,
    "stationStatus" as station_status
  from raw.waterlevels
)

select * from station_names
  );
[0m23:19:45.321510 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m23:19:45.324163 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m23:19:45.324357 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.dim_stations"} */
alter table "airflow"."staging_dim"."dim_stations" rename to "dim_stations__dbt_backup"
[0m23:19:45.324668 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:19:45.325884 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m23:19:45.326050 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.dim_stations"} */
alter table "airflow"."staging_dim"."dim_stations__dbt_tmp" rename to "dim_stations"
[0m23:19:45.326310 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:19:45.333472 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: COMMIT
[0m23:19:45.333687 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m23:19:45.333884 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: COMMIT
[0m23:19:45.334629 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:19:45.337238 [debug] [Thread-1 (]: Applying DROP to: "airflow"."staging_dim"."dim_stations__dbt_backup"
[0m23:19:45.339217 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m23:19:45.339401 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.dim_stations"} */
drop view if exists "airflow"."staging_dim"."dim_stations__dbt_backup" cascade
[0m23:19:45.340011 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m23:19:45.341053 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: Close
[0m23:19:45.341820 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13c00a52-3af8-48f6-9a30-0aaed3d3ceff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff897faa10>]}
[0m23:19:45.342144 [info ] [Thread-1 (]: 1 of 1 OK created sql view model staging_dim.dim_stations ...................... [[32mCREATE VIEW[0m in 0.04s]
[0m23:19:45.342475 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.dim_stations
[0m23:19:45.343197 [debug] [MainThread]: Using postgres connection "master"
[0m23:19:45.343371 [debug] [MainThread]: On master: BEGIN
[0m23:19:45.343517 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:19:45.344777 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m23:19:45.344974 [debug] [MainThread]: On master: COMMIT
[0m23:19:45.345157 [debug] [MainThread]: Using postgres connection "master"
[0m23:19:45.345298 [debug] [MainThread]: On master: COMMIT
[0m23:19:45.345467 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:19:45.345600 [debug] [MainThread]: On master: Close
[0m23:19:45.345777 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:19:45.345915 [debug] [MainThread]: Connection 'model.etl_waterlevel.dim_stations' was properly closed.
[0m23:19:45.346061 [info ] [MainThread]: 
[0m23:19:45.346226 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.09 seconds (0.09s).
[0m23:19:45.346652 [debug] [MainThread]: Command end result
[0m23:19:45.358822 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m23:19:45.359771 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m23:19:45.363076 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m23:19:45.363294 [info ] [MainThread]: 
[0m23:19:45.363546 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:19:45.363788 [info ] [MainThread]: 
[0m23:19:45.364039 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:19:45.364562 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.31563604, "process_in_blocks": "0", "process_kernel_time": 0.074885, "process_mem_max_rss": "113624", "process_out_blocks": "1653", "process_user_time": 0.785793}
[0m23:19:45.364817 [debug] [MainThread]: Command `dbt run` succeeded at 23:19:45.364773 after 0.32 seconds
[0m23:19:45.365005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8eed5590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ed85290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ed85150>]}
[0m23:19:45.365184 [debug] [MainThread]: Flushing usage events
[0m23:19:46.662853 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:20:09.693091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e736390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ecf01d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e735ed0>]}


============================== 23:20:09.694482 | 1c870422-c7ef-49db-a8fd-e66172ab655c ==============================
[0m23:20:09.694482 [info ] [MainThread]: Running with dbt=1.9.0
[0m23:20:09.694865 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt compile -m dim_stations', 'send_anonymous_usage_stats': 'True'}
[0m23:20:09.756138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1c870422-c7ef-49db-a8fd-e66172ab655c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e590b10>]}
[0m23:20:09.778643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1c870422-c7ef-49db-a8fd-e66172ab655c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa11a9ad0>]}
[0m23:20:09.779082 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:20:09.803672 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m23:20:09.829183 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m23:20:09.829485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1c870422-c7ef-49db-a8fd-e66172ab655c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f35c2d0>]}
[0m23:20:10.082175 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.etl_waterlevel.dimensions
- models.etl_waterlevel.staging
[0m23:20:10.084397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1c870422-c7ef-49db-a8fd-e66172ab655c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9dac1a50>]}
[0m23:20:10.103818 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m23:20:10.105258 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m23:20:10.135846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1c870422-c7ef-49db-a8fd-e66172ab655c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9db94990>]}
[0m23:20:10.136221 [info ] [MainThread]: Found 433 macros
[0m23:20:10.136488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1c870422-c7ef-49db-a8fd-e66172ab655c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d813b10>]}
[0m23:20:10.136979 [warn ] [MainThread]: The selection criterion 'dim_stations' does not match any enabled nodes
[0m23:20:10.137633 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m23:20:10.138038 [debug] [MainThread]: Command end result
[0m23:20:10.149556 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m23:20:10.150425 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m23:20:10.151951 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m23:20:10.152391 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 0.4801127, "process_in_blocks": "0", "process_kernel_time": 0.058989, "process_mem_max_rss": "105636", "process_out_blocks": "2427", "process_user_time": 0.981824}
[0m23:20:10.152590 [debug] [MainThread]: Command `dbt compile` succeeded at 23:20:10.152552 after 0.48 seconds
[0m23:20:10.152763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa30756d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3074890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3075850>]}
[0m23:20:10.152947 [debug] [MainThread]: Flushing usage events
[0m23:20:11.302926 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:29:03.663933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84343110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8435e510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8419e9d0>]}


============================== 23:29:03.665318 | 7eab445a-5816-4d49-b1fb-7e3584b2b088 ==============================
[0m23:29:03.665318 [info ] [MainThread]: Running with dbt=1.9.0
[0m23:29:03.665754 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt compile -m dim_stations', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:29:03.725647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7eab445a-5816-4d49-b1fb-7e3584b2b088', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8370b590>]}
[0m23:29:03.747519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7eab445a-5816-4d49-b1fb-7e3584b2b088', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86d7a6d0>]}
[0m23:29:03.747898 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:29:03.772208 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m23:29:03.790462 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m23:29:03.790779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7eab445a-5816-4d49-b1fb-7e3584b2b088', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8483a750>]}
[0m23:29:04.150848 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m23:29:04.153318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7eab445a-5816-4d49-b1fb-7e3584b2b088', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff851e4ed0>]}
[0m23:29:04.182412 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m23:29:04.183943 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m23:29:04.189020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7eab445a-5816-4d49-b1fb-7e3584b2b088', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8338a9d0>]}
[0m23:29:04.189279 [info ] [MainThread]: Found 1 model, 434 macros
[0m23:29:04.189467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7eab445a-5816-4d49-b1fb-7e3584b2b088', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff835297d0>]}
[0m23:29:04.190200 [info ] [MainThread]: 
[0m23:29:04.190436 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:29:04.190651 [info ] [MainThread]: 
[0m23:29:04.191003 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:29:04.191499 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow_dim'
[0m23:29:04.205804 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m23:29:04.206064 [debug] [ThreadPool]: On list_airflow_dim: BEGIN
[0m23:29:04.206266 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:29:04.208459 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m23:29:04.208725 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m23:29:04.208939 [debug] [ThreadPool]: On list_airflow_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dim'
  
[0m23:29:04.210203 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.001 seconds
[0m23:29:04.210744 [debug] [ThreadPool]: On list_airflow_dim: ROLLBACK
[0m23:29:04.211028 [debug] [ThreadPool]: On list_airflow_dim: Close
[0m23:29:04.213087 [debug] [MainThread]: Using postgres connection "master"
[0m23:29:04.213277 [debug] [MainThread]: On master: BEGIN
[0m23:29:04.213447 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:29:04.214970 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m23:29:04.215212 [debug] [MainThread]: Using postgres connection "master"
[0m23:29:04.215438 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:29:04.218261 [debug] [MainThread]: SQL status: SELECT 1 in 0.003 seconds
[0m23:29:04.218854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7eab445a-5816-4d49-b1fb-7e3584b2b088', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82f2c450>]}
[0m23:29:04.219171 [debug] [MainThread]: On master: ROLLBACK
[0m23:29:04.219428 [debug] [MainThread]: On master: Close
[0m23:29:04.220969 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.dim_stations
[0m23:29:04.221252 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_dim, now model.etl_waterlevel.dim_stations)
[0m23:29:04.221459 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.dim_stations
[0m23:29:04.224736 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.dim_stations"
[0m23:29:04.225475 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.dim_stations
[0m23:29:04.225798 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.dim_stations
[0m23:29:04.226403 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:29:04.226574 [debug] [MainThread]: Connection 'model.etl_waterlevel.dim_stations' was properly closed.
[0m23:29:04.226910 [debug] [MainThread]: Command end result
[0m23:29:04.237846 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m23:29:04.238835 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m23:29:04.241773 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m23:29:04.241954 [info ] [MainThread]: Compiled node 'dim_stations' is:
-- models/dimensions/dim_stations.sql

with station_names as (
  select distinct
    "stationId"     as station_id,
    "stationName"   as station_name,
    "stationCode"   as station_code,
    "stationStatus" as station_status
  from raw.waterlevels
)

select * from station_names
[0m23:29:04.242519 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 0.5995151, "process_in_blocks": "0", "process_kernel_time": 0.058949, "process_mem_max_rss": "114940", "process_out_blocks": "2460", "process_user_time": 1.084071}
[0m23:29:04.242738 [debug] [MainThread]: Command `dbt compile` succeeded at 23:29:04.242700 after 0.60 seconds
[0m23:29:04.242908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8443a1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84e3f310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88c29290>]}
[0m23:29:04.243087 [debug] [MainThread]: Flushing usage events
[0m23:29:05.425285 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:29:11.950195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaff433d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0b69250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaff43bd0>]}


============================== 23:29:11.951578 | 4f253dea-570d-4233-ab79-a53b51598499 ==============================
[0m23:29:11.951578 [info ] [MainThread]: Running with dbt=1.9.0
[0m23:29:11.952095 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:29:12.011665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4f253dea-570d-4233-ab79-a53b51598499', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffafd8ded0>]}
[0m23:29:12.033689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4f253dea-570d-4233-ab79-a53b51598499', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb297a5d0>]}
[0m23:29:12.034102 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:29:12.058275 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m23:29:12.093923 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:29:12.094169 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:29:12.096432 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m23:29:12.105182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4f253dea-570d-4233-ab79-a53b51598499', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf1741d0>]}
[0m23:29:12.132796 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m23:29:12.134171 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m23:29:12.139195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4f253dea-570d-4233-ab79-a53b51598499', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffafd8c1d0>]}
[0m23:29:12.139436 [info ] [MainThread]: Found 1 model, 434 macros
[0m23:29:12.139633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4f253dea-570d-4233-ab79-a53b51598499', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf0cc910>]}
[0m23:29:12.140367 [info ] [MainThread]: 
[0m23:29:12.140596 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:29:12.140827 [info ] [MainThread]: 
[0m23:29:12.141168 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:29:12.141666 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m23:29:12.156137 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m23:29:12.156376 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m23:29:12.156568 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:29:12.158906 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.002 seconds
[0m23:29:12.159510 [debug] [ThreadPool]: On list_airflow: Close
[0m23:29:12.159861 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now create_airflow_dim)
[0m23:29:12.160160 [debug] [ThreadPool]: Creating schema "database: "airflow"
schema: "dim"
"
[0m23:29:12.162608 [debug] [ThreadPool]: Using postgres connection "create_airflow_dim"
[0m23:29:12.162798 [debug] [ThreadPool]: On create_airflow_dim: BEGIN
[0m23:29:12.162989 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:29:12.164419 [debug] [ThreadPool]: SQL status: BEGIN in 0.001 seconds
[0m23:29:12.164687 [debug] [ThreadPool]: Using postgres connection "create_airflow_dim"
[0m23:29:12.164865 [debug] [ThreadPool]: On create_airflow_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "create_airflow_dim"} */
create schema if not exists "dim"
[0m23:29:12.165823 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.001 seconds
[0m23:29:12.166310 [debug] [ThreadPool]: On create_airflow_dim: COMMIT
[0m23:29:12.166496 [debug] [ThreadPool]: Using postgres connection "create_airflow_dim"
[0m23:29:12.166672 [debug] [ThreadPool]: On create_airflow_dim: COMMIT
[0m23:29:12.167345 [debug] [ThreadPool]: SQL status: COMMIT in 0.000 seconds
[0m23:29:12.167524 [debug] [ThreadPool]: On create_airflow_dim: Close
[0m23:29:12.168127 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_airflow_dim, now list_airflow_dim)
[0m23:29:12.170580 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m23:29:12.170764 [debug] [ThreadPool]: On list_airflow_dim: BEGIN
[0m23:29:12.170906 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:29:12.172101 [debug] [ThreadPool]: SQL status: BEGIN in 0.001 seconds
[0m23:29:12.172305 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m23:29:12.172476 [debug] [ThreadPool]: On list_airflow_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dim'
  
[0m23:29:12.173690 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.001 seconds
[0m23:29:12.174181 [debug] [ThreadPool]: On list_airflow_dim: ROLLBACK
[0m23:29:12.174366 [debug] [ThreadPool]: On list_airflow_dim: Close
[0m23:29:12.176231 [debug] [MainThread]: Using postgres connection "master"
[0m23:29:12.176440 [debug] [MainThread]: On master: BEGIN
[0m23:29:12.176618 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:29:12.178003 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m23:29:12.178254 [debug] [MainThread]: Using postgres connection "master"
[0m23:29:12.178492 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:29:12.181281 [debug] [MainThread]: SQL status: SELECT 1 in 0.003 seconds
[0m23:29:12.181795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4f253dea-570d-4233-ab79-a53b51598499', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf08e710>]}
[0m23:29:12.182045 [debug] [MainThread]: On master: ROLLBACK
[0m23:29:12.182313 [debug] [MainThread]: Using postgres connection "master"
[0m23:29:12.182482 [debug] [MainThread]: On master: BEGIN
[0m23:29:12.182812 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:29:12.183027 [debug] [MainThread]: On master: COMMIT
[0m23:29:12.183201 [debug] [MainThread]: Using postgres connection "master"
[0m23:29:12.183366 [debug] [MainThread]: On master: COMMIT
[0m23:29:12.183613 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:29:12.183792 [debug] [MainThread]: On master: Close
[0m23:29:12.184943 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.dim_stations
[0m23:29:12.185290 [info ] [Thread-1 (]: 1 of 1 START sql view model dim.dim_stations ................................... [RUN]
[0m23:29:12.185587 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_dim, now model.etl_waterlevel.dim_stations)
[0m23:29:12.185841 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.dim_stations
[0m23:29:12.188721 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.dim_stations"
[0m23:29:12.189497 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.dim_stations
[0m23:29:12.205051 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.dim_stations"
[0m23:29:12.205805 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m23:29:12.206007 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: BEGIN
[0m23:29:12.206195 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:29:12.207687 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m23:29:12.207965 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m23:29:12.208163 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.dim_stations"} */

  create view "airflow"."dim"."dim_stations__dbt_tmp"
    
    
  as (
    -- models/dimensions/dim_stations.sql

with station_names as (
  select distinct
    "stationId"     as station_id,
    "stationName"   as station_name,
    "stationCode"   as station_code,
    "stationStatus" as station_status
  from raw.waterlevels
)

select * from station_names
  );
[0m23:29:12.209325 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m23:29:12.211888 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m23:29:12.212081 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.dim_stations"} */
alter table "airflow"."dim"."dim_stations__dbt_tmp" rename to "dim_stations"
[0m23:29:12.212370 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:29:12.218578 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: COMMIT
[0m23:29:12.218822 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m23:29:12.219141 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: COMMIT
[0m23:29:12.219915 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:29:12.222456 [debug] [Thread-1 (]: Applying DROP to: "airflow"."dim"."dim_stations__dbt_backup"
[0m23:29:12.224408 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m23:29:12.224595 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.dim_stations"} */
drop view if exists "airflow"."dim"."dim_stations__dbt_backup" cascade
[0m23:29:12.224847 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m23:29:12.225838 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: Close
[0m23:29:12.226574 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f253dea-570d-4233-ab79-a53b51598499', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae4a5110>]}
[0m23:29:12.226903 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dim.dim_stations .............................. [[32mCREATE VIEW[0m in 0.04s]
[0m23:29:12.227217 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.dim_stations
[0m23:29:12.227919 [debug] [MainThread]: Using postgres connection "master"
[0m23:29:12.228135 [debug] [MainThread]: On master: BEGIN
[0m23:29:12.228283 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:29:12.229516 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m23:29:12.229709 [debug] [MainThread]: On master: COMMIT
[0m23:29:12.229886 [debug] [MainThread]: Using postgres connection "master"
[0m23:29:12.230038 [debug] [MainThread]: On master: COMMIT
[0m23:29:12.230251 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:29:12.230407 [debug] [MainThread]: On master: Close
[0m23:29:12.230590 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:29:12.230726 [debug] [MainThread]: Connection 'model.etl_waterlevel.dim_stations' was properly closed.
[0m23:29:12.230871 [info ] [MainThread]: 
[0m23:29:12.231141 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.09 seconds (0.09s).
[0m23:29:12.231548 [debug] [MainThread]: Command end result
[0m23:29:12.243977 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m23:29:12.245088 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m23:29:12.247860 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m23:29:12.248039 [info ] [MainThread]: 
[0m23:29:12.248278 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:29:12.248475 [info ] [MainThread]: 
[0m23:29:12.248724 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:29:12.249224 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.32000992, "process_in_blocks": "0", "process_kernel_time": 0.062709, "process_mem_max_rss": "113760", "process_out_blocks": "1655", "process_user_time": 0.79233}
[0m23:29:12.249439 [debug] [MainThread]: Command `dbt run` succeeded at 23:29:12.249397 after 0.32 seconds
[0m23:29:12.249624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffafdbbf50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffafdbbe50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaff5dd50>]}
[0m23:29:12.249797 [debug] [MainThread]: Flushing usage events
[0m23:29:13.449894 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:30:15.459167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9343ec90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93656510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9343ded0>]}


============================== 23:30:15.460584 | 9d83848d-7350-48c3-90c2-70569d7605bc ==============================
[0m23:30:15.460584 [info ] [MainThread]: Running with dbt=1.9.0
[0m23:30:15.460944 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt compile -m dim_stations', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:30:15.520639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9d83848d-7350-48c3-90c2-70569d7605bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92869350>]}
[0m23:30:15.542247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9d83848d-7350-48c3-90c2-70569d7605bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95ec84d0>]}
[0m23:30:15.542617 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:30:15.567174 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m23:30:15.602735 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:30:15.603045 [debug] [MainThread]: Partial parsing: updated file: etl_waterlevel://macros/generate_schema_name.sql
[0m23:30:15.604012 [info ] [MainThread]: Unable to do partial parsing because change detected to override macro. Starting full parse.
[0m23:30:15.944800 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m23:30:15.947168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9d83848d-7350-48c3-90c2-70569d7605bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92800650>]}
[0m23:30:15.975031 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m23:30:15.976461 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m23:30:15.981300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9d83848d-7350-48c3-90c2-70569d7605bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92435410>]}
[0m23:30:15.981600 [info ] [MainThread]: Found 1 model, 434 macros
[0m23:30:15.981841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d83848d-7350-48c3-90c2-70569d7605bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92661c50>]}
[0m23:30:15.982561 [info ] [MainThread]: 
[0m23:30:15.982771 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:30:15.982977 [info ] [MainThread]: 
[0m23:30:15.983365 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:30:15.983844 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow_----     dim
----'
[0m23:30:15.998657 [debug] [ThreadPool]: Using postgres connection "list_airflow_----     dim
----"
[0m23:30:15.998930 [debug] [ThreadPool]: On list_airflow_----     dim
----: BEGIN
[0m23:30:15.999188 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:30:16.001435 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m23:30:16.001652 [debug] [ThreadPool]: Using postgres connection "list_airflow_----     dim
----"
[0m23:30:16.001849 [debug] [ThreadPool]: On list_airflow_----     dim
----: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_----     dim\n----"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike '----     dim
----'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike '----     dim
----'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike '----     dim
----'
  
[0m23:30:16.003233 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.001 seconds
[0m23:30:16.003797 [debug] [ThreadPool]: On list_airflow_----     dim
----: ROLLBACK
[0m23:30:16.004077 [debug] [ThreadPool]: On list_airflow_----     dim
----: Close
[0m23:30:16.006416 [debug] [MainThread]: Using postgres connection "master"
[0m23:30:16.006644 [debug] [MainThread]: On master: BEGIN
[0m23:30:16.006824 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:30:16.008291 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m23:30:16.008498 [debug] [MainThread]: Using postgres connection "master"
[0m23:30:16.008718 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:30:16.011520 [debug] [MainThread]: SQL status: SELECT 2 in 0.003 seconds
[0m23:30:16.012079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d83848d-7350-48c3-90c2-70569d7605bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91b1b950>]}
[0m23:30:16.012337 [debug] [MainThread]: On master: ROLLBACK
[0m23:30:16.012595 [debug] [MainThread]: On master: Close
[0m23:30:16.014182 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.dim_stations
[0m23:30:16.014455 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_----     dim
----, now model.etl_waterlevel.dim_stations)
[0m23:30:16.014665 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.dim_stations
[0m23:30:16.017649 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.dim_stations"
[0m23:30:16.018335 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.dim_stations
[0m23:30:16.018663 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.dim_stations
[0m23:30:16.019277 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:30:16.019457 [debug] [MainThread]: Connection 'model.etl_waterlevel.dim_stations' was properly closed.
[0m23:30:16.019737 [debug] [MainThread]: Command end result
[0m23:30:16.030861 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m23:30:16.031823 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m23:30:16.034853 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m23:30:16.035036 [info ] [MainThread]: Compiled node 'dim_stations' is:
-- models/dimensions/dim_stations.sql

with station_names as (
  select distinct
    "stationId"     as station_id,
    "stationName"   as station_name,
    "stationCode"   as station_code,
    "stationStatus" as station_status
  from raw.waterlevels
)

select * from station_names
[0m23:30:16.035620 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 0.59710324, "process_in_blocks": "0", "process_kernel_time": 0.061471, "process_mem_max_rss": "115080", "process_out_blocks": "2462", "process_user_time": 1.086338}
[0m23:30:16.035858 [debug] [MainThread]: Command `dbt compile` succeeded at 23:30:16.035813 after 0.60 seconds
[0m23:30:16.036045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97da5190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97da4890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97da5850>]}
[0m23:30:16.036240 [debug] [MainThread]: Flushing usage events
[0m23:30:17.353272 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:30:26.612749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89d8c610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89f3b450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89f38490>]}


============================== 23:30:26.614162 | d28c7ef0-1e56-4065-af4e-5d570b58d921 ==============================
[0m23:30:26.614162 [info ] [MainThread]: Running with dbt=1.9.0
[0m23:30:26.614551 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m23:30:26.673871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd28c7ef0-1e56-4065-af4e-5d570b58d921', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff893fc390>]}
[0m23:30:26.695751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd28c7ef0-1e56-4065-af4e-5d570b58d921', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ca388d0>]}
[0m23:30:26.696119 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:30:26.720258 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m23:30:26.755781 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:30:26.756006 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:30:26.758235 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m23:30:26.766933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd28c7ef0-1e56-4065-af4e-5d570b58d921', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89204350>]}
[0m23:30:26.793753 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m23:30:26.795142 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m23:30:26.801448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd28c7ef0-1e56-4065-af4e-5d570b58d921', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff892153d0>]}
[0m23:30:26.801721 [info ] [MainThread]: Found 1 model, 434 macros
[0m23:30:26.801959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd28c7ef0-1e56-4065-af4e-5d570b58d921', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89393c90>]}
[0m23:30:26.802725 [info ] [MainThread]: 
[0m23:30:26.802963 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:30:26.803213 [info ] [MainThread]: 
[0m23:30:26.803566 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:30:26.804067 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m23:30:26.818562 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m23:30:26.818807 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m23:30:26.818995 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:30:26.821452 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.002 seconds
[0m23:30:26.822052 [debug] [ThreadPool]: On list_airflow: Close
[0m23:30:26.822416 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now create_airflow_----     dim
----)
[0m23:30:26.822718 [debug] [ThreadPool]: Creating schema "database: "airflow"
schema: "----     dim\n----"
"
[0m23:30:26.825254 [debug] [ThreadPool]: Using postgres connection "create_airflow_----     dim
----"
[0m23:30:26.825472 [debug] [ThreadPool]: On create_airflow_----     dim
----: BEGIN
[0m23:30:26.825658 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:30:26.827063 [debug] [ThreadPool]: SQL status: BEGIN in 0.001 seconds
[0m23:30:26.827308 [debug] [ThreadPool]: Using postgres connection "create_airflow_----     dim
----"
[0m23:30:26.827552 [debug] [ThreadPool]: On create_airflow_----     dim
----: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "create_airflow_----     dim\n----"} */
create schema if not exists "----     dim
----"
[0m23:30:26.827935 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.000 seconds
[0m23:30:26.828335 [debug] [ThreadPool]: On create_airflow_----     dim
----: COMMIT
[0m23:30:26.828525 [debug] [ThreadPool]: Using postgres connection "create_airflow_----     dim
----"
[0m23:30:26.828693 [debug] [ThreadPool]: On create_airflow_----     dim
----: COMMIT
[0m23:30:26.829167 [debug] [ThreadPool]: SQL status: COMMIT in 0.000 seconds
[0m23:30:26.829340 [debug] [ThreadPool]: On create_airflow_----     dim
----: Close
[0m23:30:26.829943 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_airflow_----     dim
----, now list_airflow_----     dim
----)
[0m23:30:26.832424 [debug] [ThreadPool]: Using postgres connection "list_airflow_----     dim
----"
[0m23:30:26.832595 [debug] [ThreadPool]: On list_airflow_----     dim
----: BEGIN
[0m23:30:26.832721 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:30:26.833901 [debug] [ThreadPool]: SQL status: BEGIN in 0.001 seconds
[0m23:30:26.834075 [debug] [ThreadPool]: Using postgres connection "list_airflow_----     dim
----"
[0m23:30:26.834225 [debug] [ThreadPool]: On list_airflow_----     dim
----: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_----     dim\n----"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike '----     dim
----'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike '----     dim
----'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike '----     dim
----'
  
[0m23:30:26.835561 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.001 seconds
[0m23:30:26.836079 [debug] [ThreadPool]: On list_airflow_----     dim
----: ROLLBACK
[0m23:30:26.836296 [debug] [ThreadPool]: On list_airflow_----     dim
----: Close
[0m23:30:26.838148 [debug] [MainThread]: Using postgres connection "master"
[0m23:30:26.838349 [debug] [MainThread]: On master: BEGIN
[0m23:30:26.838496 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:30:26.839733 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m23:30:26.839947 [debug] [MainThread]: Using postgres connection "master"
[0m23:30:26.840171 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:30:26.842937 [debug] [MainThread]: SQL status: SELECT 2 in 0.002 seconds
[0m23:30:26.843505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd28c7ef0-1e56-4065-af4e-5d570b58d921', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff891fb990>]}
[0m23:30:26.843749 [debug] [MainThread]: On master: ROLLBACK
[0m23:30:26.844016 [debug] [MainThread]: Using postgres connection "master"
[0m23:30:26.844194 [debug] [MainThread]: On master: BEGIN
[0m23:30:26.844524 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:30:26.844723 [debug] [MainThread]: On master: COMMIT
[0m23:30:26.844896 [debug] [MainThread]: Using postgres connection "master"
[0m23:30:26.845068 [debug] [MainThread]: On master: COMMIT
[0m23:30:26.845304 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:30:26.845482 [debug] [MainThread]: On master: Close
[0m23:30:26.846676 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.dim_stations
[0m23:30:26.846967 [info ] [Thread-1 (]: 1 of 1 START sql view model ----     dim
----.dim_stations ..................... [RUN]
[0m23:30:26.847244 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_----     dim
----, now model.etl_waterlevel.dim_stations)
[0m23:30:26.847498 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.dim_stations
[0m23:30:26.850430 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.dim_stations"
[0m23:30:26.851116 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.dim_stations
[0m23:30:26.866583 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.dim_stations"
[0m23:30:26.867470 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m23:30:26.867680 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: BEGIN
[0m23:30:26.867868 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:30:26.869344 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m23:30:26.869592 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m23:30:26.869821 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.dim_stations"} */

  create view "airflow"."----     dim
----"."dim_stations__dbt_tmp"
    
    
  as (
    -- models/dimensions/dim_stations.sql

with station_names as (
  select distinct
    "stationId"     as station_id,
    "stationName"   as station_name,
    "stationCode"   as station_code,
    "stationStatus" as station_status
  from raw.waterlevels
)

select * from station_names
  );
[0m23:30:26.870751 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m23:30:26.873393 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m23:30:26.873608 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.dim_stations"} */
alter table "airflow"."----     dim
----"."dim_stations__dbt_tmp" rename to "dim_stations"
[0m23:30:26.873909 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:30:26.880278 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: COMMIT
[0m23:30:26.880545 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m23:30:26.880811 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: COMMIT
[0m23:30:26.881516 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:30:26.884034 [debug] [Thread-1 (]: Applying DROP to: "airflow"."----     dim
----"."dim_stations__dbt_backup"
[0m23:30:26.886055 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m23:30:26.886264 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.dim_stations"} */
drop view if exists "airflow"."----     dim
----"."dim_stations__dbt_backup" cascade
[0m23:30:26.886518 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m23:30:26.887505 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: Close
[0m23:30:26.888225 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd28c7ef0-1e56-4065-af4e-5d570b58d921', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88377e10>]}
[0m23:30:26.888550 [info ] [Thread-1 (]: 1 of 1 OK created sql view model ----     dim
----.dim_stations ................ [[32mCREATE VIEW[0m in 0.04s]
[0m23:30:26.888925 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.dim_stations
[0m23:30:26.889640 [debug] [MainThread]: Using postgres connection "master"
[0m23:30:26.889787 [debug] [MainThread]: On master: BEGIN
[0m23:30:26.889906 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:30:26.891218 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m23:30:26.891481 [debug] [MainThread]: On master: COMMIT
[0m23:30:26.891683 [debug] [MainThread]: Using postgres connection "master"
[0m23:30:26.891862 [debug] [MainThread]: On master: COMMIT
[0m23:30:26.892121 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:30:26.892297 [debug] [MainThread]: On master: Close
[0m23:30:26.892539 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:30:26.892700 [debug] [MainThread]: Connection 'model.etl_waterlevel.dim_stations' was properly closed.
[0m23:30:26.892898 [info ] [MainThread]: 
[0m23:30:26.893106 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.09 seconds (0.09s).
[0m23:30:26.893540 [debug] [MainThread]: Command end result
[0m23:30:26.906269 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m23:30:26.907186 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m23:30:26.910055 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m23:30:26.910218 [info ] [MainThread]: 
[0m23:30:26.910525 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:30:26.910720 [info ] [MainThread]: 
[0m23:30:26.910968 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:30:26.911444 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.31970137, "process_in_blocks": "0", "process_kernel_time": 0.072208, "process_mem_max_rss": "113732", "process_out_blocks": "1658", "process_user_time": 0.788271}
[0m23:30:26.911641 [debug] [MainThread]: Command `dbt run` succeeded at 23:30:26.911606 after 0.32 seconds
[0m23:30:26.911836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a152150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8aa3b790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e8e9490>]}
[0m23:30:26.911999 [debug] [MainThread]: Flushing usage events
[0m23:30:28.304320 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:35:34.691923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9673f210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96955e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99399a50>]}


============================== 23:35:34.693315 | 7d09fad9-1a66-4811-b857-3e1354b91057 ==============================
[0m23:35:34.693315 [info ] [MainThread]: Running with dbt=1.9.0
[0m23:35:34.693669 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:35:34.734516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7d09fad9-1a66-4811-b857-3e1354b91057', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96593f10>]}
[0m23:35:34.743123 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.07196246, "process_in_blocks": "0", "process_kernel_time": 0.064158, "process_mem_max_rss": "96212", "process_out_blocks": "3", "process_user_time": 0.593469}
[0m23:35:34.743498 [debug] [MainThread]: Command `dbt clean` succeeded at 23:35:34.743413 after 0.07 seconds
[0m23:35:34.743819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b095150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b095290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b094710>]}
[0m23:35:34.744102 [debug] [MainThread]: Flushing usage events
[0m23:35:35.922299 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:35:41.799839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86143150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8874fa90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff861431d0>]}


============================== 23:35:41.801251 | aac3968c-9ad4-4c3e-ae1d-e06550c7e183 ==============================
[0m23:35:41.801251 [info ] [MainThread]: Running with dbt=1.9.0
[0m23:35:41.801619 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:35:41.862588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aac3968c-9ad4-4c3e-ae1d-e06550c7e183', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85f95650>]}
[0m23:35:41.884145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aac3968c-9ad4-4c3e-ae1d-e06550c7e183', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88bd4bd0>]}
[0m23:35:41.884520 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:35:41.908865 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m23:35:41.909432 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m23:35:41.909686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'aac3968c-9ad4-4c3e-ae1d-e06550c7e183', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff852daad0>]}
[0m23:35:42.248109 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m23:35:42.250576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aac3968c-9ad4-4c3e-ae1d-e06550c7e183', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8536b290>]}
[0m23:35:42.303674 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m23:35:42.305222 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m23:35:42.311231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aac3968c-9ad4-4c3e-ae1d-e06550c7e183', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85216c90>]}
[0m23:35:42.311500 [info ] [MainThread]: Found 1 model, 434 macros
[0m23:35:42.311681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aac3968c-9ad4-4c3e-ae1d-e06550c7e183', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff851c3510>]}
[0m23:35:42.312474 [info ] [MainThread]: 
[0m23:35:42.312729 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:35:42.312968 [info ] [MainThread]: 
[0m23:35:42.313317 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:35:42.313825 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m23:35:42.329213 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m23:35:42.329485 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m23:35:42.329680 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:35:42.332386 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.003 seconds
[0m23:35:42.333005 [debug] [ThreadPool]: On list_airflow: Close
[0m23:35:42.333664 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_dim)
[0m23:35:42.336343 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m23:35:42.336559 [debug] [ThreadPool]: On list_airflow_dim: BEGIN
[0m23:35:42.336772 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:35:42.338251 [debug] [ThreadPool]: SQL status: BEGIN in 0.001 seconds
[0m23:35:42.338490 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m23:35:42.338728 [debug] [ThreadPool]: On list_airflow_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dim'
  
[0m23:35:42.340250 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m23:35:42.340825 [debug] [ThreadPool]: On list_airflow_dim: ROLLBACK
[0m23:35:42.341086 [debug] [ThreadPool]: On list_airflow_dim: Close
[0m23:35:42.343405 [debug] [MainThread]: Using postgres connection "master"
[0m23:35:42.343625 [debug] [MainThread]: On master: BEGIN
[0m23:35:42.343814 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:35:42.345455 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m23:35:42.345734 [debug] [MainThread]: Using postgres connection "master"
[0m23:35:42.346002 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:35:42.349010 [debug] [MainThread]: SQL status: SELECT 3 in 0.003 seconds
[0m23:35:42.349580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aac3968c-9ad4-4c3e-ae1d-e06550c7e183', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff851def10>]}
[0m23:35:42.349842 [debug] [MainThread]: On master: ROLLBACK
[0m23:35:42.350185 [debug] [MainThread]: Using postgres connection "master"
[0m23:35:42.350421 [debug] [MainThread]: On master: BEGIN
[0m23:35:42.350776 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:35:42.351035 [debug] [MainThread]: On master: COMMIT
[0m23:35:42.351249 [debug] [MainThread]: Using postgres connection "master"
[0m23:35:42.351435 [debug] [MainThread]: On master: COMMIT
[0m23:35:42.351703 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:35:42.351897 [debug] [MainThread]: On master: Close
[0m23:35:42.353232 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.dim_stations
[0m23:35:42.353537 [info ] [Thread-1 (]: 1 of 1 START sql view model dim.dim_stations ................................... [RUN]
[0m23:35:42.353868 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_dim, now model.etl_waterlevel.dim_stations)
[0m23:35:42.354112 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.dim_stations
[0m23:35:42.357128 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.dim_stations"
[0m23:35:42.359350 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.dim_stations
[0m23:35:42.375550 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.dim_stations"
[0m23:35:42.376959 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m23:35:42.377180 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: BEGIN
[0m23:35:42.377406 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:35:42.379114 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m23:35:42.379401 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m23:35:42.379581 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.dim_stations"} */

  create view "airflow"."dim"."dim_stations__dbt_tmp"
    
    
  as (
    -- models/dimensions/dim_stations.sql

with station_names as (
  select distinct
    "stationId"     as station_id,
    "stationName"   as station_name,
    "stationCode"   as station_code,
    "stationStatus" as station_status
  from raw.waterlevels
)

select * from station_names
  );
[0m23:35:42.380969 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m23:35:42.383684 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m23:35:42.383899 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.dim_stations"} */
alter table "airflow"."dim"."dim_stations" rename to "dim_stations__dbt_backup"
[0m23:35:42.384237 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:35:42.385449 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m23:35:42.385646 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.dim_stations"} */
alter table "airflow"."dim"."dim_stations__dbt_tmp" rename to "dim_stations"
[0m23:35:42.385933 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:35:42.392949 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: COMMIT
[0m23:35:42.393207 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m23:35:42.393418 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: COMMIT
[0m23:35:42.394047 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m23:35:42.397247 [debug] [Thread-1 (]: Applying DROP to: "airflow"."dim"."dim_stations__dbt_backup"
[0m23:35:42.399312 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m23:35:42.399519 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.dim_stations"} */
drop view if exists "airflow"."dim"."dim_stations__dbt_backup" cascade
[0m23:35:42.400457 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:35:42.401476 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: Close
[0m23:35:42.402269 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aac3968c-9ad4-4c3e-ae1d-e06550c7e183', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85240c50>]}
[0m23:35:42.402607 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dim.dim_stations .............................. [[32mCREATE VIEW[0m in 0.05s]
[0m23:35:42.402952 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.dim_stations
[0m23:35:42.403697 [debug] [MainThread]: Using postgres connection "master"
[0m23:35:42.403893 [debug] [MainThread]: On master: BEGIN
[0m23:35:42.404035 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:35:42.405413 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m23:35:42.405618 [debug] [MainThread]: On master: COMMIT
[0m23:35:42.405777 [debug] [MainThread]: Using postgres connection "master"
[0m23:35:42.405922 [debug] [MainThread]: On master: COMMIT
[0m23:35:42.406117 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:35:42.406280 [debug] [MainThread]: On master: Close
[0m23:35:42.406470 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:35:42.406622 [debug] [MainThread]: Connection 'model.etl_waterlevel.dim_stations' was properly closed.
[0m23:35:42.406772 [info ] [MainThread]: 
[0m23:35:42.406955 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.09 seconds (0.09s).
[0m23:35:42.407361 [debug] [MainThread]: Command end result
[0m23:35:42.419720 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m23:35:42.420700 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m23:35:42.423507 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m23:35:42.423718 [info ] [MainThread]: 
[0m23:35:42.423993 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:35:42.424186 [info ] [MainThread]: 
[0m23:35:42.424397 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:35:42.424902 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.646062, "process_in_blocks": "0", "process_kernel_time": 0.078025, "process_mem_max_rss": "115792", "process_out_blocks": "2472", "process_user_time": 1.120732}
[0m23:35:42.425112 [debug] [MainThread]: Command `dbt run` succeeded at 23:35:42.425077 after 0.65 seconds
[0m23:35:42.425296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8615df10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85fb3dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86c43790>]}
[0m23:35:42.425484 [debug] [MainThread]: Flushing usage events
[0m23:35:43.695237 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:37:54.827263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8883cd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff889361d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88a55ed0>]}


============================== 23:37:54.828670 | 7cba5618-5d03-43d9-ae88-3725d56e9d70 ==============================
[0m23:37:54.828670 [info ] [MainThread]: Running with dbt=1.9.0
[0m23:37:54.829196 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select dim_stations', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:37:54.888339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7cba5618-5d03-43d9-ae88-3725d56e9d70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87c93990>]}
[0m23:37:54.910309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7cba5618-5d03-43d9-ae88-3725d56e9d70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b2c8410>]}
[0m23:37:54.910701 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:37:54.934935 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m23:37:54.971793 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:37:54.972017 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:37:54.974261 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m23:37:54.982934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7cba5618-5d03-43d9-ae88-3725d56e9d70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87aa05d0>]}
[0m23:37:55.010560 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m23:37:55.011950 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m23:37:55.017248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7cba5618-5d03-43d9-ae88-3725d56e9d70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87c64510>]}
[0m23:37:55.017473 [info ] [MainThread]: Found 1 model, 434 macros
[0m23:37:55.017655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7cba5618-5d03-43d9-ae88-3725d56e9d70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87a06250>]}
[0m23:37:55.018269 [info ] [MainThread]: 
[0m23:37:55.018545 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:37:55.018817 [info ] [MainThread]: 
[0m23:37:55.019176 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:37:55.019736 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m23:37:55.034283 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m23:37:55.034522 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m23:37:55.034739 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:37:55.037097 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.002 seconds
[0m23:37:55.037669 [debug] [ThreadPool]: On list_airflow: Close
[0m23:37:55.038305 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_dim)
[0m23:37:55.041051 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m23:37:55.041300 [debug] [ThreadPool]: On list_airflow_dim: BEGIN
[0m23:37:55.041481 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:37:55.042959 [debug] [ThreadPool]: SQL status: BEGIN in 0.001 seconds
[0m23:37:55.043217 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m23:37:55.043416 [debug] [ThreadPool]: On list_airflow_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dim'
  
[0m23:37:55.044670 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m23:37:55.045242 [debug] [ThreadPool]: On list_airflow_dim: ROLLBACK
[0m23:37:55.045505 [debug] [ThreadPool]: On list_airflow_dim: Close
[0m23:37:55.047404 [debug] [MainThread]: Using postgres connection "master"
[0m23:37:55.047598 [debug] [MainThread]: On master: BEGIN
[0m23:37:55.047827 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:37:55.049191 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m23:37:55.049417 [debug] [MainThread]: Using postgres connection "master"
[0m23:37:55.049639 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:37:55.052467 [debug] [MainThread]: SQL status: SELECT 2 in 0.003 seconds
[0m23:37:55.053067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7cba5618-5d03-43d9-ae88-3725d56e9d70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff878d6c50>]}
[0m23:37:55.053317 [debug] [MainThread]: On master: ROLLBACK
[0m23:37:55.053577 [debug] [MainThread]: Using postgres connection "master"
[0m23:37:55.053723 [debug] [MainThread]: On master: BEGIN
[0m23:37:55.054040 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:37:55.054276 [debug] [MainThread]: On master: COMMIT
[0m23:37:55.054455 [debug] [MainThread]: Using postgres connection "master"
[0m23:37:55.054621 [debug] [MainThread]: On master: COMMIT
[0m23:37:55.054888 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:37:55.055056 [debug] [MainThread]: On master: Close
[0m23:37:55.056279 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.dim_stations
[0m23:37:55.056566 [info ] [Thread-1 (]: 1 of 1 START sql view model dim.dim_stations ................................... [RUN]
[0m23:37:55.056895 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_dim, now model.etl_waterlevel.dim_stations)
[0m23:37:55.057109 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.dim_stations
[0m23:37:55.060010 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.dim_stations"
[0m23:37:55.060795 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.dim_stations
[0m23:37:55.076663 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.dim_stations"
[0m23:37:55.077453 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m23:37:55.077667 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: BEGIN
[0m23:37:55.077881 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:37:55.079452 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m23:37:55.079724 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m23:37:55.079947 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.dim_stations"} */

  create view "airflow"."dim"."dim_stations__dbt_tmp"
    
    
  as (
    -- models/dimensions/dim_stations.sql

with station_names as (
  select distinct
    "stationId"     as station_id,
    "stationName"   as station_name,
    "stationCode"   as station_code,
    "stationStatus" as station_status
  from raw.waterlevels
)

select * from station_names
  );
[0m23:37:55.081075 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m23:37:55.083733 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m23:37:55.083934 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.dim_stations"} */
alter table "airflow"."dim"."dim_stations" rename to "dim_stations__dbt_backup"
[0m23:37:55.084257 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:37:55.085536 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m23:37:55.085738 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.dim_stations"} */
alter table "airflow"."dim"."dim_stations__dbt_tmp" rename to "dim_stations"
[0m23:37:55.086057 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:37:55.092947 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: COMMIT
[0m23:37:55.093143 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m23:37:55.093310 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: COMMIT
[0m23:37:55.093737 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m23:37:55.096318 [debug] [Thread-1 (]: Applying DROP to: "airflow"."dim"."dim_stations__dbt_backup"
[0m23:37:55.098318 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m23:37:55.098501 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.dim_stations"} */
drop view if exists "airflow"."dim"."dim_stations__dbt_backup" cascade
[0m23:37:55.099085 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m23:37:55.100124 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: Close
[0m23:37:55.100907 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7cba5618-5d03-43d9-ae88-3725d56e9d70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86ca5a10>]}
[0m23:37:55.101241 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dim.dim_stations .............................. [[32mCREATE VIEW[0m in 0.04s]
[0m23:37:55.101556 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.dim_stations
[0m23:37:55.102284 [debug] [MainThread]: Using postgres connection "master"
[0m23:37:55.102481 [debug] [MainThread]: On master: BEGIN
[0m23:37:55.102643 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:37:55.103929 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m23:37:55.104126 [debug] [MainThread]: On master: COMMIT
[0m23:37:55.104291 [debug] [MainThread]: Using postgres connection "master"
[0m23:37:55.104437 [debug] [MainThread]: On master: COMMIT
[0m23:37:55.104622 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:37:55.104786 [debug] [MainThread]: On master: Close
[0m23:37:55.104981 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:37:55.105117 [debug] [MainThread]: Connection 'model.etl_waterlevel.dim_stations' was properly closed.
[0m23:37:55.105264 [info ] [MainThread]: 
[0m23:37:55.105499 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.09 seconds (0.09s).
[0m23:37:55.105843 [debug] [MainThread]: Command end result
[0m23:37:55.117976 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m23:37:55.118922 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m23:37:55.121670 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m23:37:55.121869 [info ] [MainThread]: 
[0m23:37:55.122148 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:37:55.122382 [info ] [MainThread]: 
[0m23:37:55.122611 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:37:55.123185 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.31685764, "process_in_blocks": "0", "process_kernel_time": 0.069731, "process_mem_max_rss": "113616", "process_out_blocks": "1654", "process_user_time": 0.788967}
[0m23:37:55.123388 [debug] [MainThread]: Command `dbt run` succeeded at 23:37:55.123353 after 0.32 seconds
[0m23:37:55.123559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8883ef50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8883ff50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8883e950>]}
[0m23:37:55.123739 [debug] [MainThread]: Flushing usage events
[0m23:37:56.318602 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:14:54.023543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d83fa90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d83f5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d83f350>]}


============================== 22:14:54.026592 | d2cec8a2-970f-4de5-b01e-027d5675dac2 ==============================
[0m22:14:54.026592 [info ] [MainThread]: Running with dbt=1.9.0
[0m22:14:54.027007 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt ls', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:14:54.102495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd2cec8a2-970f-4de5-b01e-027d5675dac2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cc73810>]}
[0m22:14:54.127560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd2cec8a2-970f-4de5-b01e-027d5675dac2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d67e750>]}
[0m22:14:54.128214 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:14:54.160736 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m22:14:54.201869 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m22:14:54.202182 [debug] [MainThread]: Partial parsing: updated file: dbt://macros/materializations/models/incremental/incremental.sql
[0m22:14:54.202370 [debug] [MainThread]: Partial parsing: updated file: dbt://macros/materializations/models/table.sql
[0m22:14:54.231529 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m22:14:54.233790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd2cec8a2-970f-4de5-b01e-027d5675dac2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ccc9c90>]}
[0m22:14:54.260005 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m22:14:54.261895 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m22:14:54.271975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd2cec8a2-970f-4de5-b01e-027d5675dac2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c8d7090>]}
[0m22:14:54.272244 [info ] [MainThread]: Found 1 model, 434 macros
[0m22:14:54.272458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd2cec8a2-970f-4de5-b01e-027d5675dac2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ccbdf50>]}
[0m22:14:54.272909 [info ] [MainThread]: etl_waterlevel.dimensions.dim_stations
[0m22:14:54.273499 [debug] [MainThread]: Resource report: {"command_name": "list", "command_success": true, "command_wall_clock_time": 0.27277055, "process_in_blocks": "0", "process_kernel_time": 0.500465, "process_mem_max_rss": "106372", "process_out_blocks": "1692", "process_user_time": 0.885823}
[0m22:14:54.273757 [debug] [MainThread]: Command `dbt ls` succeeded at 22:14:54.273710 after 0.27 seconds
[0m22:14:54.273948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e33f690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d83f210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d83fd90>]}
[0m22:14:54.274155 [debug] [MainThread]: Flushing usage events
[0m22:14:55.591644 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:15:10.114497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff802477d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80097990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80247610>]}


============================== 22:15:10.116024 | dfc09f9e-b686-4d17-9eab-68c271b0eb93 ==============================
[0m22:15:10.116024 [info ] [MainThread]: Running with dbt=1.9.0
[0m22:15:10.116468 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:15:10.120141 [info ] [MainThread]: dbt version: 1.9.0
[0m22:15:10.120454 [info ] [MainThread]: python version: 3.11.11
[0m22:15:10.120763 [info ] [MainThread]: python path: /usr/local/bin/python3.11
[0m22:15:10.121002 [info ] [MainThread]: os info: Linux-6.10.14-linuxkit-aarch64-with-glibc2.36
[0m22:15:10.140734 [info ] [MainThread]: Using profiles dir at /root/.dbt
[0m22:15:10.141032 [info ] [MainThread]: Using profiles.yml file at /root/.dbt/profiles.yml
[0m22:15:10.141297 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt_project.yml
[0m22:15:10.141629 [info ] [MainThread]: adapter type: postgres
[0m22:15:10.141835 [info ] [MainThread]: adapter version: 1.9.0
[0m22:15:10.179302 [info ] [MainThread]: Configuration:
[0m22:15:10.179555 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m22:15:10.179766 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m22:15:10.180017 [info ] [MainThread]: Required dependencies:
[0m22:15:10.180294 [debug] [MainThread]: Executing "git --help"
[0m22:15:10.181707 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m22:15:10.181925 [info ] [MainThread]: Connection:
[0m22:15:10.182196 [info ] [MainThread]:   host: postgres
[0m22:15:10.182436 [info ] [MainThread]:   port: 5432
[0m22:15:10.182675 [info ] [MainThread]:   user: airflow
[0m22:15:10.182917 [info ] [MainThread]:   database: airflow
[0m22:15:10.183169 [info ] [MainThread]:   schema: staging
[0m22:15:10.183426 [info ] [MainThread]:   connect_timeout: 10
[0m22:15:10.183651 [info ] [MainThread]:   role: None
[0m22:15:10.183888 [info ] [MainThread]:   search_path: None
[0m22:15:10.184109 [info ] [MainThread]:   keepalives_idle: 0
[0m22:15:10.184323 [info ] [MainThread]:   sslmode: None
[0m22:15:10.184524 [info ] [MainThread]:   sslcert: None
[0m22:15:10.184715 [info ] [MainThread]:   sslkey: None
[0m22:15:10.184936 [info ] [MainThread]:   sslrootcert: None
[0m22:15:10.185166 [info ] [MainThread]:   application_name: dbt
[0m22:15:10.185412 [info ] [MainThread]:   retries: 1
[0m22:15:10.185716 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:15:10.207525 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m22:15:10.229390 [debug] [MainThread]: Using postgres connection "debug"
[0m22:15:10.229597 [debug] [MainThread]: On debug: select 1 as id
[0m22:15:10.229741 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:15:10.239037 [debug] [MainThread]: SQL status: SELECT 1 in 0.009 seconds
[0m22:15:10.239461 [debug] [MainThread]: On debug: Close
[0m22:15:10.239630 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m22:15:10.239881 [info ] [MainThread]: [31m1 check failed:[0m
[0m22:15:10.240176 [info ] [MainThread]: Error from git --help: Could not find command, ensure it is in the user's PATH: "git"

[0m22:15:10.240655 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.14873254, "process_in_blocks": "0", "process_kernel_time": 0.099729, "process_mem_max_rss": "108144", "process_out_blocks": "8", "process_user_time": 0.623306}
[0m22:15:10.240861 [debug] [MainThread]: Command `dbt debug` failed at 22:15:10.240823 after 0.15 seconds
[0m22:15:10.241027 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m22:15:10.241347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff800bf910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f57e690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff800bcf50>]}
[0m22:15:10.241563 [debug] [MainThread]: Flushing usage events
[0m22:15:11.545719 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:29:58.964782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b237450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b437c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b236d90>]}


============================== 22:29:58.966324 | e91d8969-5dc4-4417-8d13-1d003ca2856d ==============================
[0m22:29:58.966324 [info ] [MainThread]: Running with dbt=1.9.0
[0m22:29:58.966684 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt ls', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:29:59.030354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e91d8969-5dc4-4417-8d13-1d003ca2856d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a6879d0>]}
[0m22:29:59.053178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e91d8969-5dc4-4417-8d13-1d003ca2856d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9dcc8f10>]}
[0m22:29:59.053635 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:29:59.080159 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m22:29:59.116720 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:29:59.117050 [debug] [MainThread]: Partial parsing: updated file: etl_waterlevel://models/dimensions/dim_stations.sql
[0m22:29:59.207491 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m22:29:59.209794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e91d8969-5dc4-4417-8d13-1d003ca2856d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a1f6850>]}
[0m22:29:59.236460 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m22:29:59.238132 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m22:29:59.242749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e91d8969-5dc4-4417-8d13-1d003ca2856d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a16d510>]}
[0m22:29:59.243006 [info ] [MainThread]: Found 1 model, 434 macros
[0m22:29:59.243190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e91d8969-5dc4-4417-8d13-1d003ca2856d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a20c710>]}
[0m22:29:59.243605 [info ] [MainThread]: etl_waterlevel.dimensions.dim_stations
[0m22:29:59.244180 [debug] [MainThread]: Resource report: {"command_name": "list", "command_success": true, "command_wall_clock_time": 0.30112284, "process_in_blocks": "0", "process_kernel_time": 0.081788, "process_mem_max_rss": "108820", "process_out_blocks": "1636", "process_user_time": 0.805913}
[0m22:29:59.244428 [debug] [MainThread]: Command `dbt ls` succeeded at 22:29:59.244382 after 0.30 seconds
[0m22:29:59.244625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b060510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a0bf810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b237e10>]}
[0m22:29:59.244840 [debug] [MainThread]: Flushing usage events
[0m22:30:00.374914 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:30:35.746536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf20ab50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf057b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf41de90>]}


============================== 22:30:35.748192 | 712b6775-43ab-4c44-bfa8-f21cf9294d36 ==============================
[0m22:30:35.748192 [info ] [MainThread]: Running with dbt=1.9.0
[0m22:30:35.748569 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/logs', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --select dims_stations', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:30:35.808695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '712b6775-43ab-4c44-bfa8-f21cf9294d36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae60f950>]}
[0m22:30:35.830689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '712b6775-43ab-4c44-bfa8-f21cf9294d36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1c2e990>]}
[0m22:30:35.831074 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:30:35.855269 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m22:30:35.891511 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:30:35.891738 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:30:35.894012 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m22:30:35.902773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '712b6775-43ab-4c44-bfa8-f21cf9294d36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf0a3990>]}
[0m22:30:35.930307 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m22:30:35.931679 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m22:30:35.940204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '712b6775-43ab-4c44-bfa8-f21cf9294d36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae4260d0>]}
[0m22:30:35.940475 [info ] [MainThread]: Found 1 model, 434 macros
[0m22:30:35.940740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '712b6775-43ab-4c44-bfa8-f21cf9294d36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf05cfd0>]}
[0m22:30:35.941111 [warn ] [MainThread]: The selection criterion 'dims_stations' does not match any enabled nodes
[0m22:30:35.941655 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m22:30:35.942556 [debug] [MainThread]: Command end result
[0m22:30:35.954604 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m22:30:35.955672 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m22:30:35.957667 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m22:30:35.958199 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.23377617, "process_in_blocks": "0", "process_kernel_time": 0.079853, "process_mem_max_rss": "106772", "process_out_blocks": "1726", "process_user_time": 0.755617}
[0m22:30:35.958425 [debug] [MainThread]: Command `dbt run` succeeded at 22:30:35.958382 after 0.23 seconds
[0m22:30:35.958632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf340890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf50b590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3b09610>]}
[0m22:30:35.958818 [debug] [MainThread]: Flushing usage events
[0m22:30:37.174517 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:34:02.852342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaff42990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaff43bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaff400d0>]}


============================== 22:34:02.853779 | 2709d04f-f440-4e14-aa0f-2255335aa4bf ==============================
[0m22:34:02.853779 [info ] [MainThread]: Running with dbt=1.9.0
[0m22:34:02.854229 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --select dim_stations --full-refresh', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:34:02.913598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2709d04f-f440-4e14-aa0f-2255335aa4bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffafd94250>]}
[0m22:34:02.935367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2709d04f-f440-4e14-aa0f-2255335aa4bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2a05310>]}
[0m22:34:02.935757 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:34:02.959927 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m22:34:02.997543 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:34:02.997813 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:34:03.000221 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m22:34:03.014549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2709d04f-f440-4e14-aa0f-2255335aa4bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf026f90>]}
[0m22:34:03.045583 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m22:34:03.047064 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m22:34:03.052614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2709d04f-f440-4e14-aa0f-2255335aa4bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf1d9bd0>]}
[0m22:34:03.052902 [info ] [MainThread]: Found 1 model, 434 macros
[0m22:34:03.053114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2709d04f-f440-4e14-aa0f-2255335aa4bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf194e90>]}
[0m22:34:03.053850 [info ] [MainThread]: 
[0m22:34:03.054089 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:34:03.054304 [info ] [MainThread]: 
[0m22:34:03.054631 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:34:03.055188 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m22:34:03.070041 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m22:34:03.070280 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m22:34:03.070480 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:34:03.073245 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.003 seconds
[0m22:34:03.073836 [debug] [ThreadPool]: On list_airflow: Close
[0m22:34:03.074684 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_dim)
[0m22:34:03.077548 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m22:34:03.077735 [debug] [ThreadPool]: On list_airflow_dim: BEGIN
[0m22:34:03.077875 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:34:03.079198 [debug] [ThreadPool]: SQL status: BEGIN in 0.001 seconds
[0m22:34:03.079388 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m22:34:03.079568 [debug] [ThreadPool]: On list_airflow_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dim'
  
[0m22:34:03.081533 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m22:34:03.082115 [debug] [ThreadPool]: On list_airflow_dim: ROLLBACK
[0m22:34:03.082322 [debug] [ThreadPool]: On list_airflow_dim: Close
[0m22:34:03.084323 [debug] [MainThread]: Using postgres connection "master"
[0m22:34:03.084511 [debug] [MainThread]: On master: BEGIN
[0m22:34:03.084659 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:34:03.085955 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m22:34:03.086155 [debug] [MainThread]: Using postgres connection "master"
[0m22:34:03.086380 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:34:03.089841 [debug] [MainThread]: SQL status: SELECT 2 in 0.003 seconds
[0m22:34:03.090388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2709d04f-f440-4e14-aa0f-2255335aa4bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf3b9610>]}
[0m22:34:03.090612 [debug] [MainThread]: On master: ROLLBACK
[0m22:34:03.090828 [debug] [MainThread]: Using postgres connection "master"
[0m22:34:03.091023 [debug] [MainThread]: On master: BEGIN
[0m22:34:03.091271 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m22:34:03.091427 [debug] [MainThread]: On master: COMMIT
[0m22:34:03.091579 [debug] [MainThread]: Using postgres connection "master"
[0m22:34:03.091747 [debug] [MainThread]: On master: COMMIT
[0m22:34:03.091952 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:34:03.092089 [debug] [MainThread]: On master: Close
[0m22:34:03.093039 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.dim_stations
[0m22:34:03.093328 [info ] [Thread-1 (]: 1 of 1 START sql view model dim.dim_stations ................................... [RUN]
[0m22:34:03.093654 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_dim, now model.etl_waterlevel.dim_stations)
[0m22:34:03.093865 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.dim_stations
[0m22:34:03.096832 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.dim_stations"
[0m22:34:03.097533 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.dim_stations
[0m22:34:03.113412 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.dim_stations"
[0m22:34:03.114348 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m22:34:03.114559 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: BEGIN
[0m22:34:03.114776 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:34:03.116381 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m22:34:03.116651 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m22:34:03.116876 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.dim_stations"} */

  create view "airflow"."dim"."dim_stations__dbt_tmp"
    
    
  as (
    -- models/dimensions/dim_stations.sql

with station_names as (
  select distinct
    "stationId"     as station_id,
    "stationName"   as station_name,
    "stationCode"   as station_code,
    "stationStatus" as station_status,
    "districtName" as district_name
  from raw.waterlevels
)

select * from station_names
  );
[0m22:34:03.120946 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m22:34:03.123654 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m22:34:03.123861 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.dim_stations"} */
alter table "airflow"."dim"."dim_stations" rename to "dim_stations__dbt_backup"
[0m22:34:03.124387 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:34:03.125641 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m22:34:03.125857 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.dim_stations"} */
alter table "airflow"."dim"."dim_stations__dbt_tmp" rename to "dim_stations"
[0m22:34:03.126224 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:34:03.133080 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: COMMIT
[0m22:34:03.133278 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m22:34:03.133466 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: COMMIT
[0m22:34:03.134332 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m22:34:03.136882 [debug] [Thread-1 (]: Applying DROP to: "airflow"."dim"."dim_stations__dbt_backup"
[0m22:34:03.138869 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m22:34:03.139049 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.dim_stations"} */
drop view if exists "airflow"."dim"."dim_stations__dbt_backup" cascade
[0m22:34:03.140034 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m22:34:03.141065 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: Close
[0m22:34:03.141846 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2709d04f-f440-4e14-aa0f-2255335aa4bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae285490>]}
[0m22:34:03.142179 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dim.dim_stations .............................. [[32mCREATE VIEW[0m in 0.05s]
[0m22:34:03.142458 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.dim_stations
[0m22:34:03.143208 [debug] [MainThread]: Using postgres connection "master"
[0m22:34:03.143376 [debug] [MainThread]: On master: BEGIN
[0m22:34:03.143503 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:34:03.144845 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m22:34:03.145104 [debug] [MainThread]: On master: COMMIT
[0m22:34:03.145259 [debug] [MainThread]: Using postgres connection "master"
[0m22:34:03.145392 [debug] [MainThread]: On master: COMMIT
[0m22:34:03.145564 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:34:03.145708 [debug] [MainThread]: On master: Close
[0m22:34:03.145918 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:34:03.146055 [debug] [MainThread]: Connection 'model.etl_waterlevel.dim_stations' was properly closed.
[0m22:34:03.146448 [info ] [MainThread]: 
[0m22:34:03.146629 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.09 seconds (0.09s).
[0m22:34:03.147029 [debug] [MainThread]: Command end result
[0m22:34:03.158331 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m22:34:03.159295 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m22:34:03.161958 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m22:34:03.162117 [info ] [MainThread]: 
[0m22:34:03.162390 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:34:03.162641 [info ] [MainThread]: 
[0m22:34:03.162907 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m22:34:03.163583 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.33216447, "process_in_blocks": "0", "process_kernel_time": 0.076996, "process_mem_max_rss": "113996", "process_out_blocks": "1656", "process_user_time": 0.789962}
[0m22:34:03.163855 [debug] [MainThread]: Command `dbt run` succeeded at 22:34:03.163797 after 0.33 seconds
[0m22:34:03.164050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffafdb3c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffafdb3c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0a56f50>]}
[0m22:34:03.164239 [debug] [MainThread]: Flushing usage events
[0m22:34:04.480425 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:40:08.929274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85236f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85237210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85237110>]}


============================== 22:40:08.930749 | 99d5cdd4-452e-4534-b821-601954962266 ==============================
[0m22:40:08.930749 [info ] [MainThread]: Running with dbt=1.9.0
[0m22:40:08.931116 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --select dim_stations --full-refresh', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:40:08.990884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '99d5cdd4-452e-4534-b821-601954962266', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87977610>]}
[0m22:40:09.013039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '99d5cdd4-452e-4534-b821-601954962266', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87d196d0>]}
[0m22:40:09.013420 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:40:09.037972 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m22:40:09.073759 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:40:09.074074 [debug] [MainThread]: Partial parsing: updated file: etl_waterlevel://models/dimensions/dim_stations.sql
[0m22:40:09.161371 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m22:40:09.163576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '99d5cdd4-452e-4534-b821-601954962266', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8420f310>]}
[0m22:40:09.189512 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m22:40:09.190944 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m22:40:09.196844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '99d5cdd4-452e-4534-b821-601954962266', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff841d6c10>]}
[0m22:40:09.197081 [info ] [MainThread]: Found 1 model, 434 macros
[0m22:40:09.197306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '99d5cdd4-452e-4534-b821-601954962266', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff842d6610>]}
[0m22:40:09.198001 [info ] [MainThread]: 
[0m22:40:09.198235 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:40:09.198439 [info ] [MainThread]: 
[0m22:40:09.198941 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:40:09.199443 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m22:40:09.213661 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m22:40:09.213900 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m22:40:09.214093 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:40:09.216590 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.002 seconds
[0m22:40:09.217189 [debug] [ThreadPool]: On list_airflow: Close
[0m22:40:09.217817 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_dim)
[0m22:40:09.220348 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m22:40:09.220556 [debug] [ThreadPool]: On list_airflow_dim: BEGIN
[0m22:40:09.220791 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:40:09.222350 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m22:40:09.222602 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m22:40:09.222825 [debug] [ThreadPool]: On list_airflow_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dim'
  
[0m22:40:09.224157 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m22:40:09.224741 [debug] [ThreadPool]: On list_airflow_dim: ROLLBACK
[0m22:40:09.224998 [debug] [ThreadPool]: On list_airflow_dim: Close
[0m22:40:09.226992 [debug] [MainThread]: Using postgres connection "master"
[0m22:40:09.227213 [debug] [MainThread]: On master: BEGIN
[0m22:40:09.227387 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:40:09.228851 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m22:40:09.229112 [debug] [MainThread]: Using postgres connection "master"
[0m22:40:09.229348 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:40:09.232247 [debug] [MainThread]: SQL status: SELECT 2 in 0.003 seconds
[0m22:40:09.232880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '99d5cdd4-452e-4534-b821-601954962266', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83548650>]}
[0m22:40:09.233140 [debug] [MainThread]: On master: ROLLBACK
[0m22:40:09.233406 [debug] [MainThread]: Using postgres connection "master"
[0m22:40:09.233581 [debug] [MainThread]: On master: BEGIN
[0m22:40:09.233936 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m22:40:09.234151 [debug] [MainThread]: On master: COMMIT
[0m22:40:09.234327 [debug] [MainThread]: Using postgres connection "master"
[0m22:40:09.234503 [debug] [MainThread]: On master: COMMIT
[0m22:40:09.234775 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:40:09.234964 [debug] [MainThread]: On master: Close
[0m22:40:09.236186 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.dim_stations
[0m22:40:09.236484 [info ] [Thread-1 (]: 1 of 1 START sql view model dim.dim_stations ................................... [RUN]
[0m22:40:09.236755 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_dim, now model.etl_waterlevel.dim_stations)
[0m22:40:09.236987 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.dim_stations
[0m22:40:09.239902 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.dim_stations"
[0m22:40:09.240661 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.dim_stations
[0m22:40:09.257113 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.dim_stations"
[0m22:40:09.257883 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m22:40:09.258091 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: BEGIN
[0m22:40:09.258283 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:40:09.259860 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m22:40:09.260116 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m22:40:09.260292 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.dim_stations"} */

  create view "airflow"."dim"."dim_stations__dbt_tmp"
    
    
  as (
    -- models/dimensions/dim_stations.sql

with station_names as (
  select distinct
    "stationId"     as station_id,
    "stationName"   as station_name,
    "stationCode"   as station_code,
    "districtName" as district_name,
    "latitude" as latitude,
    "longitude" as longitude,
    "stationStatus" as station_status,
  from raw.waterlevels
)

select * from station_names
  );
[0m22:40:09.260581 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "from"
LINE 18:   from raw.waterlevels
           ^

[0m22:40:09.260826 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: ROLLBACK
[0m22:40:09.261092 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: Close
[0m22:40:09.265359 [debug] [Thread-1 (]: Database Error in model dim_stations (models/dimensions/dim_stations.sql)
  syntax error at or near "from"
  LINE 18:   from raw.waterlevels
             ^
  compiled code at target/run/etl_waterlevel/models/dimensions/dim_stations.sql
[0m22:40:09.266108 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99d5cdd4-452e-4534-b821-601954962266', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8312bd50>]}
[0m22:40:09.266429 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dim.dim_stations .......................... [[31mERROR[0m in 0.03s]
[0m22:40:09.266775 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.dim_stations
[0m22:40:09.267042 [debug] [Thread-7 (]: Marking all children of 'model.etl_waterlevel.dim_stations' to be skipped because of status 'error'.  Reason: Database Error in model dim_stations (models/dimensions/dim_stations.sql)
  syntax error at or near "from"
  LINE 18:   from raw.waterlevels
             ^
  compiled code at target/run/etl_waterlevel/models/dimensions/dim_stations.sql.
[0m22:40:09.268029 [debug] [MainThread]: Using postgres connection "master"
[0m22:40:09.268210 [debug] [MainThread]: On master: BEGIN
[0m22:40:09.268398 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:40:09.269850 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m22:40:09.270056 [debug] [MainThread]: On master: COMMIT
[0m22:40:09.270236 [debug] [MainThread]: Using postgres connection "master"
[0m22:40:09.270385 [debug] [MainThread]: On master: COMMIT
[0m22:40:09.270570 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:40:09.270728 [debug] [MainThread]: On master: Close
[0m22:40:09.270982 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:40:09.271126 [debug] [MainThread]: Connection 'model.etl_waterlevel.dim_stations' was properly closed.
[0m22:40:09.271277 [info ] [MainThread]: 
[0m22:40:09.271464 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.07 seconds (0.07s).
[0m22:40:09.271890 [debug] [MainThread]: Command end result
[0m22:40:09.284112 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m22:40:09.285118 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m22:40:09.288056 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m22:40:09.288224 [info ] [MainThread]: 
[0m22:40:09.288460 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m22:40:09.288825 [info ] [MainThread]: 
[0m22:40:09.289131 [error] [MainThread]:   Database Error in model dim_stations (models/dimensions/dim_stations.sql)
  syntax error at or near "from"
  LINE 18:   from raw.waterlevels
             ^
  compiled code at target/run/etl_waterlevel/models/dimensions/dim_stations.sql
[0m22:40:09.289331 [info ] [MainThread]: 
[0m22:40:09.289567 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m22:40:09.290109 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.38190132, "process_in_blocks": "0", "process_kernel_time": 0.069994, "process_mem_max_rss": "117836", "process_out_blocks": "2473", "process_user_time": 0.864932}
[0m22:40:09.290361 [debug] [MainThread]: Command `dbt run` failed at 22:40:09.290314 after 0.38 seconds
[0m22:40:09.290556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85060310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff850aeb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff850ae310>]}
[0m22:40:09.290772 [debug] [MainThread]: Flushing usage events
[0m22:40:10.871317 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:40:23.392846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5b3b3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5b3add0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5b3b390>]}


============================== 22:40:23.394243 | 5d5f6945-4c2e-4b57-8104-c22728a8aae6 ==============================
[0m22:40:23.394243 [info ] [MainThread]: Running with dbt=1.9.0
[0m22:40:23.394646 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --select dim_stations --full-refresh', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:40:23.454719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5d5f6945-4c2e-4b57-8104-c22728a8aae6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4fecf10>]}
[0m22:40:23.476567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5d5f6945-4c2e-4b57-8104-c22728a8aae6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8637010>]}
[0m22:40:23.476947 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:40:23.501275 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m22:40:23.537190 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:40:23.537499 [debug] [MainThread]: Partial parsing: updated file: etl_waterlevel://models/dimensions/dim_stations.sql
[0m22:40:23.624078 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m22:40:23.626321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5d5f6945-4c2e-4b57-8104-c22728a8aae6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4d731d0>]}
[0m22:40:23.652175 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m22:40:23.653586 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m22:40:23.659039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5d5f6945-4c2e-4b57-8104-c22728a8aae6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4aeac10>]}
[0m22:40:23.659268 [info ] [MainThread]: Found 1 model, 434 macros
[0m22:40:23.659440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5d5f6945-4c2e-4b57-8104-c22728a8aae6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5039110>]}
[0m22:40:23.660094 [info ] [MainThread]: 
[0m22:40:23.660335 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:40:23.660567 [info ] [MainThread]: 
[0m22:40:23.661004 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:40:23.661489 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m22:40:23.675200 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m22:40:23.675431 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m22:40:23.675634 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:40:23.678119 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.002 seconds
[0m22:40:23.678714 [debug] [ThreadPool]: On list_airflow: Close
[0m22:40:23.679336 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_dim)
[0m22:40:23.681883 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m22:40:23.682080 [debug] [ThreadPool]: On list_airflow_dim: BEGIN
[0m22:40:23.682261 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:40:23.683727 [debug] [ThreadPool]: SQL status: BEGIN in 0.001 seconds
[0m22:40:23.684000 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m22:40:23.684242 [debug] [ThreadPool]: On list_airflow_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dim'
  
[0m22:40:23.685482 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m22:40:23.686063 [debug] [ThreadPool]: On list_airflow_dim: ROLLBACK
[0m22:40:23.686328 [debug] [ThreadPool]: On list_airflow_dim: Close
[0m22:40:23.688328 [debug] [MainThread]: Using postgres connection "master"
[0m22:40:23.688521 [debug] [MainThread]: On master: BEGIN
[0m22:40:23.688693 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:40:23.690159 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m22:40:23.690376 [debug] [MainThread]: Using postgres connection "master"
[0m22:40:23.690613 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:40:23.693408 [debug] [MainThread]: SQL status: SELECT 2 in 0.003 seconds
[0m22:40:23.693972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5d5f6945-4c2e-4b57-8104-c22728a8aae6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4a6f050>]}
[0m22:40:23.694217 [debug] [MainThread]: On master: ROLLBACK
[0m22:40:23.694528 [debug] [MainThread]: Using postgres connection "master"
[0m22:40:23.694709 [debug] [MainThread]: On master: BEGIN
[0m22:40:23.695057 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m22:40:23.695253 [debug] [MainThread]: On master: COMMIT
[0m22:40:23.695421 [debug] [MainThread]: Using postgres connection "master"
[0m22:40:23.695584 [debug] [MainThread]: On master: COMMIT
[0m22:40:23.695827 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:40:23.696004 [debug] [MainThread]: On master: Close
[0m22:40:23.697163 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.dim_stations
[0m22:40:23.697443 [info ] [Thread-1 (]: 1 of 1 START sql view model dim.dim_stations ................................... [RUN]
[0m22:40:23.697749 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_dim, now model.etl_waterlevel.dim_stations)
[0m22:40:23.697980 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.dim_stations
[0m22:40:23.700870 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.dim_stations"
[0m22:40:23.701547 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.dim_stations
[0m22:40:23.717688 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.dim_stations"
[0m22:40:23.718399 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m22:40:23.718603 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: BEGIN
[0m22:40:23.718820 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:40:23.720419 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m22:40:23.720673 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m22:40:23.720881 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.dim_stations"} */

  create view "airflow"."dim"."dim_stations__dbt_tmp"
    
    
  as (
    -- models/dimensions/dim_stations.sql

with station_names as (
  select distinct
    "stationId"     as station_id,
    "stationName"   as station_name,
    "stationCode"   as station_code,
    "districtName" as district_name,
    "latitude" as latitude,
    "longitude" as longitude,
    "stationStatus" as station_status
  from raw.waterlevels
)

select * from station_names
  );
[0m22:40:23.723984 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m22:40:23.726566 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m22:40:23.726792 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.dim_stations"} */
alter table "airflow"."dim"."dim_stations" rename to "dim_stations__dbt_backup"
[0m22:40:23.727120 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:40:23.728304 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m22:40:23.728494 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.dim_stations"} */
alter table "airflow"."dim"."dim_stations__dbt_tmp" rename to "dim_stations"
[0m22:40:23.728822 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:40:23.735728 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: COMMIT
[0m22:40:23.735965 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m22:40:23.736162 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: COMMIT
[0m22:40:23.736912 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m22:40:23.739465 [debug] [Thread-1 (]: Applying DROP to: "airflow"."dim"."dim_stations__dbt_backup"
[0m22:40:23.741442 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m22:40:23.741666 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.dim_stations"} */
drop view if exists "airflow"."dim"."dim_stations__dbt_backup" cascade
[0m22:40:23.742472 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m22:40:23.743505 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: Close
[0m22:40:23.744276 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d5f6945-4c2e-4b57-8104-c22728a8aae6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5b416d0>]}
[0m22:40:23.744612 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dim.dim_stations .............................. [[32mCREATE VIEW[0m in 0.05s]
[0m22:40:23.744997 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.dim_stations
[0m22:40:23.745716 [debug] [MainThread]: Using postgres connection "master"
[0m22:40:23.745883 [debug] [MainThread]: On master: BEGIN
[0m22:40:23.746016 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:40:23.747317 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m22:40:23.747517 [debug] [MainThread]: On master: COMMIT
[0m22:40:23.747688 [debug] [MainThread]: Using postgres connection "master"
[0m22:40:23.747827 [debug] [MainThread]: On master: COMMIT
[0m22:40:23.748022 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:40:23.748168 [debug] [MainThread]: On master: Close
[0m22:40:23.748350 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:40:23.748482 [debug] [MainThread]: Connection 'model.etl_waterlevel.dim_stations' was properly closed.
[0m22:40:23.748627 [info ] [MainThread]: 
[0m22:40:23.748810 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.09 seconds (0.09s).
[0m22:40:23.749199 [debug] [MainThread]: Command end result
[0m22:40:23.760388 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m22:40:23.761335 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m22:40:23.764097 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m22:40:23.764263 [info ] [MainThread]: 
[0m22:40:23.764480 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:40:23.764679 [info ] [MainThread]: 
[0m22:40:23.765000 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m22:40:23.765501 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.39363337, "process_in_blocks": "0", "process_kernel_time": 0.06472, "process_mem_max_rss": "117704", "process_out_blocks": "2475", "process_user_time": 0.868256}
[0m22:40:23.765714 [debug] [MainThread]: Command `dbt run` succeeded at 22:40:23.765674 after 0.39 seconds
[0m22:40:23.765901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5d4e1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5c706d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa4e9790>]}
[0m22:40:23.766078 [debug] [MainThread]: Flushing usage events
[0m22:40:24.965227 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:42:10.116663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0d3ab10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0f4ded0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb103b650>]}


============================== 22:42:10.118096 | 0e47d300-ef74-43e8-ab57-e0f2df265d6e ==============================
[0m22:42:10.118096 [info ] [MainThread]: Running with dbt=1.9.0
[0m22:42:10.118561 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --select dim_stations --full-refresh', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:42:10.178230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0e47d300-ef74-43e8-ab57-e0f2df265d6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb01db850>]}
[0m22:42:10.200141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0e47d300-ef74-43e8-ab57-e0f2df265d6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0b83f90>]}
[0m22:42:10.200519 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:42:10.224582 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m22:42:10.261116 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:42:10.261423 [debug] [MainThread]: Partial parsing: updated file: etl_waterlevel://models/dimensions/dim_stations.sql
[0m22:42:10.347130 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m22:42:10.349389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0e47d300-ef74-43e8-ab57-e0f2df265d6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffafe22750>]}
[0m22:42:10.376153 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m22:42:10.377604 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m22:42:10.383239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0e47d300-ef74-43e8-ab57-e0f2df265d6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf9b6f10>]}
[0m22:42:10.383477 [info ] [MainThread]: Found 1 model, 434 macros
[0m22:42:10.383658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0e47d300-ef74-43e8-ab57-e0f2df265d6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffafd3e590>]}
[0m22:42:10.384346 [info ] [MainThread]: 
[0m22:42:10.384572 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:42:10.384799 [info ] [MainThread]: 
[0m22:42:10.385214 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:42:10.385706 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m22:42:10.399849 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m22:42:10.400097 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m22:42:10.400302 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:42:10.402757 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.002 seconds
[0m22:42:10.403377 [debug] [ThreadPool]: On list_airflow: Close
[0m22:42:10.404029 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_dim)
[0m22:42:10.406677 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m22:42:10.406881 [debug] [ThreadPool]: On list_airflow_dim: BEGIN
[0m22:42:10.407084 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:42:10.408637 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m22:42:10.408910 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m22:42:10.409145 [debug] [ThreadPool]: On list_airflow_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dim'
  
[0m22:42:10.410410 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m22:42:10.410995 [debug] [ThreadPool]: On list_airflow_dim: ROLLBACK
[0m22:42:10.411262 [debug] [ThreadPool]: On list_airflow_dim: Close
[0m22:42:10.413345 [debug] [MainThread]: Using postgres connection "master"
[0m22:42:10.413570 [debug] [MainThread]: On master: BEGIN
[0m22:42:10.413749 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:42:10.415147 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m22:42:10.415387 [debug] [MainThread]: Using postgres connection "master"
[0m22:42:10.415620 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:42:10.418598 [debug] [MainThread]: SQL status: SELECT 2 in 0.003 seconds
[0m22:42:10.419195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0e47d300-ef74-43e8-ab57-e0f2df265d6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffafd8d390>]}
[0m22:42:10.419454 [debug] [MainThread]: On master: ROLLBACK
[0m22:42:10.419723 [debug] [MainThread]: Using postgres connection "master"
[0m22:42:10.419902 [debug] [MainThread]: On master: BEGIN
[0m22:42:10.420252 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m22:42:10.420492 [debug] [MainThread]: On master: COMMIT
[0m22:42:10.420661 [debug] [MainThread]: Using postgres connection "master"
[0m22:42:10.420828 [debug] [MainThread]: On master: COMMIT
[0m22:42:10.421094 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:42:10.421283 [debug] [MainThread]: On master: Close
[0m22:42:10.422532 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.dim_stations
[0m22:42:10.422822 [info ] [Thread-1 (]: 1 of 1 START sql view model dim.dim_stations ................................... [RUN]
[0m22:42:10.423123 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_dim, now model.etl_waterlevel.dim_stations)
[0m22:42:10.423361 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.dim_stations
[0m22:42:10.426225 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.dim_stations"
[0m22:42:10.426943 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.dim_stations
[0m22:42:10.443643 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.dim_stations"
[0m22:42:10.444361 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m22:42:10.444572 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: BEGIN
[0m22:42:10.444762 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:42:10.446244 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m22:42:10.446444 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m22:42:10.446611 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.dim_stations"} */

  create view "airflow"."dim"."dim_stations__dbt_tmp"
    
    
  as (
    -- models/dimensions/dim_stations.sql

with station_names as (
select
	distinct
    "stationId" as station_id,
	"stationName" as station_name,
	"stationCode" as station_code,
	"districtName" as district_name,
	"latitude" as latitude,
	"longitude" as longitude,
	"stationStatus" as station_status
from
	raw.waterlevels
)

select
	*
from
	station_names
order by
	district_name,
	station_code asc
  );
[0m22:42:10.447780 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m22:42:10.450433 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m22:42:10.450646 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.dim_stations"} */
alter table "airflow"."dim"."dim_stations" rename to "dim_stations__dbt_backup"
[0m22:42:10.450985 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:42:10.452215 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m22:42:10.452389 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.dim_stations"} */
alter table "airflow"."dim"."dim_stations__dbt_tmp" rename to "dim_stations"
[0m22:42:10.452665 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:42:10.459711 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: COMMIT
[0m22:42:10.460201 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m22:42:10.460407 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: COMMIT
[0m22:42:10.461079 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m22:42:10.463592 [debug] [Thread-1 (]: Applying DROP to: "airflow"."dim"."dim_stations__dbt_backup"
[0m22:42:10.465554 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m22:42:10.465756 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.dim_stations"} */
drop view if exists "airflow"."dim"."dim_stations__dbt_backup" cascade
[0m22:42:10.466439 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m22:42:10.467465 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: Close
[0m22:42:10.468269 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e47d300-ef74-43e8-ab57-e0f2df265d6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffafd4bd90>]}
[0m22:42:10.468610 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dim.dim_stations .............................. [[32mCREATE VIEW[0m in 0.04s]
[0m22:42:10.468904 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.dim_stations
[0m22:42:10.469666 [debug] [MainThread]: Using postgres connection "master"
[0m22:42:10.469844 [debug] [MainThread]: On master: BEGIN
[0m22:42:10.470011 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:42:10.471352 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m22:42:10.471532 [debug] [MainThread]: On master: COMMIT
[0m22:42:10.471671 [debug] [MainThread]: Using postgres connection "master"
[0m22:42:10.471820 [debug] [MainThread]: On master: COMMIT
[0m22:42:10.472038 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:42:10.472180 [debug] [MainThread]: On master: Close
[0m22:42:10.472361 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:42:10.472497 [debug] [MainThread]: Connection 'model.etl_waterlevel.dim_stations' was properly closed.
[0m22:42:10.472654 [info ] [MainThread]: 
[0m22:42:10.472885 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.09 seconds (0.09s).
[0m22:42:10.473339 [debug] [MainThread]: Command end result
[0m22:42:10.484557 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m22:42:10.485532 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m22:42:10.488366 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m22:42:10.488559 [info ] [MainThread]: 
[0m22:42:10.488801 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:42:10.489070 [info ] [MainThread]: 
[0m22:42:10.489284 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m22:42:10.489778 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.39430362, "process_in_blocks": "0", "process_kernel_time": 0.074053, "process_mem_max_rss": "117596", "process_out_blocks": "2475", "process_user_time": 0.87463}
[0m22:42:10.490018 [debug] [MainThread]: Command `dbt run` succeeded at 22:42:10.489976 after 0.39 seconds
[0m22:42:10.490197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb37fa010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0e706d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1837410>]}
[0m22:42:10.490367 [debug] [MainThread]: Flushing usage events
[0m22:42:11.861581 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:21:33.492760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c33a9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c430290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c33b350>]}


============================== 23:21:33.494550 | 8a382e43-a933-4444-8136-e453023bf882 ==============================
[0m23:21:33.494550 [info ] [MainThread]: Running with dbt=1.9.0
[0m23:21:33.494962 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --select fact_waterlevel --full-refresh', 'send_anonymous_usage_stats': 'True'}
[0m23:21:33.558743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8a382e43-a933-4444-8136-e453023bf882', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c1d5810>]}
[0m23:21:33.580705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8a382e43-a933-4444-8136-e453023bf882', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ed76dd0>]}
[0m23:21:33.581080 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:21:33.605939 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m23:21:33.632494 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m23:21:33.632826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8a382e43-a933-4444-8136-e453023bf882', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b5b5a90>]}
[0m23:21:33.988983 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.etl_waterlevel.staging
- models.etl_waterlevel.fact
[0m23:21:33.991472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8a382e43-a933-4444-8136-e453023bf882', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e916e10>]}
[0m23:21:34.018056 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m23:21:34.019889 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m23:21:34.026232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8a382e43-a933-4444-8136-e453023bf882', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b3b5c10>]}
[0m23:21:34.026461 [info ] [MainThread]: Found 2 models, 434 macros
[0m23:21:34.026648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8a382e43-a933-4444-8136-e453023bf882', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c349ad0>]}
[0m23:21:34.027313 [info ] [MainThread]: 
[0m23:21:34.027597 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:21:34.027786 [info ] [MainThread]: 
[0m23:21:34.028109 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:21:34.028629 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m23:21:34.044923 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m23:21:34.045154 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m23:21:34.045347 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:21:34.048280 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.003 seconds
[0m23:21:34.048871 [debug] [ThreadPool]: On list_airflow: Close
[0m23:21:34.049232 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now create_airflow_staging)
[0m23:21:34.049535 [debug] [ThreadPool]: Creating schema "database: "airflow"
schema: "staging"
"
[0m23:21:34.051861 [debug] [ThreadPool]: Using postgres connection "create_airflow_staging"
[0m23:21:34.052060 [debug] [ThreadPool]: On create_airflow_staging: BEGIN
[0m23:21:34.052244 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:21:34.053709 [debug] [ThreadPool]: SQL status: BEGIN in 0.001 seconds
[0m23:21:34.053974 [debug] [ThreadPool]: Using postgres connection "create_airflow_staging"
[0m23:21:34.054163 [debug] [ThreadPool]: On create_airflow_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "create_airflow_staging"} */
create schema if not exists "staging"
[0m23:21:34.054744 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.000 seconds
[0m23:21:34.055192 [debug] [ThreadPool]: On create_airflow_staging: COMMIT
[0m23:21:34.055392 [debug] [ThreadPool]: Using postgres connection "create_airflow_staging"
[0m23:21:34.055571 [debug] [ThreadPool]: On create_airflow_staging: COMMIT
[0m23:21:34.056054 [debug] [ThreadPool]: SQL status: COMMIT in 0.000 seconds
[0m23:21:34.056228 [debug] [ThreadPool]: On create_airflow_staging: Close
[0m23:21:34.056874 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_airflow_staging, now list_airflow_dim)
[0m23:21:34.057108 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow_staging'
[0m23:21:34.059510 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m23:21:34.060406 [debug] [ThreadPool]: Using postgres connection "list_airflow_staging"
[0m23:21:34.060627 [debug] [ThreadPool]: On list_airflow_dim: BEGIN
[0m23:21:34.060814 [debug] [ThreadPool]: On list_airflow_staging: BEGIN
[0m23:21:34.060986 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:21:34.061207 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:21:34.063063 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m23:21:34.063213 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m23:21:34.063566 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m23:21:34.063756 [debug] [ThreadPool]: Using postgres connection "list_airflow_staging"
[0m23:21:34.063949 [debug] [ThreadPool]: On list_airflow_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dim'
  
[0m23:21:34.064180 [debug] [ThreadPool]: On list_airflow_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_staging"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m23:21:34.066014 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.001 seconds
[0m23:21:34.066163 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m23:21:34.066779 [debug] [ThreadPool]: On list_airflow_staging: ROLLBACK
[0m23:21:34.067377 [debug] [ThreadPool]: On list_airflow_dim: ROLLBACK
[0m23:21:34.067690 [debug] [ThreadPool]: On list_airflow_staging: Close
[0m23:21:34.067954 [debug] [ThreadPool]: On list_airflow_dim: Close
[0m23:21:34.070697 [debug] [MainThread]: Using postgres connection "master"
[0m23:21:34.070950 [debug] [MainThread]: On master: BEGIN
[0m23:21:34.071158 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:21:34.072969 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m23:21:34.073176 [debug] [MainThread]: Using postgres connection "master"
[0m23:21:34.073504 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:21:34.077015 [debug] [MainThread]: SQL status: SELECT 2 in 0.003 seconds
[0m23:21:34.077647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8a382e43-a933-4444-8136-e453023bf882', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b3fc250>]}
[0m23:21:34.077931 [debug] [MainThread]: On master: ROLLBACK
[0m23:21:34.078218 [debug] [MainThread]: Using postgres connection "master"
[0m23:21:34.078489 [debug] [MainThread]: On master: BEGIN
[0m23:21:34.078859 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:21:34.079239 [debug] [MainThread]: On master: COMMIT
[0m23:21:34.079457 [debug] [MainThread]: Using postgres connection "master"
[0m23:21:34.079635 [debug] [MainThread]: On master: COMMIT
[0m23:21:34.079914 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:21:34.080109 [debug] [MainThread]: On master: Close
[0m23:21:34.081274 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.fact_waterlevel
[0m23:21:34.081572 [info ] [Thread-1 (]: 1 of 1 START sql incremental model staging.fact_waterlevel ..................... [RUN]
[0m23:21:34.081908 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_dim, now model.etl_waterlevel.fact_waterlevel)
[0m23:21:34.082146 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.fact_waterlevel
[0m23:21:34.086175 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.fact_waterlevel"
[0m23:21:34.087437 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.fact_waterlevel
[0m23:21:34.113583 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.fact_waterlevel"
[0m23:21:34.114809 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m23:21:34.115035 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: BEGIN
[0m23:21:34.115252 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:21:34.117095 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m23:21:34.117359 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m23:21:34.117613 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      
  
    

  create  table "airflow"."staging"."fact_waterlevel"
  
  
    as
  
  (
    

with main as (
select
	distinct
	concat("stationId",'_',"stationCode") as station_key,
	"stationId" as station_id,
	"stationCode" as station_code,
	"waterLevel" as water_level,
	"waterlevelStatus" as waterlevel_status,
	"stationName",
	"districtName",
	to_timestamp("lastUpdate",'DD/MM/YYYY HH24:MI') as last_update
from
	raw.waterlevels w
where
	"stationStatus" = 1



)
select
	*
from
	main
order by
	last_update desc
;
  );
  
  
[0m23:21:34.117962 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 40: ;
         ^

[0m23:21:34.118192 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: ROLLBACK
[0m23:21:34.118485 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: Close
[0m23:21:34.120707 [debug] [Thread-1 (]: Database Error in model fact_waterlevel (models/facts/fact_waterlevel.sql)
  syntax error at or near ";"
  LINE 40: ;
           ^
  compiled code at target/run/etl_waterlevel/models/facts/fact_waterlevel.sql
[0m23:21:34.121583 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a382e43-a933-4444-8136-e453023bf882', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c18ac10>]}
[0m23:21:34.121935 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model staging.fact_waterlevel ............ [[31mERROR[0m in 0.04s]
[0m23:21:34.122269 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.fact_waterlevel
[0m23:21:34.122646 [debug] [Thread-7 (]: Marking all children of 'model.etl_waterlevel.fact_waterlevel' to be skipped because of status 'error'.  Reason: Database Error in model fact_waterlevel (models/facts/fact_waterlevel.sql)
  syntax error at or near ";"
  LINE 40: ;
           ^
  compiled code at target/run/etl_waterlevel/models/facts/fact_waterlevel.sql.
[0m23:21:34.123815 [debug] [MainThread]: Using postgres connection "master"
[0m23:21:34.124042 [debug] [MainThread]: On master: BEGIN
[0m23:21:34.124264 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:21:34.126009 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m23:21:34.126301 [debug] [MainThread]: On master: COMMIT
[0m23:21:34.126505 [debug] [MainThread]: Using postgres connection "master"
[0m23:21:34.126688 [debug] [MainThread]: On master: COMMIT
[0m23:21:34.126954 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:21:34.127137 [debug] [MainThread]: On master: Close
[0m23:21:34.127404 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:21:34.127626 [debug] [MainThread]: Connection 'model.etl_waterlevel.fact_waterlevel' was properly closed.
[0m23:21:34.127852 [debug] [MainThread]: Connection 'list_airflow_staging' was properly closed.
[0m23:21:34.128056 [info ] [MainThread]: 
[0m23:21:34.128272 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.10 seconds (0.10s).
[0m23:21:34.128842 [debug] [MainThread]: Command end result
[0m23:21:34.143312 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m23:21:34.144428 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m23:21:34.147867 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m23:21:34.148059 [info ] [MainThread]: 
[0m23:21:34.148308 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m23:21:34.148629 [info ] [MainThread]: 
[0m23:21:34.148941 [error] [MainThread]:   Database Error in model fact_waterlevel (models/facts/fact_waterlevel.sql)
  syntax error at or near ";"
  LINE 40: ;
           ^
  compiled code at target/run/etl_waterlevel/models/facts/fact_waterlevel.sql
[0m23:21:34.149123 [info ] [MainThread]: 
[0m23:21:34.149378 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m23:21:34.149941 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.6802293, "process_in_blocks": "0", "process_kernel_time": 0.135487, "process_mem_max_rss": "117336", "process_out_blocks": "2497", "process_user_time": 1.140098}
[0m23:21:34.150164 [debug] [MainThread]: Command `dbt run` failed at 23:21:34.150120 after 0.68 seconds
[0m23:21:34.150386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c167250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80c493d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80c48990>]}
[0m23:21:34.150569 [debug] [MainThread]: Flushing usage events
[0m23:21:35.689743 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:23:10.141523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa408da50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4450090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa408e110>]}


============================== 23:23:10.142947 | ec702aa1-0b8f-4cf1-9192-191b837416e1 ==============================
[0m23:23:10.142947 [info ] [MainThread]: Running with dbt=1.9.0
[0m23:23:10.143322 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --select fact_waterlevel --full-refresh', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:23:10.204052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ec702aa1-0b8f-4cf1-9192-191b837416e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4336310>]}
[0m23:23:10.225932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ec702aa1-0b8f-4cf1-9192-191b837416e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6cc9d90>]}
[0m23:23:10.226301 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:23:10.250433 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m23:23:10.277519 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m23:23:10.277818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ec702aa1-0b8f-4cf1-9192-191b837416e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4e64190>]}
[0m23:23:10.631505 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m23:23:10.633961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ec702aa1-0b8f-4cf1-9192-191b837416e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3680250>]}
[0m23:23:10.662408 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m23:23:10.663900 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m23:23:10.669596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ec702aa1-0b8f-4cf1-9192-191b837416e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3655890>]}
[0m23:23:10.669839 [info ] [MainThread]: Found 2 models, 434 macros
[0m23:23:10.670024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ec702aa1-0b8f-4cf1-9192-191b837416e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa363d650>]}
[0m23:23:10.670698 [info ] [MainThread]: 
[0m23:23:10.670937 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:23:10.671236 [info ] [MainThread]: 
[0m23:23:10.671546 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:23:10.672071 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m23:23:10.686687 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m23:23:10.686937 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m23:23:10.687137 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:23:10.689739 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.003 seconds
[0m23:23:10.690374 [debug] [ThreadPool]: On list_airflow: Close
[0m23:23:10.690755 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now create_airflow_fact)
[0m23:23:10.691053 [debug] [ThreadPool]: Creating schema "database: "airflow"
schema: "fact"
"
[0m23:23:10.693384 [debug] [ThreadPool]: Using postgres connection "create_airflow_fact"
[0m23:23:10.693582 [debug] [ThreadPool]: On create_airflow_fact: BEGIN
[0m23:23:10.693769 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:23:10.695282 [debug] [ThreadPool]: SQL status: BEGIN in 0.001 seconds
[0m23:23:10.695528 [debug] [ThreadPool]: Using postgres connection "create_airflow_fact"
[0m23:23:10.695750 [debug] [ThreadPool]: On create_airflow_fact: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "create_airflow_fact"} */
create schema if not exists "fact"
[0m23:23:10.696196 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.000 seconds
[0m23:23:10.696627 [debug] [ThreadPool]: On create_airflow_fact: COMMIT
[0m23:23:10.696811 [debug] [ThreadPool]: Using postgres connection "create_airflow_fact"
[0m23:23:10.696985 [debug] [ThreadPool]: On create_airflow_fact: COMMIT
[0m23:23:10.697494 [debug] [ThreadPool]: SQL status: COMMIT in 0.000 seconds
[0m23:23:10.697674 [debug] [ThreadPool]: On create_airflow_fact: Close
[0m23:23:10.698309 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_airflow_fact, now list_airflow_dim)
[0m23:23:10.698571 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow_fact'
[0m23:23:10.700935 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m23:23:10.701861 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m23:23:10.702082 [debug] [ThreadPool]: On list_airflow_dim: BEGIN
[0m23:23:10.702268 [debug] [ThreadPool]: On list_airflow_fact: BEGIN
[0m23:23:10.702441 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:23:10.702616 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:23:10.704013 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m23:23:10.704216 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m23:23:10.704402 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m23:23:10.704605 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m23:23:10.704814 [debug] [ThreadPool]: On list_airflow_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dim'
  
[0m23:23:10.705041 [debug] [ThreadPool]: On list_airflow_fact: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_fact"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'fact'
  
[0m23:23:10.706399 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m23:23:10.706511 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.001 seconds
[0m23:23:10.707064 [debug] [ThreadPool]: On list_airflow_dim: ROLLBACK
[0m23:23:10.707597 [debug] [ThreadPool]: On list_airflow_fact: ROLLBACK
[0m23:23:10.707946 [debug] [ThreadPool]: On list_airflow_dim: Close
[0m23:23:10.708108 [debug] [ThreadPool]: On list_airflow_fact: Close
[0m23:23:10.710396 [debug] [MainThread]: Using postgres connection "master"
[0m23:23:10.710616 [debug] [MainThread]: On master: BEGIN
[0m23:23:10.710786 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:23:10.712216 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m23:23:10.712442 [debug] [MainThread]: Using postgres connection "master"
[0m23:23:10.712711 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:23:10.715623 [debug] [MainThread]: SQL status: SELECT 2 in 0.003 seconds
[0m23:23:10.716181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ec702aa1-0b8f-4cf1-9192-191b837416e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa292d3d0>]}
[0m23:23:10.716438 [debug] [MainThread]: On master: ROLLBACK
[0m23:23:10.716700 [debug] [MainThread]: Using postgres connection "master"
[0m23:23:10.716890 [debug] [MainThread]: On master: BEGIN
[0m23:23:10.717236 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:23:10.717468 [debug] [MainThread]: On master: COMMIT
[0m23:23:10.717639 [debug] [MainThread]: Using postgres connection "master"
[0m23:23:10.717815 [debug] [MainThread]: On master: COMMIT
[0m23:23:10.718063 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:23:10.718235 [debug] [MainThread]: On master: Close
[0m23:23:10.719382 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.fact_waterlevel
[0m23:23:10.719662 [info ] [Thread-1 (]: 1 of 1 START sql incremental model fact.fact_waterlevel ........................ [RUN]
[0m23:23:10.719925 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_fact, now model.etl_waterlevel.fact_waterlevel)
[0m23:23:10.720173 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.fact_waterlevel
[0m23:23:10.723718 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.fact_waterlevel"
[0m23:23:10.724513 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.fact_waterlevel
[0m23:23:10.748867 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.fact_waterlevel"
[0m23:23:10.749725 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m23:23:10.749964 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: BEGIN
[0m23:23:10.750189 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:23:10.751764 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m23:23:10.752016 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m23:23:10.752242 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      
  
    

  create  table "airflow"."fact"."fact_waterlevel"
  
  
    as
  
  (
    

with main as (
select
	distinct
	concat("stationId",'_',"stationCode") as station_key,
	"stationId" as station_id,
	"stationCode" as station_code,
	"waterLevel" as water_level,
	"waterlevelStatus" as waterlevel_status,
	"stationName",
	"districtName",
	to_timestamp("lastUpdate",'DD/MM/YYYY HH24:MI') as last_update
from
	raw.waterlevels w
where
	"stationStatus" = 1



)
select
	*
from
	main
order by
	last_update desc
  );
  
  
[0m23:23:10.779760 [debug] [Thread-1 (]: SQL status: SELECT 15498 in 0.027 seconds
[0m23:23:10.786984 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m23:23:10.787214 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m23:23:10.787416 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m23:23:10.792320 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m23:23:10.793190 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: Close
[0m23:23:10.794031 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec702aa1-0b8f-4cf1-9192-191b837416e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa250c3d0>]}
[0m23:23:10.794410 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model fact.fact_waterlevel ................... [[32mSELECT 15498[0m in 0.07s]
[0m23:23:10.794775 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.fact_waterlevel
[0m23:23:10.795657 [debug] [MainThread]: Using postgres connection "master"
[0m23:23:10.795859 [debug] [MainThread]: On master: BEGIN
[0m23:23:10.796055 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:23:10.797735 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m23:23:10.798000 [debug] [MainThread]: On master: COMMIT
[0m23:23:10.798205 [debug] [MainThread]: Using postgres connection "master"
[0m23:23:10.798387 [debug] [MainThread]: On master: COMMIT
[0m23:23:10.798647 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:23:10.798836 [debug] [MainThread]: On master: Close
[0m23:23:10.799085 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:23:10.799290 [debug] [MainThread]: Connection 'list_airflow_dim' was properly closed.
[0m23:23:10.799472 [debug] [MainThread]: Connection 'model.etl_waterlevel.fact_waterlevel' was properly closed.
[0m23:23:10.799689 [info ] [MainThread]: 
[0m23:23:10.799924 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.13 seconds (0.13s).
[0m23:23:10.800337 [debug] [MainThread]: Command end result
[0m23:23:10.813463 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m23:23:10.814446 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m23:23:10.817234 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m23:23:10.817423 [info ] [MainThread]: 
[0m23:23:10.817674 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:23:10.817853 [info ] [MainThread]: 
[0m23:23:10.818091 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:23:10.818601 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.6989326, "process_in_blocks": "0", "process_kernel_time": 0.078316, "process_mem_max_rss": "117388", "process_out_blocks": "2495", "process_user_time": 1.137602}
[0m23:23:10.818861 [debug] [MainThread]: Command `dbt run` succeeded at 23:23:10.818808 after 0.70 seconds
[0m23:23:10.819084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4d3f690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8b84810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8b85290>]}
[0m23:23:10.819281 [debug] [MainThread]: Flushing usage events
[0m23:23:12.210574 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:23:25.964464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91343150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff915565d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff913439d0>]}


============================== 23:23:25.965891 | 198c249e-cc44-4779-858c-7c63d266f777 ==============================
[0m23:23:25.965891 [info ] [MainThread]: Running with dbt=1.9.0
[0m23:23:25.966251 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select fact_waterlevel', 'send_anonymous_usage_stats': 'True'}
[0m23:23:26.026096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '198c249e-cc44-4779-858c-7c63d266f777', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff906fe390>]}
[0m23:23:26.047918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '198c249e-cc44-4779-858c-7c63d266f777', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93d81fd0>]}
[0m23:23:26.048292 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:23:26.072811 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m23:23:26.108923 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:23:26.109160 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:23:26.111494 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m23:23:26.120268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '198c249e-cc44-4779-858c-7c63d266f777', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff911b3d90>]}
[0m23:23:26.147471 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m23:23:26.148896 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m23:23:26.154514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '198c249e-cc44-4779-858c-7c63d266f777', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff904d6c10>]}
[0m23:23:26.154796 [info ] [MainThread]: Found 2 models, 434 macros
[0m23:23:26.155020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '198c249e-cc44-4779-858c-7c63d266f777', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90496c90>]}
[0m23:23:26.155760 [info ] [MainThread]: 
[0m23:23:26.156004 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:23:26.156242 [info ] [MainThread]: 
[0m23:23:26.156604 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:23:26.157130 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m23:23:26.171889 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m23:23:26.172126 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m23:23:26.172315 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:23:26.174741 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.002 seconds
[0m23:23:26.175301 [debug] [ThreadPool]: On list_airflow: Close
[0m23:23:26.175963 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_dim)
[0m23:23:26.176250 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow_fact'
[0m23:23:26.178960 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m23:23:26.179947 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m23:23:26.180189 [debug] [ThreadPool]: On list_airflow_dim: BEGIN
[0m23:23:26.180449 [debug] [ThreadPool]: On list_airflow_fact: BEGIN
[0m23:23:26.180681 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:23:26.180914 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:23:26.182573 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m23:23:26.182832 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m23:23:26.182977 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m23:23:26.183184 [debug] [ThreadPool]: On list_airflow_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dim'
  
[0m23:23:26.183453 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m23:23:26.183836 [debug] [ThreadPool]: On list_airflow_fact: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_fact"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'fact'
  
[0m23:23:26.184786 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m23:23:26.185393 [debug] [ThreadPool]: On list_airflow_dim: ROLLBACK
[0m23:23:26.185567 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m23:23:26.185865 [debug] [ThreadPool]: On list_airflow_dim: Close
[0m23:23:26.186337 [debug] [ThreadPool]: On list_airflow_fact: ROLLBACK
[0m23:23:26.186997 [debug] [ThreadPool]: On list_airflow_fact: Close
[0m23:23:26.189145 [debug] [MainThread]: Using postgres connection "master"
[0m23:23:26.189350 [debug] [MainThread]: On master: BEGIN
[0m23:23:26.189540 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:23:26.191066 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m23:23:26.191307 [debug] [MainThread]: Using postgres connection "master"
[0m23:23:26.191545 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:23:26.194311 [debug] [MainThread]: SQL status: SELECT 2 in 0.003 seconds
[0m23:23:26.194853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '198c249e-cc44-4779-858c-7c63d266f777', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90497a50>]}
[0m23:23:26.195111 [debug] [MainThread]: On master: ROLLBACK
[0m23:23:26.195376 [debug] [MainThread]: Using postgres connection "master"
[0m23:23:26.195567 [debug] [MainThread]: On master: BEGIN
[0m23:23:26.195913 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:23:26.196125 [debug] [MainThread]: On master: COMMIT
[0m23:23:26.196298 [debug] [MainThread]: Using postgres connection "master"
[0m23:23:26.196453 [debug] [MainThread]: On master: COMMIT
[0m23:23:26.196702 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:23:26.196883 [debug] [MainThread]: On master: Close
[0m23:23:26.198070 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.fact_waterlevel
[0m23:23:26.198364 [info ] [Thread-1 (]: 1 of 1 START sql incremental model fact.fact_waterlevel ........................ [RUN]
[0m23:23:26.198774 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_fact, now model.etl_waterlevel.fact_waterlevel)
[0m23:23:26.199011 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.fact_waterlevel
[0m23:23:26.204717 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.fact_waterlevel"
[0m23:23:26.205447 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.fact_waterlevel
[0m23:23:26.229811 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m23:23:26.230070 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

    
  
    

  create temporary table "fact_waterlevel__dbt_tmp232326219309"
  
  
    as
  
  (
    

with main as (
select
	distinct
	concat("stationId",'_',"stationCode") as station_key,
	"stationId" as station_id,
	"stationCode" as station_code,
	"waterLevel" as water_level,
	"waterlevelStatus" as waterlevel_status,
	"stationName",
	"districtName",
	to_timestamp("lastUpdate",'DD/MM/YYYY HH24:MI') as last_update
from
	raw.waterlevels w
where
	"stationStatus" = 1


    and to_timestamp("lastUpdate", 'DD/MM/YYY HH24:MI') > (select max(last_update) from "airflow"."fact"."fact_waterlevel")


)
select
	*
from
	main
order by
	last_update desc
  );
  
  
[0m23:23:26.230302 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:23:26.240022 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.010 seconds
[0m23:23:26.245648 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m23:23:26.245881 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: BEGIN
[0m23:23:26.246217 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m23:23:26.246497 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m23:23:26.246712 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp232326219309'
        
      order by ordinal_position

  
[0m23:23:26.250818 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.004 seconds
[0m23:23:26.253030 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m23:23:26.253240 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m23:23:26.254482 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.001 seconds
[0m23:23:26.257597 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m23:23:26.257793 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m23:23:26.258885 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.001 seconds
[0m23:23:26.264331 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.fact_waterlevel"
[0m23:23:26.265034 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m23:23:26.265249 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      insert into "airflow"."fact"."fact_waterlevel" ("station_key", "station_id", "station_code", "water_level", "waterlevel_status", "stationName", "districtName", "last_update")
    (
        select "station_key", "station_id", "station_code", "water_level", "waterlevel_status", "stationName", "districtName", "last_update"
        from "fact_waterlevel__dbt_tmp232326219309"
    )


  
[0m23:23:26.265609 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.000 seconds
[0m23:23:26.271363 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m23:23:26.271575 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m23:23:26.271730 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m23:23:26.272324 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m23:23:26.273056 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: Close
[0m23:23:26.273891 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '198c249e-cc44-4779-858c-7c63d266f777', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90726e10>]}
[0m23:23:26.274247 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model fact.fact_waterlevel ................... [[32mINSERT 0 0[0m in 0.07s]
[0m23:23:26.274529 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.fact_waterlevel
[0m23:23:26.275379 [debug] [MainThread]: Using postgres connection "master"
[0m23:23:26.275616 [debug] [MainThread]: On master: BEGIN
[0m23:23:26.275750 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:23:26.277219 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m23:23:26.277396 [debug] [MainThread]: On master: COMMIT
[0m23:23:26.277543 [debug] [MainThread]: Using postgres connection "master"
[0m23:23:26.277683 [debug] [MainThread]: On master: COMMIT
[0m23:23:26.277884 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:23:26.278040 [debug] [MainThread]: On master: Close
[0m23:23:26.278230 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:23:26.278365 [debug] [MainThread]: Connection 'list_airflow_dim' was properly closed.
[0m23:23:26.278491 [debug] [MainThread]: Connection 'model.etl_waterlevel.fact_waterlevel' was properly closed.
[0m23:23:26.278636 [info ] [MainThread]: 
[0m23:23:26.278827 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.12 seconds (0.12s).
[0m23:23:26.279244 [debug] [MainThread]: Command end result
[0m23:23:26.291756 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m23:23:26.292729 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m23:23:26.295500 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m23:23:26.295663 [info ] [MainThread]: 
[0m23:23:26.295928 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:23:26.296111 [info ] [MainThread]: 
[0m23:23:26.296394 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:23:26.296901 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.35356587, "process_in_blocks": "0", "process_kernel_time": 0.08164, "process_mem_max_rss": "115128", "process_out_blocks": "1677", "process_user_time": 0.791511}
[0m23:23:26.297118 [debug] [MainThread]: Command `dbt run` succeeded at 23:23:26.297081 after 0.35 seconds
[0m23:23:26.297288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91e43750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91e56f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff903dfd10>]}
[0m23:23:26.297488 [debug] [MainThread]: Flushing usage events
[0m23:23:27.510534 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:41:01.110047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6202c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6503650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6056410>]}


============================== 23:41:01.112313 | a1d0af72-b061-41a5-817d-7ccc2b098624 ==============================
[0m23:41:01.112313 [info ] [MainThread]: Running with dbt=1.9.0
[0m23:41:01.112751 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select fact_waterlevel --full-refresh', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:41:01.176050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a1d0af72-b061-41a5-817d-7ccc2b098624', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb565bad0>]}
[0m23:41:01.197856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a1d0af72-b061-41a5-817d-7ccc2b098624', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8c5f210>]}
[0m23:41:01.198238 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:41:01.223188 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m23:41:01.261200 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m23:41:01.261509 [debug] [MainThread]: Partial parsing: added file: etl_waterlevel://models/dimensions/dim_threshold.sql
[0m23:41:01.261754 [debug] [MainThread]: Partial parsing: updated file: etl_waterlevel://models/facts/fact_waterlevel.sql
[0m23:41:01.352322 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m23:41:01.354639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a1d0af72-b061-41a5-817d-7ccc2b098624', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb54a3290>]}
[0m23:41:01.382000 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m23:41:01.383589 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m23:41:01.389694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a1d0af72-b061-41a5-817d-7ccc2b098624', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb50fd150>]}
[0m23:41:01.389959 [info ] [MainThread]: Found 3 models, 434 macros
[0m23:41:01.390202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a1d0af72-b061-41a5-817d-7ccc2b098624', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb50a3190>]}
[0m23:41:01.390963 [info ] [MainThread]: 
[0m23:41:01.391201 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:41:01.391454 [info ] [MainThread]: 
[0m23:41:01.391827 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:41:01.392322 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m23:41:01.408618 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m23:41:01.408834 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m23:41:01.409025 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:41:01.411973 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.003 seconds
[0m23:41:01.412587 [debug] [ThreadPool]: On list_airflow: Close
[0m23:41:01.414781 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_dim)
[0m23:41:01.415110 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow_fact'
[0m23:41:01.417588 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m23:41:01.418513 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m23:41:01.418756 [debug] [ThreadPool]: On list_airflow_dim: BEGIN
[0m23:41:01.418974 [debug] [ThreadPool]: On list_airflow_fact: BEGIN
[0m23:41:01.419199 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:41:01.419444 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:41:01.421175 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m23:41:01.421379 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m23:41:01.421632 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m23:41:01.421850 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m23:41:01.422084 [debug] [ThreadPool]: On list_airflow_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dim'
  
[0m23:41:01.422328 [debug] [ThreadPool]: On list_airflow_fact: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_fact"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'fact'
  
[0m23:41:01.423828 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m23:41:01.423977 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m23:41:01.424580 [debug] [ThreadPool]: On list_airflow_fact: ROLLBACK
[0m23:41:01.425144 [debug] [ThreadPool]: On list_airflow_dim: ROLLBACK
[0m23:41:01.425477 [debug] [ThreadPool]: On list_airflow_fact: Close
[0m23:41:01.425657 [debug] [ThreadPool]: On list_airflow_dim: Close
[0m23:41:01.428081 [debug] [MainThread]: Using postgres connection "master"
[0m23:41:01.428344 [debug] [MainThread]: On master: BEGIN
[0m23:41:01.428529 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:41:01.430031 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m23:41:01.430289 [debug] [MainThread]: Using postgres connection "master"
[0m23:41:01.430529 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:41:01.433549 [debug] [MainThread]: SQL status: SELECT 2 in 0.003 seconds
[0m23:41:01.434098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a1d0af72-b061-41a5-817d-7ccc2b098624', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb55fd6d0>]}
[0m23:41:01.434348 [debug] [MainThread]: On master: ROLLBACK
[0m23:41:01.434629 [debug] [MainThread]: Using postgres connection "master"
[0m23:41:01.434809 [debug] [MainThread]: On master: BEGIN
[0m23:41:01.435144 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:41:01.435341 [debug] [MainThread]: On master: COMMIT
[0m23:41:01.435523 [debug] [MainThread]: Using postgres connection "master"
[0m23:41:01.435695 [debug] [MainThread]: On master: COMMIT
[0m23:41:01.435950 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:41:01.436139 [debug] [MainThread]: On master: Close
[0m23:41:01.437360 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.fact_waterlevel
[0m23:41:01.437669 [info ] [Thread-1 (]: 1 of 1 START sql incremental model fact.fact_waterlevel ........................ [RUN]
[0m23:41:01.437946 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_dim, now model.etl_waterlevel.fact_waterlevel)
[0m23:41:01.438174 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.fact_waterlevel
[0m23:41:01.443080 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.fact_waterlevel"
[0m23:41:01.443885 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.fact_waterlevel
[0m23:41:01.466173 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.fact_waterlevel"
[0m23:41:01.466953 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m23:41:01.467140 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: BEGIN
[0m23:41:01.467290 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:41:01.468796 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m23:41:01.469025 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m23:41:01.469220 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      
  
    

  create  table "airflow"."fact"."fact_waterlevel__dbt_tmp"
  
  
    as
  
  (
    

with main as (
select
	distinct
	concat("stationId",'_',"stationCode") as station_key,
	"stationId" as station_id,
	"stationCode" as station_code,
	"waterLevel" as water_level,
	"waterlevelStatus" as waterlevel_status,
    case
        when "waterlevelStatus" = 3 then '🚨 Beyond Danger'
        when "waterlevelStatus" = 2 then '⚠️ Between Warning and Danger'
        when "waterlevelStatus" = 1 then '🔶 Between Alert and Warning'
        when "waterlevelStatus" = 0 then '✅ Between Normal and Alert'
        when "waterlevelStatus" = -1 then '🟢 Below Normal (Safe)'
        else '❓ Unknown Status'
    end as waterlevel_condition,
	"stationName",
	"districtName",
	to_timestamp("lastUpdate",'DD/MM/YYYY HH24:MI') as last_update
from
	raw.waterlevels w
where
	"stationStatus" = 1



)
select
	*
from
	main
order by
	last_update desc
  );
  
  
[0m23:41:01.500567 [debug] [Thread-1 (]: SQL status: SELECT 15498 in 0.031 seconds
[0m23:41:01.505281 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m23:41:01.505571 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */
alter table "airflow"."fact"."fact_waterlevel" rename to "fact_waterlevel__dbt_backup"
[0m23:41:01.506059 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:41:01.507353 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m23:41:01.507566 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */
alter table "airflow"."fact"."fact_waterlevel__dbt_tmp" rename to "fact_waterlevel"
[0m23:41:01.507904 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:41:01.514562 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m23:41:01.514786 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m23:41:01.514986 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m23:41:01.520239 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m23:41:01.522853 [debug] [Thread-1 (]: Applying DROP to: "airflow"."fact"."fact_waterlevel__dbt_backup"
[0m23:41:01.524771 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m23:41:01.524982 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */
drop table if exists "airflow"."fact"."fact_waterlevel__dbt_backup" cascade
[0m23:41:01.526369 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m23:41:01.527468 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: Close
[0m23:41:01.528296 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a1d0af72-b061-41a5-817d-7ccc2b098624', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb45cd210>]}
[0m23:41:01.528649 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model fact.fact_waterlevel ................... [[32mSELECT 15498[0m in 0.09s]
[0m23:41:01.528942 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.fact_waterlevel
[0m23:41:01.529832 [debug] [MainThread]: Using postgres connection "master"
[0m23:41:01.530037 [debug] [MainThread]: On master: BEGIN
[0m23:41:01.530181 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:41:01.531658 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m23:41:01.531861 [debug] [MainThread]: On master: COMMIT
[0m23:41:01.532025 [debug] [MainThread]: Using postgres connection "master"
[0m23:41:01.532175 [debug] [MainThread]: On master: COMMIT
[0m23:41:01.532353 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:41:01.532486 [debug] [MainThread]: On master: Close
[0m23:41:01.532691 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:41:01.532838 [debug] [MainThread]: Connection 'model.etl_waterlevel.fact_waterlevel' was properly closed.
[0m23:41:01.532963 [debug] [MainThread]: Connection 'list_airflow_fact' was properly closed.
[0m23:41:01.533114 [info ] [MainThread]: 
[0m23:41:01.533348 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.14 seconds (0.14s).
[0m23:41:01.533709 [debug] [MainThread]: Command end result
[0m23:41:01.574170 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m23:41:01.575299 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m23:41:01.578374 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m23:41:01.578716 [info ] [MainThread]: 
[0m23:41:01.578975 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:41:01.579142 [info ] [MainThread]: 
[0m23:41:01.579295 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:41:01.579798 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.49147382, "process_in_blocks": "0", "process_kernel_time": 0.110485, "process_mem_max_rss": "118236", "process_out_blocks": "2517", "process_user_time": 0.937115}
[0m23:41:01.580026 [debug] [MainThread]: Command `dbt run` succeeded at 23:41:01.579990 after 0.49 seconds
[0m23:41:01.580205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbab09250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbab08950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbab09910>]}
[0m23:41:01.580379 [debug] [MainThread]: Flushing usage events
[0m23:41:03.151605 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:41:48.809128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fd669d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fd65dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fd67290>]}


============================== 23:41:48.810521 | 33b2f280-847d-482c-b29a-4c9b97120cab ==============================
[0m23:41:48.810521 [info ] [MainThread]: Running with dbt=1.9.0
[0m23:41:48.811001 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --select fact_waterlevel', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:41:48.870670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '33b2f280-847d-482c-b29a-4c9b97120cab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fd8bb10>]}
[0m23:41:48.892650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '33b2f280-847d-482c-b29a-4c9b97120cab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92946690>]}
[0m23:41:48.893025 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:41:48.917236 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m23:41:48.955748 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:41:48.955981 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:41:48.958289 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m23:41:48.966995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '33b2f280-847d-482c-b29a-4c9b97120cab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f1c0c10>]}
[0m23:41:48.994395 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m23:41:48.996028 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m23:41:49.002213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '33b2f280-847d-482c-b29a-4c9b97120cab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f04dc90>]}
[0m23:41:49.002484 [info ] [MainThread]: Found 3 models, 434 macros
[0m23:41:49.002711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '33b2f280-847d-482c-b29a-4c9b97120cab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ef80090>]}
[0m23:41:49.003529 [info ] [MainThread]: 
[0m23:41:49.003789 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:41:49.004130 [info ] [MainThread]: 
[0m23:41:49.004480 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:41:49.005043 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m23:41:49.020206 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m23:41:49.020434 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m23:41:49.020645 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:41:49.023021 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.002 seconds
[0m23:41:49.023597 [debug] [ThreadPool]: On list_airflow: Close
[0m23:41:49.025589 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_dim)
[0m23:41:49.025884 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow_fact'
[0m23:41:49.028629 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m23:41:49.029592 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m23:41:49.029852 [debug] [ThreadPool]: On list_airflow_dim: BEGIN
[0m23:41:49.030157 [debug] [ThreadPool]: On list_airflow_fact: BEGIN
[0m23:41:49.030369 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:41:49.030605 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:41:49.032369 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m23:41:49.032538 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m23:41:49.032760 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m23:41:49.033010 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m23:41:49.033252 [debug] [ThreadPool]: On list_airflow_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dim'
  
[0m23:41:49.033511 [debug] [ThreadPool]: On list_airflow_fact: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_fact"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'fact'
  
[0m23:41:49.034922 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m23:41:49.035061 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m23:41:49.035665 [debug] [ThreadPool]: On list_airflow_dim: ROLLBACK
[0m23:41:49.036210 [debug] [ThreadPool]: On list_airflow_fact: ROLLBACK
[0m23:41:49.036532 [debug] [ThreadPool]: On list_airflow_dim: Close
[0m23:41:49.036741 [debug] [ThreadPool]: On list_airflow_fact: Close
[0m23:41:49.039098 [debug] [MainThread]: Using postgres connection "master"
[0m23:41:49.039299 [debug] [MainThread]: On master: BEGIN
[0m23:41:49.039475 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:41:49.040928 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m23:41:49.041168 [debug] [MainThread]: Using postgres connection "master"
[0m23:41:49.041399 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:41:49.044284 [debug] [MainThread]: SQL status: SELECT 2 in 0.003 seconds
[0m23:41:49.044853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '33b2f280-847d-482c-b29a-4c9b97120cab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff904589d0>]}
[0m23:41:49.045129 [debug] [MainThread]: On master: ROLLBACK
[0m23:41:49.045397 [debug] [MainThread]: Using postgres connection "master"
[0m23:41:49.045585 [debug] [MainThread]: On master: BEGIN
[0m23:41:49.045933 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:41:49.046187 [debug] [MainThread]: On master: COMMIT
[0m23:41:49.046366 [debug] [MainThread]: Using postgres connection "master"
[0m23:41:49.046538 [debug] [MainThread]: On master: COMMIT
[0m23:41:49.046801 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:41:49.046985 [debug] [MainThread]: On master: Close
[0m23:41:49.048225 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.fact_waterlevel
[0m23:41:49.048511 [info ] [Thread-1 (]: 1 of 1 START sql incremental model fact.fact_waterlevel ........................ [RUN]
[0m23:41:49.048827 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_dim, now model.etl_waterlevel.fact_waterlevel)
[0m23:41:49.049079 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.fact_waterlevel
[0m23:41:49.054931 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.fact_waterlevel"
[0m23:41:49.055681 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.fact_waterlevel
[0m23:41:49.079949 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m23:41:49.080299 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

    
  
    

  create temporary table "fact_waterlevel__dbt_tmp234149068292"
  
  
    as
  
  (
    

with main as (
select
	distinct
	concat("stationId",'_',"stationCode") as station_key,
	"stationId" as station_id,
	"stationCode" as station_code,
	"waterLevel" as water_level,
	"waterlevelStatus" as waterlevel_status,
    case
        when "waterlevelStatus" = 3 then '🚨 Beyond Danger'
        when "waterlevelStatus" = 2 then '⚠️ Between Warning and Danger'
        when "waterlevelStatus" = 1 then '🔶 Between Alert and Warning'
        when "waterlevelStatus" = 0 then '✅ Between Normal and Alert'
        when "waterlevelStatus" = -1 then '🟢 Below Normal (Safe)'
        else '❓ Unknown Status'
    end as waterlevel_condition,
	"stationName",
	"districtName",
	to_timestamp("lastUpdate",'DD/MM/YYYY HH24:MI') as last_update
from
	raw.waterlevels w
where
	"stationStatus" = 1


    and to_timestamp("lastUpdate", 'DD/MM/YYY HH24:MI') > (select max(last_update) from "airflow"."fact"."fact_waterlevel")


)
select
	*
from
	main
order by
	last_update desc
  );
  
  
[0m23:41:49.080611 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:41:49.091268 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.011 seconds
[0m23:41:49.097505 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m23:41:49.097763 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: BEGIN
[0m23:41:49.098174 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m23:41:49.098433 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m23:41:49.098720 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp234149068292'
        
      order by ordinal_position

  
[0m23:41:49.101720 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.003 seconds
[0m23:41:49.104158 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m23:41:49.104402 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m23:41:49.105737 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m23:41:49.108993 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m23:41:49.109243 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m23:41:49.110428 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m23:41:49.115154 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.fact_waterlevel"
[0m23:41:49.115934 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m23:41:49.116171 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      insert into "airflow"."fact"."fact_waterlevel" ("station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update")
    (
        select "station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update"
        from "fact_waterlevel__dbt_tmp234149068292"
    )


  
[0m23:41:49.116538 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.000 seconds
[0m23:41:49.123321 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m23:41:49.123552 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m23:41:49.123756 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m23:41:49.124630 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:41:49.125465 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: Close
[0m23:41:49.126306 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '33b2f280-847d-482c-b29a-4c9b97120cab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f2e3cd0>]}
[0m23:41:49.126653 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model fact.fact_waterlevel ................... [[32mINSERT 0 0[0m in 0.08s]
[0m23:41:49.127151 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.fact_waterlevel
[0m23:41:49.128117 [debug] [MainThread]: Using postgres connection "master"
[0m23:41:49.128293 [debug] [MainThread]: On master: BEGIN
[0m23:41:49.128423 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:41:49.129925 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m23:41:49.130108 [debug] [MainThread]: On master: COMMIT
[0m23:41:49.130242 [debug] [MainThread]: Using postgres connection "master"
[0m23:41:49.130366 [debug] [MainThread]: On master: COMMIT
[0m23:41:49.130533 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:41:49.130662 [debug] [MainThread]: On master: Close
[0m23:41:49.130846 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:41:49.130985 [debug] [MainThread]: Connection 'model.etl_waterlevel.fact_waterlevel' was properly closed.
[0m23:41:49.131109 [debug] [MainThread]: Connection 'list_airflow_fact' was properly closed.
[0m23:41:49.131252 [info ] [MainThread]: 
[0m23:41:49.131430 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.13 seconds (0.13s).
[0m23:41:49.131832 [debug] [MainThread]: Command end result
[0m23:41:49.142965 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m23:41:49.143968 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m23:41:49.146968 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m23:41:49.147132 [info ] [MainThread]: 
[0m23:41:49.147404 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:41:49.147584 [info ] [MainThread]: 
[0m23:41:49.147805 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:41:49.148333 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.36022463, "process_in_blocks": "0", "process_kernel_time": 0.073164, "process_mem_max_rss": "115124", "process_out_blocks": "1692", "process_user_time": 0.817834}
[0m23:41:49.148556 [debug] [MainThread]: Command `dbt run` succeeded at 23:41:49.148513 after 0.36 seconds
[0m23:41:49.148762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fd8bd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fd8bb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fd8be10>]}
[0m23:41:49.148976 [debug] [MainThread]: Flushing usage events
[0m23:41:50.465960 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:35:45.220315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83347410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8317c610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83347950>]}


============================== 22:35:45.221987 | ee277278-c813-4f87-a47d-f95401446edc ==============================
[0m22:35:45.221987 [info ] [MainThread]: Running with dbt=1.9.0
[0m22:35:45.222405 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/logs', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --select fact_waterlevel --full-refresh', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:35:45.283353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ee277278-c813-4f87-a47d-f95401446edc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85dc8e50>]}
[0m22:35:45.304756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ee277278-c813-4f87-a47d-f95401446edc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8317dd10>]}
[0m22:35:45.305127 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:35:45.329712 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m22:35:45.368450 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:35:45.368688 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:35:45.370975 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m22:35:45.379904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ee277278-c813-4f87-a47d-f95401446edc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83195290>]}
[0m22:35:45.406698 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m22:35:45.408215 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m22:35:45.414609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ee277278-c813-4f87-a47d-f95401446edc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff825ab810>]}
[0m22:35:45.414857 [info ] [MainThread]: Found 3 models, 434 macros
[0m22:35:45.415095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ee277278-c813-4f87-a47d-f95401446edc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83344350>]}
[0m22:35:45.415791 [info ] [MainThread]: 
[0m22:35:45.416030 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:35:45.416244 [info ] [MainThread]: 
[0m22:35:45.416565 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:35:45.417109 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m22:35:45.434144 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m22:35:45.434378 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m22:35:45.434584 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:35:45.437418 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.003 seconds
[0m22:35:45.438050 [debug] [ThreadPool]: On list_airflow: Close
[0m22:35:45.440150 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_fact)
[0m22:35:45.440485 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow_dim'
[0m22:35:45.443189 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m22:35:45.444129 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m22:35:45.444395 [debug] [ThreadPool]: On list_airflow_fact: BEGIN
[0m22:35:45.444635 [debug] [ThreadPool]: On list_airflow_dim: BEGIN
[0m22:35:45.444869 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:35:45.445106 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:35:45.446849 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m22:35:45.447016 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m22:35:45.447216 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m22:35:45.447454 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m22:35:45.447704 [debug] [ThreadPool]: On list_airflow_fact: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_fact"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'fact'
  
[0m22:35:45.447968 [debug] [ThreadPool]: On list_airflow_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dim'
  
[0m22:35:45.449415 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m22:35:45.450084 [debug] [ThreadPool]: On list_airflow_dim: ROLLBACK
[0m22:35:45.450227 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m22:35:45.450505 [debug] [ThreadPool]: On list_airflow_dim: Close
[0m22:35:45.450988 [debug] [ThreadPool]: On list_airflow_fact: ROLLBACK
[0m22:35:45.451599 [debug] [ThreadPool]: On list_airflow_fact: Close
[0m22:35:45.453719 [debug] [MainThread]: Using postgres connection "master"
[0m22:35:45.453925 [debug] [MainThread]: On master: BEGIN
[0m22:35:45.454095 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:35:45.455582 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m22:35:45.455848 [debug] [MainThread]: Using postgres connection "master"
[0m22:35:45.456074 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:35:45.459161 [debug] [MainThread]: SQL status: SELECT 2 in 0.003 seconds
[0m22:35:45.459713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ee277278-c813-4f87-a47d-f95401446edc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff825aba90>]}
[0m22:35:45.459966 [debug] [MainThread]: On master: ROLLBACK
[0m22:35:45.460235 [debug] [MainThread]: Using postgres connection "master"
[0m22:35:45.460413 [debug] [MainThread]: On master: BEGIN
[0m22:35:45.460749 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m22:35:45.460982 [debug] [MainThread]: On master: COMMIT
[0m22:35:45.461159 [debug] [MainThread]: Using postgres connection "master"
[0m22:35:45.461328 [debug] [MainThread]: On master: COMMIT
[0m22:35:45.461581 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:35:45.461764 [debug] [MainThread]: On master: Close
[0m22:35:45.463024 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.fact_waterlevel
[0m22:35:45.463313 [info ] [Thread-1 (]: 1 of 1 START sql incremental model fact.fact_waterlevel ........................ [RUN]
[0m22:35:45.463614 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_fact, now model.etl_waterlevel.fact_waterlevel)
[0m22:35:45.463860 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.fact_waterlevel
[0m22:35:45.469455 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.fact_waterlevel"
[0m22:35:45.470455 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.fact_waterlevel
[0m22:35:45.492492 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.fact_waterlevel"
[0m22:35:45.493386 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m22:35:45.493602 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: BEGIN
[0m22:35:45.493813 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:35:45.495325 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m22:35:45.495547 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m22:35:45.495749 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      
  
    

  create  table "airflow"."fact"."fact_waterlevel__dbt_tmp"
  
  
    as
  
  (
    

with main as (
select
	distinct
	concat("stationId",'_',"stationCode") as station_key,
	"stationId" as station_id,
	"stationCode" as station_code,
	"waterLevel" as water_level,
	"waterlevelStatus" as waterlevel_status,
    case
        when "waterlevelStatus" = 3 then '🚨 Beyond Danger'
        when "waterlevelStatus" = 2 then '⚠️ Between Warning and Danger'
        when "waterlevelStatus" = 1 then '🔶 Between Alert and Warning'
        when "waterlevelStatus" = 0 then '✅ Between Normal and Alert'
        when "waterlevelStatus" = -1 then '🟢 Below Normal (Safe)'
        else '❓ Unknown Status'
    end as waterlevel_condition,
	"stationName",
	"districtName",
	to_timestamp("lastUpdate",'DD/MM/YYYY HH24:MI') as last_update
from
	raw.waterlevels w
where
	"stationStatus" = 1



)
select
	*
from
	main
order by
	last_update desc
  );
  
  
[0m22:35:45.529005 [debug] [Thread-1 (]: SQL status: SELECT 17164 in 0.033 seconds
[0m22:35:45.533395 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m22:35:45.533617 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */
alter table "airflow"."fact"."fact_waterlevel" rename to "fact_waterlevel__dbt_backup"
[0m22:35:45.534051 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:35:45.535239 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m22:35:45.535506 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */
alter table "airflow"."fact"."fact_waterlevel__dbt_tmp" rename to "fact_waterlevel"
[0m22:35:45.535833 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:35:45.542265 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m22:35:45.542482 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m22:35:45.542701 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m22:35:45.548781 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m22:35:45.551303 [debug] [Thread-1 (]: Applying DROP to: "airflow"."fact"."fact_waterlevel__dbt_backup"
[0m22:35:45.554007 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m22:35:45.554263 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */
drop table if exists "airflow"."fact"."fact_waterlevel__dbt_backup" cascade
[0m22:35:45.558238 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m22:35:45.559339 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: Close
[0m22:35:45.560204 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee277278-c813-4f87-a47d-f95401446edc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff816fae10>]}
[0m22:35:45.560580 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model fact.fact_waterlevel ................... [[32mSELECT 17164[0m in 0.10s]
[0m22:35:45.560892 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.fact_waterlevel
[0m22:35:45.561784 [debug] [MainThread]: Using postgres connection "master"
[0m22:35:45.561992 [debug] [MainThread]: On master: BEGIN
[0m22:35:45.562177 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:35:45.563835 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m22:35:45.564076 [debug] [MainThread]: On master: COMMIT
[0m22:35:45.564269 [debug] [MainThread]: Using postgres connection "master"
[0m22:35:45.564437 [debug] [MainThread]: On master: COMMIT
[0m22:35:45.564695 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:35:45.564869 [debug] [MainThread]: On master: Close
[0m22:35:45.565116 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:35:45.565299 [debug] [MainThread]: Connection 'model.etl_waterlevel.fact_waterlevel' was properly closed.
[0m22:35:45.565528 [debug] [MainThread]: Connection 'list_airflow_dim' was properly closed.
[0m22:35:45.565741 [info ] [MainThread]: 
[0m22:35:45.565985 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.15 seconds (0.15s).
[0m22:35:45.566403 [debug] [MainThread]: Command end result
[0m22:35:45.578907 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m22:35:45.579868 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m22:35:45.582745 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m22:35:45.582919 [info ] [MainThread]: 
[0m22:35:45.583174 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:35:45.583370 [info ] [MainThread]: 
[0m22:35:45.583599 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m22:35:45.584118 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.3861563, "process_in_blocks": "0", "process_kernel_time": 0.113308, "process_mem_max_rss": "115016", "process_out_blocks": "1689", "process_user_time": 0.809201}
[0m22:35:45.584352 [debug] [MainThread]: Command `dbt run` succeeded at 22:35:45.584301 after 0.39 seconds
[0m22:35:45.584550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff834785d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff836472d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87ca8990>]}
[0m22:35:45.584739 [debug] [MainThread]: Flushing usage events
[0m22:35:46.757346 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:42:08.698389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5f07350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5d54850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5d56190>]}


============================== 22:42:08.699801 | c1e753a6-21db-4273-a756-e0092b50af59 ==============================
[0m22:42:08.699801 [info ] [MainThread]: Running with dbt=1.9.0
[0m22:42:08.700218 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --select dim_threshold --full-refresh', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:42:08.760088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c1e753a6-21db-4273-a756-e0092b50af59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5319610>]}
[0m22:42:08.781629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c1e753a6-21db-4273-a756-e0092b50af59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb894d690>]}
[0m22:42:08.782015 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:42:08.807094 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m22:42:08.844197 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:42:08.844556 [debug] [MainThread]: Partial parsing: updated file: etl_waterlevel://models/dimensions/dim_threshold.sql
[0m22:42:08.930957 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m22:42:08.933295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c1e753a6-21db-4273-a756-e0092b50af59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb519ebd0>]}
[0m22:42:08.960888 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m22:42:08.962372 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m22:42:08.968014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c1e753a6-21db-4273-a756-e0092b50af59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4b3a790>]}
[0m22:42:08.968261 [info ] [MainThread]: Found 3 models, 434 macros
[0m22:42:08.968438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c1e753a6-21db-4273-a756-e0092b50af59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb536c790>]}
[0m22:42:08.969153 [info ] [MainThread]: 
[0m22:42:08.969434 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:42:08.969663 [info ] [MainThread]: 
[0m22:42:08.969985 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:42:08.970493 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m22:42:08.984426 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m22:42:08.984655 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m22:42:08.984869 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:42:08.987396 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.003 seconds
[0m22:42:08.987988 [debug] [ThreadPool]: On list_airflow: Close
[0m22:42:08.990034 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_dim)
[0m22:42:08.990335 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow_fact'
[0m22:42:08.992689 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m22:42:08.993602 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m22:42:08.993857 [debug] [ThreadPool]: On list_airflow_dim: BEGIN
[0m22:42:08.994100 [debug] [ThreadPool]: On list_airflow_fact: BEGIN
[0m22:42:08.994313 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:42:08.994551 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:42:08.996302 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m22:42:08.996428 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m22:42:08.996650 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m22:42:08.996924 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m22:42:08.997153 [debug] [ThreadPool]: On list_airflow_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dim'
  
[0m22:42:08.997415 [debug] [ThreadPool]: On list_airflow_fact: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_fact"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'fact'
  
[0m22:42:08.998979 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m22:42:08.999106 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m22:42:08.999707 [debug] [ThreadPool]: On list_airflow_fact: ROLLBACK
[0m22:42:09.000265 [debug] [ThreadPool]: On list_airflow_dim: ROLLBACK
[0m22:42:09.000586 [debug] [ThreadPool]: On list_airflow_fact: Close
[0m22:42:09.000814 [debug] [ThreadPool]: On list_airflow_dim: Close
[0m22:42:09.003265 [debug] [MainThread]: Using postgres connection "master"
[0m22:42:09.003455 [debug] [MainThread]: On master: BEGIN
[0m22:42:09.003634 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:42:09.005082 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m22:42:09.005339 [debug] [MainThread]: Using postgres connection "master"
[0m22:42:09.005566 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:42:09.008596 [debug] [MainThread]: SQL status: SELECT 2 in 0.003 seconds
[0m22:42:09.009230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c1e753a6-21db-4273-a756-e0092b50af59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6454910>]}
[0m22:42:09.009482 [debug] [MainThread]: On master: ROLLBACK
[0m22:42:09.009754 [debug] [MainThread]: Using postgres connection "master"
[0m22:42:09.009941 [debug] [MainThread]: On master: BEGIN
[0m22:42:09.010282 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m22:42:09.010500 [debug] [MainThread]: On master: COMMIT
[0m22:42:09.010698 [debug] [MainThread]: Using postgres connection "master"
[0m22:42:09.010898 [debug] [MainThread]: On master: COMMIT
[0m22:42:09.011162 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:42:09.011344 [debug] [MainThread]: On master: Close
[0m22:42:09.012552 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.dim_threshold
[0m22:42:09.012847 [info ] [Thread-1 (]: 1 of 1 START sql table model dim.dim_threshold ................................. [RUN]
[0m22:42:09.013128 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_dim, now model.etl_waterlevel.dim_threshold)
[0m22:42:09.013370 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.dim_threshold
[0m22:42:09.016329 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.dim_threshold"
[0m22:42:09.017139 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.dim_threshold
[0m22:42:09.033775 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.dim_threshold"
[0m22:42:09.034653 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_threshold"
[0m22:42:09.034885 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_threshold: BEGIN
[0m22:42:09.035082 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:42:09.036522 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m22:42:09.036740 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_threshold"
[0m22:42:09.036930 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_threshold: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.dim_threshold"} */

  
    

  create  table "airflow"."dim"."dim_threshold__dbt_tmp"
  
  
    as
  
  (
    select
	distinct 
	concat("stationId",'_',"stationCode") as station_key,
	wlth_normal,
	wlth_alert,
	wlth_warning,
	wlth_danger
from
	raw.waterlevels w
  );
  
[0m22:42:09.045691 [debug] [Thread-1 (]: SQL status: SELECT 89 in 0.009 seconds
[0m22:42:09.049698 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_threshold"
[0m22:42:09.049920 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_threshold: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.dim_threshold"} */
alter table "airflow"."dim"."dim_threshold__dbt_tmp" rename to "dim_threshold"
[0m22:42:09.050218 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:42:09.056239 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_threshold: COMMIT
[0m22:42:09.056467 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_threshold"
[0m22:42:09.056689 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_threshold: COMMIT
[0m22:42:09.057483 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m22:42:09.059957 [debug] [Thread-1 (]: Applying DROP to: "airflow"."dim"."dim_threshold__dbt_backup"
[0m22:42:09.061895 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_threshold"
[0m22:42:09.062086 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_threshold: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.dim_threshold"} */
drop table if exists "airflow"."dim"."dim_threshold__dbt_backup" cascade
[0m22:42:09.062340 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m22:42:09.063363 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_threshold: Close
[0m22:42:09.064204 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1e753a6-21db-4273-a756-e0092b50af59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb509a010>]}
[0m22:42:09.064580 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dim.dim_threshold ............................ [[32mSELECT 89[0m in 0.05s]
[0m22:42:09.064894 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.dim_threshold
[0m22:42:09.065588 [debug] [MainThread]: Using postgres connection "master"
[0m22:42:09.065813 [debug] [MainThread]: On master: BEGIN
[0m22:42:09.065969 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:42:09.067527 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m22:42:09.067774 [debug] [MainThread]: On master: COMMIT
[0m22:42:09.067965 [debug] [MainThread]: Using postgres connection "master"
[0m22:42:09.068139 [debug] [MainThread]: On master: COMMIT
[0m22:42:09.068397 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:42:09.068576 [debug] [MainThread]: On master: Close
[0m22:42:09.068808 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:42:09.068996 [debug] [MainThread]: Connection 'model.etl_waterlevel.dim_threshold' was properly closed.
[0m22:42:09.069191 [debug] [MainThread]: Connection 'list_airflow_fact' was properly closed.
[0m22:42:09.069404 [info ] [MainThread]: 
[0m22:42:09.069699 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.10 seconds (0.10s).
[0m22:42:09.070092 [debug] [MainThread]: Command end result
[0m22:42:09.082786 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m22:42:09.083726 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m22:42:09.086483 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m22:42:09.086712 [info ] [MainThread]: 
[0m22:42:09.087031 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:42:09.087231 [info ] [MainThread]: 
[0m22:42:09.087515 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m22:42:09.088083 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.41184178, "process_in_blocks": "0", "process_kernel_time": 0.082191, "process_mem_max_rss": "117688", "process_out_blocks": "2510", "process_user_time": 0.867019}
[0m22:42:09.088322 [debug] [MainThread]: Command `dbt run` succeeded at 22:42:09.088278 after 0.41 seconds
[0m22:42:09.088514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5d7df10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6119f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb603c710>]}
[0m22:42:09.088695 [debug] [MainThread]: Flushing usage events
[0m22:42:10.447193 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:53:05.339470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ed37b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ed34b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ed37490>]}


============================== 22:53:05.340966 | 806991e1-e4e1-4f46-9dbe-2dfd716543e8 ==============================
[0m22:53:05.340966 [info ] [MainThread]: Running with dbt=1.9.0
[0m22:53:05.341352 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --select dim_threshold --full-refresh', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:53:05.402527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '806991e1-e4e1-4f46-9dbe-2dfd716543e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e0dffd0>]}
[0m22:53:05.424236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '806991e1-e4e1-4f46-9dbe-2dfd716543e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff917a9d10>]}
[0m22:53:05.424611 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:53:05.449304 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m22:53:05.487344 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:53:05.487653 [debug] [MainThread]: Partial parsing: updated file: etl_waterlevel://models/dimensions/dim_threshold.sql
[0m22:53:05.574145 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m22:53:05.576478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '806991e1-e4e1-4f46-9dbe-2dfd716543e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ec2a790>]}
[0m22:53:05.603410 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m22:53:05.605058 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m22:53:05.611004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '806991e1-e4e1-4f46-9dbe-2dfd716543e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d9425d0>]}
[0m22:53:05.611246 [info ] [MainThread]: Found 3 models, 434 macros
[0m22:53:05.611451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '806991e1-e4e1-4f46-9dbe-2dfd716543e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d967150>]}
[0m22:53:05.612189 [info ] [MainThread]: 
[0m22:53:05.612463 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:53:05.612711 [info ] [MainThread]: 
[0m22:53:05.613030 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:53:05.613514 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m22:53:05.628700 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m22:53:05.628924 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m22:53:05.629117 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:53:05.631813 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.003 seconds
[0m22:53:05.632421 [debug] [ThreadPool]: On list_airflow: Close
[0m22:53:05.634444 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_fact)
[0m22:53:05.634723 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow_dim'
[0m22:53:05.637122 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m22:53:05.638035 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m22:53:05.638280 [debug] [ThreadPool]: On list_airflow_fact: BEGIN
[0m22:53:05.638580 [debug] [ThreadPool]: On list_airflow_dim: BEGIN
[0m22:53:05.638799 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:53:05.639022 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:53:05.640715 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m22:53:05.640887 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m22:53:05.641086 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m22:53:05.641333 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m22:53:05.641573 [debug] [ThreadPool]: On list_airflow_fact: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_fact"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'fact'
  
[0m22:53:05.641845 [debug] [ThreadPool]: On list_airflow_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dim'
  
[0m22:53:05.643241 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m22:53:05.643376 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.001 seconds
[0m22:53:05.643953 [debug] [ThreadPool]: On list_airflow_fact: ROLLBACK
[0m22:53:05.644551 [debug] [ThreadPool]: On list_airflow_dim: ROLLBACK
[0m22:53:05.644890 [debug] [ThreadPool]: On list_airflow_fact: Close
[0m22:53:05.645084 [debug] [ThreadPool]: On list_airflow_dim: Close
[0m22:53:05.647493 [debug] [MainThread]: Using postgres connection "master"
[0m22:53:05.647694 [debug] [MainThread]: On master: BEGIN
[0m22:53:05.647870 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:53:05.649306 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m22:53:05.649559 [debug] [MainThread]: Using postgres connection "master"
[0m22:53:05.649786 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:53:05.652815 [debug] [MainThread]: SQL status: SELECT 2 in 0.003 seconds
[0m22:53:05.653369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '806991e1-e4e1-4f46-9dbe-2dfd716543e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c92af50>]}
[0m22:53:05.653611 [debug] [MainThread]: On master: ROLLBACK
[0m22:53:05.653899 [debug] [MainThread]: Using postgres connection "master"
[0m22:53:05.654080 [debug] [MainThread]: On master: BEGIN
[0m22:53:05.654398 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m22:53:05.654652 [debug] [MainThread]: On master: COMMIT
[0m22:53:05.654827 [debug] [MainThread]: Using postgres connection "master"
[0m22:53:05.654996 [debug] [MainThread]: On master: COMMIT
[0m22:53:05.655237 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:53:05.655423 [debug] [MainThread]: On master: Close
[0m22:53:05.656650 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.dim_threshold
[0m22:53:05.656937 [info ] [Thread-1 (]: 1 of 1 START sql table model dim.dim_threshold ................................. [RUN]
[0m22:53:05.657313 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_dim, now model.etl_waterlevel.dim_threshold)
[0m22:53:05.657521 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.dim_threshold
[0m22:53:05.660417 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.dim_threshold"
[0m22:53:05.661242 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.dim_threshold
[0m22:53:05.677847 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.dim_threshold"
[0m22:53:05.678860 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_threshold"
[0m22:53:05.679063 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_threshold: BEGIN
[0m22:53:05.679264 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:53:05.680890 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m22:53:05.681141 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_threshold"
[0m22:53:05.681329 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_threshold: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.dim_threshold"} */

  
    

  create  table "airflow"."dim"."dim_threshold__dbt_tmp"
  
  
    as
  
  (
    select
	distinct 
	concat("stationId",'_',"stationCode") as station_key,
	wlth_normal,
	wlth_alert,
	wlth_warning,
	wlth_danger
from
	raw.waterlevels w
order by
	"station_key" asc
;
  );
  
[0m22:53:05.681621 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 23: ;
         ^

[0m22:53:05.681893 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_threshold: ROLLBACK
[0m22:53:05.682171 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_threshold: Close
[0m22:53:05.684127 [debug] [Thread-1 (]: Database Error in model dim_threshold (models/dimensions/dim_threshold.sql)
  syntax error at or near ";"
  LINE 23: ;
           ^
  compiled code at target/run/etl_waterlevel/models/dimensions/dim_threshold.sql
[0m22:53:05.684961 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '806991e1-e4e1-4f46-9dbe-2dfd716543e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8dd3acd0>]}
[0m22:53:05.685338 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dim.dim_threshold ........................ [[31mERROR[0m in 0.03s]
[0m22:53:05.685651 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.dim_threshold
[0m22:53:05.685945 [debug] [Thread-7 (]: Marking all children of 'model.etl_waterlevel.dim_threshold' to be skipped because of status 'error'.  Reason: Database Error in model dim_threshold (models/dimensions/dim_threshold.sql)
  syntax error at or near ";"
  LINE 23: ;
           ^
  compiled code at target/run/etl_waterlevel/models/dimensions/dim_threshold.sql.
[0m22:53:05.686990 [debug] [MainThread]: Using postgres connection "master"
[0m22:53:05.687186 [debug] [MainThread]: On master: BEGIN
[0m22:53:05.687397 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:53:05.688812 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m22:53:05.689052 [debug] [MainThread]: On master: COMMIT
[0m22:53:05.689323 [debug] [MainThread]: Using postgres connection "master"
[0m22:53:05.689533 [debug] [MainThread]: On master: COMMIT
[0m22:53:05.689836 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:53:05.690058 [debug] [MainThread]: On master: Close
[0m22:53:05.690375 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:53:05.690559 [debug] [MainThread]: Connection 'list_airflow_fact' was properly closed.
[0m22:53:05.690724 [debug] [MainThread]: Connection 'model.etl_waterlevel.dim_threshold' was properly closed.
[0m22:53:05.690942 [info ] [MainThread]: 
[0m22:53:05.691213 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.08 seconds (0.08s).
[0m22:53:05.691634 [debug] [MainThread]: Command end result
[0m22:53:05.703603 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m22:53:05.704625 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m22:53:05.707507 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m22:53:05.707699 [info ] [MainThread]: 
[0m22:53:05.707903 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m22:53:05.708163 [info ] [MainThread]: 
[0m22:53:05.708474 [error] [MainThread]:   Database Error in model dim_threshold (models/dimensions/dim_threshold.sql)
  syntax error at or near ";"
  LINE 23: ;
           ^
  compiled code at target/run/etl_waterlevel/models/dimensions/dim_threshold.sql
[0m22:53:05.708675 [info ] [MainThread]: 
[0m22:53:05.708904 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m22:53:05.709424 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.39134485, "process_in_blocks": "0", "process_kernel_time": 0.100874, "process_mem_max_rss": "117984", "process_out_blocks": "2509", "process_user_time": 0.855937}
[0m22:53:05.709649 [debug] [MainThread]: Command `dbt run` failed at 22:53:05.709607 after 0.39 seconds
[0m22:53:05.709846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ebaff90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ebafed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ef4a1d0>]}
[0m22:53:05.710051 [debug] [MainThread]: Flushing usage events
[0m22:53:07.142020 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:53:22.859352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8903f790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8903f1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8903f810>]}


============================== 22:53:22.860747 | 7a3f3976-d8e1-403f-862b-079d95e89b9d ==============================
[0m22:53:22.860747 [info ] [MainThread]: Running with dbt=1.9.0
[0m22:53:22.861181 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select dim_threshold --full-refresh', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:53:22.920238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7a3f3976-d8e1-403f-862b-079d95e89b9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8845c150>]}
[0m22:53:22.942074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7a3f3976-d8e1-403f-862b-079d95e89b9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8baa1690>]}
[0m22:53:22.942441 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:53:22.966882 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m22:53:23.003652 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:53:23.003957 [debug] [MainThread]: Partial parsing: updated file: etl_waterlevel://models/dimensions/dim_threshold.sql
[0m22:53:23.090291 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m22:53:23.092658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7a3f3976-d8e1-403f-862b-079d95e89b9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff883f9cd0>]}
[0m22:53:23.119897 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m22:53:23.121505 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m22:53:23.127041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7a3f3976-d8e1-403f-862b-079d95e89b9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87ec5e10>]}
[0m22:53:23.127286 [info ] [MainThread]: Found 3 models, 434 macros
[0m22:53:23.127538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7a3f3976-d8e1-403f-862b-079d95e89b9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87e9cf50>]}
[0m22:53:23.128323 [info ] [MainThread]: 
[0m22:53:23.128554 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:53:23.128776 [info ] [MainThread]: 
[0m22:53:23.129113 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:53:23.129662 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m22:53:23.143876 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m22:53:23.144115 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m22:53:23.144311 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:53:23.146767 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.002 seconds
[0m22:53:23.147370 [debug] [ThreadPool]: On list_airflow: Close
[0m22:53:23.149544 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_fact)
[0m22:53:23.149846 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow_dim'
[0m22:53:23.152272 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m22:53:23.153215 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m22:53:23.153457 [debug] [ThreadPool]: On list_airflow_fact: BEGIN
[0m22:53:23.153729 [debug] [ThreadPool]: On list_airflow_dim: BEGIN
[0m22:53:23.153947 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:53:23.154184 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:53:23.155939 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m22:53:23.156092 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m22:53:23.156296 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m22:53:23.156554 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m22:53:23.156810 [debug] [ThreadPool]: On list_airflow_fact: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_fact"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'fact'
  
[0m22:53:23.157088 [debug] [ThreadPool]: On list_airflow_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dim'
  
[0m22:53:23.158456 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m22:53:23.158612 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.001 seconds
[0m22:53:23.159204 [debug] [ThreadPool]: On list_airflow_fact: ROLLBACK
[0m22:53:23.159812 [debug] [ThreadPool]: On list_airflow_dim: ROLLBACK
[0m22:53:23.160135 [debug] [ThreadPool]: On list_airflow_fact: Close
[0m22:53:23.160331 [debug] [ThreadPool]: On list_airflow_dim: Close
[0m22:53:23.162710 [debug] [MainThread]: Using postgres connection "master"
[0m22:53:23.162910 [debug] [MainThread]: On master: BEGIN
[0m22:53:23.163087 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:53:23.164506 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m22:53:23.164794 [debug] [MainThread]: Using postgres connection "master"
[0m22:53:23.165029 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:53:23.167918 [debug] [MainThread]: SQL status: SELECT 2 in 0.003 seconds
[0m22:53:23.168451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7a3f3976-d8e1-403f-862b-079d95e89b9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87306710>]}
[0m22:53:23.168708 [debug] [MainThread]: On master: ROLLBACK
[0m22:53:23.168977 [debug] [MainThread]: Using postgres connection "master"
[0m22:53:23.169156 [debug] [MainThread]: On master: BEGIN
[0m22:53:23.169526 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m22:53:23.169775 [debug] [MainThread]: On master: COMMIT
[0m22:53:23.169953 [debug] [MainThread]: Using postgres connection "master"
[0m22:53:23.170132 [debug] [MainThread]: On master: COMMIT
[0m22:53:23.170383 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:53:23.170572 [debug] [MainThread]: On master: Close
[0m22:53:23.171780 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.dim_threshold
[0m22:53:23.172079 [info ] [Thread-1 (]: 1 of 1 START sql table model dim.dim_threshold ................................. [RUN]
[0m22:53:23.172429 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_fact, now model.etl_waterlevel.dim_threshold)
[0m22:53:23.172673 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.dim_threshold
[0m22:53:23.175558 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.dim_threshold"
[0m22:53:23.176392 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.dim_threshold
[0m22:53:23.192828 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.dim_threshold"
[0m22:53:23.193546 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_threshold"
[0m22:53:23.193830 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_threshold: BEGIN
[0m22:53:23.194036 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:53:23.195613 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m22:53:23.195863 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_threshold"
[0m22:53:23.196074 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_threshold: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.dim_threshold"} */

  
    

  create  table "airflow"."dim"."dim_threshold__dbt_tmp"
  
  
    as
  
  (
    select
	distinct 
	concat("stationId",'_',"stationCode") as station_key,
	wlth_normal,
	wlth_alert,
	wlth_warning,
	wlth_danger
from
	raw.waterlevels w
order by
	"station_key" asc
  );
  
[0m22:53:23.205067 [debug] [Thread-1 (]: SQL status: SELECT 89 in 0.009 seconds
[0m22:53:23.209338 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_threshold"
[0m22:53:23.209567 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_threshold: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.dim_threshold"} */
alter table "airflow"."dim"."dim_threshold" rename to "dim_threshold__dbt_backup"
[0m22:53:23.209897 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:53:23.211151 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_threshold"
[0m22:53:23.211325 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_threshold: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.dim_threshold"} */
alter table "airflow"."dim"."dim_threshold__dbt_tmp" rename to "dim_threshold"
[0m22:53:23.211567 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:53:23.218318 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_threshold: COMMIT
[0m22:53:23.218572 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_threshold"
[0m22:53:23.218773 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_threshold: COMMIT
[0m22:53:23.219935 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m22:53:23.222521 [debug] [Thread-1 (]: Applying DROP to: "airflow"."dim"."dim_threshold__dbt_backup"
[0m22:53:23.224582 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_threshold"
[0m22:53:23.224815 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_threshold: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.dim_threshold"} */
drop table if exists "airflow"."dim"."dim_threshold__dbt_backup" cascade
[0m22:53:23.225757 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m22:53:23.226794 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_threshold: Close
[0m22:53:23.227618 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a3f3976-d8e1-403f-862b-079d95e89b9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88070b50>]}
[0m22:53:23.228013 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dim.dim_threshold ............................ [[32mSELECT 89[0m in 0.05s]
[0m22:53:23.228414 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.dim_threshold
[0m22:53:23.229130 [debug] [MainThread]: Using postgres connection "master"
[0m22:53:23.229289 [debug] [MainThread]: On master: BEGIN
[0m22:53:23.229415 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:53:23.230691 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m22:53:23.230876 [debug] [MainThread]: On master: COMMIT
[0m22:53:23.231033 [debug] [MainThread]: Using postgres connection "master"
[0m22:53:23.231182 [debug] [MainThread]: On master: COMMIT
[0m22:53:23.231364 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:53:23.231560 [debug] [MainThread]: On master: Close
[0m22:53:23.231771 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:53:23.231915 [debug] [MainThread]: Connection 'model.etl_waterlevel.dim_threshold' was properly closed.
[0m22:53:23.232041 [debug] [MainThread]: Connection 'list_airflow_dim' was properly closed.
[0m22:53:23.232187 [info ] [MainThread]: 
[0m22:53:23.232364 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.10 seconds (0.10s).
[0m22:53:23.232765 [debug] [MainThread]: Command end result
[0m22:53:23.271137 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m22:53:23.272258 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m22:53:23.275204 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m22:53:23.275372 [info ] [MainThread]: 
[0m22:53:23.275626 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:53:23.275893 [info ] [MainThread]: 
[0m22:53:23.276135 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m22:53:23.276690 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.43851504, "process_in_blocks": "0", "process_kernel_time": 0.085652, "process_mem_max_rss": "117676", "process_out_blocks": "2511", "process_user_time": 0.886756}
[0m22:53:23.276904 [debug] [MainThread]: Command `dbt run` succeeded at 22:53:23.276862 after 0.44 seconds
[0m22:53:23.277091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88eb7e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d965650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d965110>]}
[0m22:53:23.277283 [debug] [MainThread]: Flushing usage events
[0m22:53:24.548060 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:54:16.593902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82402f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82254490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82255c90>]}


============================== 22:54:16.595312 | 1355d8d5-ddae-49c0-a739-efa819bfeb92 ==============================
[0m22:54:16.595312 [info ] [MainThread]: Running with dbt=1.9.0
[0m22:54:16.595739 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --select dim_stations --full-refresh', 'send_anonymous_usage_stats': 'True'}
[0m22:54:16.655416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1355d8d5-ddae-49c0-a739-efa819bfeb92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff817e91d0>]}
[0m22:54:16.677209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1355d8d5-ddae-49c0-a739-efa819bfeb92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84e5d390>]}
[0m22:54:16.677588 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:54:16.701821 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m22:54:16.738230 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:54:16.738463 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:54:16.740727 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m22:54:16.749293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1355d8d5-ddae-49c0-a739-efa819bfeb92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8183a050>]}
[0m22:54:16.776881 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m22:54:16.778307 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m22:54:16.783852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1355d8d5-ddae-49c0-a739-efa819bfeb92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8157f350>]}
[0m22:54:16.784087 [info ] [MainThread]: Found 3 models, 434 macros
[0m22:54:16.784310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1355d8d5-ddae-49c0-a739-efa819bfeb92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8152e350>]}
[0m22:54:16.785023 [info ] [MainThread]: 
[0m22:54:16.785222 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:54:16.785441 [info ] [MainThread]: 
[0m22:54:16.785807 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:54:16.786375 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m22:54:16.801125 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m22:54:16.801372 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m22:54:16.801582 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:54:16.804198 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.003 seconds
[0m22:54:16.804792 [debug] [ThreadPool]: On list_airflow: Close
[0m22:54:16.806868 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_fact)
[0m22:54:16.807162 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow_dim'
[0m22:54:16.809752 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m22:54:16.810705 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m22:54:16.810942 [debug] [ThreadPool]: On list_airflow_fact: BEGIN
[0m22:54:16.811199 [debug] [ThreadPool]: On list_airflow_dim: BEGIN
[0m22:54:16.811412 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:54:16.811645 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:54:16.813407 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m22:54:16.813548 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m22:54:16.813744 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m22:54:16.813981 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m22:54:16.814213 [debug] [ThreadPool]: On list_airflow_fact: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_fact"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'fact'
  
[0m22:54:16.814504 [debug] [ThreadPool]: On list_airflow_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dim'
  
[0m22:54:16.816056 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.001 seconds
[0m22:54:16.816188 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m22:54:16.816786 [debug] [ThreadPool]: On list_airflow_dim: ROLLBACK
[0m22:54:16.817368 [debug] [ThreadPool]: On list_airflow_fact: ROLLBACK
[0m22:54:16.817698 [debug] [ThreadPool]: On list_airflow_dim: Close
[0m22:54:16.817921 [debug] [ThreadPool]: On list_airflow_fact: Close
[0m22:54:16.820273 [debug] [MainThread]: Using postgres connection "master"
[0m22:54:16.820473 [debug] [MainThread]: On master: BEGIN
[0m22:54:16.820644 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:54:16.822166 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m22:54:16.822492 [debug] [MainThread]: Using postgres connection "master"
[0m22:54:16.822713 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:54:16.825980 [debug] [MainThread]: SQL status: SELECT 2 in 0.003 seconds
[0m22:54:16.826546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1355d8d5-ddae-49c0-a739-efa819bfeb92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff817add10>]}
[0m22:54:16.826786 [debug] [MainThread]: On master: ROLLBACK
[0m22:54:16.827058 [debug] [MainThread]: Using postgres connection "master"
[0m22:54:16.827237 [debug] [MainThread]: On master: BEGIN
[0m22:54:16.827585 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m22:54:16.827820 [debug] [MainThread]: On master: COMMIT
[0m22:54:16.827998 [debug] [MainThread]: Using postgres connection "master"
[0m22:54:16.828169 [debug] [MainThread]: On master: COMMIT
[0m22:54:16.828434 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:54:16.828620 [debug] [MainThread]: On master: Close
[0m22:54:16.829837 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.dim_stations
[0m22:54:16.830123 [info ] [Thread-1 (]: 1 of 1 START sql table model dim.dim_stations .................................. [RUN]
[0m22:54:16.830445 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_fact, now model.etl_waterlevel.dim_stations)
[0m22:54:16.830698 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.dim_stations
[0m22:54:16.833671 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.dim_stations"
[0m22:54:16.835119 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.dim_stations
[0m22:54:16.850936 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.dim_stations"
[0m22:54:16.851635 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m22:54:16.851846 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: BEGIN
[0m22:54:16.852045 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:54:16.853633 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m22:54:16.853880 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m22:54:16.854090 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.dim_stations"} */

  
    

  create  table "airflow"."dim"."dim_stations__dbt_tmp"
  
  
    as
  
  (
    -- models/dimensions/dim_stations.sql

with station_names as (
select
	distinct
    "stationId" as station_id,
	"stationName" as station_name,
	"stationCode" as station_code,
	"districtName" as district_name,
	"latitude" as latitude,
	"longitude" as longitude,
	"stationStatus" as station_status
from
	raw.waterlevels
)

select
	*
from
	station_names
order by
	district_name,
	station_code asc
  );
  
[0m22:54:16.862742 [debug] [Thread-1 (]: SQL status: SELECT 94 in 0.008 seconds
[0m22:54:16.866961 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m22:54:16.867158 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.dim_stations"} */
alter table "airflow"."dim"."dim_stations" rename to "dim_stations__dbt_backup"
[0m22:54:16.867573 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:54:16.868796 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m22:54:16.868979 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.dim_stations"} */
alter table "airflow"."dim"."dim_stations__dbt_tmp" rename to "dim_stations"
[0m22:54:16.869217 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:54:16.875881 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: COMMIT
[0m22:54:16.876116 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m22:54:16.876314 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: COMMIT
[0m22:54:16.877138 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m22:54:16.879660 [debug] [Thread-1 (]: Applying DROP to: "airflow"."dim"."dim_stations__dbt_backup"
[0m22:54:16.881628 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m22:54:16.881811 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.dim_stations"} */
drop view if exists "airflow"."dim"."dim_stations__dbt_backup" cascade
[0m22:54:16.882691 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m22:54:16.883699 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: Close
[0m22:54:16.884465 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1355d8d5-ddae-49c0-a739-efa819bfeb92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81617a90>]}
[0m22:54:16.884791 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dim.dim_stations ............................. [[32mSELECT 94[0m in 0.05s]
[0m22:54:16.885145 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.dim_stations
[0m22:54:16.885942 [debug] [MainThread]: Using postgres connection "master"
[0m22:54:16.886110 [debug] [MainThread]: On master: BEGIN
[0m22:54:16.886267 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:54:16.887605 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m22:54:16.887804 [debug] [MainThread]: On master: COMMIT
[0m22:54:16.887957 [debug] [MainThread]: Using postgres connection "master"
[0m22:54:16.888104 [debug] [MainThread]: On master: COMMIT
[0m22:54:16.888307 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:54:16.888460 [debug] [MainThread]: On master: Close
[0m22:54:16.888659 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:54:16.888802 [debug] [MainThread]: Connection 'model.etl_waterlevel.dim_stations' was properly closed.
[0m22:54:16.888923 [debug] [MainThread]: Connection 'list_airflow_dim' was properly closed.
[0m22:54:16.889066 [info ] [MainThread]: 
[0m22:54:16.889232 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.10 seconds (0.10s).
[0m22:54:16.889627 [debug] [MainThread]: Command end result
[0m22:54:16.902589 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m22:54:16.903566 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m22:54:16.906465 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m22:54:16.906627 [info ] [MainThread]: 
[0m22:54:16.906865 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:54:16.907062 [info ] [MainThread]: 
[0m22:54:16.907307 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m22:54:16.907817 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.33507416, "process_in_blocks": "0", "process_kernel_time": 0.067947, "process_mem_max_rss": "114376", "process_out_blocks": "1685", "process_user_time": 0.795383}
[0m22:54:16.908054 [debug] [MainThread]: Command `dbt run` succeeded at 22:54:16.908012 after 0.34 seconds
[0m22:54:16.908243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8227bd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8222fc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff824ef7d0>]}
[0m22:54:16.908435 [debug] [MainThread]: Flushing usage events
[0m22:54:18.114143 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:55:20.771513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95a37a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95a36390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95a37550>]}


============================== 22:55:20.772925 | e6a5de25-edf0-4b16-9112-66f01d7be269 ==============================
[0m22:55:20.772925 [info ] [MainThread]: Running with dbt=1.9.0
[0m22:55:20.773343 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt debug', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:55:20.776872 [info ] [MainThread]: dbt version: 1.9.0
[0m22:55:20.777162 [info ] [MainThread]: python version: 3.11.11
[0m22:55:20.777499 [info ] [MainThread]: python path: /usr/local/bin/python3.11
[0m22:55:20.777754 [info ] [MainThread]: os info: Linux-6.10.14-linuxkit-aarch64-with-glibc2.36
[0m22:55:20.797278 [info ] [MainThread]: Using profiles dir at /root/.dbt
[0m22:55:20.797562 [info ] [MainThread]: Using profiles.yml file at /root/.dbt/profiles.yml
[0m22:55:20.797831 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt_project.yml
[0m22:55:20.798209 [info ] [MainThread]: adapter type: postgres
[0m22:55:20.798461 [info ] [MainThread]: adapter version: 1.9.0
[0m22:55:20.835674 [info ] [MainThread]: Configuration:
[0m22:55:20.835919 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m22:55:20.836190 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m22:55:20.836418 [info ] [MainThread]: Required dependencies:
[0m22:55:20.836679 [debug] [MainThread]: Executing "git --help"
[0m22:55:20.837175 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m22:55:20.837379 [info ] [MainThread]: Connection:
[0m22:55:20.837634 [info ] [MainThread]:   host: postgres
[0m22:55:20.837866 [info ] [MainThread]:   port: 5432
[0m22:55:20.838102 [info ] [MainThread]:   user: airflow
[0m22:55:20.838344 [info ] [MainThread]:   database: airflow
[0m22:55:20.838569 [info ] [MainThread]:   schema: staging
[0m22:55:20.838827 [info ] [MainThread]:   connect_timeout: 10
[0m22:55:20.839019 [info ] [MainThread]:   role: None
[0m22:55:20.839229 [info ] [MainThread]:   search_path: None
[0m22:55:20.839439 [info ] [MainThread]:   keepalives_idle: 0
[0m22:55:20.839638 [info ] [MainThread]:   sslmode: None
[0m22:55:20.839887 [info ] [MainThread]:   sslcert: None
[0m22:55:20.840091 [info ] [MainThread]:   sslkey: None
[0m22:55:20.840293 [info ] [MainThread]:   sslrootcert: None
[0m22:55:20.840504 [info ] [MainThread]:   application_name: dbt
[0m22:55:20.840725 [info ] [MainThread]:   retries: 1
[0m22:55:20.841037 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:55:20.862754 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m22:55:20.871961 [debug] [MainThread]: Using postgres connection "debug"
[0m22:55:20.872177 [debug] [MainThread]: On debug: select 1 as id
[0m22:55:20.872363 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:55:20.874749 [debug] [MainThread]: SQL status: SELECT 1 in 0.002 seconds
[0m22:55:20.875202 [debug] [MainThread]: On debug: Close
[0m22:55:20.875422 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m22:55:20.876460 [info ] [MainThread]: [31m1 check failed:[0m
[0m22:55:20.876655 [info ] [MainThread]: Error from git --help: Could not find command, ensure it is in the user's PATH: "git"

[0m22:55:20.877198 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.12657842, "process_in_blocks": "0", "process_kernel_time": 0.070029, "process_mem_max_rss": "108164", "process_out_blocks": "8", "process_user_time": 0.632262}
[0m22:55:20.877422 [debug] [MainThread]: Command `dbt debug` failed at 22:55:20.877382 after 0.13 seconds
[0m22:55:20.877620 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m22:55:20.877821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94dca650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94960250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a385290>]}
[0m22:55:20.878047 [debug] [MainThread]: Flushing usage events
[0m22:55:22.199483 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:55:32.025591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8dd40990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8dd41550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8dd43610>]}


============================== 22:55:32.027004 | 5a63ccf5-9354-4418-9382-dfc44c8ea8de ==============================
[0m22:55:32.027004 [info ] [MainThread]: Running with dbt=1.9.0
[0m22:55:32.027414 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/logs', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt ls', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:55:32.087421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5a63ccf5-9354-4418-9382-dfc44c8ea8de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d1a4a90>]}
[0m22:55:32.109259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5a63ccf5-9354-4418-9382-dfc44c8ea8de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9077c850>]}
[0m22:55:32.109628 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:55:32.133590 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m22:55:32.174622 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:55:32.174886 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:55:32.177214 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m22:55:32.186027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5a63ccf5-9354-4418-9382-dfc44c8ea8de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cffe1d0>]}
[0m22:55:32.213636 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m22:55:32.215122 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m22:55:32.219725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5a63ccf5-9354-4418-9382-dfc44c8ea8de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cedac50>]}
[0m22:55:32.219969 [info ] [MainThread]: Found 3 models, 434 macros
[0m22:55:32.220193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5a63ccf5-9354-4418-9382-dfc44c8ea8de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cdae290>]}
[0m22:55:32.220632 [info ] [MainThread]: etl_waterlevel.dimensions.dim_stations
[0m22:55:32.220846 [info ] [MainThread]: etl_waterlevel.dimensions.dim_threshold
[0m22:55:32.221098 [info ] [MainThread]: etl_waterlevel.facts.fact_waterlevel
[0m22:55:32.221603 [debug] [MainThread]: Resource report: {"command_name": "list", "command_success": true, "command_wall_clock_time": 0.21681988, "process_in_blocks": "0", "process_kernel_time": 0.081766, "process_mem_max_rss": "105360", "process_out_blocks": "834", "process_user_time": 0.701}
[0m22:55:32.221848 [debug] [MainThread]: Command `dbt ls` succeeded at 22:55:32.221802 after 0.22 seconds
[0m22:55:32.222050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92649210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92648650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8dd49150>]}
[0m22:55:32.222249 [debug] [MainThread]: Flushing usage events
[0m22:55:33.350825 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:05:38.610985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8123f610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8123f790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8123ee90>]}


============================== 23:05:38.615171 | 76f1f61d-cf57-4399-b0d4-7d15672dc25c ==============================
[0m23:05:38.615171 [info ] [MainThread]: Running with dbt=1.9.0
[0m23:05:38.615602 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select dim_stations --full-refresh', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:05:38.676982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '76f1f61d-cf57-4399-b0d4-7d15672dc25c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81250e90>]}
[0m23:05:38.699993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '76f1f61d-cf57-4399-b0d4-7d15672dc25c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83cc9ed0>]}
[0m23:05:38.700471 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:05:38.725487 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m23:05:38.763171 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:05:38.763404 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:05:38.765762 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m23:05:38.774468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '76f1f61d-cf57-4399-b0d4-7d15672dc25c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80325e90>]}
[0m23:05:38.802066 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m23:05:38.805185 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m23:05:38.811361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '76f1f61d-cf57-4399-b0d4-7d15672dc25c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80494d50>]}
[0m23:05:38.811601 [info ] [MainThread]: Found 3 models, 434 macros
[0m23:05:38.811790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '76f1f61d-cf57-4399-b0d4-7d15672dc25c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80445210>]}
[0m23:05:38.812410 [info ] [MainThread]: 
[0m23:05:38.812663 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:05:38.812899 [info ] [MainThread]: 
[0m23:05:38.813249 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:05:38.813781 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m23:05:38.829623 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m23:05:38.829874 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m23:05:38.830079 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:05:38.832732 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.003 seconds
[0m23:05:38.833339 [debug] [ThreadPool]: On list_airflow: Close
[0m23:05:38.835345 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_fact)
[0m23:05:38.835626 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow_dim'
[0m23:05:38.838305 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m23:05:38.839250 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m23:05:38.839484 [debug] [ThreadPool]: On list_airflow_fact: BEGIN
[0m23:05:38.839730 [debug] [ThreadPool]: On list_airflow_dim: BEGIN
[0m23:05:38.839945 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:05:38.840174 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:05:38.841775 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m23:05:38.842018 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m23:05:38.842161 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m23:05:38.842416 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m23:05:38.842654 [debug] [ThreadPool]: On list_airflow_fact: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_fact"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'fact'
  
[0m23:05:38.842923 [debug] [ThreadPool]: On list_airflow_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dim'
  
[0m23:05:38.844358 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m23:05:38.844510 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.001 seconds
[0m23:05:38.845169 [debug] [ThreadPool]: On list_airflow_fact: ROLLBACK
[0m23:05:38.845783 [debug] [ThreadPool]: On list_airflow_dim: ROLLBACK
[0m23:05:38.846095 [debug] [ThreadPool]: On list_airflow_fact: Close
[0m23:05:38.846361 [debug] [ThreadPool]: On list_airflow_dim: Close
[0m23:05:38.848854 [debug] [MainThread]: Using postgres connection "master"
[0m23:05:38.849077 [debug] [MainThread]: On master: BEGIN
[0m23:05:38.849268 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:05:38.850693 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m23:05:38.850992 [debug] [MainThread]: Using postgres connection "master"
[0m23:05:38.851222 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:05:38.854204 [debug] [MainThread]: SQL status: SELECT 1 in 0.003 seconds
[0m23:05:38.854752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '76f1f61d-cf57-4399-b0d4-7d15672dc25c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff803b6ad0>]}
[0m23:05:38.855048 [debug] [MainThread]: On master: ROLLBACK
[0m23:05:38.855316 [debug] [MainThread]: Using postgres connection "master"
[0m23:05:38.855497 [debug] [MainThread]: On master: BEGIN
[0m23:05:38.855829 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:05:38.856074 [debug] [MainThread]: On master: COMMIT
[0m23:05:38.856243 [debug] [MainThread]: Using postgres connection "master"
[0m23:05:38.856416 [debug] [MainThread]: On master: COMMIT
[0m23:05:38.856662 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:05:38.856865 [debug] [MainThread]: On master: Close
[0m23:05:38.858107 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.dim_stations
[0m23:05:38.858423 [info ] [Thread-1 (]: 1 of 1 START sql table model dim.dim_stations .................................. [RUN]
[0m23:05:38.858697 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_dim, now model.etl_waterlevel.dim_stations)
[0m23:05:38.858962 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.dim_stations
[0m23:05:38.862044 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.dim_stations"
[0m23:05:38.862811 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.dim_stations
[0m23:05:38.878975 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.dim_stations"
[0m23:05:38.879766 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m23:05:38.879982 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: BEGIN
[0m23:05:38.880178 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:05:38.881735 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m23:05:38.881961 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m23:05:38.882140 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.dim_stations"} */

  
    

  create  table "airflow"."dim"."dim_stations__dbt_tmp"
  
  
    as
  
  (
    -- models/dimensions/dim_stations.sql

with station_names as (
select
	distinct
    "stationId" as station_id,
	"stationName" as station_name,
	"stationCode" as station_code,
	"districtName" as district_name,
	"latitude" as latitude,
	"longitude" as longitude,
	"stationStatus" as station_status
from
	raw.waterlevels
)

select
	*
from
	station_names
order by
	district_name,
	station_code asc
  );
  
[0m23:05:38.891496 [debug] [Thread-1 (]: SQL status: SELECT 94 in 0.009 seconds
[0m23:05:38.895694 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m23:05:38.895901 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.dim_stations"} */
alter table "airflow"."dim"."dim_stations" rename to "dim_stations__dbt_backup"
[0m23:05:38.896208 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:05:38.897428 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m23:05:38.897640 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.dim_stations"} */
alter table "airflow"."dim"."dim_stations__dbt_tmp" rename to "dim_stations"
[0m23:05:38.898002 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:05:38.904610 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: COMMIT
[0m23:05:38.904851 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m23:05:38.905047 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: COMMIT
[0m23:05:38.906147 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:05:38.908600 [debug] [Thread-1 (]: Applying DROP to: "airflow"."dim"."dim_stations__dbt_backup"
[0m23:05:38.910745 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m23:05:38.910956 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.dim_stations"} */
drop table if exists "airflow"."dim"."dim_stations__dbt_backup" cascade
[0m23:05:38.911829 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m23:05:38.912864 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: Close
[0m23:05:38.913614 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76f1f61d-cf57-4399-b0d4-7d15672dc25c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f6c1bd0>]}
[0m23:05:38.913957 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dim.dim_stations ............................. [[32mSELECT 94[0m in 0.05s]
[0m23:05:38.914236 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.dim_stations
[0m23:05:38.915079 [debug] [MainThread]: Using postgres connection "master"
[0m23:05:38.915231 [debug] [MainThread]: On master: BEGIN
[0m23:05:38.915354 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:05:38.916645 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m23:05:38.916882 [debug] [MainThread]: On master: COMMIT
[0m23:05:38.917072 [debug] [MainThread]: Using postgres connection "master"
[0m23:05:38.917246 [debug] [MainThread]: On master: COMMIT
[0m23:05:38.917443 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:05:38.917581 [debug] [MainThread]: On master: Close
[0m23:05:38.917766 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:05:38.917901 [debug] [MainThread]: Connection 'list_airflow_fact' was properly closed.
[0m23:05:38.918021 [debug] [MainThread]: Connection 'model.etl_waterlevel.dim_stations' was properly closed.
[0m23:05:38.918172 [info ] [MainThread]: 
[0m23:05:38.918337 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.11 seconds (0.11s).
[0m23:05:38.918693 [debug] [MainThread]: Command end result
[0m23:05:38.931316 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m23:05:38.932309 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m23:05:38.935224 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m23:05:38.935374 [info ] [MainThread]: 
[0m23:05:38.935597 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:05:38.935866 [info ] [MainThread]: 
[0m23:05:38.936105 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:05:38.936618 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.34709334, "process_in_blocks": "0", "process_kernel_time": 0.088131, "process_mem_max_rss": "114480", "process_out_blocks": "1685", "process_user_time": 0.81992}
[0m23:05:38.936830 [debug] [MainThread]: Command `dbt run` succeeded at 23:05:38.936794 after 0.35 seconds
[0m23:05:38.937014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81336290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85ba4810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85ba5290>]}
[0m23:05:38.937189 [debug] [MainThread]: Flushing usage events
[0m23:05:40.288361 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:42:08.343425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9f46f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa07c910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9f47ad0>]}


============================== 23:42:08.345383 | 3f6c85de-b0e9-4870-9f8c-a119105867a2 ==============================
[0m23:42:08.345383 [info ] [MainThread]: Running with dbt=1.9.0
[0m23:42:08.345743 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select fact_waterlevel --full-refresh', 'send_anonymous_usage_stats': 'True'}
[0m23:42:08.407650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3f6c85de-b0e9-4870-9f8c-a119105867a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9dde250>]}
[0m23:42:08.429511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3f6c85de-b0e9-4870-9f8c-a119105867a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac9b1e50>]}
[0m23:42:08.429887 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:42:08.454685 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m23:42:08.492882 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:42:08.493207 [debug] [MainThread]: Partial parsing: updated file: etl_waterlevel://models/facts/fact_waterlevel.sql
[0m23:42:08.583741 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m23:42:08.586126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3f6c85de-b0e9-4870-9f8c-a119105867a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8f72210>]}
[0m23:42:08.614045 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m23:42:08.615656 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m23:42:08.621694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3f6c85de-b0e9-4870-9f8c-a119105867a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8cac7d0>]}
[0m23:42:08.621928 [info ] [MainThread]: Found 3 models, 434 macros
[0m23:42:08.622182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3f6c85de-b0e9-4870-9f8c-a119105867a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8e2b0d0>]}
[0m23:42:08.622934 [info ] [MainThread]: 
[0m23:42:08.623151 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:42:08.623359 [info ] [MainThread]: 
[0m23:42:08.623693 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:42:08.624185 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m23:42:08.640643 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m23:42:08.640883 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m23:42:08.641122 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:42:08.644025 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.003 seconds
[0m23:42:08.644639 [debug] [ThreadPool]: On list_airflow: Close
[0m23:42:08.646694 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_dim)
[0m23:42:08.647024 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow_fact'
[0m23:42:08.649473 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m23:42:08.650469 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m23:42:08.650704 [debug] [ThreadPool]: On list_airflow_dim: BEGIN
[0m23:42:08.650947 [debug] [ThreadPool]: On list_airflow_fact: BEGIN
[0m23:42:08.651505 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:42:08.651742 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:42:08.653445 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m23:42:08.653714 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m23:42:08.653869 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m23:42:08.654128 [debug] [ThreadPool]: On list_airflow_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dim'
  
[0m23:42:08.654392 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m23:42:08.654770 [debug] [ThreadPool]: On list_airflow_fact: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_fact"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'fact'
  
[0m23:42:08.655843 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.001 seconds
[0m23:42:08.656036 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m23:42:08.656587 [debug] [ThreadPool]: On list_airflow_dim: ROLLBACK
[0m23:42:08.657209 [debug] [ThreadPool]: On list_airflow_fact: ROLLBACK
[0m23:42:08.657549 [debug] [ThreadPool]: On list_airflow_dim: Close
[0m23:42:08.657765 [debug] [ThreadPool]: On list_airflow_fact: Close
[0m23:42:08.660192 [debug] [MainThread]: Using postgres connection "master"
[0m23:42:08.660390 [debug] [MainThread]: On master: BEGIN
[0m23:42:08.660561 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:42:08.661977 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m23:42:08.662200 [debug] [MainThread]: Using postgres connection "master"
[0m23:42:08.662428 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:42:08.663840 [debug] [MainThread]: SQL status: SELECT 0 in 0.001 seconds
[0m23:42:08.664344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3f6c85de-b0e9-4870-9f8c-a119105867a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa494410>]}
[0m23:42:08.664602 [debug] [MainThread]: On master: ROLLBACK
[0m23:42:08.664867 [debug] [MainThread]: Using postgres connection "master"
[0m23:42:08.665053 [debug] [MainThread]: On master: BEGIN
[0m23:42:08.665392 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:42:08.665623 [debug] [MainThread]: On master: COMMIT
[0m23:42:08.665802 [debug] [MainThread]: Using postgres connection "master"
[0m23:42:08.665996 [debug] [MainThread]: On master: COMMIT
[0m23:42:08.666254 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:42:08.666436 [debug] [MainThread]: On master: Close
[0m23:42:08.667687 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.fact_waterlevel
[0m23:42:08.667996 [info ] [Thread-1 (]: 1 of 1 START sql incremental model fact.fact_waterlevel ........................ [RUN]
[0m23:42:08.668284 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_fact, now model.etl_waterlevel.fact_waterlevel)
[0m23:42:08.668535 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.fact_waterlevel
[0m23:42:08.673341 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.fact_waterlevel"
[0m23:42:08.674763 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.fact_waterlevel
[0m23:42:08.697046 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.fact_waterlevel"
[0m23:42:08.698003 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m23:42:08.698222 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: BEGIN
[0m23:42:08.698415 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:42:08.700143 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m23:42:08.700383 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m23:42:08.700669 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      
  
    

  create  table "airflow"."fact"."fact_waterlevel__dbt_tmp"
  
  
    as
  
  (
    

with main as (
select
	distinct
	concat("stationId",'_',"stationCode") as station_key,
	"stationId" as station_id,
	"stationCode" as station_code,
	"waterLevel" as water_level,
	"waterlevelStatus" as waterlevel_status,
    case
        when "waterlevelStatus" = 3 then '🚨 Beyond Danger'
        when "waterlevelStatus" = 2 then '⚠️ Between Warning and Danger'
        when "waterlevelStatus" = 1 then '🔶 Between Alert and Warning'
        when "waterlevelStatus" = 0 then '✅ Between Normal and Alert'
        when "waterlevelStatus" = -1 then '🟢 Below Normal (Safe)'
        else '❓ Unknown Status'
    end as waterlevel_condition,
	"stationName",
	"districtName",
	to_timestamp("lastUpdate",'DD/MM/YYYY HH24:MI') as last_update
from
	raw.waterlevels w
where
	"stationStatus" = 1



)
select
	*
from
	main
order by
	last_update desc
  );
  
  
[0m23:42:08.737519 [debug] [Thread-1 (]: SQL status: SELECT 17236 in 0.037 seconds
[0m23:42:08.742409 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m23:42:08.742692 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */
alter table "airflow"."fact"."fact_waterlevel" rename to "fact_waterlevel__dbt_backup"
[0m23:42:08.743191 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:42:08.744492 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m23:42:08.744705 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */
alter table "airflow"."fact"."fact_waterlevel__dbt_tmp" rename to "fact_waterlevel"
[0m23:42:08.745087 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:42:08.751717 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m23:42:08.752011 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m23:42:08.752215 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m23:42:08.758178 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m23:42:08.760823 [debug] [Thread-1 (]: Applying DROP to: "airflow"."fact"."fact_waterlevel__dbt_backup"
[0m23:42:08.762781 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m23:42:08.763023 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */
drop table if exists "airflow"."fact"."fact_waterlevel__dbt_backup" cascade
[0m23:42:08.764404 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m23:42:08.765501 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: Close
[0m23:42:08.766417 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f6c85de-b0e9-4870-9f8c-a119105867a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8ca5cd0>]}
[0m23:42:08.766796 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model fact.fact_waterlevel ................... [[32mSELECT 17236[0m in 0.10s]
[0m23:42:08.767156 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.fact_waterlevel
[0m23:42:08.768007 [debug] [MainThread]: Using postgres connection "master"
[0m23:42:08.768167 [debug] [MainThread]: On master: BEGIN
[0m23:42:08.768300 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:42:08.769833 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m23:42:08.770028 [debug] [MainThread]: On master: COMMIT
[0m23:42:08.770203 [debug] [MainThread]: Using postgres connection "master"
[0m23:42:08.770381 [debug] [MainThread]: On master: COMMIT
[0m23:42:08.770580 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:42:08.770726 [debug] [MainThread]: On master: Close
[0m23:42:08.770928 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:42:08.771083 [debug] [MainThread]: Connection 'list_airflow_dim' was properly closed.
[0m23:42:08.771223 [debug] [MainThread]: Connection 'model.etl_waterlevel.fact_waterlevel' was properly closed.
[0m23:42:08.771397 [info ] [MainThread]: 
[0m23:42:08.771622 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.15 seconds (0.15s).
[0m23:42:08.772191 [debug] [MainThread]: Command end result
[0m23:42:08.815161 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m23:42:08.816372 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m23:42:08.819841 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m23:42:08.820025 [info ] [MainThread]: 
[0m23:42:08.820289 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:42:08.820595 [info ] [MainThread]: 
[0m23:42:08.820883 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:42:08.821604 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.49955976, "process_in_blocks": "0", "process_kernel_time": 0.123934, "process_mem_max_rss": "118248", "process_out_blocks": "2518", "process_user_time": 0.915513}
[0m23:42:08.821847 [debug] [MainThread]: Command `dbt run` succeeded at 23:42:08.821797 after 0.50 seconds
[0m23:42:08.822054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaaa47690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae854810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae855110>]}
[0m23:42:08.822255 [debug] [MainThread]: Flushing usage events
[0m23:42:10.227271 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:27:26.999276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93137f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9326c910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93137190>]}


============================== 14:27:27.001840 | cb65a847-9c84-4c48-afb3-0ad1823aafa0 ==============================
[0m14:27:27.001840 [info ] [MainThread]: Running with dbt=1.9.0
[0m14:27:27.002307 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select fact_waterlevel --full-refresh', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:27:27.066780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cb65a847-9c84-4c48-afb3-0ad1823aafa0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9256ee90>]}
[0m14:27:27.089950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cb65a847-9c84-4c48-afb3-0ad1823aafa0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95bdddd0>]}
[0m14:27:27.090403 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:27:27.118035 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m14:27:27.159562 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:27:27.159811 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:27:27.162164 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m14:27:27.170999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cb65a847-9c84-4c48-afb3-0ad1823aafa0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff921f5e10>]}
[0m14:27:27.199972 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m14:27:27.201659 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m14:27:27.208473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cb65a847-9c84-4c48-afb3-0ad1823aafa0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff922e5ad0>]}
[0m14:27:27.208744 [info ] [MainThread]: Found 3 models, 434 macros
[0m14:27:27.209068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cb65a847-9c84-4c48-afb3-0ad1823aafa0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92f635d0>]}
[0m14:27:27.209852 [info ] [MainThread]: 
[0m14:27:27.210187 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:27:27.210431 [info ] [MainThread]: 
[0m14:27:27.210805 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:27:27.211373 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m14:27:27.230130 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m14:27:27.230371 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m14:27:27.230560 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:27:27.235170 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.005 seconds
[0m14:27:27.235769 [debug] [ThreadPool]: On list_airflow: Close
[0m14:27:27.238668 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_fact)
[0m14:27:27.238969 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow_dim'
[0m14:27:27.241732 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m14:27:27.242727 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m14:27:27.242977 [debug] [ThreadPool]: On list_airflow_fact: BEGIN
[0m14:27:27.243230 [debug] [ThreadPool]: On list_airflow_dim: BEGIN
[0m14:27:27.243470 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:27:27.243700 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:27:27.245867 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m14:27:27.246072 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m14:27:27.246290 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m14:27:27.246538 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m14:27:27.246776 [debug] [ThreadPool]: On list_airflow_fact: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_fact"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'fact'
  
[0m14:27:27.247067 [debug] [ThreadPool]: On list_airflow_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dim'
  
[0m14:27:27.249013 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.002 seconds
[0m14:27:27.249138 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m14:27:27.249748 [debug] [ThreadPool]: On list_airflow_dim: ROLLBACK
[0m14:27:27.250352 [debug] [ThreadPool]: On list_airflow_fact: ROLLBACK
[0m14:27:27.250673 [debug] [ThreadPool]: On list_airflow_dim: Close
[0m14:27:27.250856 [debug] [ThreadPool]: On list_airflow_fact: Close
[0m14:27:27.253364 [debug] [MainThread]: Using postgres connection "master"
[0m14:27:27.253558 [debug] [MainThread]: On master: BEGIN
[0m14:27:27.253728 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:27:27.255423 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m14:27:27.255659 [debug] [MainThread]: Using postgres connection "master"
[0m14:27:27.255922 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:27:27.257806 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m14:27:27.258338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cb65a847-9c84-4c48-afb3-0ad1823aafa0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9232ab10>]}
[0m14:27:27.258610 [debug] [MainThread]: On master: ROLLBACK
[0m14:27:27.258889 [debug] [MainThread]: Using postgres connection "master"
[0m14:27:27.259081 [debug] [MainThread]: On master: BEGIN
[0m14:27:27.259425 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:27:27.259618 [debug] [MainThread]: On master: COMMIT
[0m14:27:27.259812 [debug] [MainThread]: Using postgres connection "master"
[0m14:27:27.260004 [debug] [MainThread]: On master: COMMIT
[0m14:27:27.260256 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:27:27.260444 [debug] [MainThread]: On master: Close
[0m14:27:27.261728 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.fact_waterlevel
[0m14:27:27.262051 [info ] [Thread-1 (]: 1 of 1 START sql incremental model fact.fact_waterlevel ........................ [RUN]
[0m14:27:27.262399 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_fact, now model.etl_waterlevel.fact_waterlevel)
[0m14:27:27.262605 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.fact_waterlevel
[0m14:27:27.268473 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.fact_waterlevel"
[0m14:27:27.269626 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.fact_waterlevel
[0m14:27:27.292592 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.fact_waterlevel"
[0m14:27:27.293698 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m14:27:27.293926 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: BEGIN
[0m14:27:27.294132 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:27:27.295673 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m14:27:27.295926 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m14:27:27.296139 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      
  
    

  create  table "airflow"."fact"."fact_waterlevel__dbt_tmp"
  
  
    as
  
  (
    

with main as (
select
	distinct
	concat("stationId",'_',"stationCode") as station_key,
	"stationId" as station_id,
	"stationCode" as station_code,
	"waterLevel" as water_level,
	"waterlevelStatus" as waterlevel_status,
    case
        when "waterlevelStatus" = 3 then '🚨 Beyond Danger'
        when "waterlevelStatus" = 2 then '⚠️ Between Warning and Danger'
        when "waterlevelStatus" = 1 then '🔶 Between Alert and Warning'
        when "waterlevelStatus" = 0 then '✅ Between Normal and Alert'
        when "waterlevelStatus" = -1 then '🟢 Below Normal (Safe)'
        else '❓ Unknown Status'
    end as waterlevel_condition,
	"stationName",
	"districtName",
	to_timestamp("lastUpdate",'DD/MM/YYYY HH24:MI') as last_update
from
	raw.waterlevels w
where
	"stationStatus" = 1



)
select
	*
from
	main
order by
	last_update desc
  );
  
  
[0m14:27:27.338146 [debug] [Thread-1 (]: SQL status: SELECT 18173 in 0.042 seconds
[0m14:27:27.342952 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m14:27:27.343222 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */
alter table "airflow"."fact"."fact_waterlevel" rename to "fact_waterlevel__dbt_backup"
[0m14:27:27.343725 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:27:27.344967 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m14:27:27.345250 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */
alter table "airflow"."fact"."fact_waterlevel__dbt_tmp" rename to "fact_waterlevel"
[0m14:27:27.345593 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:27:27.352375 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m14:27:27.352606 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m14:27:27.352826 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m14:27:27.361430 [debug] [Thread-1 (]: SQL status: COMMIT in 0.008 seconds
[0m14:27:27.364356 [debug] [Thread-1 (]: Applying DROP to: "airflow"."fact"."fact_waterlevel__dbt_backup"
[0m14:27:27.367198 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m14:27:27.367424 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */
drop table if exists "airflow"."fact"."fact_waterlevel__dbt_backup" cascade
[0m14:27:27.369097 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m14:27:27.370283 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: Close
[0m14:27:27.371299 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb65a847-9c84-4c48-afb3-0ad1823aafa0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91487750>]}
[0m14:27:27.371732 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model fact.fact_waterlevel ................... [[32mSELECT 18173[0m in 0.11s]
[0m14:27:27.372240 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.fact_waterlevel
[0m14:27:27.373199 [debug] [MainThread]: Using postgres connection "master"
[0m14:27:27.373403 [debug] [MainThread]: On master: BEGIN
[0m14:27:27.373565 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:27:27.375134 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m14:27:27.375333 [debug] [MainThread]: On master: COMMIT
[0m14:27:27.375492 [debug] [MainThread]: Using postgres connection "master"
[0m14:27:27.375638 [debug] [MainThread]: On master: COMMIT
[0m14:27:27.375830 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:27:27.375969 [debug] [MainThread]: On master: Close
[0m14:27:27.376179 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:27:27.376324 [debug] [MainThread]: Connection 'model.etl_waterlevel.fact_waterlevel' was properly closed.
[0m14:27:27.376450 [debug] [MainThread]: Connection 'list_airflow_dim' was properly closed.
[0m14:27:27.376623 [info ] [MainThread]: 
[0m14:27:27.376836 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.17 seconds (0.17s).
[0m14:27:27.377321 [debug] [MainThread]: Command end result
[0m14:27:27.391221 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m14:27:27.392456 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m14:27:27.395430 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m14:27:27.395671 [info ] [MainThread]: 
[0m14:27:27.395958 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:27:27.396201 [info ] [MainThread]: 
[0m14:27:27.396526 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:27:27.397189 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.42072582, "process_in_blocks": "0", "process_kernel_time": 0.150598, "process_mem_max_rss": "115180", "process_out_blocks": "1691", "process_user_time": 0.862151}
[0m14:27:27.397570 [debug] [MainThread]: Command `dbt run` succeeded at 14:27:27.397506 after 0.42 seconds
[0m14:27:27.397827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97a95110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97a94810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97a95290>]}
[0m14:27:27.398050 [debug] [MainThread]: Flushing usage events
[0m14:27:28.733648 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:30:58.437491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ba3b950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c537810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ba3b410>]}


============================== 14:30:58.438907 | 74cbe4f5-7e2a-4eba-8741-d18e9227a1fc ==============================
[0m14:30:58.438907 [info ] [MainThread]: Running with dbt=1.9.0
[0m14:30:58.439361 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --select fact_waterlevel --full-refresh', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:30:58.500289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '74cbe4f5-7e2a-4eba-8741-d18e9227a1fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b8d5190>]}
[0m14:30:58.522337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '74cbe4f5-7e2a-4eba-8741-d18e9227a1fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e45cf90>]}
[0m14:30:58.522742 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:30:58.548444 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m14:30:58.585977 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:30:58.586302 [debug] [MainThread]: Partial parsing: updated file: etl_waterlevel://models/facts/fact_waterlevel.sql
[0m14:30:58.676180 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m14:30:58.678424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '74cbe4f5-7e2a-4eba-8741-d18e9227a1fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a9da690>]}
[0m14:30:58.736526 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m14:30:58.738330 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m14:30:58.744068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '74cbe4f5-7e2a-4eba-8741-d18e9227a1fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a942590>]}
[0m14:30:58.744646 [info ] [MainThread]: Found 3 models, 434 macros
[0m14:30:58.744840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '74cbe4f5-7e2a-4eba-8741-d18e9227a1fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a8c21d0>]}
[0m14:30:58.745644 [info ] [MainThread]: 
[0m14:30:58.745883 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:30:58.746117 [info ] [MainThread]: 
[0m14:30:58.746462 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:30:58.746967 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m14:30:58.762166 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m14:30:58.762401 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m14:30:58.762599 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:30:58.765372 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.003 seconds
[0m14:30:58.766212 [debug] [ThreadPool]: On list_airflow: Close
[0m14:30:58.768460 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_dim)
[0m14:30:58.768776 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow_fact'
[0m14:30:58.772232 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m14:30:58.772433 [debug] [ThreadPool]: On list_airflow_fact: BEGIN
[0m14:30:58.772640 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:30:58.771262 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m14:30:58.773175 [debug] [ThreadPool]: On list_airflow_dim: BEGIN
[0m14:30:58.773395 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:30:58.774501 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m14:30:58.774747 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m14:30:58.775022 [debug] [ThreadPool]: On list_airflow_fact: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_fact"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'fact'
  
[0m14:30:58.775282 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m14:30:58.775597 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m14:30:58.775795 [debug] [ThreadPool]: On list_airflow_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dim'
  
[0m14:30:58.776680 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m14:30:58.777300 [debug] [ThreadPool]: On list_airflow_fact: ROLLBACK
[0m14:30:58.777428 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.001 seconds
[0m14:30:58.778176 [debug] [ThreadPool]: On list_airflow_dim: ROLLBACK
[0m14:30:58.777725 [debug] [ThreadPool]: On list_airflow_fact: Close
[0m14:30:58.778449 [debug] [ThreadPool]: On list_airflow_dim: Close
[0m14:30:58.781029 [debug] [MainThread]: Using postgres connection "master"
[0m14:30:58.781365 [debug] [MainThread]: On master: BEGIN
[0m14:30:58.781590 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:30:58.783161 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m14:30:58.783396 [debug] [MainThread]: Using postgres connection "master"
[0m14:30:58.783689 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:30:58.785144 [debug] [MainThread]: SQL status: SELECT 0 in 0.001 seconds
[0m14:30:58.785683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '74cbe4f5-7e2a-4eba-8741-d18e9227a1fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7aa6d650>]}
[0m14:30:58.785943 [debug] [MainThread]: On master: ROLLBACK
[0m14:30:58.786215 [debug] [MainThread]: Using postgres connection "master"
[0m14:30:58.786417 [debug] [MainThread]: On master: BEGIN
[0m14:30:58.786768 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:30:58.786975 [debug] [MainThread]: On master: COMMIT
[0m14:30:58.787172 [debug] [MainThread]: Using postgres connection "master"
[0m14:30:58.787346 [debug] [MainThread]: On master: COMMIT
[0m14:30:58.787612 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:30:58.787860 [debug] [MainThread]: On master: Close
[0m14:30:58.789189 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.fact_waterlevel
[0m14:30:58.789552 [info ] [Thread-1 (]: 1 of 1 START sql incremental model fact.fact_waterlevel ........................ [RUN]
[0m14:30:58.789926 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_dim, now model.etl_waterlevel.fact_waterlevel)
[0m14:30:58.790184 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.fact_waterlevel
[0m14:30:58.795011 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.fact_waterlevel"
[0m14:30:58.795814 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.fact_waterlevel
[0m14:30:58.819242 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.fact_waterlevel"
[0m14:30:58.820068 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m14:30:58.820290 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: BEGIN
[0m14:30:58.820512 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:30:58.822436 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m14:30:58.822799 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m14:30:58.823052 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      
  
    

  create  table "airflow"."fact"."fact_waterlevel__dbt_tmp"
  
  
    as
  
  (
    

with main as (
select
	distinct
	concat("stationId",'_',"stationCode") as station_key,
	"stationId" as station_id,
	"stationCode" as station_code,
	"waterLevel" as water_level,
	"waterlevelStatus" as waterlevel_status,
    case
        when "waterlevelStatus" = 3 then '🚨 Beyond Danger'
        when "waterlevelStatus" = 2 then '⚠️ Between Warning and Danger'
        when "waterlevelStatus" = 1 then '🔶 Between Alert and Warning'
        when "waterlevelStatus" = 0 then '✅ Between Normal and Alert'
        when "waterlevelStatus" = -1 then '🟢 Below Normal (Safe)'
        else '❓ Unknown Status'
    end as waterlevel_condition,
	"stationName",
	"districtName",
	to_timestamp("lastUpdate",'DD/MM/YYYY HH24:MI') as last_update
from
	raw.waterlevels w
where
	"stationStatus" = 1

-- 

)
select
	*
from
	main
order by
	last_update desc
  );
  
  
[0m14:30:58.857904 [debug] [Thread-1 (]: SQL status: SELECT 18173 in 0.035 seconds
[0m14:30:58.862394 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m14:30:58.862700 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */
alter table "airflow"."fact"."fact_waterlevel" rename to "fact_waterlevel__dbt_backup"
[0m14:30:58.863173 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:30:58.864495 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m14:30:58.864716 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */
alter table "airflow"."fact"."fact_waterlevel__dbt_tmp" rename to "fact_waterlevel"
[0m14:30:58.865093 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:30:58.871716 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m14:30:58.871950 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m14:30:58.872155 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m14:30:58.880864 [debug] [Thread-1 (]: SQL status: COMMIT in 0.008 seconds
[0m14:30:58.883573 [debug] [Thread-1 (]: Applying DROP to: "airflow"."fact"."fact_waterlevel__dbt_backup"
[0m14:30:58.885500 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m14:30:58.885763 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */
drop table if exists "airflow"."fact"."fact_waterlevel__dbt_backup" cascade
[0m14:30:58.886968 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m14:30:58.888078 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: Close
[0m14:30:58.888917 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '74cbe4f5-7e2a-4eba-8741-d18e9227a1fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79c0ca10>]}
[0m14:30:58.889276 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model fact.fact_waterlevel ................... [[32mSELECT 18173[0m in 0.10s]
[0m14:30:58.889674 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.fact_waterlevel
[0m14:30:58.890481 [debug] [MainThread]: Using postgres connection "master"
[0m14:30:58.890690 [debug] [MainThread]: On master: BEGIN
[0m14:30:58.890853 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:30:58.892370 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m14:30:58.892587 [debug] [MainThread]: On master: COMMIT
[0m14:30:58.892801 [debug] [MainThread]: Using postgres connection "master"
[0m14:30:58.892940 [debug] [MainThread]: On master: COMMIT
[0m14:30:58.893126 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:30:58.893255 [debug] [MainThread]: On master: Close
[0m14:30:58.893444 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:30:58.893586 [debug] [MainThread]: Connection 'model.etl_waterlevel.fact_waterlevel' was properly closed.
[0m14:30:58.893718 [debug] [MainThread]: Connection 'list_airflow_fact' was properly closed.
[0m14:30:58.893865 [info ] [MainThread]: 
[0m14:30:58.894078 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.15 seconds (0.15s).
[0m14:30:58.894571 [debug] [MainThread]: Command end result
[0m14:30:58.935106 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m14:30:58.936267 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m14:30:58.939174 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m14:30:58.939340 [info ] [MainThread]: 
[0m14:30:58.939551 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:30:58.939890 [info ] [MainThread]: 
[0m14:30:58.940289 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:30:58.941096 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.5246407, "process_in_blocks": "0", "process_kernel_time": 0.104192, "process_mem_max_rss": "118108", "process_out_blocks": "2518", "process_user_time": 0.928717}
[0m14:30:58.941310 [debug] [MainThread]: Command `dbt run` succeeded at 14:30:58.941272 after 0.52 seconds
[0m14:30:58.941518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80419750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80309250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff803093d0>]}
[0m14:30:58.941733 [debug] [MainThread]: Flushing usage events
[0m14:31:00.293335 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:31:51.034221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5943ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa59436d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa59438d0>]}


============================== 14:31:51.035703 | cd4696b7-3bcd-41e3-b439-b568f2ad8d2d ==============================
[0m14:31:51.035703 [info ] [MainThread]: Running with dbt=1.9.0
[0m14:31:51.036124 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select fact_waterlevel --full-refresh', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:31:51.095550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cd4696b7-3bcd-41e3-b439-b568f2ad8d2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4da7b50>]}
[0m14:31:51.117204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cd4696b7-3bcd-41e3-b439-b568f2ad8d2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa83d7450>]}
[0m14:31:51.117569 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:31:51.141745 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m14:31:51.168749 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m14:31:51.169118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'cd4696b7-3bcd-41e3-b439-b568f2ad8d2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6568290>]}
[0m14:31:51.526443 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m14:31:51.528880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cd4696b7-3bcd-41e3-b439-b568f2ad8d2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa66d6790>]}
[0m14:31:51.556721 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m14:31:51.558228 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m14:31:51.564004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cd4696b7-3bcd-41e3-b439-b568f2ad8d2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4b6c410>]}
[0m14:31:51.564248 [info ] [MainThread]: Found 3 models, 434 macros
[0m14:31:51.564427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cd4696b7-3bcd-41e3-b439-b568f2ad8d2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4acc590>]}
[0m14:31:51.565120 [info ] [MainThread]: 
[0m14:31:51.565334 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:31:51.565619 [info ] [MainThread]: 
[0m14:31:51.565975 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:31:51.566516 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m14:31:51.581038 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m14:31:51.581282 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m14:31:51.581476 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:31:51.583983 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.002 seconds
[0m14:31:51.584622 [debug] [ThreadPool]: On list_airflow: Close
[0m14:31:51.586678 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_fact)
[0m14:31:51.586961 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow_dim'
[0m14:31:51.589350 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m14:31:51.590282 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m14:31:51.590517 [debug] [ThreadPool]: On list_airflow_fact: BEGIN
[0m14:31:51.590763 [debug] [ThreadPool]: On list_airflow_dim: BEGIN
[0m14:31:51.590963 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:31:51.591200 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:31:51.593055 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m14:31:51.593257 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m14:31:51.593562 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m14:31:51.593816 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m14:31:51.594132 [debug] [ThreadPool]: On list_airflow_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dim'
  
[0m14:31:51.594407 [debug] [ThreadPool]: On list_airflow_fact: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_fact"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'fact'
  
[0m14:31:51.595882 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m14:31:51.596027 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.001 seconds
[0m14:31:51.596745 [debug] [ThreadPool]: On list_airflow_fact: ROLLBACK
[0m14:31:51.597448 [debug] [ThreadPool]: On list_airflow_dim: ROLLBACK
[0m14:31:51.597778 [debug] [ThreadPool]: On list_airflow_fact: Close
[0m14:31:51.598062 [debug] [ThreadPool]: On list_airflow_dim: Close
[0m14:31:51.600768 [debug] [MainThread]: Using postgres connection "master"
[0m14:31:51.600963 [debug] [MainThread]: On master: BEGIN
[0m14:31:51.601135 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:31:51.602521 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m14:31:51.602726 [debug] [MainThread]: Using postgres connection "master"
[0m14:31:51.602963 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:31:51.604310 [debug] [MainThread]: SQL status: SELECT 0 in 0.001 seconds
[0m14:31:51.604803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cd4696b7-3bcd-41e3-b439-b568f2ad8d2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5e905d0>]}
[0m14:31:51.605038 [debug] [MainThread]: On master: ROLLBACK
[0m14:31:51.605230 [debug] [MainThread]: Using postgres connection "master"
[0m14:31:51.605358 [debug] [MainThread]: On master: BEGIN
[0m14:31:51.605590 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:31:51.605745 [debug] [MainThread]: On master: COMMIT
[0m14:31:51.605879 [debug] [MainThread]: Using postgres connection "master"
[0m14:31:51.606062 [debug] [MainThread]: On master: COMMIT
[0m14:31:51.606275 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:31:51.606423 [debug] [MainThread]: On master: Close
[0m14:31:51.607400 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.fact_waterlevel
[0m14:31:51.607682 [info ] [Thread-1 (]: 1 of 1 START sql incremental model fact.fact_waterlevel ........................ [RUN]
[0m14:31:51.608003 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_fact, now model.etl_waterlevel.fact_waterlevel)
[0m14:31:51.608207 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.fact_waterlevel
[0m14:31:51.612616 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.fact_waterlevel"
[0m14:31:51.613469 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.fact_waterlevel
[0m14:31:51.635697 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.fact_waterlevel"
[0m14:31:51.636394 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m14:31:51.636597 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: BEGIN
[0m14:31:51.636803 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:31:51.638401 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m14:31:51.638635 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m14:31:51.638885 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      
  
    

  create  table "airflow"."fact"."fact_waterlevel__dbt_tmp"
  
  
    as
  
  (
    

with main as (
select
	distinct
	concat("stationId",'_',"stationCode") as station_key,
	"stationId" as station_id,
	"stationCode" as station_code,
	"waterLevel" as water_level,
	"waterlevelStatus" as waterlevel_status,
    case
        when "waterlevelStatus" = 3 then '🚨 Beyond Danger'
        when "waterlevelStatus" = 2 then '⚠️ Between Warning and Danger'
        when "waterlevelStatus" = 1 then '🔶 Between Alert and Warning'
        when "waterlevelStatus" = 0 then '✅ Between Normal and Alert'
        when "waterlevelStatus" = -1 then '🟢 Below Normal (Safe)'
        else '❓ Unknown Status'
    end as waterlevel_condition,
	"stationName",
	"districtName",
	to_timestamp("lastUpdate",'DD/MM/YYYY HH24:MI') as last_update
from
	raw.waterlevels w
where
	"stationStatus" = 1

-- 

)
select
	*
from
	main
order by
	last_update desc
  );
  
  
[0m14:31:51.670211 [debug] [Thread-1 (]: SQL status: SELECT 18173 in 0.031 seconds
[0m14:31:51.675331 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m14:31:51.675544 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */
alter table "airflow"."fact"."fact_waterlevel" rename to "fact_waterlevel__dbt_backup"
[0m14:31:51.675913 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:31:51.677153 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m14:31:51.677360 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */
alter table "airflow"."fact"."fact_waterlevel__dbt_tmp" rename to "fact_waterlevel"
[0m14:31:51.677679 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:31:51.684279 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m14:31:51.684516 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m14:31:51.684716 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m14:31:51.690671 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m14:31:51.693203 [debug] [Thread-1 (]: Applying DROP to: "airflow"."fact"."fact_waterlevel__dbt_backup"
[0m14:31:51.695153 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m14:31:51.695367 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */
drop table if exists "airflow"."fact"."fact_waterlevel__dbt_backup" cascade
[0m14:31:51.696803 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m14:31:51.697906 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: Close
[0m14:31:51.698771 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd4696b7-3bcd-41e3-b439-b568f2ad8d2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3db12d0>]}
[0m14:31:51.699162 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model fact.fact_waterlevel ................... [[32mSELECT 18173[0m in 0.09s]
[0m14:31:51.699519 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.fact_waterlevel
[0m14:31:51.700310 [debug] [MainThread]: Using postgres connection "master"
[0m14:31:51.700502 [debug] [MainThread]: On master: BEGIN
[0m14:31:51.700674 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:31:51.702168 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m14:31:51.702405 [debug] [MainThread]: On master: COMMIT
[0m14:31:51.702558 [debug] [MainThread]: Using postgres connection "master"
[0m14:31:51.702711 [debug] [MainThread]: On master: COMMIT
[0m14:31:51.702915 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:31:51.703082 [debug] [MainThread]: On master: Close
[0m14:31:51.703292 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:31:51.703470 [debug] [MainThread]: Connection 'model.etl_waterlevel.fact_waterlevel' was properly closed.
[0m14:31:51.703646 [debug] [MainThread]: Connection 'list_airflow_dim' was properly closed.
[0m14:31:51.703849 [info ] [MainThread]: 
[0m14:31:51.704141 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.14 seconds (0.14s).
[0m14:31:51.704533 [debug] [MainThread]: Command end result
[0m14:31:51.717677 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m14:31:51.718857 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m14:31:51.721728 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m14:31:51.721902 [info ] [MainThread]: 
[0m14:31:51.722204 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:31:51.722435 [info ] [MainThread]: 
[0m14:31:51.722693 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:31:51.723212 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.71022815, "process_in_blocks": "0", "process_kernel_time": 0.0837, "process_mem_max_rss": "117076", "process_out_blocks": "2519", "process_user_time": 1.151885}
[0m14:31:51.723421 [debug] [MainThread]: Command `dbt run` succeeded at 14:31:51.723383 after 0.71 seconds
[0m14:31:51.723600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa57bbd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5a1b810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa57bbf10>]}
[0m14:31:51.723790 [debug] [MainThread]: Flushing usage events
[0m14:31:52.954246 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:32:17.946750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cb13210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c961310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c962690>]}


============================== 14:32:17.948210 | a98f8bcb-f7c4-459b-98d7-15f25fd670c3 ==============================
[0m14:32:17.948210 [info ] [MainThread]: Running with dbt=1.9.0
[0m14:32:17.948630 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --select fact_waterlevel --full-refresh', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:32:18.009574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a98f8bcb-f7c4-459b-98d7-15f25fd670c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bedd690>]}
[0m14:32:18.031586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a98f8bcb-f7c4-459b-98d7-15f25fd670c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f545410>]}
[0m14:32:18.032032 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:32:18.056905 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m14:32:18.082860 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m14:32:18.083161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a98f8bcb-f7c4-459b-98d7-15f25fd670c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d738310>]}
[0m14:32:18.444117 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m14:32:18.446526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a98f8bcb-f7c4-459b-98d7-15f25fd670c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d7880d0>]}
[0m14:32:18.474852 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m14:32:18.476416 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m14:32:18.482241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a98f8bcb-f7c4-459b-98d7-15f25fd670c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bd00250>]}
[0m14:32:18.482492 [info ] [MainThread]: Found 3 models, 434 macros
[0m14:32:18.482700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a98f8bcb-f7c4-459b-98d7-15f25fd670c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b75d910>]}
[0m14:32:18.483391 [info ] [MainThread]: 
[0m14:32:18.483635 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:32:18.483872 [info ] [MainThread]: 
[0m14:32:18.484241 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:32:18.484739 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m14:32:18.499244 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m14:32:18.499481 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m14:32:18.499672 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:32:18.503015 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.003 seconds
[0m14:32:18.503610 [debug] [ThreadPool]: On list_airflow: Close
[0m14:32:18.505673 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_dim)
[0m14:32:18.505985 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow_fact'
[0m14:32:18.508445 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m14:32:18.509400 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m14:32:18.509637 [debug] [ThreadPool]: On list_airflow_dim: BEGIN
[0m14:32:18.509876 [debug] [ThreadPool]: On list_airflow_fact: BEGIN
[0m14:32:18.510090 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:32:18.510319 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:32:18.512006 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m14:32:18.512122 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m14:32:18.512344 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m14:32:18.512584 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m14:32:18.512817 [debug] [ThreadPool]: On list_airflow_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dim'
  
[0m14:32:18.513125 [debug] [ThreadPool]: On list_airflow_fact: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_fact"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'fact'
  
[0m14:32:18.514517 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.001 seconds
[0m14:32:18.514656 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m14:32:18.515263 [debug] [ThreadPool]: On list_airflow_dim: ROLLBACK
[0m14:32:18.515861 [debug] [ThreadPool]: On list_airflow_fact: ROLLBACK
[0m14:32:18.516161 [debug] [ThreadPool]: On list_airflow_dim: Close
[0m14:32:18.516368 [debug] [ThreadPool]: On list_airflow_fact: Close
[0m14:32:18.518734 [debug] [MainThread]: Using postgres connection "master"
[0m14:32:18.518948 [debug] [MainThread]: On master: BEGIN
[0m14:32:18.519124 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:32:18.520557 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m14:32:18.520828 [debug] [MainThread]: Using postgres connection "master"
[0m14:32:18.521087 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:32:18.522445 [debug] [MainThread]: SQL status: SELECT 0 in 0.001 seconds
[0m14:32:18.522968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a98f8bcb-f7c4-459b-98d7-15f25fd670c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7af2d110>]}
[0m14:32:18.523216 [debug] [MainThread]: On master: ROLLBACK
[0m14:32:18.523492 [debug] [MainThread]: Using postgres connection "master"
[0m14:32:18.523664 [debug] [MainThread]: On master: BEGIN
[0m14:32:18.524003 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:32:18.524235 [debug] [MainThread]: On master: COMMIT
[0m14:32:18.524413 [debug] [MainThread]: Using postgres connection "master"
[0m14:32:18.524582 [debug] [MainThread]: On master: COMMIT
[0m14:32:18.524843 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:32:18.525039 [debug] [MainThread]: On master: Close
[0m14:32:18.526269 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.fact_waterlevel
[0m14:32:18.526560 [info ] [Thread-1 (]: 1 of 1 START sql table model fact.fact_waterlevel .............................. [RUN]
[0m14:32:18.526921 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_dim, now model.etl_waterlevel.fact_waterlevel)
[0m14:32:18.527141 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.fact_waterlevel
[0m14:32:18.530732 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.fact_waterlevel"
[0m14:32:18.531466 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.fact_waterlevel
[0m14:32:18.547143 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.fact_waterlevel"
[0m14:32:18.547832 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m14:32:18.548071 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: BEGIN
[0m14:32:18.548265 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:32:18.549808 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m14:32:18.550067 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m14:32:18.550293 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

  
    

  create  table "airflow"."fact"."fact_waterlevel__dbt_tmp"
  
  
    as
  
  (
    

with main as (
select
	distinct
	concat("stationId",'_',"stationCode") as station_key,
	"stationId" as station_id,
	"stationCode" as station_code,
	"waterLevel" as water_level,
	"waterlevelStatus" as waterlevel_status,
    case
        when "waterlevelStatus" = 3 then '🚨 Beyond Danger'
        when "waterlevelStatus" = 2 then '⚠️ Between Warning and Danger'
        when "waterlevelStatus" = 1 then '🔶 Between Alert and Warning'
        when "waterlevelStatus" = 0 then '✅ Between Normal and Alert'
        when "waterlevelStatus" = -1 then '🟢 Below Normal (Safe)'
        else '❓ Unknown Status'
    end as waterlevel_condition,
	"stationName",
	"districtName",
	to_timestamp("lastUpdate",'DD/MM/YYYY HH24:MI') as last_update
from
	raw.waterlevels w
where
	"stationStatus" = 1

-- 

)
select
	*
from
	main
order by
	last_update desc
  );
  
[0m14:32:18.580794 [debug] [Thread-1 (]: SQL status: SELECT 18173 in 0.030 seconds
[0m14:32:18.585082 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m14:32:18.585352 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */
alter table "airflow"."fact"."fact_waterlevel" rename to "fact_waterlevel__dbt_backup"
[0m14:32:18.585717 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:32:18.586940 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m14:32:18.587154 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */
alter table "airflow"."fact"."fact_waterlevel__dbt_tmp" rename to "fact_waterlevel"
[0m14:32:18.587468 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:32:18.594957 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m14:32:18.595191 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m14:32:18.595386 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m14:32:18.601298 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m14:32:18.603870 [debug] [Thread-1 (]: Applying DROP to: "airflow"."fact"."fact_waterlevel__dbt_backup"
[0m14:32:18.605973 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m14:32:18.606189 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */
drop table if exists "airflow"."fact"."fact_waterlevel__dbt_backup" cascade
[0m14:32:18.607590 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m14:32:18.608652 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: Close
[0m14:32:18.609477 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a98f8bcb-f7c4-459b-98d7-15f25fd670c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bab76d0>]}
[0m14:32:18.609865 [info ] [Thread-1 (]: 1 of 1 OK created sql table model fact.fact_waterlevel ......................... [[32mSELECT 18173[0m in 0.08s]
[0m14:32:18.610179 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.fact_waterlevel
[0m14:32:18.610936 [debug] [MainThread]: Using postgres connection "master"
[0m14:32:18.611108 [debug] [MainThread]: On master: BEGIN
[0m14:32:18.611258 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:32:18.612721 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m14:32:18.612938 [debug] [MainThread]: On master: COMMIT
[0m14:32:18.613102 [debug] [MainThread]: Using postgres connection "master"
[0m14:32:18.613255 [debug] [MainThread]: On master: COMMIT
[0m14:32:18.613462 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:32:18.613595 [debug] [MainThread]: On master: Close
[0m14:32:18.613779 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:32:18.613960 [debug] [MainThread]: Connection 'model.etl_waterlevel.fact_waterlevel' was properly closed.
[0m14:32:18.614103 [debug] [MainThread]: Connection 'list_airflow_fact' was properly closed.
[0m14:32:18.614249 [info ] [MainThread]: 
[0m14:32:18.614412 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.13 seconds (0.13s).
[0m14:32:18.614791 [debug] [MainThread]: Command end result
[0m14:32:18.627371 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m14:32:18.628369 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m14:32:18.631114 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m14:32:18.631290 [info ] [MainThread]: 
[0m14:32:18.631515 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:32:18.631725 [info ] [MainThread]: 
[0m14:32:18.632102 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:32:18.632594 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.70717007, "process_in_blocks": "0", "process_kernel_time": 0.090598, "process_mem_max_rss": "116800", "process_out_blocks": "2518", "process_user_time": 1.126015}
[0m14:32:18.632817 [debug] [MainThread]: Command `dbt run` succeeded at 14:32:18.632774 after 0.71 seconds
[0m14:32:18.633016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c983d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c983bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c983e50>]}
[0m14:32:18.633192 [debug] [MainThread]: Flushing usage events
[0m14:32:20.100015 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:49:39.736253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb623a390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb608ba10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb623b410>]}


============================== 14:49:39.738647 | 4e400a64-35e2-495a-9a58-bad29a436952 ==============================
[0m14:49:39.738647 [info ] [MainThread]: Running with dbt=1.9.0
[0m14:49:39.739108 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/logs', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --select fact_waterlevel --full-refresh', 'send_anonymous_usage_stats': 'True'}
[0m14:49:39.802377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4e400a64-35e2-495a-9a58-bad29a436952', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb56ce190>]}
[0m14:49:39.824250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4e400a64-35e2-495a-9a58-bad29a436952', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8cc9750>]}
[0m14:49:39.824639 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:49:39.849576 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m14:49:39.889072 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:49:39.889415 [debug] [MainThread]: Partial parsing: updated file: etl_waterlevel://models/facts/fact_waterlevel.sql
[0m14:49:39.960657 [error] [MainThread]: Encountered an error:
Compilation Error in model fact_waterlevel (models/facts/fact_waterlevel.sql)
  expected token ',', got '='
    line 2
      -- materialized='incremental',
[0m14:49:39.961355 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.24651954, "process_in_blocks": "0", "process_kernel_time": 0.094172, "process_mem_max_rss": "107284", "process_out_blocks": "4", "process_user_time": 0.776419}
[0m14:49:39.961644 [debug] [MainThread]: Command `dbt run` failed at 14:49:39.961600 after 0.25 seconds
[0m14:49:39.961882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb60808d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6062a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6061610>]}
[0m14:49:39.962159 [debug] [MainThread]: Flushing usage events
[0m14:49:41.245955 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:50:02.307111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ca37650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ca37990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ca34310>]}


============================== 14:50:02.308568 | a265c3e8-afa0-4858-b68e-f7acd3e47d11 ==============================
[0m14:50:02.308568 [info ] [MainThread]: Running with dbt=1.9.0
[0m14:50:02.308965 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/logs', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --select fact_waterlevel --full-refresh', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:50:02.371651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a265c3e8-afa0-4858-b68e-f7acd3e47d11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7be7ba90>]}
[0m14:50:02.393634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a265c3e8-afa0-4858-b68e-f7acd3e47d11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bd16750>]}
[0m14:50:02.394016 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:50:02.418936 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m14:50:02.456743 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:50:02.457056 [debug] [MainThread]: Partial parsing: updated file: etl_waterlevel://models/facts/fact_waterlevel.sql
[0m14:50:02.551400 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m14:50:02.553825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a265c3e8-afa0-4858-b68e-f7acd3e47d11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ba341d0>]}
[0m14:50:02.582152 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m14:50:02.584030 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m14:50:02.590431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a265c3e8-afa0-4858-b68e-f7acd3e47d11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b973210>]}
[0m14:50:02.590682 [info ] [MainThread]: Found 3 models, 434 macros
[0m14:50:02.590889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a265c3e8-afa0-4858-b68e-f7acd3e47d11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b9aff50>]}
[0m14:50:02.591660 [info ] [MainThread]: 
[0m14:50:02.592008 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:50:02.592232 [info ] [MainThread]: 
[0m14:50:02.592566 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:50:02.593086 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m14:50:02.610683 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m14:50:02.610941 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m14:50:02.611166 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:50:02.614402 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.003 seconds
[0m14:50:02.615065 [debug] [ThreadPool]: On list_airflow: Close
[0m14:50:02.617289 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_fact)
[0m14:50:02.617621 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow_dim'
[0m14:50:02.620073 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m14:50:02.621029 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m14:50:02.621280 [debug] [ThreadPool]: On list_airflow_fact: BEGIN
[0m14:50:02.621522 [debug] [ThreadPool]: On list_airflow_dim: BEGIN
[0m14:50:02.621748 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:50:02.621985 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:50:02.623873 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m14:50:02.624120 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m14:50:02.624245 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m14:50:02.624456 [debug] [ThreadPool]: On list_airflow_fact: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_fact"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'fact'
  
[0m14:50:02.624726 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m14:50:02.625137 [debug] [ThreadPool]: On list_airflow_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dim'
  
[0m14:50:02.626586 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m14:50:02.626748 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.001 seconds
[0m14:50:02.627341 [debug] [ThreadPool]: On list_airflow_fact: ROLLBACK
[0m14:50:02.627929 [debug] [ThreadPool]: On list_airflow_dim: ROLLBACK
[0m14:50:02.628249 [debug] [ThreadPool]: On list_airflow_fact: Close
[0m14:50:02.628448 [debug] [ThreadPool]: On list_airflow_dim: Close
[0m14:50:02.630948 [debug] [MainThread]: Using postgres connection "master"
[0m14:50:02.631145 [debug] [MainThread]: On master: BEGIN
[0m14:50:02.631324 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:50:02.632986 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m14:50:02.633307 [debug] [MainThread]: Using postgres connection "master"
[0m14:50:02.633538 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:50:02.634952 [debug] [MainThread]: SQL status: SELECT 0 in 0.001 seconds
[0m14:50:02.635442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a265c3e8-afa0-4858-b68e-f7acd3e47d11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ad5c1d0>]}
[0m14:50:02.635706 [debug] [MainThread]: On master: ROLLBACK
[0m14:50:02.635981 [debug] [MainThread]: Using postgres connection "master"
[0m14:50:02.636161 [debug] [MainThread]: On master: BEGIN
[0m14:50:02.636499 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:50:02.636702 [debug] [MainThread]: On master: COMMIT
[0m14:50:02.636879 [debug] [MainThread]: Using postgres connection "master"
[0m14:50:02.637052 [debug] [MainThread]: On master: COMMIT
[0m14:50:02.637315 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:50:02.637496 [debug] [MainThread]: On master: Close
[0m14:50:02.638769 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.fact_waterlevel
[0m14:50:02.639071 [info ] [Thread-1 (]: 1 of 1 START sql view model fact.fact_waterlevel ............................... [RUN]
[0m14:50:02.639362 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_fact, now model.etl_waterlevel.fact_waterlevel)
[0m14:50:02.639616 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.fact_waterlevel
[0m14:50:02.643667 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.fact_waterlevel"
[0m14:50:02.644481 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.fact_waterlevel
[0m14:50:02.658813 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.fact_waterlevel"
[0m14:50:02.659706 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m14:50:02.659944 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: BEGIN
[0m14:50:02.660145 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:50:02.662019 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m14:50:02.662266 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m14:50:02.662499 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

  create view "airflow"."fact"."fact_waterlevel__dbt_tmp"
    
    
  as (
    

with main as (
select
	distinct
	concat("stationId",'_',"stationCode") as station_key,
	"stationId" as station_id,
	"stationCode" as station_code,
	"waterLevel" as water_level,
	"waterlevelStatus" as waterlevel_status,
    case
        when "waterlevelStatus" = 3 then '🚨 Beyond Danger'
        when "waterlevelStatus" = 2 then '⚠️ Between Warning and Danger'
        when "waterlevelStatus" = 1 then '🔶 Between Alert and Warning'
        when "waterlevelStatus" = 0 then '✅ Between Normal and Alert'
        when "waterlevelStatus" = -1 then '🟢 Below Normal (Safe)'
        else '❓ Unknown Status'
    end as waterlevel_condition,
	"stationName",
	"districtName",
	to_timestamp("lastUpdate",'DD/MM/YYYY HH24:MI') as last_update
from
	raw.waterlevels w
where
	"stationStatus" = 1

-- 

)
select
	*
from
	main
order by
	last_update desc
  );
[0m14:50:02.665479 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m14:50:02.668071 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m14:50:02.668284 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */
alter table "airflow"."fact"."fact_waterlevel" rename to "fact_waterlevel__dbt_backup"
[0m14:50:02.668632 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:50:02.669849 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m14:50:02.670024 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */
alter table "airflow"."fact"."fact_waterlevel__dbt_tmp" rename to "fact_waterlevel"
[0m14:50:02.670350 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:50:02.677461 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m14:50:02.677659 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m14:50:02.677809 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m14:50:02.678471 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m14:50:02.681034 [debug] [Thread-1 (]: Applying DROP to: "airflow"."fact"."fact_waterlevel__dbt_backup"
[0m14:50:02.683048 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m14:50:02.683244 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */
drop table if exists "airflow"."fact"."fact_waterlevel__dbt_backup" cascade
[0m14:50:02.684599 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m14:50:02.685632 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: Close
[0m14:50:02.686427 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a265c3e8-afa0-4858-b68e-f7acd3e47d11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ba876d0>]}
[0m14:50:02.686803 [info ] [Thread-1 (]: 1 of 1 OK created sql view model fact.fact_waterlevel .......................... [[32mCREATE VIEW[0m in 0.05s]
[0m14:50:02.687159 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.fact_waterlevel
[0m14:50:02.687905 [debug] [MainThread]: Using postgres connection "master"
[0m14:50:02.688086 [debug] [MainThread]: On master: BEGIN
[0m14:50:02.688235 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:50:02.689771 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m14:50:02.689984 [debug] [MainThread]: On master: COMMIT
[0m14:50:02.690165 [debug] [MainThread]: Using postgres connection "master"
[0m14:50:02.690303 [debug] [MainThread]: On master: COMMIT
[0m14:50:02.690476 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:50:02.690613 [debug] [MainThread]: On master: Close
[0m14:50:02.690793 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:50:02.690952 [debug] [MainThread]: Connection 'model.etl_waterlevel.fact_waterlevel' was properly closed.
[0m14:50:02.691084 [debug] [MainThread]: Connection 'list_airflow_dim' was properly closed.
[0m14:50:02.691241 [info ] [MainThread]: 
[0m14:50:02.691418 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.10 seconds (0.10s).
[0m14:50:02.691846 [debug] [MainThread]: Command end result
[0m14:50:02.737651 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m14:50:02.738821 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m14:50:02.741779 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m14:50:02.741956 [info ] [MainThread]: 
[0m14:50:02.742205 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:50:02.742448 [info ] [MainThread]: 
[0m14:50:02.742734 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:50:02.743316 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.45752537, "process_in_blocks": "0", "process_kernel_time": 0.090091, "process_mem_max_rss": "117356", "process_out_blocks": "2518", "process_user_time": 0.926946}
[0m14:50:02.743558 [debug] [MainThread]: Command `dbt run` succeeded at 14:50:02.743516 after 0.46 seconds
[0m14:50:02.743761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81309250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81308950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81309910>]}
[0m14:50:02.743938 [debug] [MainThread]: Flushing usage events
[0m14:50:03.884556 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:50:27.307869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98a3f290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98a3f590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98a3f390>]}


============================== 14:50:27.309328 | 759b165e-d619-498d-a1a6-4b701760b371 ==============================
[0m14:50:27.309328 [info ] [MainThread]: Running with dbt=1.9.0
[0m14:50:27.309706 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --select fact_waterlevel --full-refresh', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:50:27.370352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '759b165e-d619-498d-a1a6-4b701760b371', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98a3c710>]}
[0m14:50:27.392225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '759b165e-d619-498d-a1a6-4b701760b371', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b519910>]}
[0m14:50:27.392594 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:50:27.416703 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m14:50:27.455133 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:50:27.455485 [debug] [MainThread]: Partial parsing: updated file: etl_waterlevel://models/facts/fact_waterlevel.sql
[0m14:50:27.547756 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m14:50:27.550048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '759b165e-d619-498d-a1a6-4b701760b371', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97a9d8d0>]}
[0m14:50:27.577204 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m14:50:27.578672 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m14:50:27.584061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '759b165e-d619-498d-a1a6-4b701760b371', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97817490>]}
[0m14:50:27.584309 [info ] [MainThread]: Found 3 models, 434 macros
[0m14:50:27.584497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '759b165e-d619-498d-a1a6-4b701760b371', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97963010>]}
[0m14:50:27.585204 [info ] [MainThread]: 
[0m14:50:27.585470 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:50:27.585672 [info ] [MainThread]: 
[0m14:50:27.585978 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:50:27.586458 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m14:50:27.600975 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m14:50:27.601200 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m14:50:27.601414 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:50:27.603813 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.002 seconds
[0m14:50:27.604429 [debug] [ThreadPool]: On list_airflow: Close
[0m14:50:27.606530 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_dim)
[0m14:50:27.606850 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow_fact'
[0m14:50:27.609309 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m14:50:27.610225 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m14:50:27.610491 [debug] [ThreadPool]: On list_airflow_dim: BEGIN
[0m14:50:27.610717 [debug] [ThreadPool]: On list_airflow_fact: BEGIN
[0m14:50:27.610931 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:50:27.611151 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:50:27.612921 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m14:50:27.613218 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m14:50:27.613343 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m14:50:27.613573 [debug] [ThreadPool]: On list_airflow_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dim'
  
[0m14:50:27.613837 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m14:50:27.614245 [debug] [ThreadPool]: On list_airflow_fact: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_fact"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'fact'
  
[0m14:50:27.615405 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.001 seconds
[0m14:50:27.615531 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m14:50:27.616142 [debug] [ThreadPool]: On list_airflow_dim: ROLLBACK
[0m14:50:27.616681 [debug] [ThreadPool]: On list_airflow_fact: ROLLBACK
[0m14:50:27.617011 [debug] [ThreadPool]: On list_airflow_dim: Close
[0m14:50:27.617199 [debug] [ThreadPool]: On list_airflow_fact: Close
[0m14:50:27.619707 [debug] [MainThread]: Using postgres connection "master"
[0m14:50:27.619933 [debug] [MainThread]: On master: BEGIN
[0m14:50:27.620106 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:50:27.621713 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m14:50:27.621976 [debug] [MainThread]: Using postgres connection "master"
[0m14:50:27.622197 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:50:27.625302 [debug] [MainThread]: SQL status: SELECT 1 in 0.003 seconds
[0m14:50:27.625901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '759b165e-d619-498d-a1a6-4b701760b371', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97c5b250>]}
[0m14:50:27.626161 [debug] [MainThread]: On master: ROLLBACK
[0m14:50:27.626488 [debug] [MainThread]: Using postgres connection "master"
[0m14:50:27.626672 [debug] [MainThread]: On master: BEGIN
[0m14:50:27.627012 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:50:27.627249 [debug] [MainThread]: On master: COMMIT
[0m14:50:27.627424 [debug] [MainThread]: Using postgres connection "master"
[0m14:50:27.627602 [debug] [MainThread]: On master: COMMIT
[0m14:50:27.627852 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:50:27.628045 [debug] [MainThread]: On master: Close
[0m14:50:27.629348 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.fact_waterlevel
[0m14:50:27.629648 [info ] [Thread-1 (]: 1 of 1 START sql table model fact.fact_waterlevel .............................. [RUN]
[0m14:50:27.629955 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_fact, now model.etl_waterlevel.fact_waterlevel)
[0m14:50:27.630205 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.fact_waterlevel
[0m14:50:27.634132 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.fact_waterlevel"
[0m14:50:27.634855 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.fact_waterlevel
[0m14:50:27.651005 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.fact_waterlevel"
[0m14:50:27.651578 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m14:50:27.651750 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: BEGIN
[0m14:50:27.651897 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:50:27.653311 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m14:50:27.653545 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m14:50:27.653771 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

  
    

  create  table "airflow"."fact"."fact_waterlevel__dbt_tmp"
  
  
    as
  
  (
    

with main as (
select
	distinct
	concat("stationId",'_',"stationCode") as station_key,
	"stationId" as station_id,
	"stationCode" as station_code,
	"waterLevel" as water_level,
	"waterlevelStatus" as waterlevel_status,
    case
        when "waterlevelStatus" = 3 then '🚨 Beyond Danger'
        when "waterlevelStatus" = 2 then '⚠️ Between Warning and Danger'
        when "waterlevelStatus" = 1 then '🔶 Between Alert and Warning'
        when "waterlevelStatus" = 0 then '✅ Between Normal and Alert'
        when "waterlevelStatus" = -1 then '🟢 Below Normal (Safe)'
        else '❓ Unknown Status'
    end as waterlevel_condition,
	"stationName",
	"districtName",
	to_timestamp("lastUpdate",'DD/MM/YYYY HH24:MI') as last_update
from
	raw.waterlevels w
where
	"stationStatus" = 1

-- 

)
select
	*
from
	main
order by
	last_update desc
  );
  
[0m14:50:27.688656 [debug] [Thread-1 (]: SQL status: SELECT 18173 in 0.035 seconds
[0m14:50:27.692944 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m14:50:27.693195 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */
alter table "airflow"."fact"."fact_waterlevel" rename to "fact_waterlevel__dbt_backup"
[0m14:50:27.693699 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:50:27.694973 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m14:50:27.695184 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */
alter table "airflow"."fact"."fact_waterlevel__dbt_tmp" rename to "fact_waterlevel"
[0m14:50:27.695530 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:50:27.702152 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m14:50:27.702385 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m14:50:27.702583 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m14:50:27.708618 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m14:50:27.711228 [debug] [Thread-1 (]: Applying DROP to: "airflow"."fact"."fact_waterlevel__dbt_backup"
[0m14:50:27.713216 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m14:50:27.713432 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */
drop view if exists "airflow"."fact"."fact_waterlevel__dbt_backup" cascade
[0m14:50:27.714198 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m14:50:27.715377 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: Close
[0m14:50:27.716293 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '759b165e-d619-498d-a1a6-4b701760b371', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97c883d0>]}
[0m14:50:27.716829 [info ] [Thread-1 (]: 1 of 1 OK created sql table model fact.fact_waterlevel ......................... [[32mSELECT 18173[0m in 0.09s]
[0m14:50:27.717159 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.fact_waterlevel
[0m14:50:27.718023 [debug] [MainThread]: Using postgres connection "master"
[0m14:50:27.718251 [debug] [MainThread]: On master: BEGIN
[0m14:50:27.718401 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:50:27.720000 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m14:50:27.720327 [debug] [MainThread]: On master: COMMIT
[0m14:50:27.720511 [debug] [MainThread]: Using postgres connection "master"
[0m14:50:27.720671 [debug] [MainThread]: On master: COMMIT
[0m14:50:27.720867 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:50:27.721009 [debug] [MainThread]: On master: Close
[0m14:50:27.721217 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:50:27.721381 [debug] [MainThread]: Connection 'list_airflow_dim' was properly closed.
[0m14:50:27.721506 [debug] [MainThread]: Connection 'model.etl_waterlevel.fact_waterlevel' was properly closed.
[0m14:50:27.721660 [info ] [MainThread]: 
[0m14:50:27.721894 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.14 seconds (0.14s).
[0m14:50:27.722687 [debug] [MainThread]: Command end result
[0m14:50:27.767028 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m14:50:27.768385 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m14:50:27.771318 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m14:50:27.771499 [info ] [MainThread]: 
[0m14:50:27.771727 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:50:27.772010 [info ] [MainThread]: 
[0m14:50:27.772298 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:50:27.772845 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.4863611, "process_in_blocks": "0", "process_kernel_time": 0.079833, "process_mem_max_rss": "117564", "process_out_blocks": "2518", "process_user_time": 0.916092}
[0m14:50:27.773089 [debug] [MainThread]: Command `dbt run` succeeded at 14:50:27.773022 after 0.49 seconds
[0m14:50:27.773314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d3d5290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d3d4810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d3d5850>]}
[0m14:50:27.773511 [debug] [MainThread]: Flushing usage events
[0m14:50:30.438307 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:55:09.303383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa280ab10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa280af50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa280b190>]}


============================== 14:55:09.304814 | 27c4004b-ad03-4222-a732-ac676d29066d ==============================
[0m14:55:09.304814 [info ] [MainThread]: Running with dbt=1.9.0
[0m14:55:09.305200 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select fact_waterlevel --full-refresh', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:55:09.365933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '27c4004b-ad03-4222-a732-ac676d29066d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1b9f650>]}
[0m14:55:09.387938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '27c4004b-ad03-4222-a732-ac676d29066d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa522ee50>]}
[0m14:55:09.388317 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:55:09.413214 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m14:55:09.452425 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:55:09.452773 [debug] [MainThread]: Partial parsing: updated file: etl_waterlevel://models/facts/fact_waterlevel.sql
[0m14:55:09.540542 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m14:55:09.542918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '27c4004b-ad03-4222-a732-ac676d29066d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa194b210>]}
[0m14:55:09.570374 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m14:55:09.572253 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m14:55:09.578261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '27c4004b-ad03-4222-a732-ac676d29066d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1778c10>]}
[0m14:55:09.578510 [info ] [MainThread]: Found 3 models, 434 macros
[0m14:55:09.578699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '27c4004b-ad03-4222-a732-ac676d29066d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1868a10>]}
[0m14:55:09.579489 [info ] [MainThread]: 
[0m14:55:09.579780 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:55:09.580024 [info ] [MainThread]: 
[0m14:55:09.580348 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:55:09.580901 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m14:55:09.596144 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m14:55:09.596413 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m14:55:09.596619 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:55:09.599520 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.003 seconds
[0m14:55:09.600167 [debug] [ThreadPool]: On list_airflow: Close
[0m14:55:09.602361 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_fact)
[0m14:55:09.602660 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow_dim'
[0m14:55:09.605203 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m14:55:09.606168 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m14:55:09.606417 [debug] [ThreadPool]: On list_airflow_fact: BEGIN
[0m14:55:09.606657 [debug] [ThreadPool]: On list_airflow_dim: BEGIN
[0m14:55:09.606895 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:55:09.607121 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:55:09.608867 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m14:55:09.609177 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m14:55:09.609308 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m14:55:09.609544 [debug] [ThreadPool]: On list_airflow_fact: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_fact"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'fact'
  
[0m14:55:09.609859 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m14:55:09.610242 [debug] [ThreadPool]: On list_airflow_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dim'
  
[0m14:55:09.611327 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m14:55:09.611948 [debug] [ThreadPool]: On list_airflow_fact: ROLLBACK
[0m14:55:09.612089 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.002 seconds
[0m14:55:09.612369 [debug] [ThreadPool]: On list_airflow_fact: Close
[0m14:55:09.612932 [debug] [ThreadPool]: On list_airflow_dim: ROLLBACK
[0m14:55:09.613561 [debug] [ThreadPool]: On list_airflow_dim: Close
[0m14:55:09.615825 [debug] [MainThread]: Using postgres connection "master"
[0m14:55:09.616031 [debug] [MainThread]: On master: BEGIN
[0m14:55:09.616205 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:55:09.617604 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m14:55:09.617885 [debug] [MainThread]: Using postgres connection "master"
[0m14:55:09.618111 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:55:09.619460 [debug] [MainThread]: SQL status: SELECT 0 in 0.001 seconds
[0m14:55:09.619981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '27c4004b-ad03-4222-a732-ac676d29066d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1779bd0>]}
[0m14:55:09.620232 [debug] [MainThread]: On master: ROLLBACK
[0m14:55:09.620537 [debug] [MainThread]: Using postgres connection "master"
[0m14:55:09.620711 [debug] [MainThread]: On master: BEGIN
[0m14:55:09.621059 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:55:09.621332 [debug] [MainThread]: On master: COMMIT
[0m14:55:09.621509 [debug] [MainThread]: Using postgres connection "master"
[0m14:55:09.621703 [debug] [MainThread]: On master: COMMIT
[0m14:55:09.621951 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:55:09.622132 [debug] [MainThread]: On master: Close
[0m14:55:09.623383 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.fact_waterlevel
[0m14:55:09.623690 [info ] [Thread-1 (]: 1 of 1 START sql view model fact.fact_waterlevel ............................... [RUN]
[0m14:55:09.623948 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_fact, now model.etl_waterlevel.fact_waterlevel)
[0m14:55:09.624178 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.fact_waterlevel
[0m14:55:09.627490 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.fact_waterlevel"
[0m14:55:09.628531 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.fact_waterlevel
[0m14:55:09.643860 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.fact_waterlevel"
[0m14:55:09.644640 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m14:55:09.644855 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: BEGIN
[0m14:55:09.645014 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:55:09.646415 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m14:55:09.646642 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m14:55:09.646911 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

  create view "airflow"."fact"."fact_waterlevel__dbt_tmp"
    
    
  as (
    

with main as (
select
	distinct
	concat("stationId",'_',"stationCode") as station_key,
	"stationId" as station_id,
	"stationCode" as station_code,
	"waterLevel" as water_level,
	"waterlevelStatus" as waterlevel_status,
    case
        when "waterlevelStatus" = 3 then '🚨 Beyond Danger'
        when "waterlevelStatus" = 2 then '⚠️ Between Warning and Danger'
        when "waterlevelStatus" = 1 then '🔶 Between Alert and Warning'
        when "waterlevelStatus" = 0 then '✅ Between Normal and Alert'
        when "waterlevelStatus" = -1 then '🟢 Below Normal (Safe)'
        else '❓ Unknown Status'
    end as waterlevel_condition,
	"stationName",
	"districtName",
	to_timestamp("lastUpdate",'DD/MM/YYYY HH24:MI') as last_update
from
	raw.waterlevels w
where
	"stationStatus" = 1

)
select
	*
from
	main
order by
	last_update desc
  );
[0m14:55:09.648521 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m14:55:09.651182 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m14:55:09.651381 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */
alter table "airflow"."fact"."fact_waterlevel" rename to "fact_waterlevel__dbt_backup"
[0m14:55:09.651702 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:55:09.652929 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m14:55:09.653127 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */
alter table "airflow"."fact"."fact_waterlevel__dbt_tmp" rename to "fact_waterlevel"
[0m14:55:09.653499 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:55:09.660857 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m14:55:09.661094 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m14:55:09.661300 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m14:55:09.662826 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m14:55:09.665396 [debug] [Thread-1 (]: Applying DROP to: "airflow"."fact"."fact_waterlevel__dbt_backup"
[0m14:55:09.667345 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m14:55:09.667528 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */
drop table if exists "airflow"."fact"."fact_waterlevel__dbt_backup" cascade
[0m14:55:09.668846 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m14:55:09.669896 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: Close
[0m14:55:09.670663 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27c4004b-ad03-4222-a732-ac676d29066d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa077fad0>]}
[0m14:55:09.671012 [info ] [Thread-1 (]: 1 of 1 OK created sql view model fact.fact_waterlevel .......................... [[32mCREATE VIEW[0m in 0.05s]
[0m14:55:09.671330 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.fact_waterlevel
[0m14:55:09.672118 [debug] [MainThread]: Using postgres connection "master"
[0m14:55:09.672304 [debug] [MainThread]: On master: BEGIN
[0m14:55:09.672447 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:55:09.673817 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m14:55:09.674016 [debug] [MainThread]: On master: COMMIT
[0m14:55:09.674187 [debug] [MainThread]: Using postgres connection "master"
[0m14:55:09.674334 [debug] [MainThread]: On master: COMMIT
[0m14:55:09.674513 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:55:09.674641 [debug] [MainThread]: On master: Close
[0m14:55:09.674877 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:55:09.675035 [debug] [MainThread]: Connection 'model.etl_waterlevel.fact_waterlevel' was properly closed.
[0m14:55:09.675181 [debug] [MainThread]: Connection 'list_airflow_dim' was properly closed.
[0m14:55:09.675348 [info ] [MainThread]: 
[0m14:55:09.675562 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.10 seconds (0.10s).
[0m14:55:09.675966 [debug] [MainThread]: Command end result
[0m14:55:09.717933 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m14:55:09.719277 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m14:55:09.722586 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m14:55:09.722787 [info ] [MainThread]: 
[0m14:55:09.722998 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:55:09.723276 [info ] [MainThread]: 
[0m14:55:09.723550 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:55:09.724165 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.4423431, "process_in_blocks": "0", "process_kernel_time": 0.087681, "process_mem_max_rss": "117552", "process_out_blocks": "2517", "process_user_time": 0.917129}
[0m14:55:09.724364 [debug] [MainThread]: Command `dbt run` succeeded at 14:55:09.724328 after 0.44 seconds
[0m14:55:09.724544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7109250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7108950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0bcedd0>]}
[0m14:55:09.724784 [debug] [MainThread]: Flushing usage events
[0m14:55:10.915945 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:05:04.769562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ef0afd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f20b650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ed5a1d0>]}


============================== 15:05:04.771148 | 0c856fc3-b2cd-4d90-8011-46a41530901f ==============================
[0m15:05:04.771148 [info ] [MainThread]: Running with dbt=1.9.0
[0m15:05:04.771553 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select fact_waterlevel --full-refresh', 'send_anonymous_usage_stats': 'True'}
[0m15:05:04.834282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0c856fc3-b2cd-4d90-8011-46a41530901f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e373250>]}
[0m15:05:04.856213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0c856fc3-b2cd-4d90-8011-46a41530901f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91945090>]}
[0m15:05:04.856593 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:05:04.881241 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m15:05:04.921455 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:05:04.921796 [debug] [MainThread]: Partial parsing: updated file: etl_waterlevel://models/facts/fact_waterlevel.sql
[0m15:05:04.991868 [error] [MainThread]: Encountered an error:
Compilation Error in model fact_waterlevel (models/facts/fact_waterlevel.sql)
  expected token ',', got '='
    line 2
      --     materialized='view',
[0m15:05:04.992502 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.24459858, "process_in_blocks": "0", "process_kernel_time": 0.101712, "process_mem_max_rss": "107268", "process_out_blocks": "4", "process_user_time": 0.757858}
[0m15:05:04.992773 [debug] [MainThread]: Command `dbt run` failed at 15:05:04.992723 after 0.24 seconds
[0m15:05:04.993022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ed83f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ed83e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff938093d0>]}
[0m15:05:04.993257 [debug] [MainThread]: Flushing usage events
[0m15:05:06.161094 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:05:26.606543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac347990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac547c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac18e6d0>]}


============================== 15:05:26.608004 | 5dcb8b53-a49b-48da-8dcc-55e4b6fdfb7e ==============================
[0m15:05:26.608004 [info ] [MainThread]: Running with dbt=1.9.0
[0m15:05:26.608576 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --select fact_waterlevel --full-refresh', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:05:26.669025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5dcb8b53-a49b-48da-8dcc-55e4b6fdfb7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab70e950>]}
[0m15:05:26.691044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5dcb8b53-a49b-48da-8dcc-55e4b6fdfb7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaedb1850>]}
[0m15:05:26.691442 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:05:26.715972 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m15:05:26.753658 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:05:26.753975 [debug] [MainThread]: Partial parsing: updated file: etl_waterlevel://models/facts/fact_waterlevel.sql
[0m15:05:26.827687 [error] [MainThread]: Encountered an error:
Compilation Error in model fact_waterlevel (models/facts/fact_waterlevel.sql)
  expected token ',', got 'for'
    line 5
      incremental_strategy='merge'  -- required for upsert behavior
[0m15:05:26.828374 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.24284446, "process_in_blocks": "0", "process_kernel_time": 0.070277, "process_mem_max_rss": "107304", "process_out_blocks": "5", "process_user_time": 0.740929}
[0m15:05:26.828668 [debug] [MainThread]: Command `dbt run` failed at 15:05:26.828612 after 0.24 seconds
[0m15:05:26.828903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac18f190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac347f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0c55110>]}
[0m15:05:26.829142 [debug] [MainThread]: Flushing usage events
[0m15:05:28.188572 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:05:52.201977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b112ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9bc0f890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b1ff850>]}


============================== 15:05:52.203384 | 5ab3cb10-eb13-4936-bb2a-e2b63e4e3eb1 ==============================
[0m15:05:52.203384 [info ] [MainThread]: Running with dbt=1.9.0
[0m15:05:52.203801 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --select fact_waterlevel --full-refresh', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:05:52.265334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5ab3cb10-eb13-4936-bb2a-e2b63e4e3eb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a57a090>]}
[0m15:05:52.287283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5ab3cb10-eb13-4936-bb2a-e2b63e4e3eb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9db46d10>]}
[0m15:05:52.287693 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:05:52.312581 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m15:05:52.349059 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:05:52.349371 [debug] [MainThread]: Partial parsing: updated file: etl_waterlevel://models/facts/fact_waterlevel.sql
[0m15:05:52.439796 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m15:05:52.442159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5ab3cb10-eb13-4936-bb2a-e2b63e4e3eb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cac3050>]}
[0m15:05:52.470051 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m15:05:52.471674 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m15:05:52.478110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5ab3cb10-eb13-4936-bb2a-e2b63e4e3eb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99e59ad0>]}
[0m15:05:52.478350 [info ] [MainThread]: Found 3 models, 434 macros
[0m15:05:52.478524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5ab3cb10-eb13-4936-bb2a-e2b63e4e3eb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99fa1c90>]}
[0m15:05:52.479290 [info ] [MainThread]: 
[0m15:05:52.479511 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:05:52.479819 [info ] [MainThread]: 
[0m15:05:52.480159 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:05:52.480653 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m15:05:52.496910 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m15:05:52.497149 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m15:05:52.497338 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:05:52.500035 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.003 seconds
[0m15:05:52.500650 [debug] [ThreadPool]: On list_airflow: Close
[0m15:05:52.502671 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_dim)
[0m15:05:52.502946 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow_fact'
[0m15:05:52.505391 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m15:05:52.506344 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m15:05:52.506595 [debug] [ThreadPool]: On list_airflow_dim: BEGIN
[0m15:05:52.506837 [debug] [ThreadPool]: On list_airflow_fact: BEGIN
[0m15:05:52.507055 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:05:52.507281 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:05:52.509100 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m15:05:52.509284 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m15:05:52.509481 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m15:05:52.509742 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m15:05:52.509990 [debug] [ThreadPool]: On list_airflow_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dim'
  
[0m15:05:52.510264 [debug] [ThreadPool]: On list_airflow_fact: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_fact"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'fact'
  
[0m15:05:52.511795 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m15:05:52.511944 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.001 seconds
[0m15:05:52.512550 [debug] [ThreadPool]: On list_airflow_fact: ROLLBACK
[0m15:05:52.513122 [debug] [ThreadPool]: On list_airflow_dim: ROLLBACK
[0m15:05:52.513447 [debug] [ThreadPool]: On list_airflow_fact: Close
[0m15:05:52.513627 [debug] [ThreadPool]: On list_airflow_dim: Close
[0m15:05:52.516021 [debug] [MainThread]: Using postgres connection "master"
[0m15:05:52.516223 [debug] [MainThread]: On master: BEGIN
[0m15:05:52.516391 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:05:52.517806 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m15:05:52.518048 [debug] [MainThread]: Using postgres connection "master"
[0m15:05:52.518280 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:05:52.521469 [debug] [MainThread]: SQL status: SELECT 1 in 0.003 seconds
[0m15:05:52.522021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5ab3cb10-eb13-4936-bb2a-e2b63e4e3eb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a094210>]}
[0m15:05:52.522271 [debug] [MainThread]: On master: ROLLBACK
[0m15:05:52.522544 [debug] [MainThread]: Using postgres connection "master"
[0m15:05:52.522734 [debug] [MainThread]: On master: BEGIN
[0m15:05:52.523068 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:05:52.523299 [debug] [MainThread]: On master: COMMIT
[0m15:05:52.523476 [debug] [MainThread]: Using postgres connection "master"
[0m15:05:52.523652 [debug] [MainThread]: On master: COMMIT
[0m15:05:52.523908 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:05:52.524083 [debug] [MainThread]: On master: Close
[0m15:05:52.525343 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.fact_waterlevel
[0m15:05:52.525662 [info ] [Thread-1 (]: 1 of 1 START sql incremental model fact.fact_waterlevel ........................ [RUN]
[0m15:05:52.525986 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_dim, now model.etl_waterlevel.fact_waterlevel)
[0m15:05:52.526223 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.fact_waterlevel
[0m15:05:52.530277 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.fact_waterlevel"
[0m15:05:52.531075 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.fact_waterlevel
[0m15:05:52.554050 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.fact_waterlevel"
[0m15:05:52.554821 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m15:05:52.555022 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: BEGIN
[0m15:05:52.555230 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:05:52.556974 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m15:05:52.557205 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m15:05:52.557436 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      
  
    

  create  table "airflow"."fact"."fact_waterlevel__dbt_tmp"
  
  
    as
  
  (
    

with main as (
select
	distinct
	concat("stationId",'_',"stationCode") as station_key,
	"stationId" as station_id,
	"stationCode" as station_code,
	"waterLevel" as water_level,
	"waterlevelStatus" as waterlevel_status,
    case
        when "waterlevelStatus" = 3 then '🚨 Beyond Danger'
        when "waterlevelStatus" = 2 then '⚠️ Between Warning and Danger'
        when "waterlevelStatus" = 1 then '🔶 Between Alert and Warning'
        when "waterlevelStatus" = 0 then '✅ Between Normal and Alert'
        when "waterlevelStatus" = -1 then '🟢 Below Normal (Safe)'
        else '❓ Unknown Status'
    end as waterlevel_condition,
	"stationName",
	"districtName",
	to_timestamp("lastUpdate",'DD/MM/YYYY HH24:MI') as last_update
from
	raw.waterlevels w
where
	"stationStatus" = 1

    

)
select
	*
from
	main
order by
	last_update desc
  );
  
  
[0m15:05:52.594024 [debug] [Thread-1 (]: SQL status: SELECT 18244 in 0.036 seconds
[0m15:05:52.598273 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m15:05:52.598500 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */
alter table "airflow"."fact"."fact_waterlevel" rename to "fact_waterlevel__dbt_backup"
[0m15:05:52.599052 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:05:52.600299 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m15:05:52.600510 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */
alter table "airflow"."fact"."fact_waterlevel__dbt_tmp" rename to "fact_waterlevel"
[0m15:05:52.600868 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:05:52.607369 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m15:05:52.607605 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m15:05:52.607800 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m15:05:52.614177 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m15:05:52.616817 [debug] [Thread-1 (]: Applying DROP to: "airflow"."fact"."fact_waterlevel__dbt_backup"
[0m15:05:52.618810 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m15:05:52.618993 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */
drop view if exists "airflow"."fact"."fact_waterlevel__dbt_backup" cascade
[0m15:05:52.619775 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m15:05:52.620901 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: Close
[0m15:05:52.621698 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5ab3cb10-eb13-4936-bb2a-e2b63e4e3eb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a2acc10>]}
[0m15:05:52.622034 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model fact.fact_waterlevel ................... [[32mSELECT 18244[0m in 0.10s]
[0m15:05:52.622393 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.fact_waterlevel
[0m15:05:52.623293 [debug] [MainThread]: Using postgres connection "master"
[0m15:05:52.623466 [debug] [MainThread]: On master: BEGIN
[0m15:05:52.623610 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:05:52.625232 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m15:05:52.625446 [debug] [MainThread]: On master: COMMIT
[0m15:05:52.625627 [debug] [MainThread]: Using postgres connection "master"
[0m15:05:52.625762 [debug] [MainThread]: On master: COMMIT
[0m15:05:52.625944 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:05:52.626076 [debug] [MainThread]: On master: Close
[0m15:05:52.626258 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:05:52.626397 [debug] [MainThread]: Connection 'model.etl_waterlevel.fact_waterlevel' was properly closed.
[0m15:05:52.626513 [debug] [MainThread]: Connection 'list_airflow_fact' was properly closed.
[0m15:05:52.626676 [info ] [MainThread]: 
[0m15:05:52.627014 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.15 seconds (0.15s).
[0m15:05:52.627458 [debug] [MainThread]: Command end result
[0m15:05:52.670733 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m15:05:52.671795 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m15:05:52.674894 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m15:05:52.675089 [info ] [MainThread]: 
[0m15:05:52.675303 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:05:52.675575 [info ] [MainThread]: 
[0m15:05:52.675862 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:05:52.676426 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.49571976, "process_in_blocks": "0", "process_kernel_time": 0.074794, "process_mem_max_rss": "117952", "process_out_blocks": "2520", "process_user_time": 0.922469}
[0m15:05:52.676641 [debug] [MainThread]: Command `dbt run` succeeded at 15:05:52.676598 after 0.50 seconds
[0m15:05:52.676870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9fa09790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9fa08950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9fa09910>]}
[0m15:05:52.677066 [debug] [MainThread]: Flushing usage events
[0m15:05:53.732288 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:15:34.180267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaae51c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab0f3050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaae44410>]}


============================== 15:15:34.182671 | 8a6843d8-bf2c-4564-ac79-6cd173a550d8 ==============================
[0m15:15:34.182671 [info ] [MainThread]: Running with dbt=1.9.0
[0m15:15:34.183105 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select fact_waterlevel --full-refresh', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:15:34.245655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8a6843d8-bf2c-4564-ac79-6cd173a550d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab21e2d0>]}
[0m15:15:34.267537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8a6843d8-bf2c-4564-ac79-6cd173a550d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffada2ec90>]}
[0m15:15:34.267921 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:15:34.292879 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m15:15:34.332512 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:15:34.332831 [debug] [MainThread]: Partial parsing: updated file: etl_waterlevel://models/facts/fact_waterlevel.sql
[0m15:15:34.422683 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m15:15:34.425179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8a6843d8-bf2c-4564-ac79-6cd173a550d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa010f90>]}
[0m15:15:34.453438 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m15:15:34.455040 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m15:15:34.460940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8a6843d8-bf2c-4564-ac79-6cd173a550d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9f06850>]}
[0m15:15:34.461177 [info ] [MainThread]: Found 3 models, 434 macros
[0m15:15:34.461357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8a6843d8-bf2c-4564-ac79-6cd173a550d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9e6c850>]}
[0m15:15:34.462128 [info ] [MainThread]: 
[0m15:15:34.462356 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:15:34.462708 [info ] [MainThread]: 
[0m15:15:34.463037 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:15:34.463482 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m15:15:34.481259 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m15:15:34.481547 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m15:15:34.481765 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:15:34.485507 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.004 seconds
[0m15:15:34.486223 [debug] [ThreadPool]: On list_airflow: Close
[0m15:15:34.488695 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_dim)
[0m15:15:34.489050 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow_fact'
[0m15:15:34.491808 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m15:15:34.492774 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m15:15:34.493015 [debug] [ThreadPool]: On list_airflow_dim: BEGIN
[0m15:15:34.493256 [debug] [ThreadPool]: On list_airflow_fact: BEGIN
[0m15:15:34.493442 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:15:34.493652 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:15:34.495601 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m15:15:34.495959 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m15:15:34.496220 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m15:15:34.496480 [debug] [ThreadPool]: On list_airflow_fact: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_fact"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'fact'
  
[0m15:15:34.496856 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m15:15:34.497338 [debug] [ThreadPool]: On list_airflow_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dim'
  
[0m15:15:34.498675 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m15:15:34.498897 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.001 seconds
[0m15:15:34.499569 [debug] [ThreadPool]: On list_airflow_fact: ROLLBACK
[0m15:15:34.500149 [debug] [ThreadPool]: On list_airflow_dim: ROLLBACK
[0m15:15:34.500457 [debug] [ThreadPool]: On list_airflow_fact: Close
[0m15:15:34.500671 [debug] [ThreadPool]: On list_airflow_dim: Close
[0m15:15:34.503413 [debug] [MainThread]: Using postgres connection "master"
[0m15:15:34.503601 [debug] [MainThread]: On master: BEGIN
[0m15:15:34.503767 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:15:34.505657 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m15:15:34.506112 [debug] [MainThread]: Using postgres connection "master"
[0m15:15:34.506390 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:15:34.508318 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m15:15:34.508908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8a6843d8-bf2c-4564-ac79-6cd173a550d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9f9f090>]}
[0m15:15:34.509167 [debug] [MainThread]: On master: ROLLBACK
[0m15:15:34.509409 [debug] [MainThread]: Using postgres connection "master"
[0m15:15:34.509559 [debug] [MainThread]: On master: BEGIN
[0m15:15:34.509859 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:15:34.510206 [debug] [MainThread]: On master: COMMIT
[0m15:15:34.510497 [debug] [MainThread]: Using postgres connection "master"
[0m15:15:34.510839 [debug] [MainThread]: On master: COMMIT
[0m15:15:34.511084 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:15:34.511245 [debug] [MainThread]: On master: Close
[0m15:15:34.512536 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.fact_waterlevel
[0m15:15:34.512877 [info ] [Thread-1 (]: 1 of 1 START sql incremental model fact.fact_waterlevel ........................ [RUN]
[0m15:15:34.513167 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_dim, now model.etl_waterlevel.fact_waterlevel)
[0m15:15:34.513420 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.fact_waterlevel
[0m15:15:34.518911 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.fact_waterlevel"
[0m15:15:34.519608 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.fact_waterlevel
[0m15:15:34.544191 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.fact_waterlevel"
[0m15:15:34.545276 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m15:15:34.545539 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: BEGIN
[0m15:15:34.545772 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:15:34.547925 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m15:15:34.548193 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m15:15:34.548452 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      
  
    

  create  table "airflow"."fact"."fact_waterlevel__dbt_tmp"
  
  
    as
  
  (
    

with main as (
select
	distinct
	concat("stationId",'_',"stationCode") as station_key,
	"stationId" as station_id,
	"stationCode" as station_code,
	"waterLevel" as water_level,
	"waterlevelStatus" as waterlevel_status,
    case
        when "waterlevelStatus" = 3 then '🚨 Beyond Danger'
        when "waterlevelStatus" = 2 then '⚠️ Between Warning and Danger'
        when "waterlevelStatus" = 1 then '🔶 Between Alert and Warning'
        when "waterlevelStatus" = 0 then '✅ Between Normal and Alert'
        when "waterlevelStatus" = -1 then '🟢 Below Normal (Safe)'
        else '❓ Unknown Status'
    end as waterlevel_condition,
	"stationName",
	"districtName",
	-- to_timestamp("lastUpdate",'DD/MM/YYYY HH24:MI') as last_update
    last_update
from
	raw.waterlevels w
where
	"stationStatus" = 1

    

)
select
	*
from
	main
order by
	last_update desc
  );
  
  
[0m15:15:34.549094 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "last_update" does not exist
LINE 34:     last_update
             ^
HINT:  Perhaps you meant to reference the column "w.lastUpdate".

[0m15:15:34.549357 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: ROLLBACK
[0m15:15:34.549705 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: Close
[0m15:15:34.551913 [debug] [Thread-1 (]: Database Error in model fact_waterlevel (models/facts/fact_waterlevel.sql)
  column "last_update" does not exist
  LINE 34:     last_update
               ^
  HINT:  Perhaps you meant to reference the column "w.lastUpdate".
  compiled code at target/run/etl_waterlevel/models/facts/fact_waterlevel.sql
[0m15:15:34.552836 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a6843d8-bf2c-4564-ac79-6cd173a550d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9d4b390>]}
[0m15:15:34.553277 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model fact.fact_waterlevel ............... [[31mERROR[0m in 0.04s]
[0m15:15:34.553817 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.fact_waterlevel
[0m15:15:34.554094 [debug] [Thread-7 (]: Marking all children of 'model.etl_waterlevel.fact_waterlevel' to be skipped because of status 'error'.  Reason: Database Error in model fact_waterlevel (models/facts/fact_waterlevel.sql)
  column "last_update" does not exist
  LINE 34:     last_update
               ^
  HINT:  Perhaps you meant to reference the column "w.lastUpdate".
  compiled code at target/run/etl_waterlevel/models/facts/fact_waterlevel.sql.
[0m15:15:34.555475 [debug] [MainThread]: Using postgres connection "master"
[0m15:15:34.555940 [debug] [MainThread]: On master: BEGIN
[0m15:15:34.556204 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:15:34.558148 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m15:15:34.558459 [debug] [MainThread]: On master: COMMIT
[0m15:15:34.558691 [debug] [MainThread]: Using postgres connection "master"
[0m15:15:34.558834 [debug] [MainThread]: On master: COMMIT
[0m15:15:34.559027 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:15:34.559220 [debug] [MainThread]: On master: Close
[0m15:15:34.559502 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:15:34.559659 [debug] [MainThread]: Connection 'model.etl_waterlevel.fact_waterlevel' was properly closed.
[0m15:15:34.559803 [debug] [MainThread]: Connection 'list_airflow_fact' was properly closed.
[0m15:15:34.559966 [info ] [MainThread]: 
[0m15:15:34.560171 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.10 seconds (0.10s).
[0m15:15:34.560668 [debug] [MainThread]: Command end result
[0m15:15:34.571994 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m15:15:34.572929 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m15:15:34.576440 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m15:15:34.576719 [info ] [MainThread]: 
[0m15:15:34.576975 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:15:34.577217 [info ] [MainThread]: 
[0m15:15:34.577529 [error] [MainThread]:   Database Error in model fact_waterlevel (models/facts/fact_waterlevel.sql)
  column "last_update" does not exist
  LINE 34:     last_update
               ^
  HINT:  Perhaps you meant to reference the column "w.lastUpdate".
  compiled code at target/run/etl_waterlevel/models/facts/fact_waterlevel.sql
[0m15:15:34.577732 [info ] [MainThread]: 
[0m15:15:34.577988 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:15:34.578558 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.42007247, "process_in_blocks": "0", "process_kernel_time": 0.160254, "process_mem_max_rss": "118604", "process_out_blocks": "2518", "process_user_time": 0.884884}
[0m15:15:34.578776 [debug] [MainThread]: Command `dbt run` failed at 15:15:34.578738 after 0.42 seconds
[0m15:15:34.578968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf9093d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffabe4db10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab0f2d50>]}
[0m15:15:34.579144 [debug] [MainThread]: Flushing usage events
[0m15:15:35.902991 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:15:45.790423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91a3f850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff918929d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff918901d0>]}


============================== 15:15:45.791941 | 6e7b607b-ddb5-4f5c-bb04-762a0246cd22 ==============================
[0m15:15:45.791941 [info ] [MainThread]: Running with dbt=1.9.0
[0m15:15:45.792326 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --select fact_waterlevel --full-refresh', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:15:45.852683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6e7b607b-ddb5-4f5c-bb04-762a0246cd22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90e79110>]}
[0m15:15:45.874592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6e7b607b-ddb5-4f5c-bb04-762a0246cd22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94521990>]}
[0m15:15:45.874967 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:15:45.899451 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m15:15:45.937097 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:15:45.937406 [debug] [MainThread]: Partial parsing: updated file: etl_waterlevel://models/facts/fact_waterlevel.sql
[0m15:15:46.031571 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m15:15:46.034233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6e7b607b-ddb5-4f5c-bb04-762a0246cd22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90c3b9d0>]}
[0m15:15:46.061827 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m15:15:46.063334 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m15:15:46.068982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6e7b607b-ddb5-4f5c-bb04-762a0246cd22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff909b5690>]}
[0m15:15:46.069236 [info ] [MainThread]: Found 3 models, 434 macros
[0m15:15:46.069416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6e7b607b-ddb5-4f5c-bb04-762a0246cd22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90933410>]}
[0m15:15:46.070267 [info ] [MainThread]: 
[0m15:15:46.070592 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:15:46.070822 [info ] [MainThread]: 
[0m15:15:46.071135 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:15:46.071580 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m15:15:46.085526 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m15:15:46.085775 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m15:15:46.085984 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:15:46.088526 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.003 seconds
[0m15:15:46.089178 [debug] [ThreadPool]: On list_airflow: Close
[0m15:15:46.091220 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_dim)
[0m15:15:46.091561 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow_fact'
[0m15:15:46.093909 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m15:15:46.094809 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m15:15:46.095043 [debug] [ThreadPool]: On list_airflow_dim: BEGIN
[0m15:15:46.095269 [debug] [ThreadPool]: On list_airflow_fact: BEGIN
[0m15:15:46.095485 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:15:46.095732 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:15:46.097487 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m15:15:46.097672 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m15:15:46.097891 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m15:15:46.098120 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m15:15:46.098366 [debug] [ThreadPool]: On list_airflow_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dim'
  
[0m15:15:46.098617 [debug] [ThreadPool]: On list_airflow_fact: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_fact"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'fact'
  
[0m15:15:46.100056 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.001 seconds
[0m15:15:46.100178 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m15:15:46.100764 [debug] [ThreadPool]: On list_airflow_dim: ROLLBACK
[0m15:15:46.101318 [debug] [ThreadPool]: On list_airflow_fact: ROLLBACK
[0m15:15:46.101638 [debug] [ThreadPool]: On list_airflow_dim: Close
[0m15:15:46.101935 [debug] [ThreadPool]: On list_airflow_fact: Close
[0m15:15:46.104334 [debug] [MainThread]: Using postgres connection "master"
[0m15:15:46.104578 [debug] [MainThread]: On master: BEGIN
[0m15:15:46.104774 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:15:46.106201 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m15:15:46.106462 [debug] [MainThread]: Using postgres connection "master"
[0m15:15:46.106726 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:15:46.108102 [debug] [MainThread]: SQL status: SELECT 0 in 0.001 seconds
[0m15:15:46.108609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6e7b607b-ddb5-4f5c-bb04-762a0246cd22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fc3ae50>]}
[0m15:15:46.108854 [debug] [MainThread]: On master: ROLLBACK
[0m15:15:46.109130 [debug] [MainThread]: Using postgres connection "master"
[0m15:15:46.109312 [debug] [MainThread]: On master: BEGIN
[0m15:15:46.109651 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:15:46.109879 [debug] [MainThread]: On master: COMMIT
[0m15:15:46.110056 [debug] [MainThread]: Using postgres connection "master"
[0m15:15:46.110238 [debug] [MainThread]: On master: COMMIT
[0m15:15:46.110495 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:15:46.110691 [debug] [MainThread]: On master: Close
[0m15:15:46.111949 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.fact_waterlevel
[0m15:15:46.112250 [info ] [Thread-1 (]: 1 of 1 START sql incremental model fact.fact_waterlevel ........................ [RUN]
[0m15:15:46.112539 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_fact, now model.etl_waterlevel.fact_waterlevel)
[0m15:15:46.112818 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.fact_waterlevel
[0m15:15:46.117759 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.fact_waterlevel"
[0m15:15:46.118502 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.fact_waterlevel
[0m15:15:46.140929 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.fact_waterlevel"
[0m15:15:46.141633 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m15:15:46.141862 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: BEGIN
[0m15:15:46.142067 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:15:46.143689 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m15:15:46.143938 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m15:15:46.144152 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      
  
    

  create  table "airflow"."fact"."fact_waterlevel__dbt_tmp"
  
  
    as
  
  (
    

with main as (
select
	distinct
	concat("stationId",'_',"stationCode") as station_key,
	"stationId" as station_id,
	"stationCode" as station_code,
	"waterLevel" as water_level,
	"waterlevelStatus" as waterlevel_status,
    case
        when "waterlevelStatus" = 3 then '🚨 Beyond Danger'
        when "waterlevelStatus" = 2 then '⚠️ Between Warning and Danger'
        when "waterlevelStatus" = 1 then '🔶 Between Alert and Warning'
        when "waterlevelStatus" = 0 then '✅ Between Normal and Alert'
        when "waterlevelStatus" = -1 then '🟢 Below Normal (Safe)'
        else '❓ Unknown Status'
    end as waterlevel_condition,
	"stationName",
	"districtName",
	-- to_timestamp("lastUpdate",'DD/MM/YYYY HH24:MI') as last_update
    "last_update"
from
	raw.waterlevels w
where
	"stationStatus" = 1

    

)
select
	*
from
	main
order by
	last_update desc
  );
  
  
[0m15:15:46.144637 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "last_update" does not exist
LINE 34:     "last_update"
             ^
HINT:  Perhaps you meant to reference the column "w.lastUpdate".

[0m15:15:46.144859 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: ROLLBACK
[0m15:15:46.145118 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: Close
[0m15:15:46.146948 [debug] [Thread-1 (]: Database Error in model fact_waterlevel (models/facts/fact_waterlevel.sql)
  column "last_update" does not exist
  LINE 34:     "last_update"
               ^
  HINT:  Perhaps you meant to reference the column "w.lastUpdate".
  compiled code at target/run/etl_waterlevel/models/facts/fact_waterlevel.sql
[0m15:15:46.147741 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e7b607b-ddb5-4f5c-bb04-762a0246cd22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff909b7210>]}
[0m15:15:46.148068 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model fact.fact_waterlevel ............... [[31mERROR[0m in 0.03s]
[0m15:15:46.148382 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.fact_waterlevel
[0m15:15:46.148654 [debug] [Thread-7 (]: Marking all children of 'model.etl_waterlevel.fact_waterlevel' to be skipped because of status 'error'.  Reason: Database Error in model fact_waterlevel (models/facts/fact_waterlevel.sql)
  column "last_update" does not exist
  LINE 34:     "last_update"
               ^
  HINT:  Perhaps you meant to reference the column "w.lastUpdate".
  compiled code at target/run/etl_waterlevel/models/facts/fact_waterlevel.sql.
[0m15:15:46.149625 [debug] [MainThread]: Using postgres connection "master"
[0m15:15:46.149798 [debug] [MainThread]: On master: BEGIN
[0m15:15:46.149944 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:15:46.151184 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m15:15:46.151381 [debug] [MainThread]: On master: COMMIT
[0m15:15:46.151533 [debug] [MainThread]: Using postgres connection "master"
[0m15:15:46.151669 [debug] [MainThread]: On master: COMMIT
[0m15:15:46.151932 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:15:46.152205 [debug] [MainThread]: On master: Close
[0m15:15:46.152536 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:15:46.152730 [debug] [MainThread]: Connection 'list_airflow_dim' was properly closed.
[0m15:15:46.152902 [debug] [MainThread]: Connection 'model.etl_waterlevel.fact_waterlevel' was properly closed.
[0m15:15:46.153082 [info ] [MainThread]: 
[0m15:15:46.153328 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.08 seconds (0.08s).
[0m15:15:46.153766 [debug] [MainThread]: Command end result
[0m15:15:46.168102 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m15:15:46.169291 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m15:15:46.172138 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m15:15:46.172304 [info ] [MainThread]: 
[0m15:15:46.172529 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:15:46.172819 [info ] [MainThread]: 
[0m15:15:46.173099 [error] [MainThread]:   Database Error in model fact_waterlevel (models/facts/fact_waterlevel.sql)
  column "last_update" does not exist
  LINE 34:     "last_update"
               ^
  HINT:  Perhaps you meant to reference the column "w.lastUpdate".
  compiled code at target/run/etl_waterlevel/models/facts/fact_waterlevel.sql
[0m15:15:46.173436 [info ] [MainThread]: 
[0m15:15:46.173959 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:15:46.174617 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.40568793, "process_in_blocks": "0", "process_kernel_time": 0.088858, "process_mem_max_rss": "118792", "process_out_blocks": "2519", "process_user_time": 0.86862}
[0m15:15:46.174855 [debug] [MainThread]: Command `dbt run` failed at 15:15:46.174804 after 0.41 seconds
[0m15:15:46.175076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9253f750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9186b390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91c521d0>]}
[0m15:15:46.175276 [debug] [MainThread]: Flushing usage events
[0m15:15:47.255137 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:16:00.677489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94803290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94801fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94803010>]}


============================== 15:16:00.678920 | 772fa3a7-0ff9-41fc-bb59-c5619b940090 ==============================
[0m15:16:00.678920 [info ] [MainThread]: Running with dbt=1.9.0
[0m15:16:00.679367 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/logs', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --select fact_waterlevel --full-refresh', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:16:00.739705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '772fa3a7-0ff9-41fc-bb59-c5619b940090', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93bbd610>]}
[0m15:16:00.761649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '772fa3a7-0ff9-41fc-bb59-c5619b940090', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9725f090>]}
[0m15:16:00.762041 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:16:00.786491 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m15:16:00.824582 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:16:00.824904 [debug] [MainThread]: Partial parsing: updated file: etl_waterlevel://models/facts/fact_waterlevel.sql
[0m15:16:00.916079 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m15:16:00.918501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '772fa3a7-0ff9-41fc-bb59-c5619b940090', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93985110>]}
[0m15:16:00.946413 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m15:16:00.947892 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m15:16:00.953509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '772fa3a7-0ff9-41fc-bb59-c5619b940090', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93739250>]}
[0m15:16:00.953767 [info ] [MainThread]: Found 3 models, 434 macros
[0m15:16:00.953944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '772fa3a7-0ff9-41fc-bb59-c5619b940090', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93672210>]}
[0m15:16:00.954645 [info ] [MainThread]: 
[0m15:16:00.954888 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:16:00.955115 [info ] [MainThread]: 
[0m15:16:00.955419 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:16:00.955900 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m15:16:00.970462 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m15:16:00.970692 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m15:16:00.970886 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:16:00.973430 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.003 seconds
[0m15:16:00.974038 [debug] [ThreadPool]: On list_airflow: Close
[0m15:16:00.976104 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_fact)
[0m15:16:00.976382 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow_dim'
[0m15:16:00.978777 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m15:16:00.979741 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m15:16:00.979998 [debug] [ThreadPool]: On list_airflow_fact: BEGIN
[0m15:16:00.980254 [debug] [ThreadPool]: On list_airflow_dim: BEGIN
[0m15:16:00.980473 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:16:00.980704 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:16:00.982509 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m15:16:00.982693 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m15:16:00.982893 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m15:16:00.983146 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m15:16:00.983385 [debug] [ThreadPool]: On list_airflow_fact: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_fact"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'fact'
  
[0m15:16:00.983662 [debug] [ThreadPool]: On list_airflow_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dim'
  
[0m15:16:00.985103 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m15:16:00.985247 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.001 seconds
[0m15:16:00.985824 [debug] [ThreadPool]: On list_airflow_fact: ROLLBACK
[0m15:16:00.986467 [debug] [ThreadPool]: On list_airflow_dim: ROLLBACK
[0m15:16:00.986775 [debug] [ThreadPool]: On list_airflow_fact: Close
[0m15:16:00.987048 [debug] [ThreadPool]: On list_airflow_dim: Close
[0m15:16:00.989521 [debug] [MainThread]: Using postgres connection "master"
[0m15:16:00.989733 [debug] [MainThread]: On master: BEGIN
[0m15:16:00.989921 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:16:00.991326 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m15:16:00.991588 [debug] [MainThread]: Using postgres connection "master"
[0m15:16:00.991821 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:16:00.993156 [debug] [MainThread]: SQL status: SELECT 0 in 0.001 seconds
[0m15:16:00.993663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '772fa3a7-0ff9-41fc-bb59-c5619b940090', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93b6b410>]}
[0m15:16:00.993951 [debug] [MainThread]: On master: ROLLBACK
[0m15:16:00.994233 [debug] [MainThread]: Using postgres connection "master"
[0m15:16:00.994425 [debug] [MainThread]: On master: BEGIN
[0m15:16:00.994764 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:16:00.995007 [debug] [MainThread]: On master: COMMIT
[0m15:16:00.995203 [debug] [MainThread]: Using postgres connection "master"
[0m15:16:00.995407 [debug] [MainThread]: On master: COMMIT
[0m15:16:00.995658 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:16:00.995841 [debug] [MainThread]: On master: Close
[0m15:16:00.997113 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.fact_waterlevel
[0m15:16:00.997411 [info ] [Thread-1 (]: 1 of 1 START sql incremental model fact.fact_waterlevel ........................ [RUN]
[0m15:16:00.997690 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_dim, now model.etl_waterlevel.fact_waterlevel)
[0m15:16:00.997934 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.fact_waterlevel
[0m15:16:01.002705 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.fact_waterlevel"
[0m15:16:01.003442 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.fact_waterlevel
[0m15:16:01.026885 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.fact_waterlevel"
[0m15:16:01.027661 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m15:16:01.027894 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: BEGIN
[0m15:16:01.028098 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:16:01.029812 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m15:16:01.030047 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m15:16:01.030248 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      
  
    

  create  table "airflow"."fact"."fact_waterlevel__dbt_tmp"
  
  
    as
  
  (
    

with main as (
select
	distinct
	concat("stationId",'_',"stationCode") as station_key,
	"stationId" as station_id,
	"stationCode" as station_code,
	"waterLevel" as water_level,
	"waterlevelStatus" as waterlevel_status,
    case
        when "waterlevelStatus" = 3 then '🚨 Beyond Danger'
        when "waterlevelStatus" = 2 then '⚠️ Between Warning and Danger'
        when "waterlevelStatus" = 1 then '🔶 Between Alert and Warning'
        when "waterlevelStatus" = 0 then '✅ Between Normal and Alert'
        when "waterlevelStatus" = -1 then '🟢 Below Normal (Safe)'
        else '❓ Unknown Status'
    end as waterlevel_condition,
	"stationName",
	"districtName",
	-- to_timestamp("lastUpdate",'DD/MM/YYYY HH24:MI') as last_update
    "lastUpdate"
from
	raw.waterlevels w
where
	"stationStatus" = 1

    

)
select
	*
from
	main
order by
	last_update desc
  );
  
  
[0m15:16:01.030816 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "last_update" does not exist
LINE 48:  last_update desc
          ^
HINT:  Perhaps you meant to reference the column "main.lastUpdate".

[0m15:16:01.031043 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: ROLLBACK
[0m15:16:01.031286 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: Close
[0m15:16:01.033139 [debug] [Thread-1 (]: Database Error in model fact_waterlevel (models/facts/fact_waterlevel.sql)
  column "last_update" does not exist
  LINE 48:  last_update desc
            ^
  HINT:  Perhaps you meant to reference the column "main.lastUpdate".
  compiled code at target/run/etl_waterlevel/models/facts/fact_waterlevel.sql
[0m15:16:01.033893 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '772fa3a7-0ff9-41fc-bb59-c5619b940090', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92a71210>]}
[0m15:16:01.034290 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model fact.fact_waterlevel ............... [[31mERROR[0m in 0.04s]
[0m15:16:01.034620 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.fact_waterlevel
[0m15:16:01.034873 [debug] [Thread-7 (]: Marking all children of 'model.etl_waterlevel.fact_waterlevel' to be skipped because of status 'error'.  Reason: Database Error in model fact_waterlevel (models/facts/fact_waterlevel.sql)
  column "last_update" does not exist
  LINE 48:  last_update desc
            ^
  HINT:  Perhaps you meant to reference the column "main.lastUpdate".
  compiled code at target/run/etl_waterlevel/models/facts/fact_waterlevel.sql.
[0m15:16:01.035837 [debug] [MainThread]: Using postgres connection "master"
[0m15:16:01.036029 [debug] [MainThread]: On master: BEGIN
[0m15:16:01.036172 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:16:01.037512 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m15:16:01.037742 [debug] [MainThread]: On master: COMMIT
[0m15:16:01.037974 [debug] [MainThread]: Using postgres connection "master"
[0m15:16:01.038225 [debug] [MainThread]: On master: COMMIT
[0m15:16:01.038579 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:16:01.038773 [debug] [MainThread]: On master: Close
[0m15:16:01.039000 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:16:01.039192 [debug] [MainThread]: Connection 'list_airflow_fact' was properly closed.
[0m15:16:01.039328 [debug] [MainThread]: Connection 'model.etl_waterlevel.fact_waterlevel' was properly closed.
[0m15:16:01.039493 [info ] [MainThread]: 
[0m15:16:01.039722 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.08 seconds (0.08s).
[0m15:16:01.040193 [debug] [MainThread]: Command end result
[0m15:16:01.053816 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m15:16:01.054959 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m15:16:01.058079 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m15:16:01.058259 [info ] [MainThread]: 
[0m15:16:01.058526 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:16:01.058764 [info ] [MainThread]: 
[0m15:16:01.059141 [error] [MainThread]:   Database Error in model fact_waterlevel (models/facts/fact_waterlevel.sql)
  column "last_update" does not exist
  LINE 48:  last_update desc
            ^
  HINT:  Perhaps you meant to reference the column "main.lastUpdate".
  compiled code at target/run/etl_waterlevel/models/facts/fact_waterlevel.sql
[0m15:16:01.059336 [info ] [MainThread]: 
[0m15:16:01.059569 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:16:01.060082 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.4037279, "process_in_blocks": "0", "process_kernel_time": 0.09002, "process_mem_max_rss": "118792", "process_out_blocks": "2518", "process_user_time": 0.8632}
[0m15:16:01.060282 [debug] [MainThread]: Command `dbt run` failed at 15:16:01.060245 after 0.40 seconds
[0m15:16:01.060467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff949385d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff954ff8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff991093d0>]}
[0m15:16:01.060641 [debug] [MainThread]: Flushing usage events
[0m15:16:02.248553 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:16:12.390336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffadc0ab10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffadf0b650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffadc0bc90>]}


============================== 15:16:12.391842 | 48b66e73-e7f2-4915-bf15-b167709d9882 ==============================
[0m15:16:12.391842 [info ] [MainThread]: Running with dbt=1.9.0
[0m15:16:12.392204 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --select fact_waterlevel --full-refresh', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:16:12.452402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '48b66e73-e7f2-4915-bf15-b167709d9882', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad0131d0>]}
[0m15:16:12.474841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '48b66e73-e7f2-4915-bf15-b167709d9882', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb062f050>]}
[0m15:16:12.475239 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:16:12.500701 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m15:16:12.538486 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:16:12.538803 [debug] [MainThread]: Partial parsing: updated file: etl_waterlevel://models/facts/fact_waterlevel.sql
[0m15:16:12.628168 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m15:16:12.630439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '48b66e73-e7f2-4915-bf15-b167709d9882', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffadc0b4d0>]}
[0m15:16:12.657458 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m15:16:12.658897 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m15:16:12.664271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '48b66e73-e7f2-4915-bf15-b167709d9882', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac943bd0>]}
[0m15:16:12.664542 [info ] [MainThread]: Found 3 models, 434 macros
[0m15:16:12.664753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '48b66e73-e7f2-4915-bf15-b167709d9882', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaca70b10>]}
[0m15:16:12.665548 [info ] [MainThread]: 
[0m15:16:12.665774 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:16:12.665987 [info ] [MainThread]: 
[0m15:16:12.666304 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:16:12.666735 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m15:16:12.680713 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m15:16:12.680941 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m15:16:12.681204 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:16:12.683696 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.002 seconds
[0m15:16:12.684314 [debug] [ThreadPool]: On list_airflow: Close
[0m15:16:12.686463 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_dim)
[0m15:16:12.686742 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow_fact'
[0m15:16:12.689257 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m15:16:12.690205 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m15:16:12.690460 [debug] [ThreadPool]: On list_airflow_dim: BEGIN
[0m15:16:12.690694 [debug] [ThreadPool]: On list_airflow_fact: BEGIN
[0m15:16:12.690914 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:16:12.691141 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:16:12.692909 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m15:16:12.693139 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m15:16:12.693341 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m15:16:12.693568 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m15:16:12.693822 [debug] [ThreadPool]: On list_airflow_fact: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_fact"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'fact'
  
[0m15:16:12.694061 [debug] [ThreadPool]: On list_airflow_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dim'
  
[0m15:16:12.695483 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m15:16:12.695608 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.001 seconds
[0m15:16:12.696242 [debug] [ThreadPool]: On list_airflow_fact: ROLLBACK
[0m15:16:12.696776 [debug] [ThreadPool]: On list_airflow_dim: ROLLBACK
[0m15:16:12.697107 [debug] [ThreadPool]: On list_airflow_fact: Close
[0m15:16:12.697285 [debug] [ThreadPool]: On list_airflow_dim: Close
[0m15:16:12.699732 [debug] [MainThread]: Using postgres connection "master"
[0m15:16:12.699920 [debug] [MainThread]: On master: BEGIN
[0m15:16:12.700093 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:16:12.701594 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m15:16:12.701814 [debug] [MainThread]: Using postgres connection "master"
[0m15:16:12.702067 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:16:12.703439 [debug] [MainThread]: SQL status: SELECT 0 in 0.001 seconds
[0m15:16:12.703943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '48b66e73-e7f2-4915-bf15-b167709d9882', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffabf60750>]}
[0m15:16:12.704210 [debug] [MainThread]: On master: ROLLBACK
[0m15:16:12.704483 [debug] [MainThread]: Using postgres connection "master"
[0m15:16:12.704660 [debug] [MainThread]: On master: BEGIN
[0m15:16:12.705014 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:16:12.705209 [debug] [MainThread]: On master: COMMIT
[0m15:16:12.705379 [debug] [MainThread]: Using postgres connection "master"
[0m15:16:12.705546 [debug] [MainThread]: On master: COMMIT
[0m15:16:12.705797 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:16:12.705986 [debug] [MainThread]: On master: Close
[0m15:16:12.707202 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.fact_waterlevel
[0m15:16:12.707490 [info ] [Thread-1 (]: 1 of 1 START sql incremental model fact.fact_waterlevel ........................ [RUN]
[0m15:16:12.707756 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_dim, now model.etl_waterlevel.fact_waterlevel)
[0m15:16:12.708020 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.fact_waterlevel
[0m15:16:12.712850 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.fact_waterlevel"
[0m15:16:12.713572 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.fact_waterlevel
[0m15:16:12.735993 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.fact_waterlevel"
[0m15:16:12.736707 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m15:16:12.736924 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: BEGIN
[0m15:16:12.737147 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:16:12.738859 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m15:16:12.739100 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m15:16:12.739336 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      
  
    

  create  table "airflow"."fact"."fact_waterlevel__dbt_tmp"
  
  
    as
  
  (
    

with main as (
select
	distinct
	concat("stationId",'_',"stationCode") as station_key,
	"stationId" as station_id,
	"stationCode" as station_code,
	"waterLevel" as water_level,
	"waterlevelStatus" as waterlevel_status,
    case
        when "waterlevelStatus" = 3 then '🚨 Beyond Danger'
        when "waterlevelStatus" = 2 then '⚠️ Between Warning and Danger'
        when "waterlevelStatus" = 1 then '🔶 Between Alert and Warning'
        when "waterlevelStatus" = 0 then '✅ Between Normal and Alert'
        when "waterlevelStatus" = -1 then '🟢 Below Normal (Safe)'
        else '❓ Unknown Status'
    end as waterlevel_condition,
	"stationName",
	"districtName",
	-- to_timestamp("lastUpdate",'DD/MM/YYYY HH24:MI') as last_update
    "lastUpdate"
from
	raw.waterlevels w
where
	"stationStatus" = 1

    

)
select
	*
from
	main
order by
	-- last_update desc
  );
  
  
[0m15:16:12.739691 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ")"
LINE 49:   );
           ^

[0m15:16:12.739926 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: ROLLBACK
[0m15:16:12.740194 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: Close
[0m15:16:12.742020 [debug] [Thread-1 (]: Database Error in model fact_waterlevel (models/facts/fact_waterlevel.sql)
  syntax error at or near ")"
  LINE 49:   );
             ^
  compiled code at target/run/etl_waterlevel/models/facts/fact_waterlevel.sql
[0m15:16:12.742783 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48b66e73-e7f2-4915-bf15-b167709d9882', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffabf60190>]}
[0m15:16:12.743127 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model fact.fact_waterlevel ............... [[31mERROR[0m in 0.03s]
[0m15:16:12.743527 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.fact_waterlevel
[0m15:16:12.743803 [debug] [Thread-7 (]: Marking all children of 'model.etl_waterlevel.fact_waterlevel' to be skipped because of status 'error'.  Reason: Database Error in model fact_waterlevel (models/facts/fact_waterlevel.sql)
  syntax error at or near ")"
  LINE 49:   );
             ^
  compiled code at target/run/etl_waterlevel/models/facts/fact_waterlevel.sql.
[0m15:16:12.744732 [debug] [MainThread]: Using postgres connection "master"
[0m15:16:12.744910 [debug] [MainThread]: On master: BEGIN
[0m15:16:12.745061 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:16:12.746345 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m15:16:12.746538 [debug] [MainThread]: On master: COMMIT
[0m15:16:12.746726 [debug] [MainThread]: Using postgres connection "master"
[0m15:16:12.746900 [debug] [MainThread]: On master: COMMIT
[0m15:16:12.747150 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:16:12.747333 [debug] [MainThread]: On master: Close
[0m15:16:12.747571 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:16:12.747764 [debug] [MainThread]: Connection 'model.etl_waterlevel.fact_waterlevel' was properly closed.
[0m15:16:12.748030 [debug] [MainThread]: Connection 'list_airflow_fact' was properly closed.
[0m15:16:12.748290 [info ] [MainThread]: 
[0m15:16:12.748534 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.08 seconds (0.08s).
[0m15:16:12.748992 [debug] [MainThread]: Command end result
[0m15:16:12.762341 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m15:16:12.763520 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m15:16:12.766446 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m15:16:12.766614 [info ] [MainThread]: 
[0m15:16:12.766809 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:16:12.767089 [info ] [MainThread]: 
[0m15:16:12.767333 [error] [MainThread]:   Database Error in model fact_waterlevel (models/facts/fact_waterlevel.sql)
  syntax error at or near ")"
  LINE 49:   );
             ^
  compiled code at target/run/etl_waterlevel/models/facts/fact_waterlevel.sql
[0m15:16:12.767553 [info ] [MainThread]: 
[0m15:16:12.767828 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:16:12.768379 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.39922917, "process_in_blocks": "0", "process_kernel_time": 0.077817, "process_mem_max_rss": "118604", "process_out_blocks": "2518", "process_user_time": 0.877939}
[0m15:16:12.768589 [debug] [MainThread]: Command `dbt run` failed at 15:16:12.768552 after 0.40 seconds
[0m15:16:12.768775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffadd40990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffadc1c890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2508990>]}
[0m15:16:12.768952 [debug] [MainThread]: Flushing usage events
[0m15:16:14.018596 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:16:42.938342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa473f910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa473f590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa473c190>]}


============================== 15:16:42.939784 | 6f119ebe-a705-4955-b5be-c28c83f8e2ed ==============================
[0m15:16:42.939784 [info ] [MainThread]: Running with dbt=1.9.0
[0m15:16:42.940155 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select fact_waterlevel --full-refresh', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:16:43.000289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6f119ebe-a705-4955-b5be-c28c83f8e2ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3b49d10>]}
[0m15:16:43.022219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6f119ebe-a705-4955-b5be-c28c83f8e2ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa71b5310>]}
[0m15:16:43.022598 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:16:43.046881 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m15:16:43.084391 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:16:43.084716 [debug] [MainThread]: Partial parsing: updated file: etl_waterlevel://models/facts/fact_waterlevel.sql
[0m15:16:43.173908 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m15:16:43.176236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6f119ebe-a705-4955-b5be-c28c83f8e2ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3786950>]}
[0m15:16:43.203185 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m15:16:43.204588 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m15:16:43.209970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6f119ebe-a705-4955-b5be-c28c83f8e2ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3675050>]}
[0m15:16:43.210212 [info ] [MainThread]: Found 3 models, 434 macros
[0m15:16:43.210413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6f119ebe-a705-4955-b5be-c28c83f8e2ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa35e3a10>]}
[0m15:16:43.211167 [info ] [MainThread]: 
[0m15:16:43.211431 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:16:43.211584 [info ] [MainThread]: 
[0m15:16:43.211820 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:16:43.212269 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m15:16:43.226174 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m15:16:43.226403 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m15:16:43.226593 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:16:43.229049 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.002 seconds
[0m15:16:43.229629 [debug] [ThreadPool]: On list_airflow: Close
[0m15:16:43.231686 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_dim)
[0m15:16:43.231963 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow_fact'
[0m15:16:43.234380 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m15:16:43.235334 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m15:16:43.235566 [debug] [ThreadPool]: On list_airflow_dim: BEGIN
[0m15:16:43.235810 [debug] [ThreadPool]: On list_airflow_fact: BEGIN
[0m15:16:43.236030 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:16:43.236265 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:16:43.237986 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m15:16:43.238183 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m15:16:43.238387 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m15:16:43.238626 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m15:16:43.238864 [debug] [ThreadPool]: On list_airflow_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dim'
  
[0m15:16:43.239132 [debug] [ThreadPool]: On list_airflow_fact: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_fact"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'fact'
  
[0m15:16:43.240533 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.001 seconds
[0m15:16:43.240665 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m15:16:43.241285 [debug] [ThreadPool]: On list_airflow_dim: ROLLBACK
[0m15:16:43.241863 [debug] [ThreadPool]: On list_airflow_fact: ROLLBACK
[0m15:16:43.242185 [debug] [ThreadPool]: On list_airflow_dim: Close
[0m15:16:43.242389 [debug] [ThreadPool]: On list_airflow_fact: Close
[0m15:16:43.244814 [debug] [MainThread]: Using postgres connection "master"
[0m15:16:43.245024 [debug] [MainThread]: On master: BEGIN
[0m15:16:43.245197 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:16:43.246681 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m15:16:43.246911 [debug] [MainThread]: Using postgres connection "master"
[0m15:16:43.247139 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:16:43.248659 [debug] [MainThread]: SQL status: SELECT 0 in 0.001 seconds
[0m15:16:43.249168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6f119ebe-a705-4955-b5be-c28c83f8e2ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4c843d0>]}
[0m15:16:43.249464 [debug] [MainThread]: On master: ROLLBACK
[0m15:16:43.249788 [debug] [MainThread]: Using postgres connection "master"
[0m15:16:43.249983 [debug] [MainThread]: On master: BEGIN
[0m15:16:43.250336 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:16:43.250586 [debug] [MainThread]: On master: COMMIT
[0m15:16:43.250763 [debug] [MainThread]: Using postgres connection "master"
[0m15:16:43.250939 [debug] [MainThread]: On master: COMMIT
[0m15:16:43.251191 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:16:43.251395 [debug] [MainThread]: On master: Close
[0m15:16:43.252666 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.fact_waterlevel
[0m15:16:43.252963 [info ] [Thread-1 (]: 1 of 1 START sql incremental model fact.fact_waterlevel ........................ [RUN]
[0m15:16:43.253330 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_fact, now model.etl_waterlevel.fact_waterlevel)
[0m15:16:43.253550 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.fact_waterlevel
[0m15:16:43.258354 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.fact_waterlevel"
[0m15:16:43.259057 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.fact_waterlevel
[0m15:16:43.282280 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.fact_waterlevel"
[0m15:16:43.282909 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m15:16:43.283091 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: BEGIN
[0m15:16:43.283252 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:16:43.284829 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m15:16:43.285101 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m15:16:43.285350 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      
  
    

  create  table "airflow"."fact"."fact_waterlevel__dbt_tmp"
  
  
    as
  
  (
    

with main as (
select
	distinct
	concat("stationId",'_',"stationCode") as station_key,
	"stationId" as station_id,
	"stationCode" as station_code,
	"waterLevel" as water_level,
	"waterlevelStatus" as waterlevel_status,
    case
        when "waterlevelStatus" = 3 then '🚨 Beyond Danger'
        when "waterlevelStatus" = 2 then '⚠️ Between Warning and Danger'
        when "waterlevelStatus" = 1 then '🔶 Between Alert and Warning'
        when "waterlevelStatus" = 0 then '✅ Between Normal and Alert'
        when "waterlevelStatus" = -1 then '🟢 Below Normal (Safe)'
        else '❓ Unknown Status'
    end as waterlevel_condition,
	"stationName",
	"districtName",
	-- to_timestamp("lastUpdate",'DD/MM/YYYY HH24:MI') as last_update
    "lastUpdate"
from
	raw.waterlevels w
where
	"stationStatus" = 1

    

)
select
	*
from
	main
	-- last_update desc
  );
  
  
[0m15:16:43.315901 [debug] [Thread-1 (]: SQL status: SELECT 18244 in 0.030 seconds
[0m15:16:43.320194 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m15:16:43.320446 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */
alter table "airflow"."fact"."fact_waterlevel" rename to "fact_waterlevel__dbt_backup"
[0m15:16:43.320853 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:16:43.322124 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m15:16:43.322337 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */
alter table "airflow"."fact"."fact_waterlevel__dbt_tmp" rename to "fact_waterlevel"
[0m15:16:43.322692 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:16:43.329596 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m15:16:43.329851 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m15:16:43.330084 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m15:16:43.336757 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m15:16:43.339654 [debug] [Thread-1 (]: Applying DROP to: "airflow"."fact"."fact_waterlevel__dbt_backup"
[0m15:16:43.341764 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m15:16:43.342001 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */
drop table if exists "airflow"."fact"."fact_waterlevel__dbt_backup" cascade
[0m15:16:43.343934 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m15:16:43.345175 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: Close
[0m15:16:43.346122 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f119ebe-a705-4955-b5be-c28c83f8e2ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3601410>]}
[0m15:16:43.346550 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model fact.fact_waterlevel ................... [[32mSELECT 18244[0m in 0.09s]
[0m15:16:43.347019 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.fact_waterlevel
[0m15:16:43.347899 [debug] [MainThread]: Using postgres connection "master"
[0m15:16:43.348079 [debug] [MainThread]: On master: BEGIN
[0m15:16:43.348234 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:16:43.349832 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m15:16:43.350028 [debug] [MainThread]: On master: COMMIT
[0m15:16:43.350210 [debug] [MainThread]: Using postgres connection "master"
[0m15:16:43.350404 [debug] [MainThread]: On master: COMMIT
[0m15:16:43.350605 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:16:43.350753 [debug] [MainThread]: On master: Close
[0m15:16:43.350948 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:16:43.351093 [debug] [MainThread]: Connection 'list_airflow_dim' was properly closed.
[0m15:16:43.351222 [debug] [MainThread]: Connection 'model.etl_waterlevel.fact_waterlevel' was properly closed.
[0m15:16:43.351475 [info ] [MainThread]: 
[0m15:16:43.351712 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.14 seconds (0.14s).
[0m15:16:43.352129 [debug] [MainThread]: Command end result
[0m15:16:43.392846 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m15:16:43.393941 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m15:16:43.396946 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m15:16:43.397184 [info ] [MainThread]: 
[0m15:16:43.397521 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:16:43.397804 [info ] [MainThread]: 
[0m15:16:43.398048 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:16:43.398676 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.4817709, "process_in_blocks": "0", "process_kernel_time": 0.082009, "process_mem_max_rss": "118112", "process_out_blocks": "2520", "process_user_time": 0.940104}
[0m15:16:43.398934 [debug] [MainThread]: Command `dbt run` succeeded at 15:16:43.398888 after 0.48 seconds
[0m15:16:43.399143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9055110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9054810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa90557d0>]}
[0m15:16:43.399363 [debug] [MainThread]: Flushing usage events
[0m15:16:44.642062 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:19:40.686770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9e3e4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba052450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba03fc50>]}


============================== 15:19:40.688398 | ec064184-f6e8-418a-8573-53ee3786b701 ==============================
[0m15:19:40.688398 [info ] [MainThread]: Running with dbt=1.9.0
[0m15:19:40.688801 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select fact_waterlevel --full-refresh', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:19:40.751821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ec064184-f6e8-418a-8573-53ee3786b701', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbc56ad50>]}
[0m15:19:40.774076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ec064184-f6e8-418a-8573-53ee3786b701', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbc924150>]}
[0m15:19:40.774450 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:19:40.801180 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m15:19:40.841129 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:19:40.841439 [debug] [MainThread]: Partial parsing: updated file: etl_waterlevel://models/facts/fact_waterlevel.sql
[0m15:19:40.933644 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m15:19:40.936056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ec064184-f6e8-418a-8573-53ee3786b701', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9c91d90>]}
[0m15:19:40.963793 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m15:19:40.965312 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m15:19:40.971402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ec064184-f6e8-418a-8573-53ee3786b701', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8bf46d0>]}
[0m15:19:40.971641 [info ] [MainThread]: Found 3 models, 434 macros
[0m15:19:40.971891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ec064184-f6e8-418a-8573-53ee3786b701', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8d8b910>]}
[0m15:19:40.972678 [info ] [MainThread]: 
[0m15:19:40.972906 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:19:40.973149 [info ] [MainThread]: 
[0m15:19:40.973501 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:19:40.973988 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m15:19:40.990642 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m15:19:40.990877 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m15:19:40.991113 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:19:40.994400 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.003 seconds
[0m15:19:40.995066 [debug] [ThreadPool]: On list_airflow: Close
[0m15:19:40.997427 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_dim)
[0m15:19:40.997741 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow_fact'
[0m15:19:41.000561 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m15:19:41.001572 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m15:19:41.001787 [debug] [ThreadPool]: On list_airflow_dim: BEGIN
[0m15:19:41.002005 [debug] [ThreadPool]: On list_airflow_fact: BEGIN
[0m15:19:41.002170 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:19:41.002365 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:19:41.004405 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m15:19:41.004571 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m15:19:41.004765 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m15:19:41.005108 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m15:19:41.005323 [debug] [ThreadPool]: On list_airflow_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dim'
  
[0m15:19:41.005545 [debug] [ThreadPool]: On list_airflow_fact: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_fact"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'fact'
  
[0m15:19:41.007258 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.002 seconds
[0m15:19:41.007388 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m15:19:41.008034 [debug] [ThreadPool]: On list_airflow_dim: ROLLBACK
[0m15:19:41.008638 [debug] [ThreadPool]: On list_airflow_fact: ROLLBACK
[0m15:19:41.008962 [debug] [ThreadPool]: On list_airflow_dim: Close
[0m15:19:41.009149 [debug] [ThreadPool]: On list_airflow_fact: Close
[0m15:19:41.012589 [debug] [MainThread]: Using postgres connection "master"
[0m15:19:41.012821 [debug] [MainThread]: On master: BEGIN
[0m15:19:41.013024 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:19:41.015140 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m15:19:41.015509 [debug] [MainThread]: Using postgres connection "master"
[0m15:19:41.015895 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:19:41.018261 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m15:19:41.018890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ec064184-f6e8-418a-8573-53ee3786b701', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8ed0e90>]}
[0m15:19:41.019187 [debug] [MainThread]: On master: ROLLBACK
[0m15:19:41.019485 [debug] [MainThread]: Using postgres connection "master"
[0m15:19:41.019681 [debug] [MainThread]: On master: BEGIN
[0m15:19:41.020032 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:19:41.020381 [debug] [MainThread]: On master: COMMIT
[0m15:19:41.020618 [debug] [MainThread]: Using postgres connection "master"
[0m15:19:41.020804 [debug] [MainThread]: On master: COMMIT
[0m15:19:41.021097 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:19:41.021336 [debug] [MainThread]: On master: Close
[0m15:19:41.022763 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.fact_waterlevel
[0m15:19:41.023093 [info ] [Thread-1 (]: 1 of 1 START sql incremental model fact.fact_waterlevel ........................ [RUN]
[0m15:19:41.023415 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_fact, now model.etl_waterlevel.fact_waterlevel)
[0m15:19:41.023754 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.fact_waterlevel
[0m15:19:41.029224 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.fact_waterlevel"
[0m15:19:41.030016 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.fact_waterlevel
[0m15:19:41.054262 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.fact_waterlevel"
[0m15:19:41.055096 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m15:19:41.055384 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: BEGIN
[0m15:19:41.055596 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:19:41.057472 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m15:19:41.057730 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m15:19:41.057948 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      
  
    

  create  table "airflow"."fact"."fact_waterlevel__dbt_tmp"
  
  
    as
  
  (
    

with main as (
select
	distinct
	concat("stationId",'_',"stationCode") as station_key,
	"stationId" as station_id,
	"stationCode" as station_code,
	"waterLevel" as water_level,
	"waterlevelStatus" as waterlevel_status,
    case
        when "waterlevelStatus" = 3 then '🚨 Beyond Danger'
        when "waterlevelStatus" = 2 then '⚠️ Between Warning and Danger'
        when "waterlevelStatus" = 1 then '🔶 Between Alert and Warning'
        when "waterlevelStatus" = 0 then '✅ Between Normal and Alert'
        when "waterlevelStatus" = -1 then '🟢 Below Normal (Safe)'
        else '❓ Unknown Status'
    end as waterlevel_condition,
	"stationName",
	"districtName",
    to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI') as last_update

from
	raw.waterlevels w
where
	"stationStatus" = 1

    

)
select
	*
from
	main
  );
  
  
[0m15:19:41.089965 [debug] [Thread-1 (]: SQL status: SELECT 18244 in 0.032 seconds
[0m15:19:41.094404 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m15:19:41.094675 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */
alter table "airflow"."fact"."fact_waterlevel" rename to "fact_waterlevel__dbt_backup"
[0m15:19:41.095122 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:19:41.096418 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m15:19:41.096641 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */
alter table "airflow"."fact"."fact_waterlevel__dbt_tmp" rename to "fact_waterlevel"
[0m15:19:41.097005 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:19:41.103806 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m15:19:41.104056 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m15:19:41.104282 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m15:19:41.113427 [debug] [Thread-1 (]: SQL status: COMMIT in 0.009 seconds
[0m15:19:41.117275 [debug] [Thread-1 (]: Applying DROP to: "airflow"."fact"."fact_waterlevel__dbt_backup"
[0m15:19:41.119226 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m15:19:41.119455 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */
drop table if exists "airflow"."fact"."fact_waterlevel__dbt_backup" cascade
[0m15:19:41.121343 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m15:19:41.122742 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: Close
[0m15:19:41.123769 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec064184-f6e8-418a-8573-53ee3786b701', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8d47910>]}
[0m15:19:41.124151 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model fact.fact_waterlevel ................... [[32mSELECT 18244[0m in 0.10s]
[0m15:19:41.124545 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.fact_waterlevel
[0m15:19:41.125322 [debug] [MainThread]: Using postgres connection "master"
[0m15:19:41.125492 [debug] [MainThread]: On master: BEGIN
[0m15:19:41.125627 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:19:41.127148 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m15:19:41.127349 [debug] [MainThread]: On master: COMMIT
[0m15:19:41.127523 [debug] [MainThread]: Using postgres connection "master"
[0m15:19:41.127693 [debug] [MainThread]: On master: COMMIT
[0m15:19:41.127881 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:19:41.128027 [debug] [MainThread]: On master: Close
[0m15:19:41.128235 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:19:41.128395 [debug] [MainThread]: Connection 'list_airflow_dim' was properly closed.
[0m15:19:41.128546 [debug] [MainThread]: Connection 'model.etl_waterlevel.fact_waterlevel' was properly closed.
[0m15:19:41.128721 [info ] [MainThread]: 
[0m15:19:41.128932 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.16 seconds (0.16s).
[0m15:19:41.129346 [debug] [MainThread]: Command end result
[0m15:19:41.176360 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m15:19:41.177756 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m15:19:41.180673 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m15:19:41.180874 [info ] [MainThread]: 
[0m15:19:41.181118 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:19:41.181392 [info ] [MainThread]: 
[0m15:19:41.181690 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:19:41.182355 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.5175559, "process_in_blocks": "0", "process_kernel_time": 0.153505, "process_mem_max_rss": "118284", "process_out_blocks": "2520", "process_user_time": 0.964893}
[0m15:19:41.182606 [debug] [MainThread]: Command `dbt run` succeeded at 15:19:41.182558 after 0.52 seconds
[0m15:19:41.182797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbe7b5650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbe7b4810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbe7b57d0>]}
[0m15:19:41.182984 [debug] [MainThread]: Flushing usage events
[0m15:19:42.610616 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:21:01.394332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a93ab10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ab4ded0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a93b3d0>]}


============================== 15:21:01.395847 | f7a350a5-29fe-4306-9f37-e204eef38ddf ==============================
[0m15:21:01.395847 [info ] [MainThread]: Running with dbt=1.9.0
[0m15:21:01.396229 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select fact_waterlevel --full-refresh', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:21:01.458324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f7a350a5-29fe-4306-9f37-e204eef38ddf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89cf5d90>]}
[0m15:21:01.480879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f7a350a5-29fe-4306-9f37-e204eef38ddf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d375710>]}
[0m15:21:01.481254 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:21:01.507187 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m15:21:01.545715 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:21:01.546030 [debug] [MainThread]: Partial parsing: updated file: etl_waterlevel://models/facts/fact_waterlevel.sql
[0m15:21:01.636290 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m15:21:01.638498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f7a350a5-29fe-4306-9f37-e204eef38ddf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff897b3210>]}
[0m15:21:01.665226 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m15:21:01.666519 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m15:21:01.671878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f7a350a5-29fe-4306-9f37-e204eef38ddf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89845bd0>]}
[0m15:21:01.672118 [info ] [MainThread]: Found 3 models, 434 macros
[0m15:21:01.672332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f7a350a5-29fe-4306-9f37-e204eef38ddf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff897bd050>]}
[0m15:21:01.673079 [info ] [MainThread]: 
[0m15:21:01.673320 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:21:01.673553 [info ] [MainThread]: 
[0m15:21:01.673934 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:21:01.674429 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m15:21:01.689100 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m15:21:01.689325 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m15:21:01.689513 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:21:01.692252 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.003 seconds
[0m15:21:01.692882 [debug] [ThreadPool]: On list_airflow: Close
[0m15:21:01.695099 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_fact)
[0m15:21:01.695383 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow_dim'
[0m15:21:01.697851 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m15:21:01.698822 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m15:21:01.699058 [debug] [ThreadPool]: On list_airflow_fact: BEGIN
[0m15:21:01.699295 [debug] [ThreadPool]: On list_airflow_dim: BEGIN
[0m15:21:01.699504 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:21:01.699730 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:21:01.701614 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m15:21:01.702000 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m15:21:01.702152 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m15:21:01.702417 [debug] [ThreadPool]: On list_airflow_fact: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_fact"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'fact'
  
[0m15:21:01.702674 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m15:21:01.703057 [debug] [ThreadPool]: On list_airflow_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dim'
  
[0m15:21:01.704484 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m15:21:01.705121 [debug] [ThreadPool]: On list_airflow_fact: ROLLBACK
[0m15:21:01.705260 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.002 seconds
[0m15:21:01.705577 [debug] [ThreadPool]: On list_airflow_fact: Close
[0m15:21:01.706088 [debug] [ThreadPool]: On list_airflow_dim: ROLLBACK
[0m15:21:01.706725 [debug] [ThreadPool]: On list_airflow_dim: Close
[0m15:21:01.709014 [debug] [MainThread]: Using postgres connection "master"
[0m15:21:01.709214 [debug] [MainThread]: On master: BEGIN
[0m15:21:01.709385 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:21:01.710901 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m15:21:01.711172 [debug] [MainThread]: Using postgres connection "master"
[0m15:21:01.711410 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:21:01.713333 [debug] [MainThread]: SQL status: SELECT 0 in 0.001 seconds
[0m15:21:01.713827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f7a350a5-29fe-4306-9f37-e204eef38ddf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ae88950>]}
[0m15:21:01.714057 [debug] [MainThread]: On master: ROLLBACK
[0m15:21:01.714267 [debug] [MainThread]: Using postgres connection "master"
[0m15:21:01.714396 [debug] [MainThread]: On master: BEGIN
[0m15:21:01.714627 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:21:01.714834 [debug] [MainThread]: On master: COMMIT
[0m15:21:01.714976 [debug] [MainThread]: Using postgres connection "master"
[0m15:21:01.715122 [debug] [MainThread]: On master: COMMIT
[0m15:21:01.715317 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:21:01.715463 [debug] [MainThread]: On master: Close
[0m15:21:01.716460 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.fact_waterlevel
[0m15:21:01.716760 [info ] [Thread-1 (]: 1 of 1 START sql incremental model fact.fact_waterlevel ........................ [RUN]
[0m15:21:01.717052 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_dim, now model.etl_waterlevel.fact_waterlevel)
[0m15:21:01.717293 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.fact_waterlevel
[0m15:21:01.722174 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.fact_waterlevel"
[0m15:21:01.722936 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.fact_waterlevel
[0m15:21:01.745286 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.fact_waterlevel"
[0m15:21:01.746030 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m15:21:01.746248 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: BEGIN
[0m15:21:01.746448 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:21:01.748109 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m15:21:01.748339 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m15:21:01.748564 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      
  
    

  create  table "airflow"."fact"."fact_waterlevel__dbt_tmp"
  
  
    as
  
  (
    

with main as (
select
	distinct
	concat("stationId",'_',"stationCode") as station_key,
	"stationId" as station_id,
	"stationCode" as station_code,
	"waterLevel" as water_level,
	"waterlevelStatus" as waterlevel_status,
    case
        when "waterlevelStatus" = 3 then '🚨 Beyond Danger'
        when "waterlevelStatus" = 2 then '⚠️ Between Warning and Danger'
        when "waterlevelStatus" = 1 then '🔶 Between Alert and Warning'
        when "waterlevelStatus" = 0 then '✅ Between Normal and Alert'
        when "waterlevelStatus" = -1 then '🟢 Below Normal (Safe)'
        else '❓ Unknown Status'
    end as waterlevel_condition,
	"stationName",
	"districtName",
    "lastUpdate"
from
	raw.waterlevels w
where
	"stationStatus" = 1

    

)
select
	*
from
	main
  );
  
  
[0m15:21:01.776264 [debug] [Thread-1 (]: SQL status: SELECT 18244 in 0.027 seconds
[0m15:21:01.780513 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m15:21:01.780746 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */
alter table "airflow"."fact"."fact_waterlevel" rename to "fact_waterlevel__dbt_backup"
[0m15:21:01.781121 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:21:01.782382 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m15:21:01.782594 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */
alter table "airflow"."fact"."fact_waterlevel__dbt_tmp" rename to "fact_waterlevel"
[0m15:21:01.782934 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:21:01.789762 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m15:21:01.790007 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m15:21:01.790204 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m15:21:01.796860 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m15:21:01.799878 [debug] [Thread-1 (]: Applying DROP to: "airflow"."fact"."fact_waterlevel__dbt_backup"
[0m15:21:01.801959 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m15:21:01.802150 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */
drop table if exists "airflow"."fact"."fact_waterlevel__dbt_backup" cascade
[0m15:21:01.803547 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m15:21:01.804805 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: Close
[0m15:21:01.805822 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f7a350a5-29fe-4306-9f37-e204eef38ddf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88b06810>]}
[0m15:21:01.806209 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model fact.fact_waterlevel ................... [[32mSELECT 18244[0m in 0.09s]
[0m15:21:01.806622 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.fact_waterlevel
[0m15:21:01.807527 [debug] [MainThread]: Using postgres connection "master"
[0m15:21:01.807763 [debug] [MainThread]: On master: BEGIN
[0m15:21:01.807952 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:21:01.809635 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m15:21:01.810051 [debug] [MainThread]: On master: COMMIT
[0m15:21:01.810239 [debug] [MainThread]: Using postgres connection "master"
[0m15:21:01.810465 [debug] [MainThread]: On master: COMMIT
[0m15:21:01.810833 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:21:01.810990 [debug] [MainThread]: On master: Close
[0m15:21:01.811192 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:21:01.811355 [debug] [MainThread]: Connection 'list_airflow_fact' was properly closed.
[0m15:21:01.811533 [debug] [MainThread]: Connection 'model.etl_waterlevel.fact_waterlevel' was properly closed.
[0m15:21:01.811785 [info ] [MainThread]: 
[0m15:21:01.812172 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.14 seconds (0.14s).
[0m15:21:01.812702 [debug] [MainThread]: Command end result
[0m15:21:01.858094 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m15:21:01.859446 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m15:21:01.862450 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m15:21:01.862639 [info ] [MainThread]: 
[0m15:21:01.862885 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:21:01.863164 [info ] [MainThread]: 
[0m15:21:01.863395 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:21:01.863983 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.49132085, "process_in_blocks": "0", "process_kernel_time": 0.086888, "process_mem_max_rss": "118076", "process_out_blocks": "2519", "process_user_time": 0.935803}
[0m15:21:01.864193 [debug] [MainThread]: Command `dbt run` succeeded at 15:21:01.864155 after 0.49 seconds
[0m15:21:01.864374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a7b2090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f249250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f2493d0>]}
[0m15:21:01.864573 [debug] [MainThread]: Flushing usage events
[0m15:21:03.199222 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:22:43.140660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96e3d350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97056190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96e3f6d0>]}


============================== 15:22:43.143104 | 94f9a271-a3ed-4b18-ac35-ffab62a8b2d6 ==============================
[0m15:22:43.143104 [info ] [MainThread]: Running with dbt=1.9.0
[0m15:22:43.143522 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select fact_waterlevel --full-refresh', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:22:43.205031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '94f9a271-a3ed-4b18-ac35-ffab62a8b2d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96c91c10>]}
[0m15:22:43.226842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '94f9a271-a3ed-4b18-ac35-ffab62a8b2d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99921ed0>]}
[0m15:22:43.227214 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:22:43.252598 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m15:22:43.291436 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:22:43.291768 [debug] [MainThread]: Partial parsing: updated file: etl_waterlevel://models/facts/fact_waterlevel.sql
[0m15:22:43.383173 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m15:22:43.385497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '94f9a271-a3ed-4b18-ac35-ffab62a8b2d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96084c10>]}
[0m15:22:43.413206 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m15:22:43.414710 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m15:22:43.420827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '94f9a271-a3ed-4b18-ac35-ffab62a8b2d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95db98d0>]}
[0m15:22:43.421096 [info ] [MainThread]: Found 3 models, 434 macros
[0m15:22:43.421330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '94f9a271-a3ed-4b18-ac35-ffab62a8b2d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95d8f090>]}
[0m15:22:43.422053 [info ] [MainThread]: 
[0m15:22:43.422344 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:22:43.422547 [info ] [MainThread]: 
[0m15:22:43.422909 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:22:43.423377 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m15:22:43.438695 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m15:22:43.438939 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m15:22:43.439137 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:22:43.442096 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.003 seconds
[0m15:22:43.442721 [debug] [ThreadPool]: On list_airflow: Close
[0m15:22:43.444885 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_fact)
[0m15:22:43.445164 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow_dim'
[0m15:22:43.447634 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m15:22:43.448565 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m15:22:43.448799 [debug] [ThreadPool]: On list_airflow_fact: BEGIN
[0m15:22:43.449035 [debug] [ThreadPool]: On list_airflow_dim: BEGIN
[0m15:22:43.449250 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:22:43.449475 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:22:43.451334 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m15:22:43.451498 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m15:22:43.451753 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m15:22:43.451990 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m15:22:43.452225 [debug] [ThreadPool]: On list_airflow_fact: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_fact"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'fact'
  
[0m15:22:43.452489 [debug] [ThreadPool]: On list_airflow_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dim'
  
[0m15:22:43.454201 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.001 seconds
[0m15:22:43.454343 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m15:22:43.454991 [debug] [ThreadPool]: On list_airflow_dim: ROLLBACK
[0m15:22:43.455586 [debug] [ThreadPool]: On list_airflow_fact: ROLLBACK
[0m15:22:43.455912 [debug] [ThreadPool]: On list_airflow_dim: Close
[0m15:22:43.456106 [debug] [ThreadPool]: On list_airflow_fact: Close
[0m15:22:43.458596 [debug] [MainThread]: Using postgres connection "master"
[0m15:22:43.458782 [debug] [MainThread]: On master: BEGIN
[0m15:22:43.458956 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:22:43.460463 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m15:22:43.460729 [debug] [MainThread]: Using postgres connection "master"
[0m15:22:43.460972 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:22:43.462634 [debug] [MainThread]: SQL status: SELECT 0 in 0.001 seconds
[0m15:22:43.463148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '94f9a271-a3ed-4b18-ac35-ffab62a8b2d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9503ad50>]}
[0m15:22:43.463399 [debug] [MainThread]: On master: ROLLBACK
[0m15:22:43.463695 [debug] [MainThread]: Using postgres connection "master"
[0m15:22:43.463872 [debug] [MainThread]: On master: BEGIN
[0m15:22:43.464200 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:22:43.464412 [debug] [MainThread]: On master: COMMIT
[0m15:22:43.464632 [debug] [MainThread]: Using postgres connection "master"
[0m15:22:43.464809 [debug] [MainThread]: On master: COMMIT
[0m15:22:43.465067 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:22:43.465246 [debug] [MainThread]: On master: Close
[0m15:22:43.466509 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.fact_waterlevel
[0m15:22:43.466828 [info ] [Thread-1 (]: 1 of 1 START sql incremental model fact.fact_waterlevel ........................ [RUN]
[0m15:22:43.467103 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_fact, now model.etl_waterlevel.fact_waterlevel)
[0m15:22:43.467362 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.fact_waterlevel
[0m15:22:43.472294 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.fact_waterlevel"
[0m15:22:43.472975 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.fact_waterlevel
[0m15:22:43.497644 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.fact_waterlevel"
[0m15:22:43.498420 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m15:22:43.498666 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: BEGIN
[0m15:22:43.498921 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:22:43.501060 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m15:22:43.501321 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m15:22:43.501582 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      
  
    

  create  table "airflow"."fact"."fact_waterlevel__dbt_tmp"
  
  
    as
  
  (
    

with main as (
select
	distinct
	concat("stationId",'_',"stationCode") as station_key,
	"stationId" as station_id,
	"stationCode" as station_code,
	"waterLevel" as water_level,
	"waterlevelStatus" as waterlevel_status,
    case
        when "waterlevelStatus" = 3 then '🚨 Beyond Danger'
        when "waterlevelStatus" = 2 then '⚠️ Between Warning and Danger'
        when "waterlevelStatus" = 1 then '🔶 Between Alert and Warning'
        when "waterlevelStatus" = 0 then '✅ Between Normal and Alert'
        when "waterlevelStatus" = -1 then '🟢 Below Normal (Safe)'
        else '❓ Unknown Status'
    end as waterlevel_condition,
	"stationName",
	"districtName",
    to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS') as last_update

from
	raw.waterlevels w
where
	"stationStatus" = 1

    

)
select
	*
from
	main
  );
  
  
[0m15:22:43.533317 [debug] [Thread-1 (]: SQL status: SELECT 18244 in 0.031 seconds
[0m15:22:43.537917 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m15:22:43.538182 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */
alter table "airflow"."fact"."fact_waterlevel" rename to "fact_waterlevel__dbt_backup"
[0m15:22:43.538634 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:22:43.539935 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m15:22:43.540151 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */
alter table "airflow"."fact"."fact_waterlevel__dbt_tmp" rename to "fact_waterlevel"
[0m15:22:43.540534 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:22:43.547297 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m15:22:43.547556 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m15:22:43.547776 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m15:22:43.555011 [debug] [Thread-1 (]: SQL status: COMMIT in 0.007 seconds
[0m15:22:43.557687 [debug] [Thread-1 (]: Applying DROP to: "airflow"."fact"."fact_waterlevel__dbt_backup"
[0m15:22:43.559667 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m15:22:43.559863 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */
drop table if exists "airflow"."fact"."fact_waterlevel__dbt_backup" cascade
[0m15:22:43.561302 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m15:22:43.562374 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: Close
[0m15:22:43.563323 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94f9a271-a3ed-4b18-ac35-ffab62a8b2d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95bf9cd0>]}
[0m15:22:43.563711 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model fact.fact_waterlevel ................... [[32mSELECT 18244[0m in 0.10s]
[0m15:22:43.564028 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.fact_waterlevel
[0m15:22:43.564876 [debug] [MainThread]: Using postgres connection "master"
[0m15:22:43.565083 [debug] [MainThread]: On master: BEGIN
[0m15:22:43.565250 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:22:43.566786 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m15:22:43.566956 [debug] [MainThread]: On master: COMMIT
[0m15:22:43.567128 [debug] [MainThread]: Using postgres connection "master"
[0m15:22:43.567277 [debug] [MainThread]: On master: COMMIT
[0m15:22:43.567481 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:22:43.567633 [debug] [MainThread]: On master: Close
[0m15:22:43.567829 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:22:43.567969 [debug] [MainThread]: Connection 'model.etl_waterlevel.fact_waterlevel' was properly closed.
[0m15:22:43.568092 [debug] [MainThread]: Connection 'list_airflow_dim' was properly closed.
[0m15:22:43.568251 [info ] [MainThread]: 
[0m15:22:43.568437 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.15 seconds (0.15s).
[0m15:22:43.568979 [debug] [MainThread]: Command end result
[0m15:22:43.609340 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m15:22:43.610483 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m15:22:43.613416 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m15:22:43.613743 [info ] [MainThread]: 
[0m15:22:43.614003 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:22:43.614344 [info ] [MainThread]: 
[0m15:22:43.614674 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:22:43.615305 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.49547243, "process_in_blocks": "0", "process_kernel_time": 0.120553, "process_mem_max_rss": "118280", "process_out_blocks": "2520", "process_user_time": 0.950478}
[0m15:22:43.615509 [debug] [MainThread]: Command `dbt run` succeeded at 15:22:43.615472 after 0.50 seconds
[0m15:22:43.615710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b7b5110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b7b4810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b7b57d0>]}
[0m15:22:43.615885 [debug] [MainThread]: Flushing usage events
[0m15:22:44.878082 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:25:11.324128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c00ed50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c105d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c00ee10>]}


============================== 15:25:11.326372 | 5287ecd2-3286-4b79-b187-204851ce8a54 ==============================
[0m15:25:11.326372 [info ] [MainThread]: Running with dbt=1.9.0
[0m15:25:11.326767 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select fact_waterlevel --full-refresh', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:25:11.390135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5287ecd2-3286-4b79-b187-204851ce8a54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b41b810>]}
[0m15:25:11.412562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5287ecd2-3286-4b79-b187-204851ce8a54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ea2d3d0>]}
[0m15:25:11.412981 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:25:11.438659 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m15:25:11.477129 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:25:11.477450 [debug] [MainThread]: Partial parsing: updated file: etl_waterlevel://models/facts/fact_waterlevel.sql
[0m15:25:11.589275 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m15:25:11.592693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5287ecd2-3286-4b79-b187-204851ce8a54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b013710>]}
[0m15:25:11.620544 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m15:25:11.622101 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m15:25:11.628244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5287ecd2-3286-4b79-b187-204851ce8a54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9af02b10>]}
[0m15:25:11.628533 [info ] [MainThread]: Found 3 models, 434 macros
[0m15:25:11.628891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5287ecd2-3286-4b79-b187-204851ce8a54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ae6cf50>]}
[0m15:25:11.629862 [info ] [MainThread]: 
[0m15:25:11.630107 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:25:11.630407 [info ] [MainThread]: 
[0m15:25:11.630767 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:25:11.631280 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m15:25:11.647291 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m15:25:11.647619 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m15:25:11.647929 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:25:11.651025 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.003 seconds
[0m15:25:11.651761 [debug] [ThreadPool]: On list_airflow: Close
[0m15:25:11.654132 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_fact)
[0m15:25:11.654446 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow_dim'
[0m15:25:11.657317 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m15:25:11.658574 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m15:25:11.658888 [debug] [ThreadPool]: On list_airflow_fact: BEGIN
[0m15:25:11.659221 [debug] [ThreadPool]: On list_airflow_dim: BEGIN
[0m15:25:11.659464 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:25:11.659705 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:25:11.662051 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m15:25:11.662207 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m15:25:11.662471 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m15:25:11.662720 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m15:25:11.662994 [debug] [ThreadPool]: On list_airflow_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dim'
  
[0m15:25:11.663252 [debug] [ThreadPool]: On list_airflow_fact: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_fact"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'fact'
  
[0m15:25:11.664959 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m15:25:11.665106 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.002 seconds
[0m15:25:11.665730 [debug] [ThreadPool]: On list_airflow_fact: ROLLBACK
[0m15:25:11.666401 [debug] [ThreadPool]: On list_airflow_dim: ROLLBACK
[0m15:25:11.666744 [debug] [ThreadPool]: On list_airflow_fact: Close
[0m15:25:11.666964 [debug] [ThreadPool]: On list_airflow_dim: Close
[0m15:25:11.670760 [debug] [MainThread]: Using postgres connection "master"
[0m15:25:11.671015 [debug] [MainThread]: On master: BEGIN
[0m15:25:11.671211 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:25:11.673278 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m15:25:11.673544 [debug] [MainThread]: Using postgres connection "master"
[0m15:25:11.673828 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:25:11.676029 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m15:25:11.676702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5287ecd2-3286-4b79-b187-204851ce8a54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9af78450>]}
[0m15:25:11.677019 [debug] [MainThread]: On master: ROLLBACK
[0m15:25:11.677330 [debug] [MainThread]: Using postgres connection "master"
[0m15:25:11.677551 [debug] [MainThread]: On master: BEGIN
[0m15:25:11.677938 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:25:11.678179 [debug] [MainThread]: On master: COMMIT
[0m15:25:11.678411 [debug] [MainThread]: Using postgres connection "master"
[0m15:25:11.678627 [debug] [MainThread]: On master: COMMIT
[0m15:25:11.678920 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:25:11.679123 [debug] [MainThread]: On master: Close
[0m15:25:11.680570 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.fact_waterlevel
[0m15:25:11.680915 [info ] [Thread-1 (]: 1 of 1 START sql incremental model fact.fact_waterlevel ........................ [RUN]
[0m15:25:11.681187 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_dim, now model.etl_waterlevel.fact_waterlevel)
[0m15:25:11.681450 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.fact_waterlevel
[0m15:25:11.687169 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.fact_waterlevel"
[0m15:25:11.687983 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.fact_waterlevel
[0m15:25:11.712734 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.fact_waterlevel"
[0m15:25:11.713691 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m15:25:11.713953 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: BEGIN
[0m15:25:11.714206 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:25:11.716353 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m15:25:11.716706 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m15:25:11.716937 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      
  
    

  create  table "airflow"."fact"."fact_waterlevel__dbt_tmp"
  
  
    as
  
  (
    

with main as (
select
    distinct
    concat("stationId",'_',"stationCode") as station_key,
    "stationId" as station_id,
    "stationCode" as station_code,
    "waterLevel" as water_level,
    "waterlevelStatus" as waterlevel_status,
    case
        when "waterlevelStatus" = 3 then '🚨 Beyond Danger'
        when "waterlevelStatus" = 2 then '⚠️ Between Warning and Danger'
        when "waterlevelStatus" = 1 then '🔶 Between Alert and Warning'
        when "waterlevelStatus" = 0 then '✅ Between Normal and Alert'
        when "waterlevelStatus" = -1 then '🟢 Below Normal (Safe)'
        else '❓ Unknown Status'
    end as waterlevel_condition,
    "stationName",
    "districtName",
    -- Convert to timestamp without timezone to avoid timezone complications
    (to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS') AT TIME ZONE 'UTC')::timestamp without time zone as last_update
from
    raw.waterlevels w
where
    "stationStatus" = 1

    

)
select
    *
from
    main
  );
  
  
[0m15:25:11.763764 [debug] [Thread-1 (]: SQL status: SELECT 18244 in 0.047 seconds
[0m15:25:11.768955 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m15:25:11.769264 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */
alter table "airflow"."fact"."fact_waterlevel" rename to "fact_waterlevel__dbt_backup"
[0m15:25:11.769800 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:25:11.771194 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m15:25:11.771428 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */
alter table "airflow"."fact"."fact_waterlevel__dbt_tmp" rename to "fact_waterlevel"
[0m15:25:11.771874 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:25:11.779136 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m15:25:11.779411 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m15:25:11.779638 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m15:25:11.786120 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m15:25:11.788858 [debug] [Thread-1 (]: Applying DROP to: "airflow"."fact"."fact_waterlevel__dbt_backup"
[0m15:25:11.791053 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m15:25:11.791316 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */
drop table if exists "airflow"."fact"."fact_waterlevel__dbt_backup" cascade
[0m15:25:11.793861 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m15:25:11.795202 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: Close
[0m15:25:11.796173 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5287ecd2-3286-4b79-b187-204851ce8a54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a2139d0>]}
[0m15:25:11.796601 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model fact.fact_waterlevel ................... [[32mSELECT 18244[0m in 0.11s]
[0m15:25:11.796985 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.fact_waterlevel
[0m15:25:11.797998 [debug] [MainThread]: Using postgres connection "master"
[0m15:25:11.798220 [debug] [MainThread]: On master: BEGIN
[0m15:25:11.798391 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:25:11.800445 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m15:25:11.800639 [debug] [MainThread]: On master: COMMIT
[0m15:25:11.800826 [debug] [MainThread]: Using postgres connection "master"
[0m15:25:11.801019 [debug] [MainThread]: On master: COMMIT
[0m15:25:11.801282 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:25:11.801477 [debug] [MainThread]: On master: Close
[0m15:25:11.801729 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:25:11.801940 [debug] [MainThread]: Connection 'list_airflow_fact' was properly closed.
[0m15:25:11.802212 [debug] [MainThread]: Connection 'model.etl_waterlevel.fact_waterlevel' was properly closed.
[0m15:25:11.802449 [info ] [MainThread]: 
[0m15:25:11.802703 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.17 seconds (0.17s).
[0m15:25:11.803159 [debug] [MainThread]: Command end result
[0m15:25:11.850243 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m15:25:11.851698 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m15:25:11.854727 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m15:25:11.854919 [info ] [MainThread]: 
[0m15:25:11.855196 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:25:11.855558 [info ] [MainThread]: 
[0m15:25:11.856157 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:25:11.856776 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.5541482, "process_in_blocks": "0", "process_kernel_time": 0.091107, "process_mem_max_rss": "118408", "process_out_blocks": "2523", "process_user_time": 0.965143}
[0m15:25:11.857046 [debug] [MainThread]: Command `dbt run` succeeded at 15:25:11.856993 after 0.55 seconds
[0m15:25:11.857276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0909250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0908950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0909910>]}
[0m15:25:11.857478 [debug] [MainThread]: Flushing usage events
[0m15:25:13.152527 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:03:17.321783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffabb0b850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffabe0b650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffabc40890>]}


============================== 23:03:17.324579 | 2bee4dda-d58d-45a7-b974-736ecf3df004 ==============================
[0m23:03:17.324579 [info ] [MainThread]: Running with dbt=1.9.0
[0m23:03:17.324998 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --select fact_waterlevel --full-refresh', 'send_anonymous_usage_stats': 'True'}
[0m23:03:17.390466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2bee4dda-d58d-45a7-b974-736ecf3df004', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffabb09550>]}
[0m23:03:17.412670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2bee4dda-d58d-45a7-b974-736ecf3df004', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae545010>]}
[0m23:03:17.413097 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:03:17.441171 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m23:03:17.480443 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:03:17.480680 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:03:17.483011 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m23:03:17.492249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2bee4dda-d58d-45a7-b974-736ecf3df004', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaadc2190>]}
[0m23:03:17.523896 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m23:03:17.525579 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m23:03:17.532563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2bee4dda-d58d-45a7-b974-736ecf3df004', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaac46a10>]}
[0m23:03:17.532882 [info ] [MainThread]: Found 3 models, 434 macros
[0m23:03:17.533142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2bee4dda-d58d-45a7-b974-736ecf3df004', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffabafbe50>]}
[0m23:03:17.533911 [info ] [MainThread]: 
[0m23:03:17.534140 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:03:17.534436 [info ] [MainThread]: 
[0m23:03:17.534864 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:03:17.535469 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m23:03:17.554481 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m23:03:17.554765 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m23:03:17.554970 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:03:17.558344 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.003 seconds
[0m23:03:17.558970 [debug] [ThreadPool]: On list_airflow: Close
[0m23:03:17.561283 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_dim)
[0m23:03:17.561575 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow_fact'
[0m23:03:17.564452 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m23:03:17.565484 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m23:03:17.565761 [debug] [ThreadPool]: On list_airflow_dim: BEGIN
[0m23:03:17.566023 [debug] [ThreadPool]: On list_airflow_fact: BEGIN
[0m23:03:17.566247 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:03:17.566489 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:03:17.568410 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m23:03:17.568730 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m23:03:17.568884 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m23:03:17.569100 [debug] [ThreadPool]: On list_airflow_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dim'
  
[0m23:03:17.569373 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m23:03:17.569810 [debug] [ThreadPool]: On list_airflow_fact: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_fact"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'fact'
  
[0m23:03:17.571169 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.002 seconds
[0m23:03:17.571834 [debug] [ThreadPool]: On list_airflow_dim: ROLLBACK
[0m23:03:17.571994 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m23:03:17.572285 [debug] [ThreadPool]: On list_airflow_dim: Close
[0m23:03:17.572759 [debug] [ThreadPool]: On list_airflow_fact: ROLLBACK
[0m23:03:17.573502 [debug] [ThreadPool]: On list_airflow_fact: Close
[0m23:03:17.575912 [debug] [MainThread]: Using postgres connection "master"
[0m23:03:17.576122 [debug] [MainThread]: On master: BEGIN
[0m23:03:17.576298 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:03:17.578250 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m23:03:17.578485 [debug] [MainThread]: Using postgres connection "master"
[0m23:03:17.578713 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:03:17.580746 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m23:03:17.581324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2bee4dda-d58d-45a7-b974-736ecf3df004', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaaed5690>]}
[0m23:03:17.581614 [debug] [MainThread]: On master: ROLLBACK
[0m23:03:17.581911 [debug] [MainThread]: Using postgres connection "master"
[0m23:03:17.582096 [debug] [MainThread]: On master: BEGIN
[0m23:03:17.582454 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:03:17.582671 [debug] [MainThread]: On master: COMMIT
[0m23:03:17.583086 [debug] [MainThread]: Using postgres connection "master"
[0m23:03:17.583291 [debug] [MainThread]: On master: COMMIT
[0m23:03:17.583599 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:03:17.583810 [debug] [MainThread]: On master: Close
[0m23:03:17.585281 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.fact_waterlevel
[0m23:03:17.585624 [info ] [Thread-1 (]: 1 of 1 START sql incremental model fact.fact_waterlevel ........................ [RUN]
[0m23:03:17.586093 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_fact, now model.etl_waterlevel.fact_waterlevel)
[0m23:03:17.586343 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.fact_waterlevel
[0m23:03:17.593417 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.fact_waterlevel"
[0m23:03:17.594503 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.fact_waterlevel
[0m23:03:17.619657 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.fact_waterlevel"
[0m23:03:17.620811 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m23:03:17.621056 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: BEGIN
[0m23:03:17.621297 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:03:17.623380 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m23:03:17.623755 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m23:03:17.624003 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      
  
    

  create  table "airflow"."fact"."fact_waterlevel__dbt_tmp"
  
  
    as
  
  (
    

with main as (
select
    distinct
    concat("stationId",'_',"stationCode") as station_key,
    "stationId" as station_id,
    "stationCode" as station_code,
    "waterLevel" as water_level,
    "waterlevelStatus" as waterlevel_status,
    case
        when "waterlevelStatus" = 3 then '🚨 Beyond Danger'
        when "waterlevelStatus" = 2 then '⚠️ Between Warning and Danger'
        when "waterlevelStatus" = 1 then '🔶 Between Alert and Warning'
        when "waterlevelStatus" = 0 then '✅ Between Normal and Alert'
        when "waterlevelStatus" = -1 then '🟢 Below Normal (Safe)'
        else '❓ Unknown Status'
    end as waterlevel_condition,
    "stationName",
    "districtName",
    -- Convert to timestamp without timezone to avoid timezone complications
    (to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS') AT TIME ZONE 'UTC')::timestamp without time zone as last_update
from
    raw.waterlevels w
where
    "stationStatus" = 1

    

)
select
    *
from
    main
  );
  
  
[0m23:03:17.664674 [debug] [Thread-1 (]: SQL status: SELECT 18671 in 0.040 seconds
[0m23:03:17.669285 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m23:03:17.669536 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */
alter table "airflow"."fact"."fact_waterlevel" rename to "fact_waterlevel__dbt_backup"
[0m23:03:17.670015 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:03:17.671248 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m23:03:17.671518 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */
alter table "airflow"."fact"."fact_waterlevel__dbt_tmp" rename to "fact_waterlevel"
[0m23:03:17.671874 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:03:17.678448 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m23:03:17.678682 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m23:03:17.678881 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m23:03:17.689327 [debug] [Thread-1 (]: SQL status: COMMIT in 0.010 seconds
[0m23:03:17.692057 [debug] [Thread-1 (]: Applying DROP to: "airflow"."fact"."fact_waterlevel__dbt_backup"
[0m23:03:17.694944 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m23:03:17.695174 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */
drop table if exists "airflow"."fact"."fact_waterlevel__dbt_backup" cascade
[0m23:03:17.699855 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m23:03:17.701014 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: Close
[0m23:03:17.701992 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2bee4dda-d58d-45a7-b974-736ecf3df004', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaaeee3d0>]}
[0m23:03:17.702441 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model fact.fact_waterlevel ................... [[32mSELECT 18671[0m in 0.12s]
[0m23:03:17.702805 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.fact_waterlevel
[0m23:03:17.703723 [debug] [MainThread]: Using postgres connection "master"
[0m23:03:17.703923 [debug] [MainThread]: On master: BEGIN
[0m23:03:17.704141 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:03:17.705892 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m23:03:17.706150 [debug] [MainThread]: On master: COMMIT
[0m23:03:17.706327 [debug] [MainThread]: Using postgres connection "master"
[0m23:03:17.706482 [debug] [MainThread]: On master: COMMIT
[0m23:03:17.706687 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:03:17.706875 [debug] [MainThread]: On master: Close
[0m23:03:17.707141 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:03:17.707323 [debug] [MainThread]: Connection 'list_airflow_dim' was properly closed.
[0m23:03:17.707526 [debug] [MainThread]: Connection 'model.etl_waterlevel.fact_waterlevel' was properly closed.
[0m23:03:17.707739 [info ] [MainThread]: 
[0m23:03:17.707960 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.17 seconds (0.17s).
[0m23:03:17.708432 [debug] [MainThread]: Command end result
[0m23:03:17.722206 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m23:03:17.724343 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m23:03:17.727529 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m23:03:17.727706 [info ] [MainThread]: 
[0m23:03:17.727932 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:03:17.728240 [info ] [MainThread]: 
[0m23:03:17.728625 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:03:17.729319 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.43097454, "process_in_blocks": "0", "process_kernel_time": 0.198601, "process_mem_max_rss": "115164", "process_out_blocks": "1694", "process_user_time": 0.868259}
[0m23:03:17.729583 [debug] [MainThread]: Command `dbt run` succeeded at 23:03:17.729530 after 0.43 seconds
[0m23:03:17.729820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0409790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0408950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0409910>]}
[0m23:03:17.730045 [debug] [MainThread]: Flushing usage events
[0m23:03:19.530314 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:07:08.793697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7e37a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7e37c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7e340d0>]}


============================== 23:07:08.795876 | 724ee76e-3ffb-4cf6-8068-0ad30be0672d ==============================
[0m23:07:08.795876 [info ] [MainThread]: Running with dbt=1.9.0
[0m23:07:08.796278 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select fact_waterlevel --full-refresh', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:07:08.857265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '724ee76e-3ffb-4cf6-8068-0ad30be0672d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb729fe50>]}
[0m23:07:08.879086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '724ee76e-3ffb-4cf6-8068-0ad30be0672d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba895790>]}
[0m23:07:08.879474 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:07:08.904054 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m23:07:08.942746 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:07:08.943006 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:07:08.945260 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m23:07:08.953927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '724ee76e-3ffb-4cf6-8068-0ad30be0672d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7094850>]}
[0m23:07:08.981397 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m23:07:08.983035 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m23:07:08.988648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '724ee76e-3ffb-4cf6-8068-0ad30be0672d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6fa26d0>]}
[0m23:07:08.988891 [info ] [MainThread]: Found 3 models, 434 macros
[0m23:07:08.989077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '724ee76e-3ffb-4cf6-8068-0ad30be0672d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7038a10>]}
[0m23:07:08.989695 [info ] [MainThread]: 
[0m23:07:08.989939 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:07:08.990150 [info ] [MainThread]: 
[0m23:07:08.990479 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:07:08.991037 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m23:07:09.005754 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m23:07:09.006005 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m23:07:09.006211 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:07:09.008850 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.003 seconds
[0m23:07:09.009462 [debug] [ThreadPool]: On list_airflow: Close
[0m23:07:09.011543 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_fact)
[0m23:07:09.011833 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow_dim'
[0m23:07:09.014514 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m23:07:09.015482 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m23:07:09.015730 [debug] [ThreadPool]: On list_airflow_fact: BEGIN
[0m23:07:09.015975 [debug] [ThreadPool]: On list_airflow_dim: BEGIN
[0m23:07:09.016184 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:07:09.016410 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:07:09.018116 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m23:07:09.018245 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m23:07:09.018461 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m23:07:09.018713 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m23:07:09.019002 [debug] [ThreadPool]: On list_airflow_fact: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_fact"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'fact'
  
[0m23:07:09.019280 [debug] [ThreadPool]: On list_airflow_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dim'
  
[0m23:07:09.020661 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m23:07:09.020825 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.001 seconds
[0m23:07:09.021427 [debug] [ThreadPool]: On list_airflow_fact: ROLLBACK
[0m23:07:09.022035 [debug] [ThreadPool]: On list_airflow_dim: ROLLBACK
[0m23:07:09.022332 [debug] [ThreadPool]: On list_airflow_fact: Close
[0m23:07:09.022596 [debug] [ThreadPool]: On list_airflow_dim: Close
[0m23:07:09.024999 [debug] [MainThread]: Using postgres connection "master"
[0m23:07:09.025189 [debug] [MainThread]: On master: BEGIN
[0m23:07:09.025358 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:07:09.026803 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m23:07:09.027043 [debug] [MainThread]: Using postgres connection "master"
[0m23:07:09.027267 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:07:09.028786 [debug] [MainThread]: SQL status: SELECT 0 in 0.001 seconds
[0m23:07:09.029274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '724ee76e-3ffb-4cf6-8068-0ad30be0672d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7223e10>]}
[0m23:07:09.029535 [debug] [MainThread]: On master: ROLLBACK
[0m23:07:09.029794 [debug] [MainThread]: Using postgres connection "master"
[0m23:07:09.029993 [debug] [MainThread]: On master: BEGIN
[0m23:07:09.030334 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:07:09.030550 [debug] [MainThread]: On master: COMMIT
[0m23:07:09.030770 [debug] [MainThread]: Using postgres connection "master"
[0m23:07:09.030951 [debug] [MainThread]: On master: COMMIT
[0m23:07:09.031211 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:07:09.031389 [debug] [MainThread]: On master: Close
[0m23:07:09.032597 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.fact_waterlevel
[0m23:07:09.032904 [info ] [Thread-1 (]: 1 of 1 START sql incremental model fact.fact_waterlevel ........................ [RUN]
[0m23:07:09.033202 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_fact, now model.etl_waterlevel.fact_waterlevel)
[0m23:07:09.033454 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.fact_waterlevel
[0m23:07:09.039170 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.fact_waterlevel"
[0m23:07:09.039929 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.fact_waterlevel
[0m23:07:09.062051 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.fact_waterlevel"
[0m23:07:09.062763 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m23:07:09.062995 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: BEGIN
[0m23:07:09.063203 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:07:09.064896 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m23:07:09.065102 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m23:07:09.065312 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      
  
    

  create  table "airflow"."fact"."fact_waterlevel__dbt_tmp"
  
  
    as
  
  (
    

with main as (
select
    distinct
    concat("stationId",'_',"stationCode") as station_key,
    "stationId" as station_id,
    "stationCode" as station_code,
    "waterLevel" as water_level,
    "waterlevelStatus" as waterlevel_status,
    case
        when "waterlevelStatus" = 3 then '🚨 Beyond Danger'
        when "waterlevelStatus" = 2 then '⚠️ Between Warning and Danger'
        when "waterlevelStatus" = 1 then '🔶 Between Alert and Warning'
        when "waterlevelStatus" = 0 then '✅ Between Normal and Alert'
        when "waterlevelStatus" = -1 then '🟢 Below Normal (Safe)'
        else '❓ Unknown Status'
    end as waterlevel_condition,
    "stationName",
    "districtName",
    -- Convert to timestamp without timezone to avoid timezone complications
    (to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS') AT TIME ZONE 'UTC')::timestamp without time zone as last_update
from
    raw.waterlevels w
where
    "stationStatus" = 1

    

)
select
    *
from
    main
  );
  
  
[0m23:07:09.117186 [debug] [Thread-1 (]: SQL status: SELECT 18673 in 0.052 seconds
[0m23:07:09.121938 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m23:07:09.122223 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */
alter table "airflow"."fact"."fact_waterlevel" rename to "fact_waterlevel__dbt_backup"
[0m23:07:09.122700 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:07:09.124111 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m23:07:09.124443 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */
alter table "airflow"."fact"."fact_waterlevel__dbt_tmp" rename to "fact_waterlevel"
[0m23:07:09.124871 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:07:09.131754 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m23:07:09.132059 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m23:07:09.132265 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m23:07:09.138991 [debug] [Thread-1 (]: SQL status: COMMIT in 0.007 seconds
[0m23:07:09.141726 [debug] [Thread-1 (]: Applying DROP to: "airflow"."fact"."fact_waterlevel__dbt_backup"
[0m23:07:09.144699 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m23:07:09.144922 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */
drop table if exists "airflow"."fact"."fact_waterlevel__dbt_backup" cascade
[0m23:07:09.146426 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m23:07:09.147549 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: Close
[0m23:07:09.148341 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '724ee76e-3ffb-4cf6-8068-0ad30be0672d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb61d3b10>]}
[0m23:07:09.148679 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model fact.fact_waterlevel ................... [[32mSELECT 18673[0m in 0.11s]
[0m23:07:09.149013 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.fact_waterlevel
[0m23:07:09.149894 [debug] [MainThread]: Using postgres connection "master"
[0m23:07:09.150075 [debug] [MainThread]: On master: BEGIN
[0m23:07:09.150223 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:07:09.151754 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m23:07:09.152085 [debug] [MainThread]: On master: COMMIT
[0m23:07:09.152260 [debug] [MainThread]: Using postgres connection "master"
[0m23:07:09.152399 [debug] [MainThread]: On master: COMMIT
[0m23:07:09.152590 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:07:09.152726 [debug] [MainThread]: On master: Close
[0m23:07:09.152922 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:07:09.153063 [debug] [MainThread]: Connection 'model.etl_waterlevel.fact_waterlevel' was properly closed.
[0m23:07:09.153187 [debug] [MainThread]: Connection 'list_airflow_dim' was properly closed.
[0m23:07:09.153334 [info ] [MainThread]: 
[0m23:07:09.153564 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.16 seconds (0.16s).
[0m23:07:09.154197 [debug] [MainThread]: Command end result
[0m23:07:09.168377 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m23:07:09.169567 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m23:07:09.173267 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m23:07:09.173469 [info ] [MainThread]: 
[0m23:07:09.173952 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:07:09.174295 [info ] [MainThread]: 
[0m23:07:09.174598 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:07:09.175356 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.40278438, "process_in_blocks": "0", "process_kernel_time": 0.102914, "process_mem_max_rss": "115152", "process_out_blocks": "1694", "process_user_time": 0.798573}
[0m23:07:09.175586 [debug] [MainThread]: Command `dbt run` succeeded at 23:07:09.175545 after 0.40 seconds
[0m23:07:09.175777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7cad950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbc709250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbc7093d0>]}
[0m23:07:09.175973 [debug] [MainThread]: Flushing usage events
[0m23:07:10.332244 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:11:55.831574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffade3f710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae93f190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffade3f190>]}


============================== 00:11:55.833418 | 41b051c4-cc24-4e7d-8d46-7317f0d6dfd6 ==============================
[0m00:11:55.833418 [info ] [MainThread]: Running with dbt=1.9.0
[0m00:11:55.833790 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select fact_waterlevel --full-refresh', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:11:55.895734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '41b051c4-cc24-4e7d-8d46-7317f0d6dfd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffade52390>]}
[0m00:11:55.918701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '41b051c4-cc24-4e7d-8d46-7317f0d6dfd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb09183d0>]}
[0m00:11:55.919065 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m00:11:55.944250 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m00:11:55.982667 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:11:55.982900 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:11:55.985173 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m00:11:55.993968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '41b051c4-cc24-4e7d-8d46-7317f0d6dfd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffacf85e10>]}
[0m00:11:56.020968 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m00:11:56.022434 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m00:11:56.028329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '41b051c4-cc24-4e7d-8d46-7317f0d6dfd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad0e7950>]}
[0m00:11:56.028574 [info ] [MainThread]: Found 3 models, 434 macros
[0m00:11:56.028773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '41b051c4-cc24-4e7d-8d46-7317f0d6dfd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad0a1050>]}
[0m00:11:56.029520 [info ] [MainThread]: 
[0m00:11:56.029766 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:11:56.029980 [info ] [MainThread]: 
[0m00:11:56.030311 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:11:56.030844 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m00:11:56.047478 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m00:11:56.047763 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m00:11:56.047951 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:11:56.051266 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.003 seconds
[0m00:11:56.051844 [debug] [ThreadPool]: On list_airflow: Close
[0m00:11:56.054013 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_fact)
[0m00:11:56.054314 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow_dim'
[0m00:11:56.057044 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m00:11:56.058012 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m00:11:56.058261 [debug] [ThreadPool]: On list_airflow_fact: BEGIN
[0m00:11:56.058502 [debug] [ThreadPool]: On list_airflow_dim: BEGIN
[0m00:11:56.058712 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:11:56.058966 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:11:56.060789 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m00:11:56.060952 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m00:11:56.061163 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m00:11:56.061405 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m00:11:56.061637 [debug] [ThreadPool]: On list_airflow_fact: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_fact"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'fact'
  
[0m00:11:56.061892 [debug] [ThreadPool]: On list_airflow_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dim'
  
[0m00:11:56.063530 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.001 seconds
[0m00:11:56.063680 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m00:11:56.064312 [debug] [ThreadPool]: On list_airflow_dim: ROLLBACK
[0m00:11:56.064880 [debug] [ThreadPool]: On list_airflow_fact: ROLLBACK
[0m00:11:56.065202 [debug] [ThreadPool]: On list_airflow_dim: Close
[0m00:11:56.065411 [debug] [ThreadPool]: On list_airflow_fact: Close
[0m00:11:56.067822 [debug] [MainThread]: Using postgres connection "master"
[0m00:11:56.068010 [debug] [MainThread]: On master: BEGIN
[0m00:11:56.068183 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:11:56.069694 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m00:11:56.069919 [debug] [MainThread]: Using postgres connection "master"
[0m00:11:56.070152 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:11:56.071570 [debug] [MainThread]: SQL status: SELECT 0 in 0.001 seconds
[0m00:11:56.072059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '41b051c4-cc24-4e7d-8d46-7317f0d6dfd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac4dfdd0>]}
[0m00:11:56.072313 [debug] [MainThread]: On master: ROLLBACK
[0m00:11:56.072593 [debug] [MainThread]: Using postgres connection "master"
[0m00:11:56.072796 [debug] [MainThread]: On master: BEGIN
[0m00:11:56.073137 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m00:11:56.073404 [debug] [MainThread]: On master: COMMIT
[0m00:11:56.073580 [debug] [MainThread]: Using postgres connection "master"
[0m00:11:56.073751 [debug] [MainThread]: On master: COMMIT
[0m00:11:56.074011 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:11:56.074192 [debug] [MainThread]: On master: Close
[0m00:11:56.075443 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.fact_waterlevel
[0m00:11:56.075736 [info ] [Thread-1 (]: 1 of 1 START sql incremental model fact.fact_waterlevel ........................ [RUN]
[0m00:11:56.076056 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_fact, now model.etl_waterlevel.fact_waterlevel)
[0m00:11:56.076292 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.fact_waterlevel
[0m00:11:56.082116 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.fact_waterlevel"
[0m00:11:56.083067 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.fact_waterlevel
[0m00:11:56.105549 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.fact_waterlevel"
[0m00:11:56.106456 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m00:11:56.106656 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: BEGIN
[0m00:11:56.106878 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:11:56.108640 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m00:11:56.108836 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m00:11:56.109021 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      
  
    

  create  table "airflow"."fact"."fact_waterlevel__dbt_tmp"
  
  
    as
  
  (
    

with main as (
select
    distinct
    concat("stationId",'_',"stationCode") as station_key,
    "stationId" as station_id,
    "stationCode" as station_code,
    "waterLevel" as water_level,
    "waterlevelStatus" as waterlevel_status,
    case
        when "waterlevelStatus" = 3 then '🚨 Beyond Danger'
        when "waterlevelStatus" = 2 then '⚠️ Between Warning and Danger'
        when "waterlevelStatus" = 1 then '🔶 Between Alert and Warning'
        when "waterlevelStatus" = 0 then '✅ Between Normal and Alert'
        when "waterlevelStatus" = -1 then '🟢 Below Normal (Safe)'
        else '❓ Unknown Status'
    end as waterlevel_condition,
    "stationName",
    "districtName",
    -- Convert to timestamp without timezone to avoid timezone complications
    (to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS') AT TIME ZONE 'UTC')::timestamp without time zone as last_update
from
    raw.waterlevels w
where
    "stationStatus" = 1

    

)
select
    *
from
    main
  );
  
  
[0m00:11:56.154514 [debug] [Thread-1 (]: SQL status: SELECT 20361 in 0.045 seconds
[0m00:11:56.159298 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m00:11:56.159556 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */
alter table "airflow"."fact"."fact_waterlevel" rename to "fact_waterlevel__dbt_backup"
[0m00:11:56.160019 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m00:11:56.161370 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m00:11:56.161643 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */
alter table "airflow"."fact"."fact_waterlevel__dbt_tmp" rename to "fact_waterlevel"
[0m00:11:56.162001 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m00:11:56.168906 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m00:11:56.169170 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m00:11:56.169389 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m00:11:56.176254 [debug] [Thread-1 (]: SQL status: COMMIT in 0.007 seconds
[0m00:11:56.178898 [debug] [Thread-1 (]: Applying DROP to: "airflow"."fact"."fact_waterlevel__dbt_backup"
[0m00:11:56.181622 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m00:11:56.181845 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */
drop table if exists "airflow"."fact"."fact_waterlevel__dbt_backup" cascade
[0m00:11:56.183418 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m00:11:56.184455 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: Close
[0m00:11:56.185305 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '41b051c4-cc24-4e7d-8d46-7317f0d6dfd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad2b2150>]}
[0m00:11:56.185644 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model fact.fact_waterlevel ................... [[32mSELECT 20361[0m in 0.11s]
[0m00:11:56.186087 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.fact_waterlevel
[0m00:11:56.186821 [debug] [MainThread]: Using postgres connection "master"
[0m00:11:56.187014 [debug] [MainThread]: On master: BEGIN
[0m00:11:56.187162 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:11:56.188901 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m00:11:56.189112 [debug] [MainThread]: On master: COMMIT
[0m00:11:56.189266 [debug] [MainThread]: Using postgres connection "master"
[0m00:11:56.189440 [debug] [MainThread]: On master: COMMIT
[0m00:11:56.189615 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:11:56.189745 [debug] [MainThread]: On master: Close
[0m00:11:56.189923 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:11:56.190062 [debug] [MainThread]: Connection 'model.etl_waterlevel.fact_waterlevel' was properly closed.
[0m00:11:56.190210 [debug] [MainThread]: Connection 'list_airflow_dim' was properly closed.
[0m00:11:56.190398 [info ] [MainThread]: 
[0m00:11:56.190591 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.16 seconds (0.16s).
[0m00:11:56.191014 [debug] [MainThread]: Command end result
[0m00:11:56.204056 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m00:11:56.205272 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m00:11:56.208413 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m00:11:56.208594 [info ] [MainThread]: 
[0m00:11:56.208840 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:11:56.209261 [info ] [MainThread]: 
[0m00:11:56.209490 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m00:11:56.210112 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.4014957, "process_in_blocks": "0", "process_kernel_time": 0.114571, "process_mem_max_rss": "115012", "process_out_blocks": "1694", "process_user_time": 0.824911}
[0m00:11:56.210322 [debug] [MainThread]: Command `dbt run` succeeded at 00:11:56.210285 after 0.40 seconds
[0m00:11:56.210507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae93f750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffade3f210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae0520d0>]}
[0m00:11:56.210690 [debug] [MainThread]: Flushing usage events
[0m00:11:57.384771 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:30:43.775829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82d430d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82d43510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82d43990>]}


============================== 01:30:43.777879 | ca93bbf7-0134-4f3c-b1e6-c5091e78d43c ==============================
[0m01:30:43.777879 [info ] [MainThread]: Running with dbt=1.9.0
[0m01:30:43.778395 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select fact_waterlevel --full-refresh', 'send_anonymous_usage_stats': 'True'}
[0m01:30:43.841668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ca93bbf7-0134-4f3c-b1e6-c5091e78d43c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82b88150>]}
[0m01:30:43.863952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ca93bbf7-0134-4f3c-b1e6-c5091e78d43c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff857d5190>]}
[0m01:30:43.864336 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m01:30:43.889552 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m01:30:43.927872 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:30:43.928088 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:30:43.930368 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m01:30:43.939134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ca93bbf7-0134-4f3c-b1e6-c5091e78d43c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82049b10>]}
[0m01:30:43.966744 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m01:30:43.968394 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m01:30:43.975142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ca93bbf7-0134-4f3c-b1e6-c5091e78d43c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81fa9c10>]}
[0m01:30:43.975434 [info ] [MainThread]: Found 3 models, 434 macros
[0m01:30:43.975737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ca93bbf7-0134-4f3c-b1e6-c5091e78d43c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff821d5490>]}
[0m01:30:43.976412 [info ] [MainThread]: 
[0m01:30:43.976699 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:30:43.977008 [info ] [MainThread]: 
[0m01:30:43.977333 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:30:43.977857 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m01:30:43.995094 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m01:30:43.995333 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m01:30:43.995535 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:30:43.998858 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.003 seconds
[0m01:30:43.999465 [debug] [ThreadPool]: On list_airflow: Close
[0m01:30:44.001527 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_fact)
[0m01:30:44.001840 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow_dim'
[0m01:30:44.004638 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m01:30:44.005632 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m01:30:44.005868 [debug] [ThreadPool]: On list_airflow_fact: BEGIN
[0m01:30:44.006132 [debug] [ThreadPool]: On list_airflow_dim: BEGIN
[0m01:30:44.006344 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:30:44.006573 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:30:44.008615 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m01:30:44.008808 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m01:30:44.009048 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m01:30:44.009318 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m01:30:44.009581 [debug] [ThreadPool]: On list_airflow_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dim'
  
[0m01:30:44.009842 [debug] [ThreadPool]: On list_airflow_fact: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_fact"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'fact'
  
[0m01:30:44.011411 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.001 seconds
[0m01:30:44.011557 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m01:30:44.012205 [debug] [ThreadPool]: On list_airflow_dim: ROLLBACK
[0m01:30:44.012768 [debug] [ThreadPool]: On list_airflow_fact: ROLLBACK
[0m01:30:44.013098 [debug] [ThreadPool]: On list_airflow_dim: Close
[0m01:30:44.013290 [debug] [ThreadPool]: On list_airflow_fact: Close
[0m01:30:44.015856 [debug] [MainThread]: Using postgres connection "master"
[0m01:30:44.016091 [debug] [MainThread]: On master: BEGIN
[0m01:30:44.016266 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:30:44.018018 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m01:30:44.018260 [debug] [MainThread]: Using postgres connection "master"
[0m01:30:44.018488 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m01:30:44.020329 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m01:30:44.020863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ca93bbf7-0134-4f3c-b1e6-c5091e78d43c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81f1ed10>]}
[0m01:30:44.021126 [debug] [MainThread]: On master: ROLLBACK
[0m01:30:44.021414 [debug] [MainThread]: Using postgres connection "master"
[0m01:30:44.021590 [debug] [MainThread]: On master: BEGIN
[0m01:30:44.021945 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m01:30:44.022167 [debug] [MainThread]: On master: COMMIT
[0m01:30:44.022346 [debug] [MainThread]: Using postgres connection "master"
[0m01:30:44.022520 [debug] [MainThread]: On master: COMMIT
[0m01:30:44.022789 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:30:44.022972 [debug] [MainThread]: On master: Close
[0m01:30:44.024360 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.fact_waterlevel
[0m01:30:44.024689 [info ] [Thread-1 (]: 1 of 1 START sql incremental model fact.fact_waterlevel ........................ [RUN]
[0m01:30:44.028540 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_fact, now model.etl_waterlevel.fact_waterlevel)
[0m01:30:44.028812 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.fact_waterlevel
[0m01:30:44.035042 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.fact_waterlevel"
[0m01:30:44.036254 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.fact_waterlevel
[0m01:30:44.058706 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.fact_waterlevel"
[0m01:30:44.059823 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m01:30:44.060015 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: BEGIN
[0m01:30:44.060190 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:30:44.062293 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m01:30:44.062538 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m01:30:44.062746 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      
  
    

  create  table "airflow"."fact"."fact_waterlevel__dbt_tmp"
  
  
    as
  
  (
    

with main as (
select
    distinct
    concat("stationId",'_',"stationCode") as station_key,
    "stationId" as station_id,
    "stationCode" as station_code,
    "waterLevel" as water_level,
    "waterlevelStatus" as waterlevel_status,
    case
        when "waterlevelStatus" = 3 then '🚨 Beyond Danger'
        when "waterlevelStatus" = 2 then '⚠️ Between Warning and Danger'
        when "waterlevelStatus" = 1 then '🔶 Between Alert and Warning'
        when "waterlevelStatus" = 0 then '✅ Between Normal and Alert'
        when "waterlevelStatus" = -1 then '🟢 Below Normal (Safe)'
        else '❓ Unknown Status'
    end as waterlevel_condition,
    "stationName",
    "districtName",
    -- Convert to timestamp without timezone to avoid timezone complications
    (to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS') AT TIME ZONE 'UTC')::timestamp without time zone as last_update
from
    raw.waterlevels w
where
    "stationStatus" = 1

    

)
select
    *
from
    main
  );
  
  
[0m01:30:44.104497 [debug] [Thread-1 (]: SQL status: SELECT 20432 in 0.041 seconds
[0m01:30:44.108824 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m01:30:44.109081 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */
alter table "airflow"."fact"."fact_waterlevel" rename to "fact_waterlevel__dbt_backup"
[0m01:30:44.109509 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:30:44.110724 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m01:30:44.111026 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */
alter table "airflow"."fact"."fact_waterlevel__dbt_tmp" rename to "fact_waterlevel"
[0m01:30:44.111369 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:30:44.118057 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m01:30:44.118298 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m01:30:44.118512 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m01:30:44.125734 [debug] [Thread-1 (]: SQL status: COMMIT in 0.007 seconds
[0m01:30:44.128405 [debug] [Thread-1 (]: Applying DROP to: "airflow"."fact"."fact_waterlevel__dbt_backup"
[0m01:30:44.131171 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m01:30:44.131393 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */
drop table if exists "airflow"."fact"."fact_waterlevel__dbt_backup" cascade
[0m01:30:44.133658 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m01:30:44.134831 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: Close
[0m01:30:44.135939 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca93bbf7-0134-4f3c-b1e6-c5091e78d43c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82162410>]}
[0m01:30:44.136504 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model fact.fact_waterlevel ................... [[32mSELECT 20432[0m in 0.11s]
[0m01:30:44.137031 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.fact_waterlevel
[0m01:30:44.137958 [debug] [MainThread]: Using postgres connection "master"
[0m01:30:44.138177 [debug] [MainThread]: On master: BEGIN
[0m01:30:44.138347 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:30:44.139946 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m01:30:44.140325 [debug] [MainThread]: On master: COMMIT
[0m01:30:44.140492 [debug] [MainThread]: Using postgres connection "master"
[0m01:30:44.140631 [debug] [MainThread]: On master: COMMIT
[0m01:30:44.140816 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:30:44.140952 [debug] [MainThread]: On master: Close
[0m01:30:44.141164 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:30:44.141306 [debug] [MainThread]: Connection 'model.etl_waterlevel.fact_waterlevel' was properly closed.
[0m01:30:44.141432 [debug] [MainThread]: Connection 'list_airflow_dim' was properly closed.
[0m01:30:44.141594 [info ] [MainThread]: 
[0m01:30:44.141883 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.16 seconds (0.16s).
[0m01:30:44.142657 [debug] [MainThread]: Command end result
[0m01:30:44.157137 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m01:30:44.158759 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m01:30:44.161843 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m01:30:44.162016 [info ] [MainThread]: 
[0m01:30:44.162273 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:30:44.162549 [info ] [MainThread]: 
[0m01:30:44.162818 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m01:30:44.163403 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.41113508, "process_in_blocks": "0", "process_kernel_time": 0.148555, "process_mem_max_rss": "115136", "process_out_blocks": "1694", "process_user_time": 0.80459}
[0m01:30:44.163611 [debug] [MainThread]: Command `dbt run` succeeded at 01:30:44.163574 after 0.41 seconds
[0m01:30:44.163812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82bb9950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82b6ee10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff876a8950>]}
[0m01:30:44.164003 [debug] [MainThread]: Flushing usage events
[0m01:30:45.495659 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:00:54.056049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fb33e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fb33d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fb334d0>]}


============================== 02:00:54.058131 | 9335a5a3-7c91-4425-bdc9-ff6918b4934c ==============================
[0m02:00:54.058131 [info ] [MainThread]: Running with dbt=1.9.0
[0m02:00:54.058508 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --select fact_waterlevel --full-refresh', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m02:00:54.121094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9335a5a3-7c91-4425-bdc9-ff6918b4934c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fd41c10>]}
[0m02:00:54.143106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9335a5a3-7c91-4425-bdc9-ff6918b4934c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92575350>]}
[0m02:00:54.143481 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m02:00:54.168164 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m02:00:54.206354 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:00:54.206640 [debug] [MainThread]: Partial parsing: updated file: etl_waterlevel://models/facts/fact_waterlevel.sql
[0m02:00:54.297476 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m02:00:54.299845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9335a5a3-7c91-4425-bdc9-ff6918b4934c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ed19390>]}
[0m02:00:54.328877 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m02:00:54.330780 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m02:00:54.337636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9335a5a3-7c91-4425-bdc9-ff6918b4934c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e888450>]}
[0m02:00:54.337892 [info ] [MainThread]: Found 3 models, 434 macros
[0m02:00:54.338144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9335a5a3-7c91-4425-bdc9-ff6918b4934c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e9b45d0>]}
[0m02:00:54.338911 [info ] [MainThread]: 
[0m02:00:54.339109 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:00:54.339302 [info ] [MainThread]: 
[0m02:00:54.339713 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:00:54.340227 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m02:00:54.358048 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m02:00:54.358292 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m02:00:54.358488 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:00:54.361711 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.003 seconds
[0m02:00:54.362300 [debug] [ThreadPool]: On list_airflow: Close
[0m02:00:54.364422 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_fact)
[0m02:00:54.364762 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow_dim'
[0m02:00:54.367166 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m02:00:54.368138 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m02:00:54.368394 [debug] [ThreadPool]: On list_airflow_fact: BEGIN
[0m02:00:54.368653 [debug] [ThreadPool]: On list_airflow_dim: BEGIN
[0m02:00:54.368876 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:00:54.369115 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:00:54.370922 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m02:00:54.371219 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m02:00:54.371368 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m02:00:54.371579 [debug] [ThreadPool]: On list_airflow_fact: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_fact"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'fact'
  
[0m02:00:54.371845 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m02:00:54.372231 [debug] [ThreadPool]: On list_airflow_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dim'
  
[0m02:00:54.373431 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m02:00:54.373584 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.001 seconds
[0m02:00:54.374185 [debug] [ThreadPool]: On list_airflow_fact: ROLLBACK
[0m02:00:54.374806 [debug] [ThreadPool]: On list_airflow_dim: ROLLBACK
[0m02:00:54.375132 [debug] [ThreadPool]: On list_airflow_fact: Close
[0m02:00:54.375339 [debug] [ThreadPool]: On list_airflow_dim: Close
[0m02:00:54.377846 [debug] [MainThread]: Using postgres connection "master"
[0m02:00:54.378044 [debug] [MainThread]: On master: BEGIN
[0m02:00:54.378218 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:00:54.380018 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m02:00:54.380256 [debug] [MainThread]: Using postgres connection "master"
[0m02:00:54.380494 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:00:54.382337 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m02:00:54.382837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9335a5a3-7c91-4425-bdc9-ff6918b4934c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e89f010>]}
[0m02:00:54.383089 [debug] [MainThread]: On master: ROLLBACK
[0m02:00:54.383352 [debug] [MainThread]: Using postgres connection "master"
[0m02:00:54.383589 [debug] [MainThread]: On master: BEGIN
[0m02:00:54.383916 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m02:00:54.384138 [debug] [MainThread]: On master: COMMIT
[0m02:00:54.384311 [debug] [MainThread]: Using postgres connection "master"
[0m02:00:54.384488 [debug] [MainThread]: On master: COMMIT
[0m02:00:54.384752 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m02:00:54.384972 [debug] [MainThread]: On master: Close
[0m02:00:54.386264 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.fact_waterlevel
[0m02:00:54.386566 [info ] [Thread-1 (]: 1 of 1 START sql incremental model fact.fact_waterlevel ........................ [RUN]
[0m02:00:54.386880 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_dim, now model.etl_waterlevel.fact_waterlevel)
[0m02:00:54.387124 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.fact_waterlevel
[0m02:00:54.392201 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.fact_waterlevel"
[0m02:00:54.393610 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.fact_waterlevel
[0m02:00:54.416366 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.fact_waterlevel"
[0m02:00:54.417277 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m02:00:54.417491 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: BEGIN
[0m02:00:54.417697 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:00:54.419415 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m02:00:54.419791 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m02:00:54.420027 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      
  
    

  create  table "airflow"."fact"."fact_waterlevel__dbt_tmp"
  
  
    as
  
  (
    

with main as (
select
    distinct
    concat("stationId",'_',"stationCode") as station_key,
    "stationId" as station_id,
    "stationCode" as station_code,
    "waterLevel" as water_level,
    "waterlevelStatus" as waterlevel_status,
    case
        when "waterlevelStatus" = 3 then '🚨 Beyond Danger'
        when "waterlevelStatus" = 2 then '⚠️ Between Warning and Danger'
        when "waterlevelStatus" = 1 then '🔶 Between Alert and Warning'
        when "waterlevelStatus" = 0 then '✅ Between Normal and Alert'
        when "waterlevelStatus" = -1 then '🟢 Below Normal (Safe)'
        else '❓ Unknown Status'
    end as waterlevel_condition,
    "stationName",
    "districtName",
    -- Convert timestamp to KL timezone
    to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS') at TIME zone 'Asia/Kuala_Lumpur' as last_update
from
    raw.waterlevels w
where
    "stationStatus" = 1

    

)
select
    *
from
    main
  );
  
  
[0m02:00:54.464216 [debug] [Thread-1 (]: SQL status: SELECT 20432 in 0.044 seconds
[0m02:00:54.468862 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m02:00:54.469129 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */
alter table "airflow"."fact"."fact_waterlevel" rename to "fact_waterlevel__dbt_backup"
[0m02:00:54.469627 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m02:00:54.470992 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m02:00:54.471215 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */
alter table "airflow"."fact"."fact_waterlevel__dbt_tmp" rename to "fact_waterlevel"
[0m02:00:54.471616 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m02:00:54.478476 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m02:00:54.478734 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m02:00:54.478957 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m02:00:54.485890 [debug] [Thread-1 (]: SQL status: COMMIT in 0.007 seconds
[0m02:00:54.488539 [debug] [Thread-1 (]: Applying DROP to: "airflow"."fact"."fact_waterlevel__dbt_backup"
[0m02:00:54.490594 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m02:00:54.490785 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */
drop table if exists "airflow"."fact"."fact_waterlevel__dbt_backup" cascade
[0m02:00:54.493344 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m02:00:54.494447 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: Close
[0m02:00:54.495360 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9335a5a3-7c91-4425-bdc9-ff6918b4934c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8eade590>]}
[0m02:00:54.495788 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model fact.fact_waterlevel ................... [[32mSELECT 20432[0m in 0.11s]
[0m02:00:54.496136 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.fact_waterlevel
[0m02:00:54.496984 [debug] [MainThread]: Using postgres connection "master"
[0m02:00:54.497178 [debug] [MainThread]: On master: BEGIN
[0m02:00:54.497330 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:00:54.498851 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m02:00:54.499111 [debug] [MainThread]: On master: COMMIT
[0m02:00:54.499286 [debug] [MainThread]: Using postgres connection "master"
[0m02:00:54.499443 [debug] [MainThread]: On master: COMMIT
[0m02:00:54.499631 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m02:00:54.499772 [debug] [MainThread]: On master: Close
[0m02:00:54.499963 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:00:54.500106 [debug] [MainThread]: Connection 'list_airflow_fact' was properly closed.
[0m02:00:54.500233 [debug] [MainThread]: Connection 'model.etl_waterlevel.fact_waterlevel' was properly closed.
[0m02:00:54.500385 [info ] [MainThread]: 
[0m02:00:54.500572 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.16 seconds (0.16s).
[0m02:00:54.501063 [debug] [MainThread]: Command end result
[0m02:00:54.542160 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m02:00:54.543320 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m02:00:54.546315 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m02:00:54.546520 [info ] [MainThread]: 
[0m02:00:54.546768 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:00:54.547056 [info ] [MainThread]: 
[0m02:00:54.547317 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m02:00:54.547885 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.5145283, "process_in_blocks": "0", "process_kernel_time": 0.116161, "process_mem_max_rss": "118084", "process_out_blocks": "2522", "process_user_time": 0.9373}
[0m02:00:54.548125 [debug] [MainThread]: Command `dbt run` succeeded at 02:00:54.548065 after 0.51 seconds
[0m02:00:54.548331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94429790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94428950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94429910>]}
[0m02:00:54.548538 [debug] [MainThread]: Flushing usage events
[0m02:00:55.931217 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:01:54.092608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8423e850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8423e390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8423f5d0>]}


============================== 02:01:54.094251 | 3e6a34cc-2cf3-4555-95e9-43f9d5af5d46 ==============================
[0m02:01:54.094251 [info ] [MainThread]: Running with dbt=1.9.0
[0m02:01:54.094626 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --select fact_waterlevel --full-refresh', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m02:01:54.154624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3e6a34cc-2cf3-4555-95e9-43f9d5af5d46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8368f0d0>]}
[0m02:01:54.176439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3e6a34cc-2cf3-4555-95e9-43f9d5af5d46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86d21b10>]}
[0m02:01:54.176818 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m02:01:54.201786 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m02:01:54.239836 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:01:54.240134 [debug] [MainThread]: Partial parsing: updated file: etl_waterlevel://models/facts/fact_waterlevel.sql
[0m02:01:54.329875 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m02:01:54.332192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3e6a34cc-2cf3-4555-95e9-43f9d5af5d46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8326bd10>]}
[0m02:01:54.359362 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m02:01:54.360702 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m02:01:54.366258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3e6a34cc-2cf3-4555-95e9-43f9d5af5d46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82ff45d0>]}
[0m02:01:54.366490 [info ] [MainThread]: Found 3 models, 434 macros
[0m02:01:54.366675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3e6a34cc-2cf3-4555-95e9-43f9d5af5d46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff831731d0>]}
[0m02:01:54.367401 [info ] [MainThread]: 
[0m02:01:54.367623 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:01:54.367850 [info ] [MainThread]: 
[0m02:01:54.368231 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:01:54.368725 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m02:01:54.382730 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m02:01:54.382951 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m02:01:54.383158 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:01:54.385872 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.003 seconds
[0m02:01:54.386479 [debug] [ThreadPool]: On list_airflow: Close
[0m02:01:54.388630 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_fact)
[0m02:01:54.388964 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow_dim'
[0m02:01:54.391400 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m02:01:54.392351 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m02:01:54.392608 [debug] [ThreadPool]: On list_airflow_fact: BEGIN
[0m02:01:54.392860 [debug] [ThreadPool]: On list_airflow_dim: BEGIN
[0m02:01:54.393086 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:01:54.393307 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:01:54.395001 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m02:01:54.395162 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m02:01:54.395361 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m02:01:54.395580 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m02:01:54.395868 [debug] [ThreadPool]: On list_airflow_fact: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_fact"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'fact'
  
[0m02:01:54.396150 [debug] [ThreadPool]: On list_airflow_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dim'
  
[0m02:01:54.397598 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m02:01:54.398204 [debug] [ThreadPool]: On list_airflow_fact: ROLLBACK
[0m02:01:54.398338 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.002 seconds
[0m02:01:54.398612 [debug] [ThreadPool]: On list_airflow_fact: Close
[0m02:01:54.399069 [debug] [ThreadPool]: On list_airflow_dim: ROLLBACK
[0m02:01:54.399685 [debug] [ThreadPool]: On list_airflow_dim: Close
[0m02:01:54.401868 [debug] [MainThread]: Using postgres connection "master"
[0m02:01:54.402090 [debug] [MainThread]: On master: BEGIN
[0m02:01:54.402266 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:01:54.403693 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m02:01:54.403899 [debug] [MainThread]: Using postgres connection "master"
[0m02:01:54.404124 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:01:54.405585 [debug] [MainThread]: SQL status: SELECT 0 in 0.001 seconds
[0m02:01:54.406087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3e6a34cc-2cf3-4555-95e9-43f9d5af5d46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff833eb510>]}
[0m02:01:54.406340 [debug] [MainThread]: On master: ROLLBACK
[0m02:01:54.406607 [debug] [MainThread]: Using postgres connection "master"
[0m02:01:54.406804 [debug] [MainThread]: On master: BEGIN
[0m02:01:54.407128 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m02:01:54.407346 [debug] [MainThread]: On master: COMMIT
[0m02:01:54.407525 [debug] [MainThread]: Using postgres connection "master"
[0m02:01:54.407695 [debug] [MainThread]: On master: COMMIT
[0m02:01:54.407947 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m02:01:54.408128 [debug] [MainThread]: On master: Close
[0m02:01:54.409404 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.fact_waterlevel
[0m02:01:54.409718 [info ] [Thread-1 (]: 1 of 1 START sql incremental model fact.fact_waterlevel ........................ [RUN]
[0m02:01:54.410096 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_dim, now model.etl_waterlevel.fact_waterlevel)
[0m02:01:54.410302 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.fact_waterlevel
[0m02:01:54.415196 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.fact_waterlevel"
[0m02:01:54.415900 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.fact_waterlevel
[0m02:01:54.438612 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.fact_waterlevel"
[0m02:01:54.439324 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m02:01:54.439587 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: BEGIN
[0m02:01:54.439824 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:01:54.441676 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m02:01:54.441911 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m02:01:54.442164 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      
  
    

  create  table "airflow"."fact"."fact_waterlevel__dbt_tmp"
  
  
    as
  
  (
    

with main as (
select
    distinct
    concat("stationId",'_',"stationCode") as station_key,
    "stationId" as station_id,
    "stationCode" as station_code,
    "waterLevel" as water_level,
    "waterlevelStatus" as waterlevel_status,
    case
        when "waterlevelStatus" = 3 then '🚨 Beyond Danger'
        when "waterlevelStatus" = 2 then '⚠️ Between Warning and Danger'
        when "waterlevelStatus" = 1 then '🔶 Between Alert and Warning'
        when "waterlevelStatus" = 0 then '✅ Between Normal and Alert'
        when "waterlevelStatus" = -1 then '🟢 Below Normal (Safe)'
        else '❓ Unknown Status'
    end as waterlevel_condition,
    "stationName",
    "districtName",
    "lastUpdate",
    -- Convert timestamp to KL timezone
    to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS') at TIME zone 'Asia/Kuala_Lumpur' as last_update
from
    raw.waterlevels w
where
    "stationStatus" = 1

    

)
select
    *
from
    main
  );
  
  
[0m02:01:54.478928 [debug] [Thread-1 (]: SQL status: SELECT 20432 in 0.036 seconds
[0m02:01:54.483227 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m02:01:54.483464 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */
alter table "airflow"."fact"."fact_waterlevel" rename to "fact_waterlevel__dbt_backup"
[0m02:01:54.483855 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m02:01:54.485183 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m02:01:54.485392 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */
alter table "airflow"."fact"."fact_waterlevel__dbt_tmp" rename to "fact_waterlevel"
[0m02:01:54.485732 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m02:01:54.492249 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m02:01:54.492495 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m02:01:54.492727 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m02:01:54.501273 [debug] [Thread-1 (]: SQL status: COMMIT in 0.008 seconds
[0m02:01:54.504293 [debug] [Thread-1 (]: Applying DROP to: "airflow"."fact"."fact_waterlevel__dbt_backup"
[0m02:01:54.506331 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m02:01:54.506565 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */
drop table if exists "airflow"."fact"."fact_waterlevel__dbt_backup" cascade
[0m02:01:54.508304 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m02:01:54.509532 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: Close
[0m02:01:54.510491 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e6a34cc-2cf3-4555-95e9-43f9d5af5d46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff832d3e10>]}
[0m02:01:54.510881 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model fact.fact_waterlevel ................... [[32mSELECT 20432[0m in 0.10s]
[0m02:01:54.511306 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.fact_waterlevel
[0m02:01:54.512362 [debug] [MainThread]: Using postgres connection "master"
[0m02:01:54.512580 [debug] [MainThread]: On master: BEGIN
[0m02:01:54.512739 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:01:54.514362 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m02:01:54.514623 [debug] [MainThread]: On master: COMMIT
[0m02:01:54.514822 [debug] [MainThread]: Using postgres connection "master"
[0m02:01:54.514962 [debug] [MainThread]: On master: COMMIT
[0m02:01:54.515147 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m02:01:54.515279 [debug] [MainThread]: On master: Close
[0m02:01:54.515470 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:01:54.515610 [debug] [MainThread]: Connection 'list_airflow_fact' was properly closed.
[0m02:01:54.515745 [debug] [MainThread]: Connection 'model.etl_waterlevel.fact_waterlevel' was properly closed.
[0m02:01:54.515893 [info ] [MainThread]: 
[0m02:01:54.516299 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.15 seconds (0.15s).
[0m02:01:54.516811 [debug] [MainThread]: Command end result
[0m02:01:54.558406 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m02:01:54.560072 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m02:01:54.563182 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m02:01:54.563364 [info ] [MainThread]: 
[0m02:01:54.563574 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:01:54.563904 [info ] [MainThread]: 
[0m02:01:54.564177 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m02:01:54.564782 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.49384713, "process_in_blocks": "0", "process_kernel_time": 0.088541, "process_mem_max_rss": "118260", "process_out_blocks": "2523", "process_user_time": 0.919235}
[0m02:01:54.565175 [debug] [MainThread]: Command `dbt run` succeeded at 02:01:54.565029 after 0.49 seconds
[0m02:01:54.565392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88bb5110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88bb4810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88bb57d0>]}
[0m02:01:54.565578 [debug] [MainThread]: Flushing usage events
[0m02:01:55.636382 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:02:49.274964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaba111d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaba13550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaba10110>]}


============================== 02:02:49.276681 | fc17f213-feaf-4759-a59e-e1981a4862ba ==============================
[0m02:02:49.276681 [info ] [MainThread]: Running with dbt=1.9.0
[0m02:02:49.277091 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --select fact_waterlevel --full-refresh', 'send_anonymous_usage_stats': 'True'}
[0m02:02:49.338644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fc17f213-feaf-4759-a59e-e1981a4862ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab8aef90>]}
[0m02:02:49.360377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fc17f213-feaf-4759-a59e-e1981a4862ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae436ed0>]}
[0m02:02:49.360795 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m02:02:49.385510 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m02:02:49.423052 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:02:49.423362 [debug] [MainThread]: Partial parsing: updated file: etl_waterlevel://models/facts/fact_waterlevel.sql
[0m02:02:49.512687 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m02:02:49.515003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fc17f213-feaf-4759-a59e-e1981a4862ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac756250>]}
[0m02:02:49.543589 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m02:02:49.545295 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m02:02:49.550670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fc17f213-feaf-4759-a59e-e1981a4862ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa90da10>]}
[0m02:02:49.550920 [info ] [MainThread]: Found 3 models, 434 macros
[0m02:02:49.551101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fc17f213-feaf-4759-a59e-e1981a4862ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa980a50>]}
[0m02:02:49.551828 [info ] [MainThread]: 
[0m02:02:49.552027 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:02:49.552232 [info ] [MainThread]: 
[0m02:02:49.552560 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:02:49.553113 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m02:02:49.567242 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m02:02:49.567478 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m02:02:49.567683 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:02:49.570187 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.003 seconds
[0m02:02:49.570816 [debug] [ThreadPool]: On list_airflow: Close
[0m02:02:49.572889 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_fact)
[0m02:02:49.573215 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow_dim'
[0m02:02:49.575671 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m02:02:49.576571 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m02:02:49.576831 [debug] [ThreadPool]: On list_airflow_fact: BEGIN
[0m02:02:49.577051 [debug] [ThreadPool]: On list_airflow_dim: BEGIN
[0m02:02:49.577270 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:02:49.577479 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:02:49.579204 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m02:02:49.579492 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m02:02:49.579664 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m02:02:49.579881 [debug] [ThreadPool]: On list_airflow_fact: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_fact"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'fact'
  
[0m02:02:49.580122 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m02:02:49.580500 [debug] [ThreadPool]: On list_airflow_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dim'
  
[0m02:02:49.581629 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m02:02:49.581759 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.001 seconds
[0m02:02:49.582297 [debug] [ThreadPool]: On list_airflow_fact: ROLLBACK
[0m02:02:49.582897 [debug] [ThreadPool]: On list_airflow_dim: ROLLBACK
[0m02:02:49.583219 [debug] [ThreadPool]: On list_airflow_fact: Close
[0m02:02:49.583462 [debug] [ThreadPool]: On list_airflow_dim: Close
[0m02:02:49.585985 [debug] [MainThread]: Using postgres connection "master"
[0m02:02:49.586212 [debug] [MainThread]: On master: BEGIN
[0m02:02:49.586386 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:02:49.587894 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m02:02:49.588134 [debug] [MainThread]: Using postgres connection "master"
[0m02:02:49.588359 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:02:49.589805 [debug] [MainThread]: SQL status: SELECT 0 in 0.001 seconds
[0m02:02:49.590307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fc17f213-feaf-4759-a59e-e1981a4862ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaaa35410>]}
[0m02:02:49.590554 [debug] [MainThread]: On master: ROLLBACK
[0m02:02:49.590829 [debug] [MainThread]: Using postgres connection "master"
[0m02:02:49.591006 [debug] [MainThread]: On master: BEGIN
[0m02:02:49.591376 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m02:02:49.591616 [debug] [MainThread]: On master: COMMIT
[0m02:02:49.591848 [debug] [MainThread]: Using postgres connection "master"
[0m02:02:49.592027 [debug] [MainThread]: On master: COMMIT
[0m02:02:49.592276 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m02:02:49.592452 [debug] [MainThread]: On master: Close
[0m02:02:49.593760 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.fact_waterlevel
[0m02:02:49.594054 [info ] [Thread-1 (]: 1 of 1 START sql incremental model fact.fact_waterlevel ........................ [RUN]
[0m02:02:49.594318 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_dim, now model.etl_waterlevel.fact_waterlevel)
[0m02:02:49.594546 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.fact_waterlevel
[0m02:02:49.599397 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.fact_waterlevel"
[0m02:02:49.600127 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.fact_waterlevel
[0m02:02:49.622772 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.fact_waterlevel"
[0m02:02:49.623521 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m02:02:49.623749 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: BEGIN
[0m02:02:49.624002 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:02:49.625746 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m02:02:49.625973 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m02:02:49.626198 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      
  
    

  create  table "airflow"."fact"."fact_waterlevel__dbt_tmp"
  
  
    as
  
  (
    

with main as (
select
    distinct
    concat("stationId",'_',"stationCode") as station_key,
    "stationId" as station_id,
    "stationCode" as station_code,
    "waterLevel" as water_level,
    "waterlevelStatus" as waterlevel_status,
    case
        when "waterlevelStatus" = 3 then '🚨 Beyond Danger'
        when "waterlevelStatus" = 2 then '⚠️ Between Warning and Danger'
        when "waterlevelStatus" = 1 then '🔶 Between Alert and Warning'
        when "waterlevelStatus" = 0 then '✅ Between Normal and Alert'
        when "waterlevelStatus" = -1 then '🟢 Below Normal (Safe)'
        else '❓ Unknown Status'
    end as waterlevel_condition,
    "stationName",
    "districtName",
    "lastUpdate",
    -- Convert timestamp to KL timezone
    to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS') at TIME zone 'Asia/Kuala_Lumpur' as last_update
from
    raw.waterlevels w
where
    "stationStatus" = 1

    

)
select
    *
from
    main
  );
  
  
[0m02:02:49.662467 [debug] [Thread-1 (]: SQL status: SELECT 20432 in 0.036 seconds
[0m02:02:49.666817 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m02:02:49.667053 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */
alter table "airflow"."fact"."fact_waterlevel" rename to "fact_waterlevel__dbt_backup"
[0m02:02:49.667448 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m02:02:49.668757 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m02:02:49.668962 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */
alter table "airflow"."fact"."fact_waterlevel__dbt_tmp" rename to "fact_waterlevel"
[0m02:02:49.669294 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m02:02:49.675859 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m02:02:49.676093 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m02:02:49.676292 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m02:02:49.683681 [debug] [Thread-1 (]: SQL status: COMMIT in 0.007 seconds
[0m02:02:49.686766 [debug] [Thread-1 (]: Applying DROP to: "airflow"."fact"."fact_waterlevel__dbt_backup"
[0m02:02:49.688910 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m02:02:49.689122 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */
drop table if exists "airflow"."fact"."fact_waterlevel__dbt_backup" cascade
[0m02:02:49.690871 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m02:02:49.692180 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: Close
[0m02:02:49.693023 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc17f213-feaf-4759-a59e-e1981a4862ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa7580d0>]}
[0m02:02:49.693674 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model fact.fact_waterlevel ................... [[32mSELECT 20432[0m in 0.10s]
[0m02:02:49.694143 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.fact_waterlevel
[0m02:02:49.695030 [debug] [MainThread]: Using postgres connection "master"
[0m02:02:49.695223 [debug] [MainThread]: On master: BEGIN
[0m02:02:49.695367 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:02:49.697044 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m02:02:49.697241 [debug] [MainThread]: On master: COMMIT
[0m02:02:49.697454 [debug] [MainThread]: Using postgres connection "master"
[0m02:02:49.697660 [debug] [MainThread]: On master: COMMIT
[0m02:02:49.697913 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m02:02:49.698121 [debug] [MainThread]: On master: Close
[0m02:02:49.698433 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:02:49.698599 [debug] [MainThread]: Connection 'list_airflow_fact' was properly closed.
[0m02:02:49.698955 [debug] [MainThread]: Connection 'model.etl_waterlevel.fact_waterlevel' was properly closed.
[0m02:02:49.699145 [info ] [MainThread]: 
[0m02:02:49.699361 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.15 seconds (0.15s).
[0m02:02:49.699979 [debug] [MainThread]: Command end result
[0m02:02:49.744930 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m02:02:49.746102 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m02:02:49.749263 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m02:02:49.749462 [info ] [MainThread]: 
[0m02:02:49.749740 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:02:49.750080 [info ] [MainThread]: 
[0m02:02:49.750276 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m02:02:49.750850 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.49792334, "process_in_blocks": "0", "process_kernel_time": 0.082548, "process_mem_max_rss": "118220", "process_out_blocks": "2522", "process_user_time": 0.922952}
[0m02:02:49.751053 [debug] [MainThread]: Command `dbt run` succeeded at 02:02:49.751015 after 0.50 seconds
[0m02:02:49.751233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb02e93d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb02e8950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb02e9910>]}
[0m02:02:49.751406 [debug] [MainThread]: Flushing usage events
[0m02:02:51.142486 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:03:30.832906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94c474d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94a60450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94c47310>]}


============================== 02:03:30.834351 | 2ec19457-758e-46c5-a371-805b06343737 ==============================
[0m02:03:30.834351 [info ] [MainThread]: Running with dbt=1.9.0
[0m02:03:30.834772 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select fact_waterlevel --full-refresh', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m02:03:30.894534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2ec19457-758e-46c5-a371-805b06343737', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95747510>]}
[0m02:03:30.916579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2ec19457-758e-46c5-a371-805b06343737', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff976a1a90>]}
[0m02:03:30.916971 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m02:03:30.941667 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m02:03:30.978433 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:03:30.978747 [debug] [MainThread]: Partial parsing: updated file: etl_waterlevel://models/facts/fact_waterlevel.sql
[0m02:03:31.067900 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m02:03:31.070405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2ec19457-758e-46c5-a371-805b06343737', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94c44ed0>]}
[0m02:03:31.097579 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m02:03:31.099023 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m02:03:31.105171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2ec19457-758e-46c5-a371-805b06343737', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93b0aad0>]}
[0m02:03:31.105422 [info ] [MainThread]: Found 3 models, 434 macros
[0m02:03:31.105604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2ec19457-758e-46c5-a371-805b06343737', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93aee450>]}
[0m02:03:31.106434 [info ] [MainThread]: 
[0m02:03:31.106680 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:03:31.106919 [info ] [MainThread]: 
[0m02:03:31.107228 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:03:31.107671 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m02:03:31.121504 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m02:03:31.121713 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m02:03:31.121944 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:03:31.124429 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.002 seconds
[0m02:03:31.125040 [debug] [ThreadPool]: On list_airflow: Close
[0m02:03:31.127172 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_dim)
[0m02:03:31.127478 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow_fact'
[0m02:03:31.129922 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m02:03:31.130837 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m02:03:31.131090 [debug] [ThreadPool]: On list_airflow_dim: BEGIN
[0m02:03:31.131315 [debug] [ThreadPool]: On list_airflow_fact: BEGIN
[0m02:03:31.131530 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:03:31.131747 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:03:31.133464 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m02:03:31.133621 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m02:03:31.133819 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m02:03:31.134067 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m02:03:31.134335 [debug] [ThreadPool]: On list_airflow_fact: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_fact"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'fact'
  
[0m02:03:31.134616 [debug] [ThreadPool]: On list_airflow_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dim'
  
[0m02:03:31.136025 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m02:03:31.136176 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.001 seconds
[0m02:03:31.136910 [debug] [ThreadPool]: On list_airflow_fact: ROLLBACK
[0m02:03:31.137550 [debug] [ThreadPool]: On list_airflow_dim: ROLLBACK
[0m02:03:31.137886 [debug] [ThreadPool]: On list_airflow_fact: Close
[0m02:03:31.138139 [debug] [ThreadPool]: On list_airflow_dim: Close
[0m02:03:31.140870 [debug] [MainThread]: Using postgres connection "master"
[0m02:03:31.141126 [debug] [MainThread]: On master: BEGIN
[0m02:03:31.141328 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:03:31.142961 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m02:03:31.143204 [debug] [MainThread]: Using postgres connection "master"
[0m02:03:31.143453 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:03:31.144896 [debug] [MainThread]: SQL status: SELECT 0 in 0.001 seconds
[0m02:03:31.145405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2ec19457-758e-46c5-a371-805b06343737', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92f6dc10>]}
[0m02:03:31.145636 [debug] [MainThread]: On master: ROLLBACK
[0m02:03:31.145879 [debug] [MainThread]: Using postgres connection "master"
[0m02:03:31.146022 [debug] [MainThread]: On master: BEGIN
[0m02:03:31.146295 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m02:03:31.146501 [debug] [MainThread]: On master: COMMIT
[0m02:03:31.146649 [debug] [MainThread]: Using postgres connection "master"
[0m02:03:31.146784 [debug] [MainThread]: On master: COMMIT
[0m02:03:31.146990 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m02:03:31.147136 [debug] [MainThread]: On master: Close
[0m02:03:31.148110 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.fact_waterlevel
[0m02:03:31.148396 [info ] [Thread-1 (]: 1 of 1 START sql incremental model fact.fact_waterlevel ........................ [RUN]
[0m02:03:31.148645 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_dim, now model.etl_waterlevel.fact_waterlevel)
[0m02:03:31.148846 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.fact_waterlevel
[0m02:03:31.153777 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.fact_waterlevel"
[0m02:03:31.154538 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.fact_waterlevel
[0m02:03:31.176921 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.fact_waterlevel"
[0m02:03:31.177614 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m02:03:31.177832 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: BEGIN
[0m02:03:31.178027 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:03:31.179726 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m02:03:31.179978 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m02:03:31.180201 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      
  
    

  create  table "airflow"."fact"."fact_waterlevel__dbt_tmp"
  
  
    as
  
  (
    

with main as (
select
    distinct
    concat("stationId",'_',"stationCode") as station_key,
    "stationId" as station_id,
    "stationCode" as station_code,
    "waterLevel" as water_level,
    "waterlevelStatus" as waterlevel_status,
    case
        when "waterlevelStatus" = 3 then '🚨 Beyond Danger'
        when "waterlevelStatus" = 2 then '⚠️ Between Warning and Danger'
        when "waterlevelStatus" = 1 then '🔶 Between Alert and Warning'
        when "waterlevelStatus" = 0 then '✅ Between Normal and Alert'
        when "waterlevelStatus" = -1 then '🟢 Below Normal (Safe)'
        else '❓ Unknown Status'
    end as waterlevel_condition,
    "stationName",
    "districtName",
    "lastUpdate",
    -- Convert timestamp to KL timezone
    to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS') at TIME zone 'Asia/Kuala_Lumpur' as last_update,
    to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp AS last_update_my
from
    raw.waterlevels w
where
    "stationStatus" = 1

    

)
select
    *
from
    main
  );
  
  
[0m02:03:31.221906 [debug] [Thread-1 (]: SQL status: SELECT 20432 in 0.041 seconds
[0m02:03:31.226254 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m02:03:31.226493 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */
alter table "airflow"."fact"."fact_waterlevel" rename to "fact_waterlevel__dbt_backup"
[0m02:03:31.226907 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m02:03:31.228194 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m02:03:31.228406 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */
alter table "airflow"."fact"."fact_waterlevel__dbt_tmp" rename to "fact_waterlevel"
[0m02:03:31.228806 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m02:03:31.235419 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m02:03:31.235654 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m02:03:31.235870 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m02:03:31.243633 [debug] [Thread-1 (]: SQL status: COMMIT in 0.008 seconds
[0m02:03:31.246545 [debug] [Thread-1 (]: Applying DROP to: "airflow"."fact"."fact_waterlevel__dbt_backup"
[0m02:03:31.248686 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m02:03:31.248932 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */
drop table if exists "airflow"."fact"."fact_waterlevel__dbt_backup" cascade
[0m02:03:31.250501 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m02:03:31.251767 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: Close
[0m02:03:31.252590 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ec19457-758e-46c5-a371-805b06343737', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92e27690>]}
[0m02:03:31.252960 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model fact.fact_waterlevel ................... [[32mSELECT 20432[0m in 0.10s]
[0m02:03:31.253302 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.fact_waterlevel
[0m02:03:31.254284 [debug] [MainThread]: Using postgres connection "master"
[0m02:03:31.254449 [debug] [MainThread]: On master: BEGIN
[0m02:03:31.254586 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:03:31.256196 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m02:03:31.256370 [debug] [MainThread]: On master: COMMIT
[0m02:03:31.256596 [debug] [MainThread]: Using postgres connection "master"
[0m02:03:31.256793 [debug] [MainThread]: On master: COMMIT
[0m02:03:31.257063 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m02:03:31.257218 [debug] [MainThread]: On master: Close
[0m02:03:31.257415 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:03:31.257554 [debug] [MainThread]: Connection 'model.etl_waterlevel.fact_waterlevel' was properly closed.
[0m02:03:31.257718 [debug] [MainThread]: Connection 'list_airflow_fact' was properly closed.
[0m02:03:31.257932 [info ] [MainThread]: 
[0m02:03:31.258381 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.15 seconds (0.15s).
[0m02:03:31.259177 [debug] [MainThread]: Command end result
[0m02:03:31.301092 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m02:03:31.302371 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m02:03:31.305546 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m02:03:31.305717 [info ] [MainThread]: 
[0m02:03:31.305992 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:03:31.306345 [info ] [MainThread]: 
[0m02:03:31.306584 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m02:03:31.307191 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.49627745, "process_in_blocks": "0", "process_kernel_time": 0.088402, "process_mem_max_rss": "118084", "process_out_blocks": "2523", "process_user_time": 0.910144}
[0m02:03:31.307397 [debug] [MainThread]: Command `dbt run` succeeded at 02:03:31.307362 after 0.50 seconds
[0m02:03:31.307571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99565650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99564810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff995657d0>]}
[0m02:03:31.307777 [debug] [MainThread]: Flushing usage events
[0m02:03:32.371527 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:05:07.512574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7af07290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7af07350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7af06e10>]}


============================== 02:05:07.514446 | 0efdde64-4eb0-420d-ae11-c57347056aba ==============================
[0m02:05:07.514446 [info ] [MainThread]: Running with dbt=1.9.0
[0m02:05:07.514862 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --select fact_waterlevel --full-refresh', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m02:05:07.577236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0efdde64-4eb0-420d-ae11-c57347056aba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a36ddd0>]}
[0m02:05:07.599336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0efdde64-4eb0-420d-ae11-c57347056aba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d949d90>]}
[0m02:05:07.599727 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m02:05:07.627142 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m02:05:07.666024 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:05:07.666356 [debug] [MainThread]: Partial parsing: updated file: etl_waterlevel://models/facts/fact_waterlevel.sql
[0m02:05:07.756326 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m02:05:07.758585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0efdde64-4eb0-420d-ae11-c57347056aba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a0df050>]}
[0m02:05:07.786291 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m02:05:07.787776 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m02:05:07.794397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0efdde64-4eb0-420d-ae11-c57347056aba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79e4c6d0>]}
[0m02:05:07.794672 [info ] [MainThread]: Found 3 models, 434 macros
[0m02:05:07.794893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0efdde64-4eb0-420d-ae11-c57347056aba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79d86390>]}
[0m02:05:07.795662 [info ] [MainThread]: 
[0m02:05:07.795905 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:05:07.796268 [info ] [MainThread]: 
[0m02:05:07.796547 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:05:07.797025 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m02:05:07.813055 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m02:05:07.813290 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m02:05:07.813489 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:05:07.816376 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.003 seconds
[0m02:05:07.817001 [debug] [ThreadPool]: On list_airflow: Close
[0m02:05:07.819102 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_fact)
[0m02:05:07.819440 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow_dim'
[0m02:05:07.821921 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m02:05:07.822821 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m02:05:07.823061 [debug] [ThreadPool]: On list_airflow_fact: BEGIN
[0m02:05:07.823289 [debug] [ThreadPool]: On list_airflow_dim: BEGIN
[0m02:05:07.823505 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:05:07.823720 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:05:07.825355 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m02:05:07.825616 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m02:05:07.825758 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m02:05:07.825980 [debug] [ThreadPool]: On list_airflow_fact: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_fact"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'fact'
  
[0m02:05:07.826226 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m02:05:07.826599 [debug] [ThreadPool]: On list_airflow_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dim'
  
[0m02:05:07.827658 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m02:05:07.827833 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.001 seconds
[0m02:05:07.828390 [debug] [ThreadPool]: On list_airflow_fact: ROLLBACK
[0m02:05:07.828983 [debug] [ThreadPool]: On list_airflow_dim: ROLLBACK
[0m02:05:07.829297 [debug] [ThreadPool]: On list_airflow_fact: Close
[0m02:05:07.829465 [debug] [ThreadPool]: On list_airflow_dim: Close
[0m02:05:07.831903 [debug] [MainThread]: Using postgres connection "master"
[0m02:05:07.832119 [debug] [MainThread]: On master: BEGIN
[0m02:05:07.832291 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:05:07.833772 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m02:05:07.834080 [debug] [MainThread]: Using postgres connection "master"
[0m02:05:07.834309 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:05:07.835676 [debug] [MainThread]: SQL status: SELECT 0 in 0.001 seconds
[0m02:05:07.836200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0efdde64-4eb0-420d-ae11-c57347056aba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79de8590>]}
[0m02:05:07.836448 [debug] [MainThread]: On master: ROLLBACK
[0m02:05:07.836727 [debug] [MainThread]: Using postgres connection "master"
[0m02:05:07.836914 [debug] [MainThread]: On master: BEGIN
[0m02:05:07.837250 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m02:05:07.837468 [debug] [MainThread]: On master: COMMIT
[0m02:05:07.837642 [debug] [MainThread]: Using postgres connection "master"
[0m02:05:07.837832 [debug] [MainThread]: On master: COMMIT
[0m02:05:07.838115 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m02:05:07.838312 [debug] [MainThread]: On master: Close
[0m02:05:07.839481 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.fact_waterlevel
[0m02:05:07.839808 [info ] [Thread-1 (]: 1 of 1 START sql incremental model fact.fact_waterlevel ........................ [RUN]
[0m02:05:07.840142 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_dim, now model.etl_waterlevel.fact_waterlevel)
[0m02:05:07.840387 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.fact_waterlevel
[0m02:05:07.845329 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.fact_waterlevel"
[0m02:05:07.846202 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.fact_waterlevel
[0m02:05:07.869151 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.fact_waterlevel"
[0m02:05:07.870026 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m02:05:07.870267 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: BEGIN
[0m02:05:07.870487 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:05:07.872344 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m02:05:07.872591 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m02:05:07.872831 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      
  
    

  create  table "airflow"."fact"."fact_waterlevel__dbt_tmp"
  
  
    as
  
  (
    

with main as (
select
    distinct
    concat("stationId",'_',"stationCode") as station_key,
    "stationId" as station_id,
    "stationCode" as station_code,
    "waterLevel" as water_level,
    "waterlevelStatus" as waterlevel_status,
    case
        when "waterlevelStatus" = 3 then '🚨 Beyond Danger'
        when "waterlevelStatus" = 2 then '⚠️ Between Warning and Danger'
        when "waterlevelStatus" = 1 then '🔶 Between Alert and Warning'
        when "waterlevelStatus" = 0 then '✅ Between Normal and Alert'
        when "waterlevelStatus" = -1 then '🟢 Below Normal (Safe)'
        else '❓ Unknown Status'
    end as waterlevel_condition,
    "stationName",
    "districtName",
    "lastUpdate",
    -- Convert timestamp to KL timezone
    -- to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS') at TIME zone 'Asia/Kuala_Lumpur' as last_update,
    to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp AS last_update_my
from
    raw.waterlevels w
where
    "stationStatus" = 1

    

)
select
    *
from
    main
  );
  
  
[0m02:05:07.907579 [debug] [Thread-1 (]: SQL status: SELECT 20503 in 0.034 seconds
[0m02:05:07.912178 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m02:05:07.912430 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */
alter table "airflow"."fact"."fact_waterlevel" rename to "fact_waterlevel__dbt_backup"
[0m02:05:07.912895 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m02:05:07.914175 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m02:05:07.914388 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */
alter table "airflow"."fact"."fact_waterlevel__dbt_tmp" rename to "fact_waterlevel"
[0m02:05:07.914741 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m02:05:07.921373 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m02:05:07.921611 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m02:05:07.921838 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m02:05:07.928697 [debug] [Thread-1 (]: SQL status: COMMIT in 0.007 seconds
[0m02:05:07.931326 [debug] [Thread-1 (]: Applying DROP to: "airflow"."fact"."fact_waterlevel__dbt_backup"
[0m02:05:07.933247 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m02:05:07.933472 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */
drop table if exists "airflow"."fact"."fact_waterlevel__dbt_backup" cascade
[0m02:05:07.935474 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m02:05:07.936685 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: Close
[0m02:05:07.937638 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0efdde64-4eb0-420d-ae11-c57347056aba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff787083d0>]}
[0m02:05:07.938065 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model fact.fact_waterlevel ................... [[32mSELECT 20503[0m in 0.10s]
[0m02:05:07.938419 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.fact_waterlevel
[0m02:05:07.939265 [debug] [MainThread]: Using postgres connection "master"
[0m02:05:07.939460 [debug] [MainThread]: On master: BEGIN
[0m02:05:07.939610 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:05:07.941132 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m02:05:07.941406 [debug] [MainThread]: On master: COMMIT
[0m02:05:07.941563 [debug] [MainThread]: Using postgres connection "master"
[0m02:05:07.941697 [debug] [MainThread]: On master: COMMIT
[0m02:05:07.941929 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m02:05:07.942103 [debug] [MainThread]: On master: Close
[0m02:05:07.942305 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:05:07.942438 [debug] [MainThread]: Connection 'list_airflow_fact' was properly closed.
[0m02:05:07.942610 [debug] [MainThread]: Connection 'model.etl_waterlevel.fact_waterlevel' was properly closed.
[0m02:05:07.942804 [info ] [MainThread]: 
[0m02:05:07.942994 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.15 seconds (0.15s).
[0m02:05:07.943544 [debug] [MainThread]: Command end result
[0m02:05:07.984076 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m02:05:07.985450 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m02:05:07.988418 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m02:05:07.988609 [info ] [MainThread]: 
[0m02:05:07.988895 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:05:07.989249 [info ] [MainThread]: 
[0m02:05:07.989494 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m02:05:07.990062 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.5001963, "process_in_blocks": "0", "process_kernel_time": 0.108452, "process_mem_max_rss": "118300", "process_out_blocks": "2523", "process_user_time": 0.952193}
[0m02:05:07.990301 [debug] [MainThread]: Command `dbt run` succeeded at 02:05:07.990251 after 0.50 seconds
[0m02:05:07.990490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f7f4850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f7f4810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f7f5390>]}
[0m02:05:07.990668 [debug] [MainThread]: Flushing usage events
[0m02:05:09.275423 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m05:13:05.713141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff905416d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90543750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90543ad0>]}


============================== 05:13:05.715018 | be8bd1d4-1459-4674-8cc3-eaa0e1972155 ==============================
[0m05:13:05.715018 [info ] [MainThread]: Running with dbt=1.9.0
[0m05:13:05.715332 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --select fact_waterlevel --full-refresh', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m05:13:05.777483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'be8bd1d4-1459-4674-8cc3-eaa0e1972155', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f948b50>]}
[0m05:13:05.799320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'be8bd1d4-1459-4674-8cc3-eaa0e1972155', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93007250>]}
[0m05:13:05.799693 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m05:13:05.825349 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m05:13:05.864615 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:13:05.864883 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:13:05.867245 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m05:13:05.876215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'be8bd1d4-1459-4674-8cc3-eaa0e1972155', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f67a210>]}
[0m05:13:05.904632 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m05:13:05.906315 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m05:13:05.912013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'be8bd1d4-1459-4674-8cc3-eaa0e1972155', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f7d8250>]}
[0m05:13:05.912254 [info ] [MainThread]: Found 3 models, 434 macros
[0m05:13:05.912449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be8bd1d4-1459-4674-8cc3-eaa0e1972155', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f74d890>]}
[0m05:13:05.913151 [info ] [MainThread]: 
[0m05:13:05.913414 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m05:13:05.913641 [info ] [MainThread]: 
[0m05:13:05.914044 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m05:13:05.914583 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m05:13:05.931841 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m05:13:05.932076 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m05:13:05.932278 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:13:05.935416 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.003 seconds
[0m05:13:05.936029 [debug] [ThreadPool]: On list_airflow: Close
[0m05:13:05.938100 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_fact)
[0m05:13:05.938410 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow_dim'
[0m05:13:05.941091 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m05:13:05.942070 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m05:13:05.942299 [debug] [ThreadPool]: On list_airflow_fact: BEGIN
[0m05:13:05.942535 [debug] [ThreadPool]: On list_airflow_dim: BEGIN
[0m05:13:05.942803 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:13:05.943044 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:13:05.944793 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m05:13:05.945105 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m05:13:05.945260 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m05:13:05.945463 [debug] [ThreadPool]: On list_airflow_fact: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_fact"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'fact'
  
[0m05:13:05.945722 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m05:13:05.946127 [debug] [ThreadPool]: On list_airflow_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dim'
  
[0m05:13:05.947321 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m05:13:05.947961 [debug] [ThreadPool]: On list_airflow_fact: ROLLBACK
[0m05:13:05.948100 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.002 seconds
[0m05:13:05.948377 [debug] [ThreadPool]: On list_airflow_fact: Close
[0m05:13:05.948946 [debug] [ThreadPool]: On list_airflow_dim: ROLLBACK
[0m05:13:05.949568 [debug] [ThreadPool]: On list_airflow_dim: Close
[0m05:13:05.951784 [debug] [MainThread]: Using postgres connection "master"
[0m05:13:05.951979 [debug] [MainThread]: On master: BEGIN
[0m05:13:05.952154 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:13:05.953697 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m05:13:05.953949 [debug] [MainThread]: Using postgres connection "master"
[0m05:13:05.954180 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m05:13:05.955715 [debug] [MainThread]: SQL status: SELECT 0 in 0.001 seconds
[0m05:13:05.956213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be8bd1d4-1459-4674-8cc3-eaa0e1972155', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8eae3250>]}
[0m05:13:05.956461 [debug] [MainThread]: On master: ROLLBACK
[0m05:13:05.956722 [debug] [MainThread]: Using postgres connection "master"
[0m05:13:05.956919 [debug] [MainThread]: On master: BEGIN
[0m05:13:05.957244 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m05:13:05.957457 [debug] [MainThread]: On master: COMMIT
[0m05:13:05.957633 [debug] [MainThread]: Using postgres connection "master"
[0m05:13:05.957819 [debug] [MainThread]: On master: COMMIT
[0m05:13:05.958132 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m05:13:05.958321 [debug] [MainThread]: On master: Close
[0m05:13:05.959538 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.fact_waterlevel
[0m05:13:05.959849 [info ] [Thread-1 (]: 1 of 1 START sql incremental model fact.fact_waterlevel ........................ [RUN]
[0m05:13:05.960090 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_dim, now model.etl_waterlevel.fact_waterlevel)
[0m05:13:05.960333 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.fact_waterlevel
[0m05:13:05.966185 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.fact_waterlevel"
[0m05:13:05.966954 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.fact_waterlevel
[0m05:13:05.989447 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.fact_waterlevel"
[0m05:13:05.990182 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m05:13:05.990392 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: BEGIN
[0m05:13:05.990596 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:13:05.992503 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m05:13:05.992754 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m05:13:05.993054 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      
  
    

  create  table "airflow"."fact"."fact_waterlevel__dbt_tmp"
  
  
    as
  
  (
    

with main as (
select
    distinct
    concat("stationId",'_',"stationCode") as station_key,
    "stationId" as station_id,
    "stationCode" as station_code,
    "waterLevel" as water_level,
    "waterlevelStatus" as waterlevel_status,
    case
        when "waterlevelStatus" = 3 then '🚨 Beyond Danger'
        when "waterlevelStatus" = 2 then '⚠️ Between Warning and Danger'
        when "waterlevelStatus" = 1 then '🔶 Between Alert and Warning'
        when "waterlevelStatus" = 0 then '✅ Between Normal and Alert'
        when "waterlevelStatus" = -1 then '🟢 Below Normal (Safe)'
        else '❓ Unknown Status'
    end as waterlevel_condition,
    "stationName",
    "districtName",
    "lastUpdate",
    -- Convert timestamp to KL timezone
    -- to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS') at TIME zone 'Asia/Kuala_Lumpur' as last_update,
    to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp AS last_update_my
from
    raw.waterlevels w
where
    "stationStatus" = 1

    

)
select
    *
from
    main
  );
  
  
[0m05:13:06.037158 [debug] [Thread-1 (]: SQL status: SELECT 20649 in 0.044 seconds
[0m05:13:06.041534 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m05:13:06.041772 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */
alter table "airflow"."fact"."fact_waterlevel" rename to "fact_waterlevel__dbt_backup"
[0m05:13:06.042222 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m05:13:06.043427 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m05:13:06.043683 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */
alter table "airflow"."fact"."fact_waterlevel__dbt_tmp" rename to "fact_waterlevel"
[0m05:13:06.044010 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m05:13:06.050511 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m05:13:06.050742 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m05:13:06.050956 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m05:13:06.059599 [debug] [Thread-1 (]: SQL status: COMMIT in 0.008 seconds
[0m05:13:06.062517 [debug] [Thread-1 (]: Applying DROP to: "airflow"."fact"."fact_waterlevel__dbt_backup"
[0m05:13:06.065631 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m05:13:06.065910 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */
drop table if exists "airflow"."fact"."fact_waterlevel__dbt_backup" cascade
[0m05:13:06.069567 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m05:13:06.070822 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: Close
[0m05:13:06.071687 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be8bd1d4-1459-4674-8cc3-eaa0e1972155', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e881f50>]}
[0m05:13:06.072056 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model fact.fact_waterlevel ................... [[32mSELECT 20649[0m in 0.11s]
[0m05:13:06.072408 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.fact_waterlevel
[0m05:13:06.074360 [debug] [MainThread]: Using postgres connection "master"
[0m05:13:06.074541 [debug] [MainThread]: On master: BEGIN
[0m05:13:06.074682 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:13:06.076793 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m05:13:06.077028 [debug] [MainThread]: On master: COMMIT
[0m05:13:06.077335 [debug] [MainThread]: Using postgres connection "master"
[0m05:13:06.077487 [debug] [MainThread]: On master: COMMIT
[0m05:13:06.077717 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m05:13:06.077917 [debug] [MainThread]: On master: Close
[0m05:13:06.078165 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:13:06.078370 [debug] [MainThread]: Connection 'list_airflow_fact' was properly closed.
[0m05:13:06.078749 [debug] [MainThread]: Connection 'model.etl_waterlevel.fact_waterlevel' was properly closed.
[0m05:13:06.079505 [info ] [MainThread]: 
[0m05:13:06.079970 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.17 seconds (0.17s).
[0m05:13:06.081052 [debug] [MainThread]: Command end result
[0m05:13:06.095086 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m05:13:06.096345 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m05:13:06.100304 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m05:13:06.100508 [info ] [MainThread]: 
[0m05:13:06.100825 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:13:06.101105 [info ] [MainThread]: 
[0m05:13:06.101356 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m05:13:06.101954 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.41104922, "process_in_blocks": "0", "process_kernel_time": 0.113587, "process_mem_max_rss": "115264", "process_out_blocks": "1695", "process_user_time": 0.84294}
[0m05:13:06.102204 [debug] [MainThread]: Command `dbt run` succeeded at 05:13:06.102143 after 0.41 seconds
[0m05:13:06.102426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff903bbf50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91043750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94ec9790>]}
[0m05:13:06.102618 [debug] [MainThread]: Flushing usage events
[0m05:13:07.385213 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m05:13:27.649264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94912b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94bf00d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff949134d0>]}


============================== 05:13:27.650851 | 7b55ebc1-c925-40c3-a520-b79a0af32239 ==============================
[0m05:13:27.650851 [info ] [MainThread]: Running with dbt=1.9.0
[0m05:13:27.651234 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --select fact_waterlevel --full-refresh', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m05:13:27.712977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7b55ebc1-c925-40c3-a520-b79a0af32239', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94c133d0>]}
[0m05:13:27.735187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7b55ebc1-c925-40c3-a520-b79a0af32239', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97347110>]}
[0m05:13:27.735559 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m05:13:27.761715 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m05:13:27.799084 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m05:13:27.799382 [debug] [MainThread]: Partial parsing: updated file: etl_waterlevel://models/facts/fact_waterlevel.sql
[0m05:13:27.897044 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m05:13:27.899499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7b55ebc1-c925-40c3-a520-b79a0af32239', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93aa5090>]}
[0m05:13:27.926978 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m05:13:27.928503 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m05:13:27.934399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7b55ebc1-c925-40c3-a520-b79a0af32239', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9381e050>]}
[0m05:13:27.934656 [info ] [MainThread]: Found 3 models, 434 macros
[0m05:13:27.934913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7b55ebc1-c925-40c3-a520-b79a0af32239', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94910190>]}
[0m05:13:27.935696 [info ] [MainThread]: 
[0m05:13:27.935978 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m05:13:27.936203 [info ] [MainThread]: 
[0m05:13:27.936645 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m05:13:27.937124 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m05:13:27.952944 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m05:13:27.953177 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m05:13:27.953401 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:13:27.956292 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.003 seconds
[0m05:13:27.956924 [debug] [ThreadPool]: On list_airflow: Close
[0m05:13:27.959195 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_fact)
[0m05:13:27.959524 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow_dim'
[0m05:13:27.961988 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m05:13:27.962956 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m05:13:27.963200 [debug] [ThreadPool]: On list_airflow_fact: BEGIN
[0m05:13:27.963452 [debug] [ThreadPool]: On list_airflow_dim: BEGIN
[0m05:13:27.963678 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:13:27.963892 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:13:27.965710 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m05:13:27.966050 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m05:13:27.966205 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m05:13:27.966431 [debug] [ThreadPool]: On list_airflow_fact: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_fact"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'fact'
  
[0m05:13:27.966673 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m05:13:27.967102 [debug] [ThreadPool]: On list_airflow_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dim'
  
[0m05:13:27.968400 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m05:13:27.969018 [debug] [ThreadPool]: On list_airflow_fact: ROLLBACK
[0m05:13:27.969167 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.002 seconds
[0m05:13:27.969420 [debug] [ThreadPool]: On list_airflow_fact: Close
[0m05:13:27.969906 [debug] [ThreadPool]: On list_airflow_dim: ROLLBACK
[0m05:13:27.970586 [debug] [ThreadPool]: On list_airflow_dim: Close
[0m05:13:27.972880 [debug] [MainThread]: Using postgres connection "master"
[0m05:13:27.973108 [debug] [MainThread]: On master: BEGIN
[0m05:13:27.973303 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:13:27.975097 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m05:13:27.975376 [debug] [MainThread]: Using postgres connection "master"
[0m05:13:27.975623 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m05:13:27.977306 [debug] [MainThread]: SQL status: SELECT 0 in 0.001 seconds
[0m05:13:27.977799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7b55ebc1-c925-40c3-a520-b79a0af32239', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92c693d0>]}
[0m05:13:27.978061 [debug] [MainThread]: On master: ROLLBACK
[0m05:13:27.978333 [debug] [MainThread]: Using postgres connection "master"
[0m05:13:27.978523 [debug] [MainThread]: On master: BEGIN
[0m05:13:27.978864 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m05:13:27.979084 [debug] [MainThread]: On master: COMMIT
[0m05:13:27.979267 [debug] [MainThread]: Using postgres connection "master"
[0m05:13:27.979476 [debug] [MainThread]: On master: COMMIT
[0m05:13:27.979744 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m05:13:27.979925 [debug] [MainThread]: On master: Close
[0m05:13:27.981164 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.fact_waterlevel
[0m05:13:27.981486 [info ] [Thread-1 (]: 1 of 1 START sql incremental model fact.fact_waterlevel ........................ [RUN]
[0m05:13:27.981815 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_dim, now model.etl_waterlevel.fact_waterlevel)
[0m05:13:27.982075 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.fact_waterlevel
[0m05:13:27.986929 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.fact_waterlevel"
[0m05:13:27.990440 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.fact_waterlevel
[0m05:13:28.014081 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.fact_waterlevel"
[0m05:13:28.014877 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m05:13:28.015111 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: BEGIN
[0m05:13:28.015351 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:13:28.017090 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m05:13:28.017503 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m05:13:28.017749 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      
  
    

  create  table "airflow"."fact"."fact_waterlevel__dbt_tmp"
  
  
    as
  
  (
    

with main as (
select
    distinct
    concat("stationId",'_',"stationCode") as station_key,
    "stationId" as station_id,
    "stationCode" as station_code,
    "waterLevel" as water_level,
    "waterlevelStatus" as waterlevel_status,
    case
        when "waterlevelStatus" = 3 then '🚨 Beyond Danger'
        when "waterlevelStatus" = 2 then '⚠️ Between Warning and Danger'
        when "waterlevelStatus" = 1 then '🔶 Between Alert and Warning'
        when "waterlevelStatus" = 0 then '✅ Between Normal and Alert'
        when "waterlevelStatus" = -1 then '🟢 Below Normal (Safe)'
        else '❓ Unknown Status'
    end as waterlevel_condition,
    "stationName",
    "districtName",
    to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp AS last_update_my
from
    raw.waterlevels w
where
    "stationStatus" = 1

    

)
select
    *
from
    main
  );
  
  
[0m05:13:28.051400 [debug] [Thread-1 (]: SQL status: SELECT 20649 in 0.033 seconds
[0m05:13:28.055899 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m05:13:28.056167 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */
alter table "airflow"."fact"."fact_waterlevel" rename to "fact_waterlevel__dbt_backup"
[0m05:13:28.056607 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m05:13:28.057909 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m05:13:28.058176 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */
alter table "airflow"."fact"."fact_waterlevel__dbt_tmp" rename to "fact_waterlevel"
[0m05:13:28.058518 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m05:13:28.065184 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m05:13:28.065416 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m05:13:28.065616 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m05:13:28.072552 [debug] [Thread-1 (]: SQL status: COMMIT in 0.007 seconds
[0m05:13:28.075253 [debug] [Thread-1 (]: Applying DROP to: "airflow"."fact"."fact_waterlevel__dbt_backup"
[0m05:13:28.077222 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m05:13:28.077443 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */
drop table if exists "airflow"."fact"."fact_waterlevel__dbt_backup" cascade
[0m05:13:28.078620 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m05:13:28.079797 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: Close
[0m05:13:28.080626 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b55ebc1-c925-40c3-a520-b79a0af32239', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93763350>]}
[0m05:13:28.080987 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model fact.fact_waterlevel ................... [[32mSELECT 20649[0m in 0.10s]
[0m05:13:28.081263 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.fact_waterlevel
[0m05:13:28.082039 [debug] [MainThread]: Using postgres connection "master"
[0m05:13:28.082227 [debug] [MainThread]: On master: BEGIN
[0m05:13:28.082381 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:13:28.083920 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m05:13:28.084172 [debug] [MainThread]: On master: COMMIT
[0m05:13:28.084326 [debug] [MainThread]: Using postgres connection "master"
[0m05:13:28.084517 [debug] [MainThread]: On master: COMMIT
[0m05:13:28.084740 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m05:13:28.084886 [debug] [MainThread]: On master: Close
[0m05:13:28.085082 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:13:28.085224 [debug] [MainThread]: Connection 'list_airflow_fact' was properly closed.
[0m05:13:28.085358 [debug] [MainThread]: Connection 'model.etl_waterlevel.fact_waterlevel' was properly closed.
[0m05:13:28.085505 [info ] [MainThread]: 
[0m05:13:28.085709 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.15 seconds (0.15s).
[0m05:13:28.086156 [debug] [MainThread]: Command end result
[0m05:13:28.126385 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m05:13:28.127492 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m05:13:28.130761 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m05:13:28.130941 [info ] [MainThread]: 
[0m05:13:28.131172 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:13:28.131461 [info ] [MainThread]: 
[0m05:13:28.131691 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m05:13:28.132239 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.5061537, "process_in_blocks": "0", "process_kernel_time": 0.109526, "process_mem_max_rss": "118224", "process_out_blocks": "2520", "process_user_time": 0.939517}
[0m05:13:28.132474 [debug] [MainThread]: Command `dbt run` succeeded at 05:13:28.132436 after 0.51 seconds
[0m05:13:28.132680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff992093d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99208950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99208990>]}
[0m05:13:28.132858 [debug] [MainThread]: Flushing usage events
[0m05:13:29.167695 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:24:35.742809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb023f810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb023c110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb023f010>]}


============================== 11:24:35.744752 | d2e84307-383e-4cb3-a3f2-328a140317b3 ==============================
[0m11:24:35.744752 [info ] [MainThread]: Running with dbt=1.9.0
[0m11:24:35.745131 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/logs', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --select fact_waterlevel --full-refresh', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:24:35.807099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd2e84307-383e-4cb3-a3f2-328a140317b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf640f50>]}
[0m11:24:35.829233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd2e84307-383e-4cb3-a3f2-328a140317b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2ca1710>]}
[0m11:24:35.829750 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m11:24:35.854825 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m11:24:35.892812 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:24:35.893016 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:24:35.895317 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m11:24:35.905075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd2e84307-383e-4cb3-a3f2-328a140317b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf2e05d0>]}
[0m11:24:35.932265 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m11:24:35.933781 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m11:24:35.940177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd2e84307-383e-4cb3-a3f2-328a140317b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf379f50>]}
[0m11:24:35.940421 [info ] [MainThread]: Found 3 models, 434 macros
[0m11:24:35.940603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd2e84307-383e-4cb3-a3f2-328a140317b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb022fb10>]}
[0m11:24:35.941340 [info ] [MainThread]: 
[0m11:24:35.941599 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:24:35.941833 [info ] [MainThread]: 
[0m11:24:35.942181 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:24:35.942740 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m11:24:35.959922 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m11:24:35.960164 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m11:24:35.960383 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:24:35.963368 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.003 seconds
[0m11:24:35.963969 [debug] [ThreadPool]: On list_airflow: Close
[0m11:24:35.966076 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_dim)
[0m11:24:35.966389 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow_fact'
[0m11:24:35.968992 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m11:24:35.969951 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m11:24:35.970182 [debug] [ThreadPool]: On list_airflow_dim: BEGIN
[0m11:24:35.970444 [debug] [ThreadPool]: On list_airflow_fact: BEGIN
[0m11:24:35.970676 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:24:35.970904 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:24:35.972623 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m11:24:35.972801 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m11:24:35.973009 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m11:24:35.973249 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m11:24:35.973511 [debug] [ThreadPool]: On list_airflow_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dim'
  
[0m11:24:35.973782 [debug] [ThreadPool]: On list_airflow_fact: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_fact"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'fact'
  
[0m11:24:35.975338 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m11:24:35.975483 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.001 seconds
[0m11:24:35.976076 [debug] [ThreadPool]: On list_airflow_fact: ROLLBACK
[0m11:24:35.976676 [debug] [ThreadPool]: On list_airflow_dim: ROLLBACK
[0m11:24:35.977002 [debug] [ThreadPool]: On list_airflow_fact: Close
[0m11:24:35.977195 [debug] [ThreadPool]: On list_airflow_dim: Close
[0m11:24:35.979648 [debug] [MainThread]: Using postgres connection "master"
[0m11:24:35.979883 [debug] [MainThread]: On master: BEGIN
[0m11:24:35.980052 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:24:35.981505 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m11:24:35.981746 [debug] [MainThread]: Using postgres connection "master"
[0m11:24:35.981980 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:24:35.983481 [debug] [MainThread]: SQL status: SELECT 0 in 0.001 seconds
[0m11:24:35.983982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd2e84307-383e-4cb3-a3f2-328a140317b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae7dfad0>]}
[0m11:24:35.984232 [debug] [MainThread]: On master: ROLLBACK
[0m11:24:35.984522 [debug] [MainThread]: Using postgres connection "master"
[0m11:24:35.984697 [debug] [MainThread]: On master: BEGIN
[0m11:24:35.985031 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m11:24:35.985278 [debug] [MainThread]: On master: COMMIT
[0m11:24:35.985485 [debug] [MainThread]: Using postgres connection "master"
[0m11:24:35.985660 [debug] [MainThread]: On master: COMMIT
[0m11:24:35.985922 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:24:35.986104 [debug] [MainThread]: On master: Close
[0m11:24:35.987415 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.fact_waterlevel
[0m11:24:35.987716 [info ] [Thread-1 (]: 1 of 1 START sql incremental model fact.fact_waterlevel ........................ [RUN]
[0m11:24:35.988016 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_dim, now model.etl_waterlevel.fact_waterlevel)
[0m11:24:35.988260 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.fact_waterlevel
[0m11:24:35.994126 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.fact_waterlevel"
[0m11:24:35.995111 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.fact_waterlevel
[0m11:24:36.017740 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.fact_waterlevel"
[0m11:24:36.018680 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m11:24:36.018901 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: BEGIN
[0m11:24:36.019112 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:24:36.020909 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m11:24:36.021166 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m11:24:36.021437 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      
  
    

  create  table "airflow"."fact"."fact_waterlevel__dbt_tmp"
  
  
    as
  
  (
    

with main as (
select
    distinct
    concat("stationId",'_',"stationCode") as station_key,
    "stationId" as station_id,
    "stationCode" as station_code,
    "waterLevel" as water_level,
    "waterlevelStatus" as waterlevel_status,
    case
        when "waterlevelStatus" = 3 then '🚨 Beyond Danger'
        when "waterlevelStatus" = 2 then '⚠️ Between Warning and Danger'
        when "waterlevelStatus" = 1 then '🔶 Between Alert and Warning'
        when "waterlevelStatus" = 0 then '✅ Between Normal and Alert'
        when "waterlevelStatus" = -1 then '🟢 Below Normal (Safe)'
        else '❓ Unknown Status'
    end as waterlevel_condition,
    "stationName",
    "districtName",
    to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp AS last_update_my
from
    raw.waterlevels w
where
    "stationStatus" = 1

    

)
select
    *
from
    main
  );
  
  
[0m11:24:36.060078 [debug] [Thread-1 (]: SQL status: SELECT 21080 in 0.038 seconds
[0m11:24:36.064438 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m11:24:36.064677 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */
alter table "airflow"."fact"."fact_waterlevel" rename to "fact_waterlevel__dbt_backup"
[0m11:24:36.065113 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:24:36.066348 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m11:24:36.066596 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */
alter table "airflow"."fact"."fact_waterlevel__dbt_tmp" rename to "fact_waterlevel"
[0m11:24:36.066917 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:24:36.073429 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m11:24:36.073662 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m11:24:36.073860 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m11:24:36.080699 [debug] [Thread-1 (]: SQL status: COMMIT in 0.007 seconds
[0m11:24:36.083324 [debug] [Thread-1 (]: Applying DROP to: "airflow"."fact"."fact_waterlevel__dbt_backup"
[0m11:24:36.086070 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m11:24:36.086300 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */
drop table if exists "airflow"."fact"."fact_waterlevel__dbt_backup" cascade
[0m11:24:36.087961 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m11:24:36.089061 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: Close
[0m11:24:36.089877 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2e84307-383e-4cb3-a3f2-328a140317b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae5f5910>]}
[0m11:24:36.090229 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model fact.fact_waterlevel ................... [[32mSELECT 21080[0m in 0.10s]
[0m11:24:36.090514 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.fact_waterlevel
[0m11:24:36.091401 [debug] [MainThread]: Using postgres connection "master"
[0m11:24:36.091593 [debug] [MainThread]: On master: BEGIN
[0m11:24:36.091749 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:24:36.093205 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m11:24:36.093422 [debug] [MainThread]: On master: COMMIT
[0m11:24:36.093579 [debug] [MainThread]: Using postgres connection "master"
[0m11:24:36.093712 [debug] [MainThread]: On master: COMMIT
[0m11:24:36.093887 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:24:36.094013 [debug] [MainThread]: On master: Close
[0m11:24:36.094195 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:24:36.094340 [debug] [MainThread]: Connection 'model.etl_waterlevel.fact_waterlevel' was properly closed.
[0m11:24:36.094463 [debug] [MainThread]: Connection 'list_airflow_fact' was properly closed.
[0m11:24:36.094620 [info ] [MainThread]: 
[0m11:24:36.094817 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.15 seconds (0.15s).
[0m11:24:36.095219 [debug] [MainThread]: Command end result
[0m11:24:36.107624 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m11:24:36.108473 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m11:24:36.111396 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m11:24:36.111631 [info ] [MainThread]: 
[0m11:24:36.111989 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:24:36.112306 [info ] [MainThread]: 
[0m11:24:36.112667 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:24:36.113602 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.39358804, "process_in_blocks": "0", "process_kernel_time": 0.118828, "process_mem_max_rss": "115028", "process_out_blocks": "1692", "process_user_time": 0.816823}
[0m11:24:36.114022 [debug] [MainThread]: Command `dbt run` succeeded at 11:24:36.113953 after 0.39 seconds
[0m11:24:36.114438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4b65650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4b64810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4b657d0>]}
[0m11:24:36.114704 [debug] [MainThread]: Flushing usage events
[0m11:24:37.604887 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:28:55.324388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac637790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac463450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac636ad0>]}


============================== 11:28:55.325801 | 584a43fc-0ab7-442b-b6ed-2e767d287e5f ==============================
[0m11:28:55.325801 [info ] [MainThread]: Running with dbt=1.9.0
[0m11:28:55.326323 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select fact_waterlevel --full-refresh', 'send_anonymous_usage_stats': 'True'}
[0m11:28:55.391939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '584a43fc-0ab7-442b-b6ed-2e767d287e5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac849ad0>]}
[0m11:28:55.414025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '584a43fc-0ab7-442b-b6ed-2e767d287e5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf0c9790>]}
[0m11:28:55.414432 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m11:28:55.439276 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m11:28:55.475444 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:28:55.475731 [debug] [MainThread]: Partial parsing: updated file: etl_waterlevel://models/facts/fact_waterlevel.sql
[0m11:28:55.565334 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m11:28:55.567689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '584a43fc-0ab7-442b-b6ed-2e767d287e5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab673c10>]}
[0m11:28:55.594995 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m11:28:55.596458 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m11:28:55.601836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '584a43fc-0ab7-442b-b6ed-2e767d287e5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab56e690>]}
[0m11:28:55.602075 [info ] [MainThread]: Found 3 models, 434 macros
[0m11:28:55.602288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '584a43fc-0ab7-442b-b6ed-2e767d287e5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab4da1d0>]}
[0m11:28:55.603050 [info ] [MainThread]: 
[0m11:28:55.603297 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:28:55.603525 [info ] [MainThread]: 
[0m11:28:55.603852 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:28:55.604305 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m11:28:55.618212 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m11:28:55.618469 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m11:28:55.618675 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:28:55.621466 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.003 seconds
[0m11:28:55.622047 [debug] [ThreadPool]: On list_airflow: Close
[0m11:28:55.624133 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_fact)
[0m11:28:55.624460 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow_dim'
[0m11:28:55.626919 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m11:28:55.627883 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m11:28:55.628124 [debug] [ThreadPool]: On list_airflow_fact: BEGIN
[0m11:28:55.628425 [debug] [ThreadPool]: On list_airflow_dim: BEGIN
[0m11:28:55.628649 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:28:55.628874 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:28:55.630625 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m11:28:55.630936 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m11:28:55.631081 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m11:28:55.631301 [debug] [ThreadPool]: On list_airflow_fact: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_fact"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'fact'
  
[0m11:28:55.631559 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m11:28:55.631934 [debug] [ThreadPool]: On list_airflow_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dim'
  
[0m11:28:55.633249 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m11:28:55.633858 [debug] [ThreadPool]: On list_airflow_fact: ROLLBACK
[0m11:28:55.633996 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.002 seconds
[0m11:28:55.634291 [debug] [ThreadPool]: On list_airflow_fact: Close
[0m11:28:55.634757 [debug] [ThreadPool]: On list_airflow_dim: ROLLBACK
[0m11:28:55.635380 [debug] [ThreadPool]: On list_airflow_dim: Close
[0m11:28:55.637635 [debug] [MainThread]: Using postgres connection "master"
[0m11:28:55.637823 [debug] [MainThread]: On master: BEGIN
[0m11:28:55.637990 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:28:55.639385 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m11:28:55.639652 [debug] [MainThread]: Using postgres connection "master"
[0m11:28:55.639882 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:28:55.641263 [debug] [MainThread]: SQL status: SELECT 0 in 0.001 seconds
[0m11:28:55.641747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '584a43fc-0ab7-442b-b6ed-2e767d287e5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa89ae50>]}
[0m11:28:55.641996 [debug] [MainThread]: On master: ROLLBACK
[0m11:28:55.642280 [debug] [MainThread]: Using postgres connection "master"
[0m11:28:55.642460 [debug] [MainThread]: On master: BEGIN
[0m11:28:55.642796 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m11:28:55.643038 [debug] [MainThread]: On master: COMMIT
[0m11:28:55.643214 [debug] [MainThread]: Using postgres connection "master"
[0m11:28:55.643395 [debug] [MainThread]: On master: COMMIT
[0m11:28:55.643644 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:28:55.643826 [debug] [MainThread]: On master: Close
[0m11:28:55.645091 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.fact_waterlevel
[0m11:28:55.645394 [info ] [Thread-1 (]: 1 of 1 START sql incremental model fact.fact_waterlevel ........................ [RUN]
[0m11:28:55.645717 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_dim, now model.etl_waterlevel.fact_waterlevel)
[0m11:28:55.645929 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.fact_waterlevel
[0m11:28:55.650794 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.fact_waterlevel"
[0m11:28:55.651512 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.fact_waterlevel
[0m11:28:55.673906 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.fact_waterlevel"
[0m11:28:55.674633 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m11:28:55.674854 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: BEGIN
[0m11:28:55.675062 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:28:55.676948 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m11:28:55.677177 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m11:28:55.677405 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      
  
    

  create  table "airflow"."fact"."fact_waterlevel__dbt_tmp"
  
  
    as
  
  (
    

with main as (
select
    distinct
    concat("stationId",'_',"stationCode") as station_key,
    "stationId" as station_id,
    "stationCode" as station_code,
    "waterLevel" as water_level,
    "waterlevelStatus" as waterlevel_status,
    case
        when "waterlevelStatus" = 3 then '🚨 Beyond Danger'
        when "waterlevelStatus" = 2 then '⚠️ Between Warning and Danger'
        when "waterlevelStatus" = 1 then '🔶 Between Alert and Warning'
        when "waterlevelStatus" = 0 then '✅ Between Normal and Alert'
        when "waterlevelStatus" = -1 then '🟢 Below Normal (Safe)'
        else '❓ Unknown Status'
    end as waterlevel_condition,
    "stationName",
    "districtName",
    to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp AS last_update
from
    raw.waterlevels w
where
    "stationStatus" = 1

    

)
select
    *
from
    main
  );
  
  
[0m11:28:55.711285 [debug] [Thread-1 (]: SQL status: SELECT 21080 in 0.034 seconds
[0m11:28:55.715495 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m11:28:55.715717 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */
alter table "airflow"."fact"."fact_waterlevel" rename to "fact_waterlevel__dbt_backup"
[0m11:28:55.716094 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:28:55.717314 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m11:28:55.717519 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */
alter table "airflow"."fact"."fact_waterlevel__dbt_tmp" rename to "fact_waterlevel"
[0m11:28:55.717859 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:28:55.724282 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m11:28:55.724503 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m11:28:55.724699 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m11:28:55.732168 [debug] [Thread-1 (]: SQL status: COMMIT in 0.007 seconds
[0m11:28:55.735046 [debug] [Thread-1 (]: Applying DROP to: "airflow"."fact"."fact_waterlevel__dbt_backup"
[0m11:28:55.737247 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m11:28:55.737496 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */
drop table if exists "airflow"."fact"."fact_waterlevel__dbt_backup" cascade
[0m11:28:55.738757 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m11:28:55.739955 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: Close
[0m11:28:55.740771 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '584a43fc-0ab7-442b-b6ed-2e767d287e5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab838290>]}
[0m11:28:55.741129 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model fact.fact_waterlevel ................... [[32mSELECT 21080[0m in 0.09s]
[0m11:28:55.741616 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.fact_waterlevel
[0m11:28:55.742548 [debug] [MainThread]: Using postgres connection "master"
[0m11:28:55.742718 [debug] [MainThread]: On master: BEGIN
[0m11:28:55.742849 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:28:55.744762 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m11:28:55.744992 [debug] [MainThread]: On master: COMMIT
[0m11:28:55.745261 [debug] [MainThread]: Using postgres connection "master"
[0m11:28:55.745450 [debug] [MainThread]: On master: COMMIT
[0m11:28:55.745653 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:28:55.745789 [debug] [MainThread]: On master: Close
[0m11:28:55.745975 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:28:55.746123 [debug] [MainThread]: Connection 'list_airflow_fact' was properly closed.
[0m11:28:55.746322 [debug] [MainThread]: Connection 'model.etl_waterlevel.fact_waterlevel' was properly closed.
[0m11:28:55.746501 [info ] [MainThread]: 
[0m11:28:55.746819 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.14 seconds (0.14s).
[0m11:28:55.747592 [debug] [MainThread]: Command end result
[0m11:28:55.789394 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m11:28:55.790517 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m11:28:55.793744 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m11:28:55.793943 [info ] [MainThread]: 
[0m11:28:55.794204 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:28:55.794560 [info ] [MainThread]: 
[0m11:28:55.794846 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:28:55.795418 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.4922499, "process_in_blocks": "0", "process_kernel_time": 0.091329, "process_mem_max_rss": "118228", "process_out_blocks": "2520", "process_user_time": 0.914301}
[0m11:28:55.795620 [debug] [MainThread]: Command `dbt run` succeeded at 11:28:55.795583 after 0.49 seconds
[0m11:28:55.795806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac4aff50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac4ade10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad6ba9d0>]}
[0m11:28:55.795979 [debug] [MainThread]: Flushing usage events
[0m11:28:57.020729 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:05:05.667733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1b403a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0c34520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0c34580>]}


============================== 06:05:05.671063 | 7195e911-1244-4767-994c-90979a07a33f ==============================
[0m06:05:05.671063 [info ] [MainThread]: Running with dbt=1.9.0
[0m06:05:05.671491 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'version_check': 'True', 'profiles_dir': '/home/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --models fact_waterlevel', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:05:05.673047 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'etl_waterlevel'
[0m06:05:05.673582 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.033126585, "process_in_blocks": "0", "process_kernel_time": 0.056937, "process_mem_max_rss": "90608", "process_out_blocks": "930", "process_user_time": 0.875039}
[0m06:05:05.673954 [debug] [MainThread]: Command `dbt run` failed at 06:05:05.673907 after 0.03 seconds
[0m06:05:05.674193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1b403a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0c877c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0c87250>]}
[0m06:05:05.674464 [debug] [MainThread]: Flushing usage events
[0m06:05:07.122939 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:06:09.241269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c4642e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b553d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b553cd0>]}


============================== 06:06:09.244271 | c609297b-9844-483f-b471-d90a6b93546b ==============================
[0m06:06:09.244271 [info ] [MainThread]: Running with dbt=1.9.0
[0m06:06:09.244648 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'debug': 'False', 'profiles_dir': '/home/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --models fact_waterlevel', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:06:09.246109 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'etl_waterlevel'
[0m06:06:09.246627 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.031391084, "process_in_blocks": "0", "process_kernel_time": 0.036998, "process_mem_max_rss": "90620", "process_out_blocks": "2", "process_user_time": 0.829972}
[0m06:06:09.246995 [debug] [MainThread]: Command `dbt run` failed at 06:06:09.246943 after 0.03 seconds
[0m06:06:09.247265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c4642e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b597700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b597190>]}
[0m06:06:09.247534 [debug] [MainThread]: Flushing usage events
[0m06:06:10.475241 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:07:11.759625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa72842e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa63644f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6364550>]}


============================== 06:07:11.762611 | bf749680-cb7a-48ca-80aa-9b3d6e7d6cf5 ==============================
[0m06:07:11.762611 [info ] [MainThread]: Running with dbt=1.9.0
[0m06:07:11.762984 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --models fact_waterlevel', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:07:11.764449 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'etl_waterlevel'
[0m06:07:11.764980 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.031066084, "process_in_blocks": "0", "process_kernel_time": 0.056118, "process_mem_max_rss": "90760", "process_out_blocks": "2", "process_user_time": 0.84077}
[0m06:07:11.765399 [debug] [MainThread]: Command `dbt run` failed at 06:07:11.765351 after 0.03 seconds
[0m06:07:11.765661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa72842e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa63b3700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa63b3190>]}
[0m06:07:11.765941 [debug] [MainThread]: Flushing usage events
[0m06:07:13.142222 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:08:14.361420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab278340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa367dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa367d60>]}


============================== 06:08:14.364430 | 934d8ded-88af-4257-b387-2123ecfcc36c ==============================
[0m06:08:14.364430 [info ] [MainThread]: Running with dbt=1.9.0
[0m06:08:14.364832 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --models fact_waterlevel', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:08:14.366282 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'etl_waterlevel'
[0m06:08:14.366810 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.031274334, "process_in_blocks": "0", "process_kernel_time": 0.035958, "process_mem_max_rss": "90820", "process_out_blocks": "2", "process_user_time": 0.837037}
[0m06:08:14.367162 [debug] [MainThread]: Command `dbt run` failed at 06:08:14.367114 after 0.03 seconds
[0m06:08:14.367439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab278340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa3abaf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa3a9900>]}
[0m06:08:14.367742 [debug] [MainThread]: Flushing usage events
[0m06:08:15.509763 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:12:56.810190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8df84550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d017f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d017f10>]}


============================== 06:12:56.813162 | 1862218f-036f-4087-b4d1-c0bba67bf290 ==============================
[0m06:12:56.813162 [info ] [MainThread]: Running with dbt=1.9.0
[0m06:12:56.813719 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models fact_waterlevel', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:12:56.815276 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'etl_waterlevel'
[0m06:12:56.815953 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.031215541, "process_in_blocks": "0", "process_kernel_time": 0.032107, "process_mem_max_rss": "90512", "process_out_blocks": "2", "process_user_time": 0.833789}
[0m06:12:56.816352 [debug] [MainThread]: Command `dbt run` failed at 06:12:56.816303 after 0.03 seconds
[0m06:12:56.816627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8df84550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d0bf9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d0bf430>]}
[0m06:12:56.816914 [debug] [MainThread]: Flushing usage events
[0m06:12:58.073273 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:13:52.650559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9668c5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9571bfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9571bf70>]}


============================== 06:13:52.653532 | 3e3c5dac-5117-473d-a28b-6fecbb485d6c ==============================
[0m06:13:52.653532 [info ] [MainThread]: Running with dbt=1.9.0
[0m06:13:52.654010 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --models fact_waterlevel', 'send_anonymous_usage_stats': 'True'}
[0m06:13:52.655580 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'etl_waterlevel'
[0m06:13:52.656173 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.03200767, "process_in_blocks": "0", "process_kernel_time": 0.042031, "process_mem_max_rss": "90696", "process_out_blocks": "2", "process_user_time": 0.827615}
[0m06:13:52.656557 [debug] [MainThread]: Command `dbt run` failed at 06:13:52.656496 after 0.03 seconds
[0m06:13:52.656887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9668c5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff957c3a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff957c3490>]}
[0m06:13:52.657169 [debug] [MainThread]: Flushing usage events
[0m06:13:53.983332 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:16:38.311640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1128faa50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11294b6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112976fd0>]}


============================== 14:16:38.313665 | 7eafdc5f-839f-49ab-b5e9-701422f5c451 ==============================
[0m14:16:38.313665 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:16:38.313991 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/aiman/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/aiman/DE_Projects/etl_waterlevel/transform/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:16:38.317805 [info ] [MainThread]: dbt version: 1.9.3
[0m14:16:38.318010 [info ] [MainThread]: python version: 3.11.3
[0m14:16:38.318178 [info ] [MainThread]: python path: /Users/aiman/DE_Projects/etl_waterlevel/venv/bin/python3.11
[0m14:16:38.318326 [info ] [MainThread]: os info: macOS-15.4-arm64-arm-64bit
[0m14:16:38.318482 [info ] [MainThread]: Using profiles dir at /Users/aiman/.dbt
[0m14:16:38.318627 [info ] [MainThread]: Using profiles.yml file at /Users/aiman/.dbt/profiles.yml
[0m14:16:38.318829 [info ] [MainThread]: Using dbt_project.yml file at /Users/aiman/DE_Projects/etl_waterlevel/transform/dbt_project.yml
[0m14:16:38.358138 [info ] [MainThread]: Configuration:
[0m14:16:38.358388 [info ] [MainThread]:   profiles.yml file [[31mERROR not found[0m]
[0m14:16:38.358551 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m14:16:38.358690 [info ] [MainThread]: Required dependencies:
[0m14:16:38.358877 [debug] [MainThread]: Executing "git --help"
[0m14:16:38.368778 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m14:16:38.369220 [debug] [MainThread]: STDERR: "b''"
[0m14:16:38.369377 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m14:16:38.369545 [info ] [MainThread]: Connection test skipped since no profile was found
[0m14:16:38.369698 [info ] [MainThread]: [31m1 check failed:[0m
[0m14:16:38.369842 [info ] [MainThread]: dbt looked for a profiles.yml file in /Users/aiman/.dbt/profiles.yml, but did
not find one. For more information on configuring your profile, consult the
documentation:

https://docs.getdbt.com/docs/configure-your-profile


[0m14:16:38.371140 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.087540664, "process_in_blocks": "0", "process_kernel_time": 0.092194, "process_mem_max_rss": "106250240", "process_out_blocks": "0", "process_user_time": 0.596999}
[0m14:16:38.371370 [debug] [MainThread]: Command `dbt debug` failed at 14:16:38.371316 after 0.09 seconds
[0m14:16:38.371671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d93ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e34750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112906850>]}
[0m14:16:38.371897 [debug] [MainThread]: Flushing usage events
[0m14:16:39.668793 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:00:15.230510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb20883a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1164550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1164580>]}


============================== 07:00:15.234066 | 4e0512b0-330c-4f18-9f97-2d542d4f662c ==============================
[0m07:00:15.234066 [info ] [MainThread]: Running with dbt=1.9.0
[0m07:00:15.234450 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select tag:static', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m07:00:15.330185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4e0512b0-330c-4f18-9f97-2d542d4f662c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb43f4d30>]}
[0m07:00:15.360774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4e0512b0-330c-4f18-9f97-2d542d4f662c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1f44760>]}
[0m07:00:15.361584 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m07:00:15.402143 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m07:00:15.440081 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m07:00:15.440646 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m07:00:15.440982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4e0512b0-330c-4f18-9f97-2d542d4f662c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1a2ee00>]}
[0m07:00:15.902586 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m07:00:15.905316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4e0512b0-330c-4f18-9f97-2d542d4f662c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb02edd80>]}
[0m07:00:15.941491 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m07:00:15.945547 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m07:00:15.955333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4e0512b0-330c-4f18-9f97-2d542d4f662c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb02ed480>]}
[0m07:00:15.955667 [info ] [MainThread]: Found 3 models, 434 macros
[0m07:00:15.955898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4e0512b0-330c-4f18-9f97-2d542d4f662c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb02edfc0>]}
[0m07:00:15.956739 [info ] [MainThread]: 
[0m07:00:15.957041 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:00:15.957298 [info ] [MainThread]: 
[0m07:00:15.957696 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:00:15.960056 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m07:00:15.978708 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m07:00:15.979093 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m07:00:15.979378 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:00:15.983305 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.004 seconds
[0m07:00:15.984086 [debug] [ThreadPool]: On list_airflow: Close
[0m07:00:15.985186 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_dim)
[0m07:00:15.988866 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m07:00:15.989156 [debug] [ThreadPool]: On list_airflow_dim: BEGIN
[0m07:00:15.989436 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:00:15.991099 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m07:00:15.991406 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m07:00:15.991676 [debug] [ThreadPool]: On list_airflow_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dim'
  
[0m07:00:15.993136 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.001 seconds
[0m07:00:15.993842 [debug] [ThreadPool]: On list_airflow_dim: ROLLBACK
[0m07:00:15.994198 [debug] [ThreadPool]: On list_airflow_dim: Close
[0m07:00:15.994636 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_dim, now list_airflow_fact)
[0m07:00:15.996060 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m07:00:15.996318 [debug] [ThreadPool]: On list_airflow_fact: BEGIN
[0m07:00:15.996554 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:00:15.998062 [debug] [ThreadPool]: SQL status: BEGIN in 0.001 seconds
[0m07:00:15.998323 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m07:00:15.998582 [debug] [ThreadPool]: On list_airflow_fact: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_fact"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'fact'
  
[0m07:00:15.999767 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m07:00:16.000399 [debug] [ThreadPool]: On list_airflow_fact: ROLLBACK
[0m07:00:16.000726 [debug] [ThreadPool]: On list_airflow_fact: Close
[0m07:00:16.003184 [debug] [MainThread]: Using postgres connection "master"
[0m07:00:16.003453 [debug] [MainThread]: On master: BEGIN
[0m07:00:16.003690 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:00:16.005334 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m07:00:16.005604 [debug] [MainThread]: Using postgres connection "master"
[0m07:00:16.005905 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:00:16.008887 [debug] [MainThread]: SQL status: SELECT 1 in 0.003 seconds
[0m07:00:16.009566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4e0512b0-330c-4f18-9f97-2d542d4f662c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0307f40>]}
[0m07:00:16.009930 [debug] [MainThread]: On master: ROLLBACK
[0m07:00:16.010281 [debug] [MainThread]: Using postgres connection "master"
[0m07:00:16.010518 [debug] [MainThread]: On master: BEGIN
[0m07:00:16.010927 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m07:00:16.011196 [debug] [MainThread]: On master: COMMIT
[0m07:00:16.011436 [debug] [MainThread]: Using postgres connection "master"
[0m07:00:16.011669 [debug] [MainThread]: On master: COMMIT
[0m07:00:16.011985 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:00:16.012247 [debug] [MainThread]: On master: Close
[0m07:00:16.013436 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.dim_stations
[0m07:00:16.013815 [info ] [Thread-1 (]: 1 of 2 START sql view model dim.dim_stations ................................... [RUN]
[0m07:00:16.014134 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_fact, now model.etl_waterlevel.dim_stations)
[0m07:00:16.014405 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.dim_stations
[0m07:00:16.018628 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.dim_stations"
[0m07:00:16.020516 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.dim_stations
[0m07:00:16.037713 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.dim_stations"
[0m07:00:16.038800 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m07:00:16.039055 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: BEGIN
[0m07:00:16.039273 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:00:16.040823 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m07:00:16.041107 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m07:00:16.041383 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.dim_stations"} */

  create view "airflow"."dim"."dim_stations__dbt_tmp"
    
    
  as (
    


with station_names as (
select
	distinct
  "stationId" as station_id,
	"stationName" as station_name,
	"stationCode" as station_code,
	"districtName" as district_name,
	"latitude" as latitude,
	"longitude" as longitude,
	"stationStatus" as station_status
from
	raw.waterlevels
)

select
	*
from
	station_names
order by
	district_name,
	station_code asc
  );
[0m07:00:16.043122 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m07:00:16.046965 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m07:00:16.047266 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.dim_stations"} */
alter table "airflow"."dim"."dim_stations" rename to "dim_stations__dbt_backup"
[0m07:00:16.047691 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:00:16.049183 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m07:00:16.049447 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.dim_stations"} */
alter table "airflow"."dim"."dim_stations__dbt_tmp" rename to "dim_stations"
[0m07:00:16.049884 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:00:16.058384 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: COMMIT
[0m07:00:16.058689 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m07:00:16.058970 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: COMMIT
[0m07:00:16.059926 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m07:00:16.062976 [debug] [Thread-1 (]: Applying DROP to: "airflow"."dim"."dim_stations__dbt_backup"
[0m07:00:16.065200 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_stations"
[0m07:00:16.065473 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.dim_stations"} */
drop table if exists "airflow"."dim"."dim_stations__dbt_backup" cascade
[0m07:00:16.066643 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m07:00:16.068083 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_stations: Close
[0m07:00:16.069254 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e0512b0-330c-4f18-9f97-2d542d4f662c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaff122c0>]}
[0m07:00:16.069698 [info ] [Thread-1 (]: 1 of 2 OK created sql view model dim.dim_stations .............................. [[32mCREATE VIEW[0m in 0.05s]
[0m07:00:16.070080 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.dim_stations
[0m07:00:16.070355 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.dim_threshold
[0m07:00:16.070693 [info ] [Thread-1 (]: 2 of 2 START sql view model dim.dim_threshold .................................. [RUN]
[0m07:00:16.070983 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.etl_waterlevel.dim_stations, now model.etl_waterlevel.dim_threshold)
[0m07:00:16.071232 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.dim_threshold
[0m07:00:16.072857 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.dim_threshold"
[0m07:00:16.074031 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.dim_threshold
[0m07:00:16.076058 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.dim_threshold"
[0m07:00:16.076682 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_threshold"
[0m07:00:16.076944 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_threshold: BEGIN
[0m07:00:16.077187 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:00:16.078905 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m07:00:16.079219 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_threshold"
[0m07:00:16.079485 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_threshold: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.dim_threshold"} */

  create view "airflow"."dim"."dim_threshold__dbt_tmp"
    
    
  as (
    


select
	distinct 
	concat("stationId",'_',"stationCode") as station_key,
	wlth_normal,
	wlth_alert,
	wlth_warning,
	wlth_danger
from
	raw.waterlevels w
order by
	"station_key" asc
  );
[0m07:00:16.080561 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m07:00:16.082315 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_threshold"
[0m07:00:16.082591 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_threshold: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.dim_threshold"} */
alter table "airflow"."dim"."dim_threshold" rename to "dim_threshold__dbt_backup"
[0m07:00:16.082975 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:00:16.084505 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_threshold"
[0m07:00:16.084752 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_threshold: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.dim_threshold"} */
alter table "airflow"."dim"."dim_threshold__dbt_tmp" rename to "dim_threshold"
[0m07:00:16.085198 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:00:16.086739 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_threshold: COMMIT
[0m07:00:16.087065 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_threshold"
[0m07:00:16.087372 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_threshold: COMMIT
[0m07:00:16.088121 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m07:00:16.116374 [debug] [Thread-1 (]: Applying DROP to: "airflow"."dim"."dim_threshold__dbt_backup"
[0m07:00:16.117893 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.dim_threshold"
[0m07:00:16.118245 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_threshold: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.dim_threshold"} */
drop view if exists "airflow"."dim"."dim_threshold__dbt_backup" cascade
[0m07:00:16.119495 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m07:00:16.120289 [debug] [Thread-1 (]: On model.etl_waterlevel.dim_threshold: Close
[0m07:00:16.120742 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e0512b0-330c-4f18-9f97-2d542d4f662c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2410670>]}
[0m07:00:16.121228 [info ] [Thread-1 (]: 2 of 2 OK created sql view model dim.dim_threshold ............................. [[32mCREATE VIEW[0m in 0.05s]
[0m07:00:16.121634 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.dim_threshold
[0m07:00:16.122341 [debug] [MainThread]: Using postgres connection "master"
[0m07:00:16.122618 [debug] [MainThread]: On master: BEGIN
[0m07:00:16.122849 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:00:16.124502 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m07:00:16.124753 [debug] [MainThread]: On master: COMMIT
[0m07:00:16.124988 [debug] [MainThread]: Using postgres connection "master"
[0m07:00:16.125247 [debug] [MainThread]: On master: COMMIT
[0m07:00:16.125539 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:00:16.125806 [debug] [MainThread]: On master: Close
[0m07:00:16.126132 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:00:16.126381 [debug] [MainThread]: Connection 'model.etl_waterlevel.dim_threshold' was properly closed.
[0m07:00:16.126693 [info ] [MainThread]: 
[0m07:00:16.126980 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.17 seconds (0.17s).
[0m07:00:16.127477 [debug] [MainThread]: Command end result
[0m07:00:16.142949 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m07:00:16.144143 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m07:00:16.147892 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m07:00:16.148123 [info ] [MainThread]: 
[0m07:00:16.148379 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:00:16.148593 [info ] [MainThread]: 
[0m07:00:16.148804 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m07:00:16.149336 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.9475289, "process_in_blocks": "0", "process_kernel_time": 0.170913, "process_mem_max_rss": "114652", "process_out_blocks": "3468", "process_user_time": 1.75683}
[0m07:00:16.149652 [debug] [MainThread]: Command `dbt run` succeeded at 07:00:16.149609 after 0.95 seconds
[0m07:00:16.149883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb20883a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb361e5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0324f40>]}
[0m07:00:16.150161 [debug] [MainThread]: Flushing usage events
[0m07:00:17.474774 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:05:05.672844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3f88340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3077d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3077d30>]}


============================== 07:05:05.677292 | c95c2db3-db73-4f6d-9ec6-bf61b5377280 ==============================
[0m07:05:05.677292 [info ] [MainThread]: Running with dbt=1.9.0
[0m07:05:05.677744 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --models fact_waterlevel', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m07:05:05.771825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c95c2db3-db73-4f6d-9ec6-bf61b5377280', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb619e7a0>]}
[0m07:05:05.798836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c95c2db3-db73-4f6d-9ec6-bf61b5377280', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3e4a7a0>]}
[0m07:05:05.799347 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m07:05:05.834540 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m07:05:05.884882 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:05:05.885213 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:05:05.888385 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m07:05:05.900162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c95c2db3-db73-4f6d-9ec6-bf61b5377280', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb22cc580>]}
[0m07:05:05.936256 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m07:05:05.940209 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m07:05:05.949807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c95c2db3-db73-4f6d-9ec6-bf61b5377280', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb22eb220>]}
[0m07:05:05.950132 [info ] [MainThread]: Found 3 models, 434 macros
[0m07:05:05.950360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c95c2db3-db73-4f6d-9ec6-bf61b5377280', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb22eb1c0>]}
[0m07:05:05.951021 [info ] [MainThread]: 
[0m07:05:05.951281 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:05:05.951503 [info ] [MainThread]: 
[0m07:05:05.951954 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:05:05.952558 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m07:05:05.992479 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m07:05:05.992884 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m07:05:05.993177 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:05:05.996369 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.003 seconds
[0m07:05:05.997127 [debug] [ThreadPool]: On list_airflow: Close
[0m07:05:05.999749 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_dim)
[0m07:05:06.002942 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m07:05:06.003230 [debug] [ThreadPool]: On list_airflow_dim: BEGIN
[0m07:05:06.003481 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:05:06.005127 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m07:05:06.005429 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m07:05:06.005697 [debug] [ThreadPool]: On list_airflow_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dim'
  
[0m07:05:06.007183 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.001 seconds
[0m07:05:06.007850 [debug] [ThreadPool]: On list_airflow_dim: ROLLBACK
[0m07:05:06.008179 [debug] [ThreadPool]: On list_airflow_dim: Close
[0m07:05:06.008582 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_dim, now list_airflow_fact)
[0m07:05:06.010044 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m07:05:06.010303 [debug] [ThreadPool]: On list_airflow_fact: BEGIN
[0m07:05:06.010537 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:05:06.012028 [debug] [ThreadPool]: SQL status: BEGIN in 0.001 seconds
[0m07:05:06.012291 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m07:05:06.012543 [debug] [ThreadPool]: On list_airflow_fact: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_fact"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'fact'
  
[0m07:05:06.013750 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m07:05:06.014351 [debug] [ThreadPool]: On list_airflow_fact: ROLLBACK
[0m07:05:06.014660 [debug] [ThreadPool]: On list_airflow_fact: Close
[0m07:05:06.017122 [debug] [MainThread]: Using postgres connection "master"
[0m07:05:06.017409 [debug] [MainThread]: On master: BEGIN
[0m07:05:06.017660 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:05:06.019036 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m07:05:06.019331 [debug] [MainThread]: Using postgres connection "master"
[0m07:05:06.019617 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:05:06.023014 [debug] [MainThread]: SQL status: SELECT 2 in 0.003 seconds
[0m07:05:06.023681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c95c2db3-db73-4f6d-9ec6-bf61b5377280', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb22ead10>]}
[0m07:05:06.024036 [debug] [MainThread]: On master: ROLLBACK
[0m07:05:06.024365 [debug] [MainThread]: Using postgres connection "master"
[0m07:05:06.024611 [debug] [MainThread]: On master: BEGIN
[0m07:05:06.025025 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m07:05:06.025291 [debug] [MainThread]: On master: COMMIT
[0m07:05:06.025534 [debug] [MainThread]: Using postgres connection "master"
[0m07:05:06.025799 [debug] [MainThread]: On master: COMMIT
[0m07:05:06.026117 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:05:06.026352 [debug] [MainThread]: On master: Close
[0m07:05:06.027436 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.fact_waterlevel
[0m07:05:06.027816 [info ] [Thread-1 (]: 1 of 1 START sql incremental model fact.fact_waterlevel ........................ [RUN]
[0m07:05:06.028152 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_fact, now model.etl_waterlevel.fact_waterlevel)
[0m07:05:06.028422 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.fact_waterlevel
[0m07:05:06.035470 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.fact_waterlevel"
[0m07:05:06.036423 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.fact_waterlevel
[0m07:05:06.064712 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m07:05:06.065067 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

    
  
    

  create temporary table "fact_waterlevel__dbt_tmp070506052704"
  
  
    as
  
  (
    

with main as (
    select
        distinct
        concat("stationId",'_',"stationCode") as station_key,
        "stationId" as station_id,
        "stationCode" as station_code,
        "waterLevel" as water_level,
        "waterlevelStatus" as waterlevel_status,
        case
            when "waterlevelStatus" = 3 then '🚨 Beyond Danger'
            when "waterlevelStatus" = 2 then '⚠️ Between Warning and Danger'
            when "waterlevelStatus" = 1 then '🔶 Between Alert and Warning'
            when "waterlevelStatus" = 0 then '✅ Between Normal and Alert'
            when "waterlevelStatus" = -1 then '🟢 Below Normal (Safe)'
            else '❓ Unknown Status'
        end as waterlevel_condition,
        "stationName",
        "districtName",
        to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp AS last_update
    from
        raw.waterlevels w
    where
        "stationStatus" = 1

        
        and to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp >= (
            select max(last_update) - interval '1 hour' from "airflow"."fact"."fact_waterlevel"
        )
        
)

select * from main
  );
  
  
[0m07:05:06.065381 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:05:06.080988 [debug] [Thread-1 (]: SQL status: SELECT 143 in 0.016 seconds
[0m07:05:06.088267 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m07:05:06.088584 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: BEGIN
[0m07:05:06.089003 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m07:05:06.089282 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m07:05:06.089568 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp070506052704'
        
      order by ordinal_position

  
[0m07:05:06.092538 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.003 seconds
[0m07:05:06.095239 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m07:05:06.095552 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m07:05:06.096982 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m07:05:06.103491 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m07:05:06.103807 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp070506052704'
        
      order by ordinal_position

  
[0m07:05:06.105010 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m07:05:06.106714 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m07:05:06.107005 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m07:05:06.108233 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m07:05:06.112834 [debug] [Thread-1 (]: 
    In "airflow"."fact"."fact_waterlevel":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m07:05:06.117957 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.fact_waterlevel"
[0m07:05:06.118880 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m07:05:06.119195 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      
        
        
        delete from "airflow"."fact"."fact_waterlevel" as DBT_INTERNAL_DEST
        where (station_key) in (
            select distinct station_key
            from "fact_waterlevel__dbt_tmp070506052704" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airflow"."fact"."fact_waterlevel" ("station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update")
    (
        select "station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update"
        from "fact_waterlevel__dbt_tmp070506052704"
    )
  
[0m07:05:06.125126 [debug] [Thread-1 (]: SQL status: INSERT 0 143 in 0.006 seconds
[0m07:05:06.132887 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m07:05:06.133205 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m07:05:06.133479 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m07:05:06.135092 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m07:05:06.136164 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: Close
[0m07:05:06.137329 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c95c2db3-db73-4f6d-9ec6-bf61b5377280', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb619e7d0>]}
[0m07:05:06.137844 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model fact.fact_waterlevel ................... [[32mINSERT 0 143[0m in 0.11s]
[0m07:05:06.138234 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.fact_waterlevel
[0m07:05:06.138900 [debug] [MainThread]: Using postgres connection "master"
[0m07:05:06.139155 [debug] [MainThread]: On master: BEGIN
[0m07:05:06.139348 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:05:06.140859 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m07:05:06.141096 [debug] [MainThread]: On master: COMMIT
[0m07:05:06.141312 [debug] [MainThread]: Using postgres connection "master"
[0m07:05:06.141500 [debug] [MainThread]: On master: COMMIT
[0m07:05:06.141743 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:05:06.141948 [debug] [MainThread]: On master: Close
[0m07:05:06.142201 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:05:06.142411 [debug] [MainThread]: Connection 'model.etl_waterlevel.fact_waterlevel' was properly closed.
[0m07:05:06.142665 [info ] [MainThread]: 
[0m07:05:06.142885 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.19 seconds (0.19s).
[0m07:05:06.143259 [debug] [MainThread]: Command end result
[0m07:05:06.158214 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m07:05:06.159529 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m07:05:06.162921 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m07:05:06.163156 [info ] [MainThread]: 
[0m07:05:06.163427 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:05:06.163645 [info ] [MainThread]: 
[0m07:05:06.163874 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m07:05:06.164398 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.51806414, "process_in_blocks": "0", "process_kernel_time": 0.110094, "process_mem_max_rss": "111156", "process_out_blocks": "1702", "process_user_time": 1.231053}
[0m07:05:06.164742 [debug] [MainThread]: Command `dbt run` succeeded at 07:05:06.164697 after 0.52 seconds
[0m07:05:06.165025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3f88340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb25ed420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3e49390>]}
[0m07:05:06.165292 [debug] [MainThread]: Flushing usage events
[0m07:05:07.503471 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:12:35.284931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ae882e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99f77d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99f77ca0>]}


============================== 08:12:35.289498 | 408265b8-d017-45ee-8c86-e9e2f36b84c8 ==============================
[0m08:12:35.289498 [info ] [MainThread]: Running with dbt=1.9.0
[0m08:12:35.289923 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --models fact_waterlevel', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m08:12:35.398334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '408265b8-d017-45ee-8c86-e9e2f36b84c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff996ba9e0>]}
[0m08:12:35.430390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '408265b8-d017-45ee-8c86-e9e2f36b84c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99f74bb0>]}
[0m08:12:35.430965 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m08:12:35.470139 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m08:12:35.527030 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:12:35.527401 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:12:35.531146 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m08:12:35.545176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '408265b8-d017-45ee-8c86-e9e2f36b84c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99234520>]}
[0m08:12:35.587427 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m08:12:35.591725 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m08:12:35.602228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '408265b8-d017-45ee-8c86-e9e2f36b84c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99253220>]}
[0m08:12:35.602599 [info ] [MainThread]: Found 3 models, 434 macros
[0m08:12:35.602873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '408265b8-d017-45ee-8c86-e9e2f36b84c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff992531c0>]}
[0m08:12:35.603679 [info ] [MainThread]: 
[0m08:12:35.604009 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:12:35.604318 [info ] [MainThread]: 
[0m08:12:35.604749 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:12:35.605428 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m08:12:35.651843 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m08:12:35.652305 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m08:12:35.652620 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:12:35.655799 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.003 seconds
[0m08:12:35.656723 [debug] [ThreadPool]: On list_airflow: Close
[0m08:12:35.659730 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_fact)
[0m08:12:35.663510 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m08:12:35.663831 [debug] [ThreadPool]: On list_airflow_fact: BEGIN
[0m08:12:35.664124 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:12:35.665755 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m08:12:35.666089 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m08:12:35.666393 [debug] [ThreadPool]: On list_airflow_fact: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_fact"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'fact'
  
[0m08:12:35.668000 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m08:12:35.668775 [debug] [ThreadPool]: On list_airflow_fact: ROLLBACK
[0m08:12:35.669155 [debug] [ThreadPool]: On list_airflow_fact: Close
[0m08:12:35.669573 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_fact, now list_airflow_dim)
[0m08:12:35.671096 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m08:12:35.671406 [debug] [ThreadPool]: On list_airflow_dim: BEGIN
[0m08:12:35.671668 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:12:35.673320 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m08:12:35.673612 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m08:12:35.673903 [debug] [ThreadPool]: On list_airflow_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dim'
  
[0m08:12:35.675456 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.001 seconds
[0m08:12:35.676208 [debug] [ThreadPool]: On list_airflow_dim: ROLLBACK
[0m08:12:35.676559 [debug] [ThreadPool]: On list_airflow_dim: Close
[0m08:12:35.679441 [debug] [MainThread]: Using postgres connection "master"
[0m08:12:35.679738 [debug] [MainThread]: On master: BEGIN
[0m08:12:35.680007 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:12:35.681615 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m08:12:35.681897 [debug] [MainThread]: Using postgres connection "master"
[0m08:12:35.682258 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:12:35.685869 [debug] [MainThread]: SQL status: SELECT 2 in 0.003 seconds
[0m08:12:35.686629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '408265b8-d017-45ee-8c86-e9e2f36b84c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d078ca0>]}
[0m08:12:35.687037 [debug] [MainThread]: On master: ROLLBACK
[0m08:12:35.687402 [debug] [MainThread]: Using postgres connection "master"
[0m08:12:35.687685 [debug] [MainThread]: On master: BEGIN
[0m08:12:35.688100 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m08:12:35.688382 [debug] [MainThread]: On master: COMMIT
[0m08:12:35.688653 [debug] [MainThread]: Using postgres connection "master"
[0m08:12:35.688917 [debug] [MainThread]: On master: COMMIT
[0m08:12:35.689257 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:12:35.689539 [debug] [MainThread]: On master: Close
[0m08:12:35.690646 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.fact_waterlevel
[0m08:12:35.691067 [info ] [Thread-1 (]: 1 of 1 START sql incremental model fact.fact_waterlevel ........................ [RUN]
[0m08:12:35.691468 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_dim, now model.etl_waterlevel.fact_waterlevel)
[0m08:12:35.691773 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.fact_waterlevel
[0m08:12:35.700191 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.fact_waterlevel"
[0m08:12:35.701891 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.fact_waterlevel
[0m08:12:35.735440 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m08:12:35.735861 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

    
  
    

  create temporary table "fact_waterlevel__dbt_tmp081235721208"
  
  
    as
  
  (
    

with main as (
    select
        distinct
        concat("stationId",'_',"stationCode") as station_key,
        "stationId" as station_id,
        "stationCode" as station_code,
        "waterLevel" as water_level,
        "waterlevelStatus" as waterlevel_status,
        case
            when "waterlevelStatus" = 3 then '🚨 Beyond Danger'
            when "waterlevelStatus" = 2 then '⚠️ Between Warning and Danger'
            when "waterlevelStatus" = 1 then '🔶 Between Alert and Warning'
            when "waterlevelStatus" = 0 then '✅ Between Normal and Alert'
            when "waterlevelStatus" = -1 then '🟢 Below Normal (Safe)'
            else '❓ Unknown Status'
        end as waterlevel_condition,
        "stationName",
        "districtName",
        to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp AS last_update
    from
        raw.waterlevels w
    where
        "stationStatus" = 1

        
        and to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp >= (
            select max(last_update) - interval '1 hour' from "airflow"."fact"."fact_waterlevel"
        )
        
)

select * from main
  );
  
  
[0m08:12:35.736252 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:12:35.753331 [debug] [Thread-1 (]: SQL status: SELECT 144 in 0.017 seconds
[0m08:12:35.762079 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m08:12:35.762442 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: BEGIN
[0m08:12:35.762899 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m08:12:35.763211 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m08:12:35.763533 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp081235721208'
        
      order by ordinal_position

  
[0m08:12:35.766884 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.003 seconds
[0m08:12:35.770046 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m08:12:35.770414 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m08:12:35.771982 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m08:12:35.779686 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m08:12:35.780049 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp081235721208'
        
      order by ordinal_position

  
[0m08:12:35.781443 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m08:12:35.783413 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m08:12:35.783741 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m08:12:35.785104 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m08:12:35.790533 [debug] [Thread-1 (]: 
    In "airflow"."fact"."fact_waterlevel":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m08:12:35.796645 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.fact_waterlevel"
[0m08:12:35.798300 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m08:12:35.798649 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      
        
        
        delete from "airflow"."fact"."fact_waterlevel" as DBT_INTERNAL_DEST
        where (station_key) in (
            select distinct station_key
            from "fact_waterlevel__dbt_tmp081235721208" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airflow"."fact"."fact_waterlevel" ("station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update")
    (
        select "station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update"
        from "fact_waterlevel__dbt_tmp081235721208"
    )
  
[0m08:12:35.799597 [debug] [Thread-1 (]: SQL status: INSERT 0 144 in 0.001 seconds
[0m08:12:35.808500 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m08:12:35.808837 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m08:12:35.809155 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m08:12:35.810603 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m08:12:35.811843 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: Close
[0m08:12:35.813093 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '408265b8-d017-45ee-8c86-e9e2f36b84c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d078ca0>]}
[0m08:12:35.813642 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model fact.fact_waterlevel ................... [[32mINSERT 0 144[0m in 0.12s]
[0m08:12:35.814095 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.fact_waterlevel
[0m08:12:35.814934 [debug] [MainThread]: Using postgres connection "master"
[0m08:12:35.815196 [debug] [MainThread]: On master: BEGIN
[0m08:12:35.815425 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:12:35.817067 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m08:12:35.817355 [debug] [MainThread]: On master: COMMIT
[0m08:12:35.817636 [debug] [MainThread]: Using postgres connection "master"
[0m08:12:35.817897 [debug] [MainThread]: On master: COMMIT
[0m08:12:35.818190 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:12:35.818420 [debug] [MainThread]: On master: Close
[0m08:12:35.818714 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:12:35.818955 [debug] [MainThread]: Connection 'model.etl_waterlevel.fact_waterlevel' was properly closed.
[0m08:12:35.819201 [info ] [MainThread]: 
[0m08:12:35.819451 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.21 seconds (0.21s).
[0m08:12:35.819868 [debug] [MainThread]: Command end result
[0m08:12:35.837913 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m08:12:35.839142 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m08:12:35.843314 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m08:12:35.843590 [info ] [MainThread]: 
[0m08:12:35.843901 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:12:35.844182 [info ] [MainThread]: 
[0m08:12:35.844473 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m08:12:35.845123 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.58946604, "process_in_blocks": "0", "process_kernel_time": 0.11911, "process_mem_max_rss": "111616", "process_out_blocks": "1702", "process_user_time": 1.320225}
[0m08:12:35.845516 [debug] [MainThread]: Command `dbt run` succeeded at 08:12:35.845462 after 0.59 seconds
[0m08:12:35.845805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ae882e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff996ba9e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99f6c100>]}
[0m08:12:35.846094 [debug] [MainThread]: Flushing usage events
[0m08:12:37.571843 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:18:13.257499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fb8c2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ec70520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ec70580>]}


============================== 09:18:13.262243 | f3cc136b-4d8c-47f2-a9a9-dff3802f1c69 ==============================
[0m09:18:13.262243 [info ] [MainThread]: Running with dbt=1.9.0
[0m09:18:13.262695 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/airflow/.dbt', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --models fact_waterlevel', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:18:13.386222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f3cc136b-4d8c-47f2-a9a9-dff3802f1c69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91c7fd60>]}
[0m09:18:13.430249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f3cc136b-4d8c-47f2-a9a9-dff3802f1c69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fad8100>]}
[0m09:18:13.431094 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:18:13.480638 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m09:18:13.556339 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:18:13.556814 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:18:13.561617 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m09:18:13.579495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f3cc136b-4d8c-47f2-a9a9-dff3802f1c69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ded44f0>]}
[0m09:18:13.633967 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m09:18:13.639212 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m09:18:13.655139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f3cc136b-4d8c-47f2-a9a9-dff3802f1c69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8def3220>]}
[0m09:18:13.655724 [info ] [MainThread]: Found 3 models, 434 macros
[0m09:18:13.656224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f3cc136b-4d8c-47f2-a9a9-dff3802f1c69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8def31c0>]}
[0m09:18:13.657421 [info ] [MainThread]: 
[0m09:18:13.657856 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:18:13.658202 [info ] [MainThread]: 
[0m09:18:13.658693 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:18:13.659614 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m09:18:13.727761 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m09:18:13.728456 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m09:18:13.728942 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:18:13.733648 [debug] [ThreadPool]: SQL status: SELECT 20 in 0.005 seconds
[0m09:18:13.734973 [debug] [ThreadPool]: On list_airflow: Close
[0m09:18:13.739559 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_dim)
[0m09:18:13.745274 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m09:18:13.745749 [debug] [ThreadPool]: On list_airflow_dim: BEGIN
[0m09:18:13.746173 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:18:13.748897 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m09:18:13.749526 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m09:18:13.749968 [debug] [ThreadPool]: On list_airflow_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dim'
  
[0m09:18:13.752437 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.002 seconds
[0m09:18:13.753677 [debug] [ThreadPool]: On list_airflow_dim: ROLLBACK
[0m09:18:13.754223 [debug] [ThreadPool]: On list_airflow_dim: Close
[0m09:18:13.754864 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_dim, now list_airflow_fact)
[0m09:18:13.757336 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m09:18:13.757771 [debug] [ThreadPool]: On list_airflow_fact: BEGIN
[0m09:18:13.758168 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:18:13.760658 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m09:18:13.761084 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m09:18:13.761497 [debug] [ThreadPool]: On list_airflow_fact: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_fact"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'fact'
  
[0m09:18:13.763571 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m09:18:13.764728 [debug] [ThreadPool]: On list_airflow_fact: ROLLBACK
[0m09:18:13.765243 [debug] [ThreadPool]: On list_airflow_fact: Close
[0m09:18:13.769604 [debug] [MainThread]: Using postgres connection "master"
[0m09:18:13.770063 [debug] [MainThread]: On master: BEGIN
[0m09:18:13.770476 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:18:13.773080 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m09:18:13.773535 [debug] [MainThread]: Using postgres connection "master"
[0m09:18:13.774036 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:18:13.779490 [debug] [MainThread]: SQL status: SELECT 2 in 0.005 seconds
[0m09:18:13.780701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f3cc136b-4d8c-47f2-a9a9-dff3802f1c69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8def2b30>]}
[0m09:18:13.781275 [debug] [MainThread]: On master: ROLLBACK
[0m09:18:13.781812 [debug] [MainThread]: Using postgres connection "master"
[0m09:18:13.782218 [debug] [MainThread]: On master: BEGIN
[0m09:18:13.782812 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m09:18:13.783233 [debug] [MainThread]: On master: COMMIT
[0m09:18:13.783683 [debug] [MainThread]: Using postgres connection "master"
[0m09:18:13.784058 [debug] [MainThread]: On master: COMMIT
[0m09:18:13.784557 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:18:13.784951 [debug] [MainThread]: On master: Close
[0m09:18:13.786683 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.fact_waterlevel
[0m09:18:13.787346 [info ] [Thread-1 (]: 1 of 1 START sql incremental model fact.fact_waterlevel ........................ [RUN]
[0m09:18:13.787941 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_fact, now model.etl_waterlevel.fact_waterlevel)
[0m09:18:13.788477 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.fact_waterlevel
[0m09:18:13.800999 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.fact_waterlevel"
[0m09:18:13.803333 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.fact_waterlevel
[0m09:18:13.853261 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m09:18:13.853970 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

    
  
    

  create temporary table "fact_waterlevel__dbt_tmp091813832246"
  
  
    as
  
  (
    

with main as (
    select
        distinct
        concat("stationId",'_',"stationCode") as station_key,
        "stationId" as station_id,
        "stationCode" as station_code,
        "waterLevel" as water_level,
        "waterlevelStatus" as waterlevel_status,
        case
            when "waterlevelStatus" = 3 then '🚨 Beyond Danger'
            when "waterlevelStatus" = 2 then '⚠️ Between Warning and Danger'
            when "waterlevelStatus" = 1 then '🔶 Between Alert and Warning'
            when "waterlevelStatus" = 0 then '✅ Between Normal and Alert'
            when "waterlevelStatus" = -1 then '🟢 Below Normal (Safe)'
            else '❓ Unknown Status'
        end as waterlevel_condition,
        "stationName",
        "districtName",
        to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp AS last_update
    from
        raw.waterlevels w
    where
        "stationStatus" = 1

        
        and to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp >= (
            select max(last_update) - interval '1 hour' from "airflow"."fact"."fact_waterlevel"
        )
        
)

select * from main
  );
  
  
[0m09:18:13.854597 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:18:13.879324 [debug] [Thread-1 (]: SQL status: SELECT 144 in 0.025 seconds
[0m09:18:13.891806 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m09:18:13.892330 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: BEGIN
[0m09:18:13.892943 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m09:18:13.893414 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m09:18:13.893897 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp091813832246'
        
      order by ordinal_position

  
[0m09:18:13.898631 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.004 seconds
[0m09:18:13.903265 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m09:18:13.903780 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m09:18:13.906087 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.002 seconds
[0m09:18:13.917230 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m09:18:13.917744 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp091813832246'
        
      order by ordinal_position

  
[0m09:18:13.919792 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.002 seconds
[0m09:18:13.922915 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m09:18:13.923508 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m09:18:13.925703 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.002 seconds
[0m09:18:13.933672 [debug] [Thread-1 (]: 
    In "airflow"."fact"."fact_waterlevel":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m09:18:13.942656 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.fact_waterlevel"
[0m09:18:13.944044 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m09:18:13.944559 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      
        
        
        delete from "airflow"."fact"."fact_waterlevel" as DBT_INTERNAL_DEST
        where (station_key) in (
            select distinct station_key
            from "fact_waterlevel__dbt_tmp091813832246" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airflow"."fact"."fact_waterlevel" ("station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update")
    (
        select "station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update"
        from "fact_waterlevel__dbt_tmp091813832246"
    )
  
[0m09:18:13.946067 [debug] [Thread-1 (]: SQL status: INSERT 0 144 in 0.001 seconds
[0m09:18:13.959451 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m09:18:13.960019 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m09:18:13.960508 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m09:18:13.961266 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m09:18:13.962993 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: Close
[0m09:18:13.964679 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3cc136b-4d8c-47f2-a9a9-dff3802f1c69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff915b0280>]}
[0m09:18:13.965380 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model fact.fact_waterlevel ................... [[32mINSERT 0 144[0m in 0.18s]
[0m09:18:13.965951 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.fact_waterlevel
[0m09:18:13.967016 [debug] [MainThread]: Using postgres connection "master"
[0m09:18:13.967393 [debug] [MainThread]: On master: BEGIN
[0m09:18:13.967712 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:18:13.970107 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m09:18:13.970558 [debug] [MainThread]: On master: COMMIT
[0m09:18:13.970978 [debug] [MainThread]: Using postgres connection "master"
[0m09:18:13.971335 [debug] [MainThread]: On master: COMMIT
[0m09:18:13.971749 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:18:13.972079 [debug] [MainThread]: On master: Close
[0m09:18:13.972534 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:18:13.972877 [debug] [MainThread]: Connection 'model.etl_waterlevel.fact_waterlevel' was properly closed.
[0m09:18:13.973270 [info ] [MainThread]: 
[0m09:18:13.973706 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.31 seconds (0.31s).
[0m09:18:13.974390 [debug] [MainThread]: Command end result
[0m09:18:13.998668 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m09:18:14.000265 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m09:18:14.005908 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m09:18:14.006276 [info ] [MainThread]: 
[0m09:18:14.006694 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:18:14.007034 [info ] [MainThread]: 
[0m09:18:14.007401 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m09:18:14.008222 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.78565735, "process_in_blocks": "0", "process_kernel_time": 0.13803, "process_mem_max_rss": "111288", "process_out_blocks": "1702", "process_user_time": 1.547342}
[0m09:18:14.008769 [debug] [MainThread]: Command `dbt run` succeeded at 09:18:14.008697 after 0.79 seconds
[0m09:18:14.009185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fb8c2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fba1bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fad8100>]}
[0m09:18:14.009579 [debug] [MainThread]: Flushing usage events
[0m09:18:15.133282 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:06:02.120083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba994340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9a784f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9a78550>]}


============================== 10:06:02.125753 | 3b8a4d27-bf6e-47d3-9dc3-529aa5bb4203 ==============================
[0m10:06:02.125753 [info ] [MainThread]: Running with dbt=1.9.0
[0m10:06:02.126457 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/logs', 'profiles_dir': '/home/airflow/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --models fact_waterlevel', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:06:02.275165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3b8a4d27-bf6e-47d3-9dc3-529aa5bb4203', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbcbc27a0>]}
[0m10:06:02.322444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3b8a4d27-bf6e-47d3-9dc3-529aa5bb4203', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba8567a0>]}
[0m10:06:02.323213 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:06:02.383442 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m10:06:02.476915 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:06:02.477552 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:06:02.484284 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m10:06:02.507881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3b8a4d27-bf6e-47d3-9dc3-529aa5bb4203', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8cf0580>]}
[0m10:06:02.579308 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m10:06:02.585780 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m10:06:02.603702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3b8a4d27-bf6e-47d3-9dc3-529aa5bb4203', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8d0f220>]}
[0m10:06:02.604312 [info ] [MainThread]: Found 3 models, 434 macros
[0m10:06:02.604790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3b8a4d27-bf6e-47d3-9dc3-529aa5bb4203', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8d0f1c0>]}
[0m10:06:02.606159 [info ] [MainThread]: 
[0m10:06:02.606662 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:06:02.607078 [info ] [MainThread]: 
[0m10:06:02.607681 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:06:02.608811 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m10:06:02.676266 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m10:06:02.676973 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m10:06:02.677473 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:06:02.683414 [debug] [ThreadPool]: SQL status: SELECT 20 in 0.006 seconds
[0m10:06:02.684676 [debug] [ThreadPool]: On list_airflow: Close
[0m10:06:02.689196 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_dim)
[0m10:06:02.694721 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m10:06:02.695194 [debug] [ThreadPool]: On list_airflow_dim: BEGIN
[0m10:06:02.695642 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:06:02.698256 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m10:06:02.698707 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m10:06:02.699150 [debug] [ThreadPool]: On list_airflow_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dim'
  
[0m10:06:02.701531 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.002 seconds
[0m10:06:02.702724 [debug] [ThreadPool]: On list_airflow_dim: ROLLBACK
[0m10:06:02.703232 [debug] [ThreadPool]: On list_airflow_dim: Close
[0m10:06:02.703848 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_dim, now list_airflow_fact)
[0m10:06:02.706215 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m10:06:02.706653 [debug] [ThreadPool]: On list_airflow_fact: BEGIN
[0m10:06:02.707032 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:06:02.709410 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m10:06:02.709863 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m10:06:02.710275 [debug] [ThreadPool]: On list_airflow_fact: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_fact"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'fact'
  
[0m10:06:02.712326 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m10:06:02.713380 [debug] [ThreadPool]: On list_airflow_fact: ROLLBACK
[0m10:06:02.713905 [debug] [ThreadPool]: On list_airflow_fact: Close
[0m10:06:02.717989 [debug] [MainThread]: Using postgres connection "master"
[0m10:06:02.718409 [debug] [MainThread]: On master: BEGIN
[0m10:06:02.718821 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:06:02.721025 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m10:06:02.721438 [debug] [MainThread]: Using postgres connection "master"
[0m10:06:02.721942 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:06:02.727292 [debug] [MainThread]: SQL status: SELECT 2 in 0.005 seconds
[0m10:06:02.728358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3b8a4d27-bf6e-47d3-9dc3-529aa5bb4203', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8d0ed10>]}
[0m10:06:02.728902 [debug] [MainThread]: On master: ROLLBACK
[0m10:06:02.729402 [debug] [MainThread]: Using postgres connection "master"
[0m10:06:02.729774 [debug] [MainThread]: On master: BEGIN
[0m10:06:02.730324 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:06:02.730753 [debug] [MainThread]: On master: COMMIT
[0m10:06:02.731149 [debug] [MainThread]: Using postgres connection "master"
[0m10:06:02.731528 [debug] [MainThread]: On master: COMMIT
[0m10:06:02.732012 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:06:02.732404 [debug] [MainThread]: On master: Close
[0m10:06:02.734025 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.fact_waterlevel
[0m10:06:02.734627 [info ] [Thread-1 (]: 1 of 1 START sql incremental model fact.fact_waterlevel ........................ [RUN]
[0m10:06:02.735137 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_fact, now model.etl_waterlevel.fact_waterlevel)
[0m10:06:02.735578 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.fact_waterlevel
[0m10:06:02.747709 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.fact_waterlevel"
[0m10:06:02.749643 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.fact_waterlevel
[0m10:06:02.797449 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m10:06:02.798037 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

    
  
    

  create temporary table "fact_waterlevel__dbt_tmp100602777075"
  
  
    as
  
  (
    

with main as (
    select
        distinct
        concat("stationId",'_',"stationCode") as station_key,
        "stationId" as station_id,
        "stationCode" as station_code,
        "waterLevel" as water_level,
        "waterlevelStatus" as waterlevel_status,
        case
            when "waterlevelStatus" = 3 then '🚨 Beyond Danger'
            when "waterlevelStatus" = 2 then '⚠️ Between Warning and Danger'
            when "waterlevelStatus" = 1 then '🔶 Between Alert and Warning'
            when "waterlevelStatus" = 0 then '✅ Between Normal and Alert'
            when "waterlevelStatus" = -1 then '🟢 Below Normal (Safe)'
            else '❓ Unknown Status'
        end as waterlevel_condition,
        "stationName",
        "districtName",
        to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp AS last_update
    from
        raw.waterlevels w
    where
        "stationStatus" = 1

        
        and to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp >= (
            select max(last_update) - interval '1 hour' from "airflow"."fact"."fact_waterlevel"
        )
        
)

select * from main
  );
  
  
[0m10:06:02.798564 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:06:02.819029 [debug] [Thread-1 (]: SQL status: SELECT 160 in 0.020 seconds
[0m10:06:02.831402 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m10:06:02.831919 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: BEGIN
[0m10:06:02.832538 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m10:06:02.833012 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m10:06:02.833478 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp100602777075'
        
      order by ordinal_position

  
[0m10:06:02.838338 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.004 seconds
[0m10:06:02.842821 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m10:06:02.843328 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m10:06:02.845613 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.002 seconds
[0m10:06:02.856695 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m10:06:02.857196 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp100602777075'
        
      order by ordinal_position

  
[0m10:06:02.859283 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.002 seconds
[0m10:06:02.862241 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m10:06:02.862755 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m10:06:02.864776 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.002 seconds
[0m10:06:02.872729 [debug] [Thread-1 (]: 
    In "airflow"."fact"."fact_waterlevel":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m10:06:02.881684 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.fact_waterlevel"
[0m10:06:02.882896 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m10:06:02.883398 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      
        
        
        delete from "airflow"."fact"."fact_waterlevel" as DBT_INTERNAL_DEST
        where (station_key) in (
            select distinct station_key
            from "fact_waterlevel__dbt_tmp100602777075" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airflow"."fact"."fact_waterlevel" ("station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update")
    (
        select "station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update"
        from "fact_waterlevel__dbt_tmp100602777075"
    )
  
[0m10:06:02.884748 [debug] [Thread-1 (]: SQL status: INSERT 0 160 in 0.001 seconds
[0m10:06:02.898414 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m10:06:02.898933 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m10:06:02.899381 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m10:06:02.900732 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m10:06:02.902487 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: Close
[0m10:06:02.904239 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b8a4d27-bf6e-47d3-9dc3-529aa5bb4203', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbcbc27d0>]}
[0m10:06:02.905011 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model fact.fact_waterlevel ................... [[32mINSERT 0 160[0m in 0.17s]
[0m10:06:02.905665 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.fact_waterlevel
[0m10:06:02.906776 [debug] [MainThread]: Using postgres connection "master"
[0m10:06:02.907167 [debug] [MainThread]: On master: BEGIN
[0m10:06:02.907489 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:06:02.909939 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m10:06:02.910338 [debug] [MainThread]: On master: COMMIT
[0m10:06:02.910745 [debug] [MainThread]: Using postgres connection "master"
[0m10:06:02.911083 [debug] [MainThread]: On master: COMMIT
[0m10:06:02.911537 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:06:02.911880 [debug] [MainThread]: On master: Close
[0m10:06:02.912322 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:06:02.912723 [debug] [MainThread]: Connection 'model.etl_waterlevel.fact_waterlevel' was properly closed.
[0m10:06:02.913107 [info ] [MainThread]: 
[0m10:06:02.913500 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.31 seconds (0.31s).
[0m10:06:02.914131 [debug] [MainThread]: Command end result
[0m10:06:02.938656 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m10:06:02.940261 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m10:06:02.946117 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m10:06:02.946507 [info ] [MainThread]: 
[0m10:06:02.946990 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:06:02.947416 [info ] [MainThread]: 
[0m10:06:02.947895 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:06:02.948816 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.8745128, "process_in_blocks": "0", "process_kernel_time": 0.130962, "process_mem_max_rss": "111484", "process_out_blocks": "1702", "process_user_time": 2.370323}
[0m10:06:02.949475 [debug] [MainThread]: Command `dbt run` succeeded at 10:06:02.949355 after 0.88 seconds
[0m10:06:02.950019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba994340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8ffc0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbaa02290>]}
[0m10:06:02.950581 [debug] [MainThread]: Flushing usage events
[0m10:06:04.137676 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:18:55.054928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d960310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ca60520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ca60580>]}


============================== 11:18:55.058815 | be2a7860-3b8c-4c8d-874d-86c064151f0b ==============================
[0m11:18:55.058815 [info ] [MainThread]: Running with dbt=1.9.0
[0m11:18:55.059199 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models fact_waterlevel', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:18:55.159900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'be2a7860-3b8c-4c8d-874d-86c064151f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c146290>]}
[0m11:18:55.190959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'be2a7860-3b8c-4c8d-874d-86c064151f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d8ac1c0>]}
[0m11:18:55.191475 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m11:18:55.230445 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m11:18:55.286188 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:18:55.286534 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:18:55.290116 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m11:18:55.303998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'be2a7860-3b8c-4c8d-874d-86c064151f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9bcd8550>]}
[0m11:18:55.345510 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m11:18:55.349500 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m11:18:55.360413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'be2a7860-3b8c-4c8d-874d-86c064151f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9bcf7220>]}
[0m11:18:55.360769 [info ] [MainThread]: Found 3 models, 434 macros
[0m11:18:55.361044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be2a7860-3b8c-4c8d-874d-86c064151f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9bcf71c0>]}
[0m11:18:55.361854 [info ] [MainThread]: 
[0m11:18:55.362155 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:18:55.362395 [info ] [MainThread]: 
[0m11:18:55.362745 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:18:55.363386 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m11:18:55.409976 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m11:18:55.410460 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m11:18:55.410782 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:18:55.414022 [debug] [ThreadPool]: SQL status: SELECT 20 in 0.003 seconds
[0m11:18:55.414924 [debug] [ThreadPool]: On list_airflow: Close
[0m11:18:55.418010 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_fact)
[0m11:18:55.421760 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m11:18:55.422080 [debug] [ThreadPool]: On list_airflow_fact: BEGIN
[0m11:18:55.422373 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:18:55.424120 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m11:18:55.424477 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m11:18:55.424788 [debug] [ThreadPool]: On list_airflow_fact: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_fact"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'fact'
  
[0m11:18:55.426441 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m11:18:55.427215 [debug] [ThreadPool]: On list_airflow_fact: ROLLBACK
[0m11:18:55.427574 [debug] [ThreadPool]: On list_airflow_fact: Close
[0m11:18:55.427996 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_fact, now list_airflow_dim)
[0m11:18:55.429549 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m11:18:55.429833 [debug] [ThreadPool]: On list_airflow_dim: BEGIN
[0m11:18:55.430118 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:18:55.431713 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m11:18:55.432002 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m11:18:55.432295 [debug] [ThreadPool]: On list_airflow_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dim'
  
[0m11:18:55.433826 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.001 seconds
[0m11:18:55.434568 [debug] [ThreadPool]: On list_airflow_dim: ROLLBACK
[0m11:18:55.434913 [debug] [ThreadPool]: On list_airflow_dim: Close
[0m11:18:55.437847 [debug] [MainThread]: Using postgres connection "master"
[0m11:18:55.438172 [debug] [MainThread]: On master: BEGIN
[0m11:18:55.438461 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:18:55.440023 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m11:18:55.440313 [debug] [MainThread]: Using postgres connection "master"
[0m11:18:55.440650 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:18:55.444334 [debug] [MainThread]: SQL status: SELECT 2 in 0.003 seconds
[0m11:18:55.445081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be2a7860-3b8c-4c8d-874d-86c064151f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f3f1f00>]}
[0m11:18:55.445456 [debug] [MainThread]: On master: ROLLBACK
[0m11:18:55.445830 [debug] [MainThread]: Using postgres connection "master"
[0m11:18:55.446117 [debug] [MainThread]: On master: BEGIN
[0m11:18:55.446542 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m11:18:55.446831 [debug] [MainThread]: On master: COMMIT
[0m11:18:55.447113 [debug] [MainThread]: Using postgres connection "master"
[0m11:18:55.447386 [debug] [MainThread]: On master: COMMIT
[0m11:18:55.447720 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:18:55.447997 [debug] [MainThread]: On master: Close
[0m11:18:55.449116 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.fact_waterlevel
[0m11:18:55.449522 [info ] [Thread-1 (]: 1 of 1 START sql incremental model fact.fact_waterlevel ........................ [RUN]
[0m11:18:55.449885 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_dim, now model.etl_waterlevel.fact_waterlevel)
[0m11:18:55.450202 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.fact_waterlevel
[0m11:18:55.458549 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.fact_waterlevel"
[0m11:18:55.460242 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.fact_waterlevel
[0m11:18:55.493565 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m11:18:55.493996 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

    
  
    

  create temporary table "fact_waterlevel__dbt_tmp111855479097"
  
  
    as
  
  (
    

with main as (
    select
        distinct
        concat("stationId",'_',"stationCode") as station_key,
        "stationId" as station_id,
        "stationCode" as station_code,
        "waterLevel" as water_level,
        "waterlevelStatus" as waterlevel_status,
        case
            when "waterlevelStatus" = 3 then '🚨 Beyond Danger'
            when "waterlevelStatus" = 2 then '⚠️ Between Warning and Danger'
            when "waterlevelStatus" = 1 then '🔶 Between Alert and Warning'
            when "waterlevelStatus" = 0 then '✅ Between Normal and Alert'
            when "waterlevelStatus" = -1 then '🟢 Below Normal (Safe)'
            else '❓ Unknown Status'
        end as waterlevel_condition,
        "stationName",
        "districtName",
        to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp AS last_update
    from
        raw.waterlevels w
    where
        "stationStatus" = 1

        
        and to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp >= (
            select max(last_update) - interval '1 hour' from "airflow"."fact"."fact_waterlevel"
        )
        
)

select * from main
  );
  
  
[0m11:18:55.494404 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:18:55.514368 [debug] [Thread-1 (]: SQL status: SELECT 215 in 0.020 seconds
[0m11:18:55.523160 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m11:18:55.523525 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: BEGIN
[0m11:18:55.523961 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m11:18:55.524301 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m11:18:55.524627 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp111855479097'
        
      order by ordinal_position

  
[0m11:18:55.528022 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.003 seconds
[0m11:18:55.531170 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m11:18:55.531543 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m11:18:55.533128 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m11:18:55.540801 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m11:18:55.541150 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp111855479097'
        
      order by ordinal_position

  
[0m11:18:55.542561 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m11:18:55.544535 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m11:18:55.544870 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m11:18:55.546263 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m11:18:55.551688 [debug] [Thread-1 (]: 
    In "airflow"."fact"."fact_waterlevel":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m11:18:55.557895 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.fact_waterlevel"
[0m11:18:55.558831 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m11:18:55.559213 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      
        
        
        delete from "airflow"."fact"."fact_waterlevel" as DBT_INTERNAL_DEST
        where (station_key) in (
            select distinct station_key
            from "fact_waterlevel__dbt_tmp111855479097" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airflow"."fact"."fact_waterlevel" ("station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update")
    (
        select "station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update"
        from "fact_waterlevel__dbt_tmp111855479097"
    )
  
[0m11:18:55.560352 [debug] [Thread-1 (]: SQL status: INSERT 0 215 in 0.001 seconds
[0m11:18:55.569334 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m11:18:55.569668 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m11:18:55.569976 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m11:18:55.571785 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m11:18:55.573036 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: Close
[0m11:18:55.574342 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be2a7860-3b8c-4c8d-874d-86c064151f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9fb66dd0>]}
[0m11:18:55.574849 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model fact.fact_waterlevel ................... [[32mINSERT 0 215[0m in 0.12s]
[0m11:18:55.575338 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.fact_waterlevel
[0m11:18:55.576170 [debug] [MainThread]: Using postgres connection "master"
[0m11:18:55.576436 [debug] [MainThread]: On master: BEGIN
[0m11:18:55.576660 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:18:55.578456 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m11:18:55.578754 [debug] [MainThread]: On master: COMMIT
[0m11:18:55.578999 [debug] [MainThread]: Using postgres connection "master"
[0m11:18:55.579216 [debug] [MainThread]: On master: COMMIT
[0m11:18:55.579513 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:18:55.579774 [debug] [MainThread]: On master: Close
[0m11:18:55.580157 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:18:55.580468 [debug] [MainThread]: Connection 'model.etl_waterlevel.fact_waterlevel' was properly closed.
[0m11:18:55.580753 [info ] [MainThread]: 
[0m11:18:55.581056 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.22 seconds (0.22s).
[0m11:18:55.581539 [debug] [MainThread]: Command end result
[0m11:18:55.598716 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m11:18:55.599944 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m11:18:55.604073 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m11:18:55.604351 [info ] [MainThread]: 
[0m11:18:55.604652 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:18:55.604889 [info ] [MainThread]: 
[0m11:18:55.605134 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:18:55.605738 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.58156604, "process_in_blocks": "0", "process_kernel_time": 0.115044, "process_mem_max_rss": "111164", "process_out_blocks": "1702", "process_user_time": 1.314511}
[0m11:18:55.606114 [debug] [MainThread]: Command `dbt run` succeeded at 11:18:55.606058 after 0.58 seconds
[0m11:18:55.606412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d960310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d9cf6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cc040a0>]}
[0m11:18:55.606700 [debug] [MainThread]: Flushing usage events
[0m11:18:57.126011 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:15:50.890829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81d40310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80e47d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80e47ca0>]}


============================== 12:15:50.895567 | c7030629-2f43-47d6-a81d-ffbc20875807 ==============================
[0m12:15:50.895567 [info ] [MainThread]: Running with dbt=1.9.0
[0m12:15:50.896088 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models fact_waterlevel', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:15:50.991620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c7030629-2f43-47d6-a81d-ffbc20875807', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83e9a770>]}
[0m12:15:51.019001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c7030629-2f43-47d6-a81d-ffbc20875807', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81c8c1c0>]}
[0m12:15:51.019524 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:15:51.054916 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m12:15:51.106029 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:15:51.106485 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:15:51.109900 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m12:15:51.121681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c7030629-2f43-47d6-a81d-ffbc20875807', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8003c520>]}
[0m12:15:51.160620 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m12:15:51.164616 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m12:15:51.174114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c7030629-2f43-47d6-a81d-ffbc20875807', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8005b220>]}
[0m12:15:51.174445 [info ] [MainThread]: Found 3 models, 434 macros
[0m12:15:51.174684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c7030629-2f43-47d6-a81d-ffbc20875807', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8005b1c0>]}
[0m12:15:51.175412 [info ] [MainThread]: 
[0m12:15:51.175687 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:15:51.176068 [info ] [MainThread]: 
[0m12:15:51.176474 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:15:51.177076 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m12:15:51.219231 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m12:15:51.219664 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m12:15:51.219937 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:15:51.223399 [debug] [ThreadPool]: SQL status: SELECT 20 in 0.003 seconds
[0m12:15:51.224183 [debug] [ThreadPool]: On list_airflow: Close
[0m12:15:51.226897 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_dim)
[0m12:15:51.230206 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m12:15:51.230486 [debug] [ThreadPool]: On list_airflow_dim: BEGIN
[0m12:15:51.230763 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:15:51.232415 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m12:15:51.232714 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m12:15:51.232981 [debug] [ThreadPool]: On list_airflow_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dim'
  
[0m12:15:51.234471 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.001 seconds
[0m12:15:51.235149 [debug] [ThreadPool]: On list_airflow_dim: ROLLBACK
[0m12:15:51.235490 [debug] [ThreadPool]: On list_airflow_dim: Close
[0m12:15:51.235874 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_dim, now list_airflow_fact)
[0m12:15:51.237259 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m12:15:51.237515 [debug] [ThreadPool]: On list_airflow_fact: BEGIN
[0m12:15:51.237752 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:15:51.239156 [debug] [ThreadPool]: SQL status: BEGIN in 0.001 seconds
[0m12:15:51.239410 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m12:15:51.239664 [debug] [ThreadPool]: On list_airflow_fact: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_fact"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'fact'
  
[0m12:15:51.240870 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m12:15:51.241568 [debug] [ThreadPool]: On list_airflow_fact: ROLLBACK
[0m12:15:51.241901 [debug] [ThreadPool]: On list_airflow_fact: Close
[0m12:15:51.244310 [debug] [MainThread]: Using postgres connection "master"
[0m12:15:51.244569 [debug] [MainThread]: On master: BEGIN
[0m12:15:51.244809 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:15:51.246308 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m12:15:51.246569 [debug] [MainThread]: Using postgres connection "master"
[0m12:15:51.246869 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:15:51.249954 [debug] [MainThread]: SQL status: SELECT 2 in 0.003 seconds
[0m12:15:51.250559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c7030629-2f43-47d6-a81d-ffbc20875807', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8005a9b0>]}
[0m12:15:51.250886 [debug] [MainThread]: On master: ROLLBACK
[0m12:15:51.251232 [debug] [MainThread]: Using postgres connection "master"
[0m12:15:51.251483 [debug] [MainThread]: On master: BEGIN
[0m12:15:51.251880 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:15:51.252157 [debug] [MainThread]: On master: COMMIT
[0m12:15:51.252421 [debug] [MainThread]: Using postgres connection "master"
[0m12:15:51.252657 [debug] [MainThread]: On master: COMMIT
[0m12:15:51.252984 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:15:51.253265 [debug] [MainThread]: On master: Close
[0m12:15:51.254458 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.fact_waterlevel
[0m12:15:51.254831 [info ] [Thread-1 (]: 1 of 1 START sql incremental model fact.fact_waterlevel ........................ [RUN]
[0m12:15:51.255172 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_fact, now model.etl_waterlevel.fact_waterlevel)
[0m12:15:51.255443 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.fact_waterlevel
[0m12:15:51.262507 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.fact_waterlevel"
[0m12:15:51.264265 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.fact_waterlevel
[0m12:15:51.292053 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m12:15:51.292420 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

    
  
    

  create temporary table "fact_waterlevel__dbt_tmp121551280158"
  
  
    as
  
  (
    

with main as (
    select
        distinct
        concat("stationId",'_',"stationCode") as station_key,
        "stationId" as station_id,
        "stationCode" as station_code,
        "waterLevel" as water_level,
        "waterlevelStatus" as waterlevel_status,
        case
            when "waterlevelStatus" = 3 then '🚨 Beyond Danger'
            when "waterlevelStatus" = 2 then '⚠️ Between Warning and Danger'
            when "waterlevelStatus" = 1 then '🔶 Between Alert and Warning'
            when "waterlevelStatus" = 0 then '✅ Between Normal and Alert'
            when "waterlevelStatus" = -1 then '🟢 Below Normal (Safe)'
            else '❓ Unknown Status'
        end as waterlevel_condition,
        "stationName",
        "districtName",
        to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp AS last_update
    from
        raw.waterlevels w
    where
        "stationStatus" = 1

        
        and to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp >= (
            select max(last_update) - interval '1 hour' from "airflow"."fact"."fact_waterlevel"
        )
        
)

select * from main
  );
  
  
[0m12:15:51.292778 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:15:51.307869 [debug] [Thread-1 (]: SQL status: SELECT 144 in 0.015 seconds
[0m12:15:51.315081 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m12:15:51.315395 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: BEGIN
[0m12:15:51.315827 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m12:15:51.316129 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m12:15:51.316436 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp121551280158'
        
      order by ordinal_position

  
[0m12:15:51.319236 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.003 seconds
[0m12:15:51.321893 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m12:15:51.322184 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m12:15:51.323530 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m12:15:51.330067 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m12:15:51.330391 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp121551280158'
        
      order by ordinal_position

  
[0m12:15:51.331624 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m12:15:51.333330 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m12:15:51.333623 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m12:15:51.334783 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m12:15:51.339455 [debug] [Thread-1 (]: 
    In "airflow"."fact"."fact_waterlevel":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m12:15:51.344588 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.fact_waterlevel"
[0m12:15:51.345572 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m12:15:51.345892 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      
        
        
        delete from "airflow"."fact"."fact_waterlevel" as DBT_INTERNAL_DEST
        where (station_key) in (
            select distinct station_key
            from "fact_waterlevel__dbt_tmp121551280158" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airflow"."fact"."fact_waterlevel" ("station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update")
    (
        select "station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update"
        from "fact_waterlevel__dbt_tmp121551280158"
    )
  
[0m12:15:51.346893 [debug] [Thread-1 (]: SQL status: INSERT 0 144 in 0.001 seconds
[0m12:15:51.354419 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m12:15:51.354717 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m12:15:51.354989 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m12:15:51.356060 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m12:15:51.357078 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: Close
[0m12:15:51.358357 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7030629-2f43-47d6-a81d-ffbc20875807', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81c98d30>]}
[0m12:15:51.359074 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model fact.fact_waterlevel ................... [[32mINSERT 0 144[0m in 0.10s]
[0m12:15:51.359584 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.fact_waterlevel
[0m12:15:51.360262 [debug] [MainThread]: Using postgres connection "master"
[0m12:15:51.360543 [debug] [MainThread]: On master: BEGIN
[0m12:15:51.360769 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:15:51.362212 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m12:15:51.362451 [debug] [MainThread]: On master: COMMIT
[0m12:15:51.362670 [debug] [MainThread]: Using postgres connection "master"
[0m12:15:51.362867 [debug] [MainThread]: On master: COMMIT
[0m12:15:51.363114 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:15:51.363304 [debug] [MainThread]: On master: Close
[0m12:15:51.363571 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:15:51.363780 [debug] [MainThread]: Connection 'model.etl_waterlevel.fact_waterlevel' was properly closed.
[0m12:15:51.363992 [info ] [MainThread]: 
[0m12:15:51.364219 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.19 seconds (0.19s).
[0m12:15:51.364594 [debug] [MainThread]: Command end result
[0m12:15:51.379901 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m12:15:51.380995 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m12:15:51.384878 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m12:15:51.385119 [info ] [MainThread]: 
[0m12:15:51.385370 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:15:51.385610 [info ] [MainThread]: 
[0m12:15:51.385887 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:15:51.386484 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.52193606, "process_in_blocks": "0", "process_kernel_time": 0.122099, "process_mem_max_rss": "111320", "process_out_blocks": "1702", "process_user_time": 1.219994}
[0m12:15:51.386817 [debug] [MainThread]: Command `dbt run` succeeded at 12:15:51.386772 after 0.52 seconds
[0m12:15:51.387067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81d40310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81c8c1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81daf6d0>]}
[0m12:15:51.387324 [debug] [MainThread]: Flushing usage events
[0m12:15:52.722868 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:05:05.738321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f788340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e87bd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e87bd30>]}


============================== 13:05:05.742145 | 13ab1187-668a-4fa5-88f1-dc0c6c75b175 ==============================
[0m13:05:05.742145 [info ] [MainThread]: Running with dbt=1.9.0
[0m13:05:05.742556 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'debug': 'False', 'profiles_dir': '/home/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --models fact_waterlevel', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:05:05.827406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '13ab1187-668a-4fa5-88f1-dc0c6c75b175', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff918ea7a0>]}
[0m13:05:05.854145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '13ab1187-668a-4fa5-88f1-dc0c6c75b175', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f64a7a0>]}
[0m13:05:05.854625 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:05:05.888852 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m13:05:05.938202 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:05:05.938518 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:05:05.941685 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m13:05:05.953409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '13ab1187-668a-4fa5-88f1-dc0c6c75b175', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8dad4580>]}
[0m13:05:05.989943 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m13:05:05.993965 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m13:05:06.002570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '13ab1187-668a-4fa5-88f1-dc0c6c75b175', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8daf3220>]}
[0m13:05:06.002947 [info ] [MainThread]: Found 3 models, 434 macros
[0m13:05:06.003199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '13ab1187-668a-4fa5-88f1-dc0c6c75b175', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8daf31c0>]}
[0m13:05:06.003902 [info ] [MainThread]: 
[0m13:05:06.004169 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:05:06.004371 [info ] [MainThread]: 
[0m13:05:06.004669 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:05:06.005236 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m13:05:06.044392 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m13:05:06.044810 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m13:05:06.045094 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:05:06.047873 [debug] [ThreadPool]: SQL status: SELECT 20 in 0.003 seconds
[0m13:05:06.048614 [debug] [ThreadPool]: On list_airflow: Close
[0m13:05:06.051246 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_dim)
[0m13:05:06.054391 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m13:05:06.054686 [debug] [ThreadPool]: On list_airflow_dim: BEGIN
[0m13:05:06.054935 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:05:06.056538 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m13:05:06.056884 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m13:05:06.057160 [debug] [ThreadPool]: On list_airflow_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dim'
  
[0m13:05:06.058530 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.001 seconds
[0m13:05:06.059215 [debug] [ThreadPool]: On list_airflow_dim: ROLLBACK
[0m13:05:06.059543 [debug] [ThreadPool]: On list_airflow_dim: Close
[0m13:05:06.059965 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_dim, now list_airflow_fact)
[0m13:05:06.061402 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m13:05:06.061679 [debug] [ThreadPool]: On list_airflow_fact: BEGIN
[0m13:05:06.061918 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:05:06.063347 [debug] [ThreadPool]: SQL status: BEGIN in 0.001 seconds
[0m13:05:06.063605 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m13:05:06.063882 [debug] [ThreadPool]: On list_airflow_fact: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_fact"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'fact'
  
[0m13:05:06.065130 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m13:05:06.065777 [debug] [ThreadPool]: On list_airflow_fact: ROLLBACK
[0m13:05:06.066105 [debug] [ThreadPool]: On list_airflow_fact: Close
[0m13:05:06.068542 [debug] [MainThread]: Using postgres connection "master"
[0m13:05:06.068864 [debug] [MainThread]: On master: BEGIN
[0m13:05:06.069106 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:05:06.070565 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m13:05:06.070850 [debug] [MainThread]: Using postgres connection "master"
[0m13:05:06.071147 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:05:06.074086 [debug] [MainThread]: SQL status: SELECT 2 in 0.003 seconds
[0m13:05:06.074743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '13ab1187-668a-4fa5-88f1-dc0c6c75b175', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8daf2d10>]}
[0m13:05:06.075081 [debug] [MainThread]: On master: ROLLBACK
[0m13:05:06.075419 [debug] [MainThread]: Using postgres connection "master"
[0m13:05:06.075682 [debug] [MainThread]: On master: BEGIN
[0m13:05:06.076082 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m13:05:06.076344 [debug] [MainThread]: On master: COMMIT
[0m13:05:06.076592 [debug] [MainThread]: Using postgres connection "master"
[0m13:05:06.076848 [debug] [MainThread]: On master: COMMIT
[0m13:05:06.077196 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:05:06.077440 [debug] [MainThread]: On master: Close
[0m13:05:06.078543 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.fact_waterlevel
[0m13:05:06.078974 [info ] [Thread-1 (]: 1 of 1 START sql incremental model fact.fact_waterlevel ........................ [RUN]
[0m13:05:06.079293 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_fact, now model.etl_waterlevel.fact_waterlevel)
[0m13:05:06.079572 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.fact_waterlevel
[0m13:05:06.086430 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.fact_waterlevel"
[0m13:05:06.088027 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.fact_waterlevel
[0m13:05:06.115815 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m13:05:06.116172 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

    
  
    

  create temporary table "fact_waterlevel__dbt_tmp130506103902"
  
  
    as
  
  (
    

with main as (
    select
        distinct
        concat("stationId",'_',"stationCode") as station_key,
        "stationId" as station_id,
        "stationCode" as station_code,
        "waterLevel" as water_level,
        "waterlevelStatus" as waterlevel_status,
        case
            when "waterlevelStatus" = 3 then '🚨 Beyond Danger'
            when "waterlevelStatus" = 2 then '⚠️ Between Warning and Danger'
            when "waterlevelStatus" = 1 then '🔶 Between Alert and Warning'
            when "waterlevelStatus" = 0 then '✅ Between Normal and Alert'
            when "waterlevelStatus" = -1 then '🟢 Below Normal (Safe)'
            else '❓ Unknown Status'
        end as waterlevel_condition,
        "stationName",
        "districtName",
        to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp AS last_update
    from
        raw.waterlevels w
    where
        "stationStatus" = 1

        
        and to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp >= (
            select max(last_update) - interval '1 hour' from "airflow"."fact"."fact_waterlevel"
        )
        
)

select * from main
  );
  
  
[0m13:05:06.116493 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:05:06.128574 [debug] [Thread-1 (]: SQL status: SELECT 191 in 0.012 seconds
[0m13:05:06.135798 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m13:05:06.136103 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: BEGIN
[0m13:05:06.136497 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m13:05:06.136820 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m13:05:06.137106 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp130506103902'
        
      order by ordinal_position

  
[0m13:05:06.139880 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.002 seconds
[0m13:05:06.142563 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m13:05:06.142882 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m13:05:06.144256 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m13:05:06.150741 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m13:05:06.151063 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp130506103902'
        
      order by ordinal_position

  
[0m13:05:06.152274 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m13:05:06.153978 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m13:05:06.154273 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m13:05:06.155422 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m13:05:06.159865 [debug] [Thread-1 (]: 
    In "airflow"."fact"."fact_waterlevel":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m13:05:06.165285 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.fact_waterlevel"
[0m13:05:06.166320 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m13:05:06.166653 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      
        
        
        delete from "airflow"."fact"."fact_waterlevel" as DBT_INTERNAL_DEST
        where (station_key) in (
            select distinct station_key
            from "fact_waterlevel__dbt_tmp130506103902" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airflow"."fact"."fact_waterlevel" ("station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update")
    (
        select "station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update"
        from "fact_waterlevel__dbt_tmp130506103902"
    )
  
[0m13:05:06.167610 [debug] [Thread-1 (]: SQL status: INSERT 0 191 in 0.001 seconds
[0m13:05:06.175159 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m13:05:06.175463 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m13:05:06.175767 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m13:05:06.177039 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m13:05:06.178102 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: Close
[0m13:05:06.179287 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13ab1187-668a-4fa5-88f1-dc0c6c75b175', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff918ea7d0>]}
[0m13:05:06.179838 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model fact.fact_waterlevel ................... [[32mINSERT 0 191[0m in 0.10s]
[0m13:05:06.180277 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.fact_waterlevel
[0m13:05:06.180998 [debug] [MainThread]: Using postgres connection "master"
[0m13:05:06.181240 [debug] [MainThread]: On master: BEGIN
[0m13:05:06.181439 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:05:06.182951 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m13:05:06.183200 [debug] [MainThread]: On master: COMMIT
[0m13:05:06.183425 [debug] [MainThread]: Using postgres connection "master"
[0m13:05:06.183620 [debug] [MainThread]: On master: COMMIT
[0m13:05:06.183888 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:05:06.184095 [debug] [MainThread]: On master: Close
[0m13:05:06.184364 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:05:06.184576 [debug] [MainThread]: Connection 'model.etl_waterlevel.fact_waterlevel' was properly closed.
[0m13:05:06.184801 [info ] [MainThread]: 
[0m13:05:06.185029 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.18 seconds (0.18s).
[0m13:05:06.185400 [debug] [MainThread]: Command end result
[0m13:05:06.200358 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m13:05:06.201543 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m13:05:06.205515 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m13:05:06.205766 [info ] [MainThread]: 
[0m13:05:06.206033 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:05:06.206245 [info ] [MainThread]: 
[0m13:05:06.206459 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:05:06.206975 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.4946685, "process_in_blocks": "0", "process_kernel_time": 0.072916, "process_mem_max_rss": "111396", "process_out_blocks": "1702", "process_user_time": 1.202625}
[0m13:05:06.207314 [debug] [MainThread]: Command `dbt run` succeeded at 13:05:06.207269 after 0.50 seconds
[0m13:05:06.207557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f788340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ddd1420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f7f6290>]}
[0m13:05:06.207810 [debug] [MainThread]: Flushing usage events
[0m13:05:07.475682 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:17:42.494410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98764340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9784c4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9784c550>]}


============================== 14:17:42.498574 | 6c463f65-fd06-433e-b185-3e65135d2b6c ==============================
[0m14:17:42.498574 [info ] [MainThread]: Running with dbt=1.9.0
[0m14:17:42.498991 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'profiles_dir': '/home/airflow/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --models fact_waterlevel', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:17:42.589530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6c463f65-fd06-433e-b185-3e65135d2b6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a91a7a0>]}
[0m14:17:42.616590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6c463f65-fd06-433e-b185-3e65135d2b6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff988227a0>]}
[0m14:17:42.617177 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:17:42.652205 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m14:17:42.702803 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:17:42.703181 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:17:42.706430 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m14:17:42.718288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6c463f65-fd06-433e-b185-3e65135d2b6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96ac4580>]}
[0m14:17:42.754782 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m14:17:42.758460 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m14:17:42.768440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6c463f65-fd06-433e-b185-3e65135d2b6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96ae3220>]}
[0m14:17:42.768797 [info ] [MainThread]: Found 3 models, 434 macros
[0m14:17:42.769096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6c463f65-fd06-433e-b185-3e65135d2b6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96ae31c0>]}
[0m14:17:42.769852 [info ] [MainThread]: 
[0m14:17:42.770182 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:17:42.770444 [info ] [MainThread]: 
[0m14:17:42.770797 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:17:42.771426 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m14:17:42.813848 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m14:17:42.814283 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m14:17:42.814564 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:17:42.817639 [debug] [ThreadPool]: SQL status: SELECT 20 in 0.003 seconds
[0m14:17:42.818399 [debug] [ThreadPool]: On list_airflow: Close
[0m14:17:42.821126 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_dim)
[0m14:17:42.824350 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m14:17:42.824640 [debug] [ThreadPool]: On list_airflow_dim: BEGIN
[0m14:17:42.824889 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:17:42.826531 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m14:17:42.826834 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m14:17:42.827100 [debug] [ThreadPool]: On list_airflow_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dim'
  
[0m14:17:42.828547 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.001 seconds
[0m14:17:42.829208 [debug] [ThreadPool]: On list_airflow_dim: ROLLBACK
[0m14:17:42.829542 [debug] [ThreadPool]: On list_airflow_dim: Close
[0m14:17:42.829968 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_dim, now list_airflow_fact)
[0m14:17:42.831402 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m14:17:42.831691 [debug] [ThreadPool]: On list_airflow_fact: BEGIN
[0m14:17:42.831922 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:17:42.833456 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m14:17:42.833716 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m14:17:42.833988 [debug] [ThreadPool]: On list_airflow_fact: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_fact"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'fact'
  
[0m14:17:42.835257 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m14:17:42.835859 [debug] [ThreadPool]: On list_airflow_fact: ROLLBACK
[0m14:17:42.836197 [debug] [ThreadPool]: On list_airflow_fact: Close
[0m14:17:42.838592 [debug] [MainThread]: Using postgres connection "master"
[0m14:17:42.838858 [debug] [MainThread]: On master: BEGIN
[0m14:17:42.839106 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:17:42.840657 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m14:17:42.840906 [debug] [MainThread]: Using postgres connection "master"
[0m14:17:42.841221 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:17:42.844426 [debug] [MainThread]: SQL status: SELECT 2 in 0.003 seconds
[0m14:17:42.845119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6c463f65-fd06-433e-b185-3e65135d2b6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96ae2d10>]}
[0m14:17:42.845474 [debug] [MainThread]: On master: ROLLBACK
[0m14:17:42.845815 [debug] [MainThread]: Using postgres connection "master"
[0m14:17:42.846055 [debug] [MainThread]: On master: BEGIN
[0m14:17:42.846451 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:17:42.846702 [debug] [MainThread]: On master: COMMIT
[0m14:17:42.846941 [debug] [MainThread]: Using postgres connection "master"
[0m14:17:42.847198 [debug] [MainThread]: On master: COMMIT
[0m14:17:42.847538 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:17:42.847786 [debug] [MainThread]: On master: Close
[0m14:17:42.848923 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.fact_waterlevel
[0m14:17:42.849323 [info ] [Thread-1 (]: 1 of 1 START sql incremental model fact.fact_waterlevel ........................ [RUN]
[0m14:17:42.849646 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_fact, now model.etl_waterlevel.fact_waterlevel)
[0m14:17:42.849919 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.fact_waterlevel
[0m14:17:42.857009 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.fact_waterlevel"
[0m14:17:42.858074 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.fact_waterlevel
[0m14:17:42.886604 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m14:17:42.886981 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

    
  
    

  create temporary table "fact_waterlevel__dbt_tmp141742874621"
  
  
    as
  
  (
    

with main as (
    select
        distinct
        concat("stationId",'_',"stationCode") as station_key,
        "stationId" as station_id,
        "stationCode" as station_code,
        "waterLevel" as water_level,
        "waterlevelStatus" as waterlevel_status,
        case
            when "waterlevelStatus" = 3 then '🚨 Beyond Danger'
            when "waterlevelStatus" = 2 then '⚠️ Between Warning and Danger'
            when "waterlevelStatus" = 1 then '🔶 Between Alert and Warning'
            when "waterlevelStatus" = 0 then '✅ Between Normal and Alert'
            when "waterlevelStatus" = -1 then '🟢 Below Normal (Safe)'
            else '❓ Unknown Status'
        end as waterlevel_condition,
        "stationName",
        "districtName",
        to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp AS last_update
    from
        raw.waterlevels w
    where
        "stationStatus" = 1

        
        and to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp >= (
            select max(last_update) - interval '1 hour' from "airflow"."fact"."fact_waterlevel"
        )
        
)

select * from main
  );
  
  
[0m14:17:42.887330 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:17:42.901583 [debug] [Thread-1 (]: SQL status: SELECT 180 in 0.014 seconds
[0m14:17:42.908906 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m14:17:42.909222 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: BEGIN
[0m14:17:42.909638 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m14:17:42.909986 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m14:17:42.910292 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp141742874621'
        
      order by ordinal_position

  
[0m14:17:42.913200 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.003 seconds
[0m14:17:42.915833 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m14:17:42.916154 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m14:17:42.917528 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m14:17:42.924004 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m14:17:42.924325 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp141742874621'
        
      order by ordinal_position

  
[0m14:17:42.925526 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m14:17:42.927190 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m14:17:42.927477 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m14:17:42.928694 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m14:17:42.933274 [debug] [Thread-1 (]: 
    In "airflow"."fact"."fact_waterlevel":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m14:17:42.938398 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.fact_waterlevel"
[0m14:17:42.939269 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m14:17:42.939577 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      
        
        
        delete from "airflow"."fact"."fact_waterlevel" as DBT_INTERNAL_DEST
        where (station_key) in (
            select distinct station_key
            from "fact_waterlevel__dbt_tmp141742874621" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airflow"."fact"."fact_waterlevel" ("station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update")
    (
        select "station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update"
        from "fact_waterlevel__dbt_tmp141742874621"
    )
  
[0m14:17:42.940527 [debug] [Thread-1 (]: SQL status: INSERT 0 180 in 0.001 seconds
[0m14:17:42.948399 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m14:17:42.948698 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m14:17:42.949001 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m14:17:42.950332 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m14:17:42.951396 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: Close
[0m14:17:42.952448 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c463f65-fd06-433e-b185-3e65135d2b6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a91a7d0>]}
[0m14:17:42.952912 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model fact.fact_waterlevel ................... [[32mINSERT 0 180[0m in 0.10s]
[0m14:17:42.953280 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.fact_waterlevel
[0m14:17:42.953976 [debug] [MainThread]: Using postgres connection "master"
[0m14:17:42.954226 [debug] [MainThread]: On master: BEGIN
[0m14:17:42.954452 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:17:42.956020 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m14:17:42.956247 [debug] [MainThread]: On master: COMMIT
[0m14:17:42.956454 [debug] [MainThread]: Using postgres connection "master"
[0m14:17:42.956646 [debug] [MainThread]: On master: COMMIT
[0m14:17:42.956906 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:17:42.957128 [debug] [MainThread]: On master: Close
[0m14:17:42.957406 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:17:42.957633 [debug] [MainThread]: Connection 'model.etl_waterlevel.fact_waterlevel' was properly closed.
[0m14:17:42.957873 [info ] [MainThread]: 
[0m14:17:42.958158 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.19 seconds (0.19s).
[0m14:17:42.958544 [debug] [MainThread]: Command end result
[0m14:17:42.972682 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m14:17:42.973648 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m14:17:42.977383 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m14:17:42.977611 [info ] [MainThread]: 
[0m14:17:42.977872 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:17:42.978083 [info ] [MainThread]: 
[0m14:17:42.978296 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:17:42.978831 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.51201427, "process_in_blocks": "0", "process_kernel_time": 0.125596, "process_mem_max_rss": "111400", "process_out_blocks": "1702", "process_user_time": 1.219079}
[0m14:17:42.979163 [debug] [MainThread]: Command `dbt run` succeeded at 14:17:42.979118 after 0.51 seconds
[0m14:17:42.979407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98764340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96dc9420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff987d2290>]}
[0m14:17:42.979650 [debug] [MainThread]: Flushing usage events
[0m14:17:44.373609 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:19:04.345182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a078340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8915c4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8915c550>]}


============================== 15:19:04.348822 | bc92bc66-a143-43fe-850a-10f5d5fa759f ==============================
[0m15:19:04.348822 [info ] [MainThread]: Running with dbt=1.9.0
[0m15:19:04.349218 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --models fact_waterlevel', 'send_anonymous_usage_stats': 'True'}
[0m15:19:04.450971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bc92bc66-a143-43fe-850a-10f5d5fa759f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c26e7a0>]}
[0m15:19:04.478478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bc92bc66-a143-43fe-850a-10f5d5fa759f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a1367a0>]}
[0m15:19:04.479029 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:19:04.514711 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m15:19:04.565160 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:19:04.565477 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:19:04.568648 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m15:19:04.580455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bc92bc66-a143-43fe-850a-10f5d5fa759f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88424580>]}
[0m15:19:04.616395 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m15:19:04.619953 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m15:19:04.629661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bc92bc66-a143-43fe-850a-10f5d5fa759f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88443220>]}
[0m15:19:04.629984 [info ] [MainThread]: Found 3 models, 434 macros
[0m15:19:04.630236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bc92bc66-a143-43fe-850a-10f5d5fa759f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff884431c0>]}
[0m15:19:04.630962 [info ] [MainThread]: 
[0m15:19:04.631302 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:19:04.631621 [info ] [MainThread]: 
[0m15:19:04.631993 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:19:04.632608 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m15:19:04.676777 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m15:19:04.677216 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m15:19:04.677488 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:19:04.680811 [debug] [ThreadPool]: SQL status: SELECT 20 in 0.003 seconds
[0m15:19:04.681680 [debug] [ThreadPool]: On list_airflow: Close
[0m15:19:04.684756 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_fact)
[0m15:19:04.688327 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m15:19:04.688630 [debug] [ThreadPool]: On list_airflow_fact: BEGIN
[0m15:19:04.688885 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:19:04.690694 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m15:19:04.690995 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m15:19:04.691263 [debug] [ThreadPool]: On list_airflow_fact: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_fact"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'fact'
  
[0m15:19:04.692694 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m15:19:04.693368 [debug] [ThreadPool]: On list_airflow_fact: ROLLBACK
[0m15:19:04.693718 [debug] [ThreadPool]: On list_airflow_fact: Close
[0m15:19:04.694121 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_fact, now list_airflow_dim)
[0m15:19:04.695542 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m15:19:04.695806 [debug] [ThreadPool]: On list_airflow_dim: BEGIN
[0m15:19:04.696041 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:19:04.697606 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m15:19:04.697890 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m15:19:04.698211 [debug] [ThreadPool]: On list_airflow_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dim'
  
[0m15:19:04.699720 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.001 seconds
[0m15:19:04.700366 [debug] [ThreadPool]: On list_airflow_dim: ROLLBACK
[0m15:19:04.700694 [debug] [ThreadPool]: On list_airflow_dim: Close
[0m15:19:04.703250 [debug] [MainThread]: Using postgres connection "master"
[0m15:19:04.703516 [debug] [MainThread]: On master: BEGIN
[0m15:19:04.703756 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:19:04.705306 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m15:19:04.705579 [debug] [MainThread]: Using postgres connection "master"
[0m15:19:04.705887 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:19:04.709150 [debug] [MainThread]: SQL status: SELECT 2 in 0.003 seconds
[0m15:19:04.709798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bc92bc66-a143-43fe-850a-10f5d5fa759f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c202350>]}
[0m15:19:04.710146 [debug] [MainThread]: On master: ROLLBACK
[0m15:19:04.710519 [debug] [MainThread]: Using postgres connection "master"
[0m15:19:04.710773 [debug] [MainThread]: On master: BEGIN
[0m15:19:04.711166 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:19:04.711423 [debug] [MainThread]: On master: COMMIT
[0m15:19:04.711664 [debug] [MainThread]: Using postgres connection "master"
[0m15:19:04.711904 [debug] [MainThread]: On master: COMMIT
[0m15:19:04.712222 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:19:04.712467 [debug] [MainThread]: On master: Close
[0m15:19:04.713683 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.fact_waterlevel
[0m15:19:04.714044 [info ] [Thread-1 (]: 1 of 1 START sql incremental model fact.fact_waterlevel ........................ [RUN]
[0m15:19:04.714408 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_dim, now model.etl_waterlevel.fact_waterlevel)
[0m15:19:04.714679 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.fact_waterlevel
[0m15:19:04.721729 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.fact_waterlevel"
[0m15:19:04.723389 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.fact_waterlevel
[0m15:19:04.751537 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m15:19:04.751895 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

    
  
    

  create temporary table "fact_waterlevel__dbt_tmp151904739086"
  
  
    as
  
  (
    

with main as (
    select
        distinct
        concat("stationId",'_',"stationCode") as station_key,
        "stationId" as station_id,
        "stationCode" as station_code,
        "waterLevel" as water_level,
        "waterlevelStatus" as waterlevel_status,
        case
            when "waterlevelStatus" = 3 then '🚨 Beyond Danger'
            when "waterlevelStatus" = 2 then '⚠️ Between Warning and Danger'
            when "waterlevelStatus" = 1 then '🔶 Between Alert and Warning'
            when "waterlevelStatus" = 0 then '✅ Between Normal and Alert'
            when "waterlevelStatus" = -1 then '🟢 Below Normal (Safe)'
            else '❓ Unknown Status'
        end as waterlevel_condition,
        "stationName",
        "districtName",
        to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp AS last_update
    from
        raw.waterlevels w
    where
        "stationStatus" = 1

        
        and to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp >= (
            select max(last_update) - interval '1 hour' from "airflow"."fact"."fact_waterlevel"
        )
        
)

select * from main
  );
  
  
[0m15:19:04.752248 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:19:04.767129 [debug] [Thread-1 (]: SQL status: SELECT 188 in 0.015 seconds
[0m15:19:04.774371 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m15:19:04.774683 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: BEGIN
[0m15:19:04.775087 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m15:19:04.775390 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m15:19:04.775678 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp151904739086'
        
      order by ordinal_position

  
[0m15:19:04.778592 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.003 seconds
[0m15:19:04.781253 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m15:19:04.781559 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m15:19:04.782930 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m15:19:04.789373 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m15:19:04.789689 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp151904739086'
        
      order by ordinal_position

  
[0m15:19:04.790917 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m15:19:04.792637 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m15:19:04.792936 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m15:19:04.794215 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m15:19:04.798735 [debug] [Thread-1 (]: 
    In "airflow"."fact"."fact_waterlevel":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m15:19:04.803909 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.fact_waterlevel"
[0m15:19:04.804735 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m15:19:04.805062 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      
        
        
        delete from "airflow"."fact"."fact_waterlevel" as DBT_INTERNAL_DEST
        where (station_key) in (
            select distinct station_key
            from "fact_waterlevel__dbt_tmp151904739086" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airflow"."fact"."fact_waterlevel" ("station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update")
    (
        select "station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update"
        from "fact_waterlevel__dbt_tmp151904739086"
    )
  
[0m15:19:04.806075 [debug] [Thread-1 (]: SQL status: INSERT 0 188 in 0.001 seconds
[0m15:19:04.813808 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m15:19:04.814232 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m15:19:04.814550 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m15:19:04.816036 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:19:04.817115 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: Close
[0m15:19:04.818290 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc92bc66-a143-43fe-850a-10f5d5fa759f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c202350>]}
[0m15:19:04.818801 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model fact.fact_waterlevel ................... [[32mINSERT 0 188[0m in 0.10s]
[0m15:19:04.819178 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.fact_waterlevel
[0m15:19:04.819873 [debug] [MainThread]: Using postgres connection "master"
[0m15:19:04.820112 [debug] [MainThread]: On master: BEGIN
[0m15:19:04.820322 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:19:04.821923 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m15:19:04.822178 [debug] [MainThread]: On master: COMMIT
[0m15:19:04.822396 [debug] [MainThread]: Using postgres connection "master"
[0m15:19:04.822591 [debug] [MainThread]: On master: COMMIT
[0m15:19:04.822839 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:19:04.823038 [debug] [MainThread]: On master: Close
[0m15:19:04.823302 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:19:04.823507 [debug] [MainThread]: Connection 'model.etl_waterlevel.fact_waterlevel' was properly closed.
[0m15:19:04.823723 [info ] [MainThread]: 
[0m15:19:04.823947 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.19 seconds (0.19s).
[0m15:19:04.824328 [debug] [MainThread]: Command end result
[0m15:19:04.839789 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m15:19:04.840917 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m15:19:04.844713 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m15:19:04.844970 [info ] [MainThread]: 
[0m15:19:04.845227 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:19:04.845441 [info ] [MainThread]: 
[0m15:19:04.845662 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:19:04.846180 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.52794546, "process_in_blocks": "0", "process_kernel_time": 0.126733, "process_mem_max_rss": "111544", "process_out_blocks": "1702", "process_user_time": 1.21445}
[0m15:19:04.846495 [debug] [MainThread]: Command `dbt run` succeeded at 15:19:04.846450 after 0.53 seconds
[0m15:19:04.846742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a078340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a0e6290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff883ecf40>]}
[0m15:19:04.846981 [debug] [MainThread]: Flushing usage events
[0m15:19:06.245222 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:20:28.822396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4888370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3973d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3973d30>]}


============================== 16:20:28.826935 | 51f96a2a-ed6f-402b-8181-d7b935d0ca74 ==============================
[0m16:20:28.826935 [info ] [MainThread]: Running with dbt=1.9.0
[0m16:20:28.827352 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models fact_waterlevel', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:20:28.926279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '51f96a2a-ed6f-402b-8181-d7b935d0ca74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4918310>]}
[0m16:20:28.953422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '51f96a2a-ed6f-402b-8181-d7b935d0ca74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4231810>]}
[0m16:20:28.953956 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:20:28.990179 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m16:20:29.041512 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:20:29.041870 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:20:29.044981 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m16:20:29.056804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '51f96a2a-ed6f-402b-8181-d7b935d0ca74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2bc45b0>]}
[0m16:20:29.092562 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m16:20:29.096512 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m16:20:29.106129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '51f96a2a-ed6f-402b-8181-d7b935d0ca74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2be3220>]}
[0m16:20:29.106434 [info ] [MainThread]: Found 3 models, 434 macros
[0m16:20:29.106676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '51f96a2a-ed6f-402b-8181-d7b935d0ca74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2be31c0>]}
[0m16:20:29.107409 [info ] [MainThread]: 
[0m16:20:29.107682 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:20:29.107933 [info ] [MainThread]: 
[0m16:20:29.108238 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:20:29.108875 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m16:20:29.151288 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m16:20:29.151719 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m16:20:29.151988 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:20:29.155232 [debug] [ThreadPool]: SQL status: SELECT 20 in 0.003 seconds
[0m16:20:29.156010 [debug] [ThreadPool]: On list_airflow: Close
[0m16:20:29.158719 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_dim)
[0m16:20:29.161897 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m16:20:29.162170 [debug] [ThreadPool]: On list_airflow_dim: BEGIN
[0m16:20:29.162436 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:20:29.164132 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m16:20:29.164430 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m16:20:29.164725 [debug] [ThreadPool]: On list_airflow_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dim'
  
[0m16:20:29.166228 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.001 seconds
[0m16:20:29.166906 [debug] [ThreadPool]: On list_airflow_dim: ROLLBACK
[0m16:20:29.167238 [debug] [ThreadPool]: On list_airflow_dim: Close
[0m16:20:29.167635 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_dim, now list_airflow_fact)
[0m16:20:29.169011 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m16:20:29.169266 [debug] [ThreadPool]: On list_airflow_fact: BEGIN
[0m16:20:29.169521 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:20:29.170990 [debug] [ThreadPool]: SQL status: BEGIN in 0.001 seconds
[0m16:20:29.171247 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m16:20:29.171533 [debug] [ThreadPool]: On list_airflow_fact: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_fact"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'fact'
  
[0m16:20:29.172798 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m16:20:29.173427 [debug] [ThreadPool]: On list_airflow_fact: ROLLBACK
[0m16:20:29.173747 [debug] [ThreadPool]: On list_airflow_fact: Close
[0m16:20:29.176220 [debug] [MainThread]: Using postgres connection "master"
[0m16:20:29.176504 [debug] [MainThread]: On master: BEGIN
[0m16:20:29.176738 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:20:29.178277 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m16:20:29.178551 [debug] [MainThread]: Using postgres connection "master"
[0m16:20:29.178847 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:20:29.181970 [debug] [MainThread]: SQL status: SELECT 2 in 0.003 seconds
[0m16:20:29.182655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '51f96a2a-ed6f-402b-8181-d7b935d0ca74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2be2ad0>]}
[0m16:20:29.182976 [debug] [MainThread]: On master: ROLLBACK
[0m16:20:29.183323 [debug] [MainThread]: Using postgres connection "master"
[0m16:20:29.183577 [debug] [MainThread]: On master: BEGIN
[0m16:20:29.183963 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m16:20:29.184212 [debug] [MainThread]: On master: COMMIT
[0m16:20:29.184464 [debug] [MainThread]: Using postgres connection "master"
[0m16:20:29.184760 [debug] [MainThread]: On master: COMMIT
[0m16:20:29.185078 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:20:29.185337 [debug] [MainThread]: On master: Close
[0m16:20:29.186511 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.fact_waterlevel
[0m16:20:29.186873 [info ] [Thread-1 (]: 1 of 1 START sql incremental model fact.fact_waterlevel ........................ [RUN]
[0m16:20:29.187192 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_fact, now model.etl_waterlevel.fact_waterlevel)
[0m16:20:29.187485 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.fact_waterlevel
[0m16:20:29.194439 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.fact_waterlevel"
[0m16:20:29.196143 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.fact_waterlevel
[0m16:20:29.224312 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m16:20:29.224684 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

    
  
    

  create temporary table "fact_waterlevel__dbt_tmp162029212261"
  
  
    as
  
  (
    

with main as (
    select
        distinct
        concat("stationId",'_',"stationCode") as station_key,
        "stationId" as station_id,
        "stationCode" as station_code,
        "waterLevel" as water_level,
        "waterlevelStatus" as waterlevel_status,
        case
            when "waterlevelStatus" = 3 then '🚨 Beyond Danger'
            when "waterlevelStatus" = 2 then '⚠️ Between Warning and Danger'
            when "waterlevelStatus" = 1 then '🔶 Between Alert and Warning'
            when "waterlevelStatus" = 0 then '✅ Between Normal and Alert'
            when "waterlevelStatus" = -1 then '🟢 Below Normal (Safe)'
            else '❓ Unknown Status'
        end as waterlevel_condition,
        "stationName",
        "districtName",
        to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp AS last_update
    from
        raw.waterlevels w
    where
        "stationStatus" = 1

        
        and to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp >= (
            select max(last_update) - interval '1 hour' from "airflow"."fact"."fact_waterlevel"
        )
        
)

select * from main
  );
  
  
[0m16:20:29.225013 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:20:29.240145 [debug] [Thread-1 (]: SQL status: SELECT 140 in 0.015 seconds
[0m16:20:29.247532 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m16:20:29.247848 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: BEGIN
[0m16:20:29.248255 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m16:20:29.248558 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m16:20:29.248834 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp162029212261'
        
      order by ordinal_position

  
[0m16:20:29.251747 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.003 seconds
[0m16:20:29.254365 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m16:20:29.254686 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m16:20:29.256085 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m16:20:29.262581 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m16:20:29.262886 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp162029212261'
        
      order by ordinal_position

  
[0m16:20:29.264142 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m16:20:29.265818 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m16:20:29.266107 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m16:20:29.267347 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m16:20:29.272017 [debug] [Thread-1 (]: 
    In "airflow"."fact"."fact_waterlevel":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m16:20:29.277244 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.fact_waterlevel"
[0m16:20:29.278141 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m16:20:29.278468 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      
        
        
        delete from "airflow"."fact"."fact_waterlevel" as DBT_INTERNAL_DEST
        where (station_key) in (
            select distinct station_key
            from "fact_waterlevel__dbt_tmp162029212261" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airflow"."fact"."fact_waterlevel" ("station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update")
    (
        select "station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update"
        from "fact_waterlevel__dbt_tmp162029212261"
    )
  
[0m16:20:29.279377 [debug] [Thread-1 (]: SQL status: INSERT 0 140 in 0.001 seconds
[0m16:20:29.286807 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m16:20:29.287108 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m16:20:29.287380 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m16:20:29.288750 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m16:20:29.289938 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: Close
[0m16:20:29.291082 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51f96a2a-ed6f-402b-8181-d7b935d0ca74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6a86800>]}
[0m16:20:29.291561 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model fact.fact_waterlevel ................... [[32mINSERT 0 140[0m in 0.10s]
[0m16:20:29.291976 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.fact_waterlevel
[0m16:20:29.292691 [debug] [MainThread]: Using postgres connection "master"
[0m16:20:29.292937 [debug] [MainThread]: On master: BEGIN
[0m16:20:29.293164 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:20:29.294830 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m16:20:29.295082 [debug] [MainThread]: On master: COMMIT
[0m16:20:29.295315 [debug] [MainThread]: Using postgres connection "master"
[0m16:20:29.295514 [debug] [MainThread]: On master: COMMIT
[0m16:20:29.295763 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:20:29.295981 [debug] [MainThread]: On master: Close
[0m16:20:29.296279 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:20:29.296547 [debug] [MainThread]: Connection 'model.etl_waterlevel.fact_waterlevel' was properly closed.
[0m16:20:29.296803 [info ] [MainThread]: 
[0m16:20:29.297030 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.19 seconds (0.19s).
[0m16:20:29.297423 [debug] [MainThread]: Command end result
[0m16:20:29.312585 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m16:20:29.313586 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m16:20:29.317814 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m16:20:29.318086 [info ] [MainThread]: 
[0m16:20:29.318417 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:20:29.318670 [info ] [MainThread]: 
[0m16:20:29.318902 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:20:29.319493 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.52569526, "process_in_blocks": "0", "process_kernel_time": 0.130193, "process_mem_max_rss": "111288", "process_out_blocks": "1702", "process_user_time": 1.226824}
[0m16:20:29.319855 [debug] [MainThread]: Command `dbt run` succeeded at 16:20:29.319799 after 0.53 seconds
[0m16:20:29.320121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4888370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb490dd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb48f68f0>]}
[0m16:20:29.320405 [debug] [MainThread]: Flushing usage events
[0m16:20:30.499285 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:05:06.772981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba598340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb96804f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9680550>]}


============================== 17:05:06.777192 | b9d4a424-2af1-4d05-a800-c59fbf02d475 ==============================
[0m17:05:06.777192 [info ] [MainThread]: Running with dbt=1.9.0
[0m17:05:06.777590 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --models fact_waterlevel', 'send_anonymous_usage_stats': 'True'}
[0m17:05:06.862293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b9d4a424-2af1-4d05-a800-c59fbf02d475', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbc74e7a0>]}
[0m17:05:06.889395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b9d4a424-2af1-4d05-a800-c59fbf02d475', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba45a7a0>]}
[0m17:05:06.889912 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:05:06.924105 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m17:05:06.973171 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:05:06.973519 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:05:06.976660 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m17:05:06.988454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b9d4a424-2af1-4d05-a800-c59fbf02d475', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb893c580>]}
[0m17:05:07.024342 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m17:05:07.027683 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m17:05:07.036391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b9d4a424-2af1-4d05-a800-c59fbf02d475', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb895b220>]}
[0m17:05:07.036717 [info ] [MainThread]: Found 3 models, 434 macros
[0m17:05:07.036959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b9d4a424-2af1-4d05-a800-c59fbf02d475', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb895b1c0>]}
[0m17:05:07.037629 [info ] [MainThread]: 
[0m17:05:07.037919 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:05:07.038161 [info ] [MainThread]: 
[0m17:05:07.038479 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:05:07.039041 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m17:05:07.078431 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m17:05:07.078865 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m17:05:07.079144 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:05:07.081887 [debug] [ThreadPool]: SQL status: SELECT 20 in 0.003 seconds
[0m17:05:07.082654 [debug] [ThreadPool]: On list_airflow: Close
[0m17:05:07.085420 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_dim)
[0m17:05:07.088689 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m17:05:07.088986 [debug] [ThreadPool]: On list_airflow_dim: BEGIN
[0m17:05:07.089244 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:05:07.090853 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m17:05:07.091144 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m17:05:07.091403 [debug] [ThreadPool]: On list_airflow_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dim'
  
[0m17:05:07.092767 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.001 seconds
[0m17:05:07.093428 [debug] [ThreadPool]: On list_airflow_dim: ROLLBACK
[0m17:05:07.093784 [debug] [ThreadPool]: On list_airflow_dim: Close
[0m17:05:07.094193 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_dim, now list_airflow_fact)
[0m17:05:07.095636 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m17:05:07.095892 [debug] [ThreadPool]: On list_airflow_fact: BEGIN
[0m17:05:07.096124 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:05:07.097574 [debug] [ThreadPool]: SQL status: BEGIN in 0.001 seconds
[0m17:05:07.097819 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m17:05:07.098077 [debug] [ThreadPool]: On list_airflow_fact: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_fact"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'fact'
  
[0m17:05:07.099281 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m17:05:07.099896 [debug] [ThreadPool]: On list_airflow_fact: ROLLBACK
[0m17:05:07.100216 [debug] [ThreadPool]: On list_airflow_fact: Close
[0m17:05:07.102694 [debug] [MainThread]: Using postgres connection "master"
[0m17:05:07.102988 [debug] [MainThread]: On master: BEGIN
[0m17:05:07.103223 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:05:07.104681 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m17:05:07.104945 [debug] [MainThread]: Using postgres connection "master"
[0m17:05:07.105249 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:05:07.108500 [debug] [MainThread]: SQL status: SELECT 2 in 0.003 seconds
[0m17:05:07.109145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b9d4a424-2af1-4d05-a800-c59fbf02d475', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb895ad10>]}
[0m17:05:07.109482 [debug] [MainThread]: On master: ROLLBACK
[0m17:05:07.109831 [debug] [MainThread]: Using postgres connection "master"
[0m17:05:07.110074 [debug] [MainThread]: On master: BEGIN
[0m17:05:07.110473 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m17:05:07.110729 [debug] [MainThread]: On master: COMMIT
[0m17:05:07.110968 [debug] [MainThread]: Using postgres connection "master"
[0m17:05:07.111203 [debug] [MainThread]: On master: COMMIT
[0m17:05:07.111514 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:05:07.111759 [debug] [MainThread]: On master: Close
[0m17:05:07.112856 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.fact_waterlevel
[0m17:05:07.113243 [info ] [Thread-1 (]: 1 of 1 START sql incremental model fact.fact_waterlevel ........................ [RUN]
[0m17:05:07.113578 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_fact, now model.etl_waterlevel.fact_waterlevel)
[0m17:05:07.113851 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.fact_waterlevel
[0m17:05:07.120842 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.fact_waterlevel"
[0m17:05:07.122422 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.fact_waterlevel
[0m17:05:07.150973 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m17:05:07.151317 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

    
  
    

  create temporary table "fact_waterlevel__dbt_tmp170507138630"
  
  
    as
  
  (
    

with main as (
    select
        distinct
        concat("stationId",'_',"stationCode") as station_key,
        "stationId" as station_id,
        "stationCode" as station_code,
        "waterLevel" as water_level,
        "waterlevelStatus" as waterlevel_status,
        case
            when "waterlevelStatus" = 3 then '🚨 Beyond Danger'
            when "waterlevelStatus" = 2 then '⚠️ Between Warning and Danger'
            when "waterlevelStatus" = 1 then '🔶 Between Alert and Warning'
            when "waterlevelStatus" = 0 then '✅ Between Normal and Alert'
            when "waterlevelStatus" = -1 then '🟢 Below Normal (Safe)'
            else '❓ Unknown Status'
        end as waterlevel_condition,
        "stationName",
        "districtName",
        to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp AS last_update
    from
        raw.waterlevels w
    where
        "stationStatus" = 1

        
        and to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp >= (
            select max(last_update) - interval '1 hour' from "airflow"."fact"."fact_waterlevel"
        )
        
)

select * from main
  );
  
  
[0m17:05:07.151652 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:05:07.163735 [debug] [Thread-1 (]: SQL status: SELECT 141 in 0.012 seconds
[0m17:05:07.171005 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m17:05:07.171323 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: BEGIN
[0m17:05:07.171722 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m17:05:07.172008 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m17:05:07.172284 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp170507138630'
        
      order by ordinal_position

  
[0m17:05:07.175127 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.003 seconds
[0m17:05:07.177747 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m17:05:07.178050 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m17:05:07.179419 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m17:05:07.185957 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m17:05:07.186276 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp170507138630'
        
      order by ordinal_position

  
[0m17:05:07.187453 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m17:05:07.189128 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m17:05:07.189424 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m17:05:07.190658 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m17:05:07.195195 [debug] [Thread-1 (]: 
    In "airflow"."fact"."fact_waterlevel":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m17:05:07.200400 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.fact_waterlevel"
[0m17:05:07.201220 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m17:05:07.201546 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      
        
        
        delete from "airflow"."fact"."fact_waterlevel" as DBT_INTERNAL_DEST
        where (station_key) in (
            select distinct station_key
            from "fact_waterlevel__dbt_tmp170507138630" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airflow"."fact"."fact_waterlevel" ("station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update")
    (
        select "station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update"
        from "fact_waterlevel__dbt_tmp170507138630"
    )
  
[0m17:05:07.202487 [debug] [Thread-1 (]: SQL status: INSERT 0 141 in 0.001 seconds
[0m17:05:07.210011 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m17:05:07.210320 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m17:05:07.210593 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m17:05:07.211314 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m17:05:07.212390 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: Close
[0m17:05:07.213477 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9d4a424-2af1-4d05-a800-c59fbf02d475', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbc74e7d0>]}
[0m17:05:07.213986 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model fact.fact_waterlevel ................... [[32mINSERT 0 141[0m in 0.10s]
[0m17:05:07.214351 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.fact_waterlevel
[0m17:05:07.215091 [debug] [MainThread]: Using postgres connection "master"
[0m17:05:07.215315 [debug] [MainThread]: On master: BEGIN
[0m17:05:07.215510 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:05:07.216946 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m17:05:07.217193 [debug] [MainThread]: On master: COMMIT
[0m17:05:07.217413 [debug] [MainThread]: Using postgres connection "master"
[0m17:05:07.217609 [debug] [MainThread]: On master: COMMIT
[0m17:05:07.217855 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:05:07.218075 [debug] [MainThread]: On master: Close
[0m17:05:07.218370 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:05:07.218597 [debug] [MainThread]: Connection 'model.etl_waterlevel.fact_waterlevel' was properly closed.
[0m17:05:07.218815 [info ] [MainThread]: 
[0m17:05:07.219057 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.18 seconds (0.18s).
[0m17:05:07.219429 [debug] [MainThread]: Command end result
[0m17:05:07.234621 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m17:05:07.235860 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m17:05:07.239386 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m17:05:07.239611 [info ] [MainThread]: 
[0m17:05:07.239862 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:05:07.240071 [info ] [MainThread]: 
[0m17:05:07.240286 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:05:07.240780 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.49399003, "process_in_blocks": "0", "process_kernel_time": 0.071423, "process_mem_max_rss": "111292", "process_out_blocks": "1702", "process_user_time": 1.204286}
[0m17:05:07.241089 [debug] [MainThread]: Command `dbt run` succeeded at 17:05:07.241046 after 0.49 seconds
[0m17:05:07.241318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba598340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8c38040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba606290>]}
[0m17:05:07.241602 [debug] [MainThread]: Flushing usage events
[0m17:05:08.369852 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:09:34.904841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4d60340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3e6bd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3e6bd30>]}


============================== 18:09:34.908987 | cf252980-32e9-4022-88a7-846718fc3c51 ==============================
[0m18:09:34.908987 [info ] [MainThread]: Running with dbt=1.9.0
[0m18:09:34.909373 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'version_check': 'True', 'profiles_dir': '/home/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models fact_waterlevel', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:09:35.002747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cf252980-32e9-4022-88a7-846718fc3c51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6f4e7a0>]}
[0m18:09:35.029328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cf252980-32e9-4022-88a7-846718fc3c51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4c1e7a0>]}
[0m18:09:35.029827 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:09:35.064510 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m18:09:35.114940 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:09:35.115255 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:09:35.118294 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m18:09:35.130117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cf252980-32e9-4022-88a7-846718fc3c51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3068580>]}
[0m18:09:35.165860 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m18:09:35.169196 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m18:09:35.178707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cf252980-32e9-4022-88a7-846718fc3c51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3087220>]}
[0m18:09:35.179029 [info ] [MainThread]: Found 3 models, 434 macros
[0m18:09:35.179286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cf252980-32e9-4022-88a7-846718fc3c51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb30871c0>]}
[0m18:09:35.180131 [info ] [MainThread]: 
[0m18:09:35.180437 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:09:35.180680 [info ] [MainThread]: 
[0m18:09:35.181029 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:09:35.181636 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m18:09:35.228507 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m18:09:35.229031 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m18:09:35.229308 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:09:35.232403 [debug] [ThreadPool]: SQL status: SELECT 20 in 0.003 seconds
[0m18:09:35.233154 [debug] [ThreadPool]: On list_airflow: Close
[0m18:09:35.235849 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_dim)
[0m18:09:35.239141 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m18:09:35.239424 [debug] [ThreadPool]: On list_airflow_dim: BEGIN
[0m18:09:35.239660 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:09:35.241394 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m18:09:35.241698 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m18:09:35.241977 [debug] [ThreadPool]: On list_airflow_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dim'
  
[0m18:09:35.243538 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.001 seconds
[0m18:09:35.244207 [debug] [ThreadPool]: On list_airflow_dim: ROLLBACK
[0m18:09:35.244535 [debug] [ThreadPool]: On list_airflow_dim: Close
[0m18:09:35.244938 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_dim, now list_airflow_fact)
[0m18:09:35.246330 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m18:09:35.246598 [debug] [ThreadPool]: On list_airflow_fact: BEGIN
[0m18:09:35.246831 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:09:35.248320 [debug] [ThreadPool]: SQL status: BEGIN in 0.001 seconds
[0m18:09:35.248603 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m18:09:35.248851 [debug] [ThreadPool]: On list_airflow_fact: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_fact"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'fact'
  
[0m18:09:35.250182 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m18:09:35.250808 [debug] [ThreadPool]: On list_airflow_fact: ROLLBACK
[0m18:09:35.251124 [debug] [ThreadPool]: On list_airflow_fact: Close
[0m18:09:35.253660 [debug] [MainThread]: Using postgres connection "master"
[0m18:09:35.253965 [debug] [MainThread]: On master: BEGIN
[0m18:09:35.254249 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:09:35.256949 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m18:09:35.257299 [debug] [MainThread]: Using postgres connection "master"
[0m18:09:35.257725 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:09:35.261250 [debug] [MainThread]: SQL status: SELECT 2 in 0.003 seconds
[0m18:09:35.262004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cf252980-32e9-4022-88a7-846718fc3c51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3086d10>]}
[0m18:09:35.262371 [debug] [MainThread]: On master: ROLLBACK
[0m18:09:35.262725 [debug] [MainThread]: Using postgres connection "master"
[0m18:09:35.262977 [debug] [MainThread]: On master: BEGIN
[0m18:09:35.263389 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m18:09:35.263652 [debug] [MainThread]: On master: COMMIT
[0m18:09:35.263893 [debug] [MainThread]: Using postgres connection "master"
[0m18:09:35.264130 [debug] [MainThread]: On master: COMMIT
[0m18:09:35.264444 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:09:35.264701 [debug] [MainThread]: On master: Close
[0m18:09:35.265862 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.fact_waterlevel
[0m18:09:35.266241 [info ] [Thread-1 (]: 1 of 1 START sql incremental model fact.fact_waterlevel ........................ [RUN]
[0m18:09:35.266603 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_fact, now model.etl_waterlevel.fact_waterlevel)
[0m18:09:35.266878 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.fact_waterlevel
[0m18:09:35.273907 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.fact_waterlevel"
[0m18:09:35.274963 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.fact_waterlevel
[0m18:09:35.303209 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m18:09:35.303561 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

    
  
    

  create temporary table "fact_waterlevel__dbt_tmp180935291188"
  
  
    as
  
  (
    

with main as (
    select
        distinct
        concat("stationId",'_',"stationCode") as station_key,
        "stationId" as station_id,
        "stationCode" as station_code,
        "waterLevel" as water_level,
        "waterlevelStatus" as waterlevel_status,
        case
            when "waterlevelStatus" = 3 then '🚨 Beyond Danger'
            when "waterlevelStatus" = 2 then '⚠️ Between Warning and Danger'
            when "waterlevelStatus" = 1 then '🔶 Between Alert and Warning'
            when "waterlevelStatus" = 0 then '✅ Between Normal and Alert'
            when "waterlevelStatus" = -1 then '🟢 Below Normal (Safe)'
            else '❓ Unknown Status'
        end as waterlevel_condition,
        "stationName",
        "districtName",
        to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp AS last_update
    from
        raw.waterlevels w
    where
        "stationStatus" = 1

        
        and to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp >= (
            select max(last_update) - interval '1 hour' from "airflow"."fact"."fact_waterlevel"
        )
        
)

select * from main
  );
  
  
[0m18:09:35.303928 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:09:35.318244 [debug] [Thread-1 (]: SQL status: SELECT 190 in 0.014 seconds
[0m18:09:35.325470 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m18:09:35.325788 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: BEGIN
[0m18:09:35.326197 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m18:09:35.326506 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m18:09:35.326811 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp180935291188'
        
      order by ordinal_position

  
[0m18:09:35.329748 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.003 seconds
[0m18:09:35.332377 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m18:09:35.332686 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m18:09:35.334117 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m18:09:35.340566 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m18:09:35.340886 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp180935291188'
        
      order by ordinal_position

  
[0m18:09:35.342090 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m18:09:35.343737 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m18:09:35.344090 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m18:09:35.345280 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m18:09:35.349837 [debug] [Thread-1 (]: 
    In "airflow"."fact"."fact_waterlevel":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m18:09:35.355006 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.fact_waterlevel"
[0m18:09:35.355892 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m18:09:35.356208 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      
        
        
        delete from "airflow"."fact"."fact_waterlevel" as DBT_INTERNAL_DEST
        where (station_key) in (
            select distinct station_key
            from "fact_waterlevel__dbt_tmp180935291188" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airflow"."fact"."fact_waterlevel" ("station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update")
    (
        select "station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update"
        from "fact_waterlevel__dbt_tmp180935291188"
    )
  
[0m18:09:35.357114 [debug] [Thread-1 (]: SQL status: INSERT 0 190 in 0.001 seconds
[0m18:09:35.364925 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m18:09:35.365214 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m18:09:35.365451 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m18:09:35.365928 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m18:09:35.366976 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: Close
[0m18:09:35.368450 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf252980-32e9-4022-88a7-846718fc3c51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6f4e7d0>]}
[0m18:09:35.368932 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model fact.fact_waterlevel ................... [[32mINSERT 0 190[0m in 0.10s]
[0m18:09:35.369301 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.fact_waterlevel
[0m18:09:35.370006 [debug] [MainThread]: Using postgres connection "master"
[0m18:09:35.370248 [debug] [MainThread]: On master: BEGIN
[0m18:09:35.370486 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:09:35.372001 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m18:09:35.372241 [debug] [MainThread]: On master: COMMIT
[0m18:09:35.372488 [debug] [MainThread]: Using postgres connection "master"
[0m18:09:35.372694 [debug] [MainThread]: On master: COMMIT
[0m18:09:35.372941 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:09:35.373159 [debug] [MainThread]: On master: Close
[0m18:09:35.373457 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:09:35.373674 [debug] [MainThread]: Connection 'model.etl_waterlevel.fact_waterlevel' was properly closed.
[0m18:09:35.373896 [info ] [MainThread]: 
[0m18:09:35.374119 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.19 seconds (0.19s).
[0m18:09:35.374496 [debug] [MainThread]: Command end result
[0m18:09:35.389738 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m18:09:35.390868 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m18:09:35.394586 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m18:09:35.394808 [info ] [MainThread]: 
[0m18:09:35.395069 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:09:35.395274 [info ] [MainThread]: 
[0m18:09:35.395540 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:09:35.396111 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.5172938, "process_in_blocks": "0", "process_kernel_time": 0.113075, "process_mem_max_rss": "111420", "process_out_blocks": "1702", "process_user_time": 1.216815}
[0m18:09:35.396457 [debug] [MainThread]: Command `dbt run` succeeded at 18:09:35.396408 after 0.52 seconds
[0m18:09:35.396707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4d60340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb338c0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4dca290>]}
[0m18:09:35.396952 [debug] [MainThread]: Flushing usage events
[0m18:09:37.010474 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:14:04.418586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8378c2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82870520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82870580>]}


============================== 19:14:04.422494 | 675169ff-0e64-404a-a5dd-be4dcbdc99c3 ==============================
[0m19:14:04.422494 [info ] [MainThread]: Running with dbt=1.9.0
[0m19:14:04.422899 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --models fact_waterlevel', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:14:04.509286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '675169ff-0e64-404a-a5dd-be4dcbdc99c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8587fd60>]}
[0m19:14:04.536171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '675169ff-0e64-404a-a5dd-be4dcbdc99c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff836d8100>]}
[0m19:14:04.536677 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m19:14:04.571345 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m19:14:04.621603 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:14:04.622062 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:14:04.625462 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m19:14:04.637569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '675169ff-0e64-404a-a5dd-be4dcbdc99c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81ad44f0>]}
[0m19:14:04.673570 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m19:14:04.677152 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m19:14:04.686202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '675169ff-0e64-404a-a5dd-be4dcbdc99c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81af3220>]}
[0m19:14:04.686505 [info ] [MainThread]: Found 3 models, 434 macros
[0m19:14:04.686754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '675169ff-0e64-404a-a5dd-be4dcbdc99c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81af31c0>]}
[0m19:14:04.687463 [info ] [MainThread]: 
[0m19:14:04.687717 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:14:04.687974 [info ] [MainThread]: 
[0m19:14:04.688445 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:14:04.689127 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m19:14:04.728613 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m19:14:04.729024 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m19:14:04.729299 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:14:04.732238 [debug] [ThreadPool]: SQL status: SELECT 20 in 0.003 seconds
[0m19:14:04.733019 [debug] [ThreadPool]: On list_airflow: Close
[0m19:14:04.735684 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_dim)
[0m19:14:04.738902 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m19:14:04.739173 [debug] [ThreadPool]: On list_airflow_dim: BEGIN
[0m19:14:04.739413 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:14:04.740993 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m19:14:04.741283 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m19:14:04.741569 [debug] [ThreadPool]: On list_airflow_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dim'
  
[0m19:14:04.742872 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.001 seconds
[0m19:14:04.743550 [debug] [ThreadPool]: On list_airflow_dim: ROLLBACK
[0m19:14:04.743881 [debug] [ThreadPool]: On list_airflow_dim: Close
[0m19:14:04.744277 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_dim, now list_airflow_fact)
[0m19:14:04.745696 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m19:14:04.745951 [debug] [ThreadPool]: On list_airflow_fact: BEGIN
[0m19:14:04.746185 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:14:04.747716 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m19:14:04.747993 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m19:14:04.748255 [debug] [ThreadPool]: On list_airflow_fact: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_fact"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'fact'
  
[0m19:14:04.749637 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m19:14:04.750263 [debug] [ThreadPool]: On list_airflow_fact: ROLLBACK
[0m19:14:04.750608 [debug] [ThreadPool]: On list_airflow_fact: Close
[0m19:14:04.753034 [debug] [MainThread]: Using postgres connection "master"
[0m19:14:04.753299 [debug] [MainThread]: On master: BEGIN
[0m19:14:04.753583 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:14:04.755064 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m19:14:04.755330 [debug] [MainThread]: Using postgres connection "master"
[0m19:14:04.755666 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:14:04.758623 [debug] [MainThread]: SQL status: SELECT 2 in 0.003 seconds
[0m19:14:04.759260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '675169ff-0e64-404a-a5dd-be4dcbdc99c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81af2b30>]}
[0m19:14:04.759604 [debug] [MainThread]: On master: ROLLBACK
[0m19:14:04.759960 [debug] [MainThread]: Using postgres connection "master"
[0m19:14:04.760247 [debug] [MainThread]: On master: BEGIN
[0m19:14:04.760658 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m19:14:04.760916 [debug] [MainThread]: On master: COMMIT
[0m19:14:04.761160 [debug] [MainThread]: Using postgres connection "master"
[0m19:14:04.761398 [debug] [MainThread]: On master: COMMIT
[0m19:14:04.761730 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:14:04.762000 [debug] [MainThread]: On master: Close
[0m19:14:04.763133 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.fact_waterlevel
[0m19:14:04.763507 [info ] [Thread-1 (]: 1 of 1 START sql incremental model fact.fact_waterlevel ........................ [RUN]
[0m19:14:04.763832 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_fact, now model.etl_waterlevel.fact_waterlevel)
[0m19:14:04.764109 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.fact_waterlevel
[0m19:14:04.771040 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.fact_waterlevel"
[0m19:14:04.772694 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.fact_waterlevel
[0m19:14:04.800727 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m19:14:04.801090 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

    
  
    

  create temporary table "fact_waterlevel__dbt_tmp191404788848"
  
  
    as
  
  (
    

with main as (
    select
        distinct
        concat("stationId",'_',"stationCode") as station_key,
        "stationId" as station_id,
        "stationCode" as station_code,
        "waterLevel" as water_level,
        "waterlevelStatus" as waterlevel_status,
        case
            when "waterlevelStatus" = 3 then '🚨 Beyond Danger'
            when "waterlevelStatus" = 2 then '⚠️ Between Warning and Danger'
            when "waterlevelStatus" = 1 then '🔶 Between Alert and Warning'
            when "waterlevelStatus" = 0 then '✅ Between Normal and Alert'
            when "waterlevelStatus" = -1 then '🟢 Below Normal (Safe)'
            else '❓ Unknown Status'
        end as waterlevel_condition,
        "stationName",
        "districtName",
        to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp AS last_update
    from
        raw.waterlevels w
    where
        "stationStatus" = 1

        
        and to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp >= (
            select max(last_update) - interval '1 hour' from "airflow"."fact"."fact_waterlevel"
        )
        
)

select * from main
  );
  
  
[0m19:14:04.801440 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:14:04.813755 [debug] [Thread-1 (]: SQL status: SELECT 141 in 0.012 seconds
[0m19:14:04.820792 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m19:14:04.821100 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: BEGIN
[0m19:14:04.821513 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m19:14:04.821794 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m19:14:04.822076 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp191404788848'
        
      order by ordinal_position

  
[0m19:14:04.824880 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.003 seconds
[0m19:14:04.827490 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m19:14:04.827836 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m19:14:04.829183 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m19:14:04.835643 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m19:14:04.835953 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp191404788848'
        
      order by ordinal_position

  
[0m19:14:04.837186 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m19:14:04.838886 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m19:14:04.839180 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m19:14:04.840380 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m19:14:04.844836 [debug] [Thread-1 (]: 
    In "airflow"."fact"."fact_waterlevel":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m19:14:04.849980 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.fact_waterlevel"
[0m19:14:04.850802 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m19:14:04.851101 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      
        
        
        delete from "airflow"."fact"."fact_waterlevel" as DBT_INTERNAL_DEST
        where (station_key) in (
            select distinct station_key
            from "fact_waterlevel__dbt_tmp191404788848" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airflow"."fact"."fact_waterlevel" ("station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update")
    (
        select "station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update"
        from "fact_waterlevel__dbt_tmp191404788848"
    )
  
[0m19:14:04.851956 [debug] [Thread-1 (]: SQL status: INSERT 0 141 in 0.001 seconds
[0m19:14:04.859408 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m19:14:04.859706 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m19:14:04.859982 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m19:14:04.860945 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m19:14:04.862001 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: Close
[0m19:14:04.863149 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '675169ff-0e64-404a-a5dd-be4dcbdc99c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff851b0280>]}
[0m19:14:04.863907 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model fact.fact_waterlevel ................... [[32mINSERT 0 141[0m in 0.10s]
[0m19:14:04.864333 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.fact_waterlevel
[0m19:14:04.865037 [debug] [MainThread]: Using postgres connection "master"
[0m19:14:04.865320 [debug] [MainThread]: On master: BEGIN
[0m19:14:04.865575 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:14:04.867073 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m19:14:04.867316 [debug] [MainThread]: On master: COMMIT
[0m19:14:04.867578 [debug] [MainThread]: Using postgres connection "master"
[0m19:14:04.867801 [debug] [MainThread]: On master: COMMIT
[0m19:14:04.868065 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:14:04.868270 [debug] [MainThread]: On master: Close
[0m19:14:04.868549 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:14:04.868765 [debug] [MainThread]: Connection 'model.etl_waterlevel.fact_waterlevel' was properly closed.
[0m19:14:04.868989 [info ] [MainThread]: 
[0m19:14:04.869216 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.18 seconds (0.18s).
[0m19:14:04.869603 [debug] [MainThread]: Command end result
[0m19:14:04.885402 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m19:14:04.886712 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m19:14:04.890241 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m19:14:04.890478 [info ] [MainThread]: 
[0m19:14:04.890748 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:14:04.890965 [info ] [MainThread]: 
[0m19:14:04.891184 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:14:04.891725 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.49931946, "process_in_blocks": "0", "process_kernel_time": 0.074991, "process_mem_max_rss": "111556", "process_out_blocks": "1702", "process_user_time": 1.205864}
[0m19:14:04.892052 [debug] [MainThread]: Command `dbt run` succeeded at 19:14:04.892007 after 0.50 seconds
[0m19:14:04.892295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8378c2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff837a5bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff836d8100>]}
[0m19:14:04.892568 [debug] [MainThread]: Flushing usage events
[0m19:14:06.353307 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:19:01.700339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91890340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9097fd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9097fd30>]}


============================== 20:19:01.704006 | a44872db-1277-462b-9f49-dd2c16eb7a3a ==============================
[0m20:19:01.704006 [info ] [MainThread]: Running with dbt=1.9.0
[0m20:19:01.704408 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/logs', 'profiles_dir': '/home/airflow/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --models fact_waterlevel', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:19:01.804247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a44872db-1277-462b-9f49-dd2c16eb7a3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93aca7a0>]}
[0m20:19:01.830986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a44872db-1277-462b-9f49-dd2c16eb7a3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff917527a0>]}
[0m20:19:01.831508 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m20:19:01.866341 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m20:19:01.917470 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:19:01.917811 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:19:01.921017 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m20:19:01.932922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a44872db-1277-462b-9f49-dd2c16eb7a3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fc18580>]}
[0m20:19:01.972579 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m20:19:01.976227 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m20:19:01.985597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a44872db-1277-462b-9f49-dd2c16eb7a3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fc37220>]}
[0m20:19:01.985917 [info ] [MainThread]: Found 3 models, 434 macros
[0m20:19:01.986159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a44872db-1277-462b-9f49-dd2c16eb7a3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fc371c0>]}
[0m20:19:01.986848 [info ] [MainThread]: 
[0m20:19:01.987102 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:19:01.987305 [info ] [MainThread]: 
[0m20:19:01.987597 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:19:01.988223 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m20:19:02.031150 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m20:19:02.031580 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m20:19:02.031883 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:19:02.034906 [debug] [ThreadPool]: SQL status: SELECT 20 in 0.003 seconds
[0m20:19:02.035813 [debug] [ThreadPool]: On list_airflow: Close
[0m20:19:02.038493 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_fact)
[0m20:19:02.041690 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m20:19:02.041951 [debug] [ThreadPool]: On list_airflow_fact: BEGIN
[0m20:19:02.042180 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:19:02.043703 [debug] [ThreadPool]: SQL status: BEGIN in 0.001 seconds
[0m20:19:02.044021 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m20:19:02.044264 [debug] [ThreadPool]: On list_airflow_fact: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_fact"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'fact'
  
[0m20:19:02.045751 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m20:19:02.046476 [debug] [ThreadPool]: On list_airflow_fact: ROLLBACK
[0m20:19:02.046865 [debug] [ThreadPool]: On list_airflow_fact: Close
[0m20:19:02.047299 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_fact, now list_airflow_dim)
[0m20:19:02.048700 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m20:19:02.048990 [debug] [ThreadPool]: On list_airflow_dim: BEGIN
[0m20:19:02.049242 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:19:02.050815 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m20:19:02.051065 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m20:19:02.051323 [debug] [ThreadPool]: On list_airflow_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dim'
  
[0m20:19:02.052571 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.001 seconds
[0m20:19:02.053235 [debug] [ThreadPool]: On list_airflow_dim: ROLLBACK
[0m20:19:02.053568 [debug] [ThreadPool]: On list_airflow_dim: Close
[0m20:19:02.056086 [debug] [MainThread]: Using postgres connection "master"
[0m20:19:02.056351 [debug] [MainThread]: On master: BEGIN
[0m20:19:02.056599 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:19:02.058159 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m20:19:02.058418 [debug] [MainThread]: Using postgres connection "master"
[0m20:19:02.058736 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:19:02.061869 [debug] [MainThread]: SQL status: SELECT 2 in 0.003 seconds
[0m20:19:02.062528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a44872db-1277-462b-9f49-dd2c16eb7a3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93a5a350>]}
[0m20:19:02.062870 [debug] [MainThread]: On master: ROLLBACK
[0m20:19:02.063242 [debug] [MainThread]: Using postgres connection "master"
[0m20:19:02.063488 [debug] [MainThread]: On master: BEGIN
[0m20:19:02.063908 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m20:19:02.064164 [debug] [MainThread]: On master: COMMIT
[0m20:19:02.064403 [debug] [MainThread]: Using postgres connection "master"
[0m20:19:02.064658 [debug] [MainThread]: On master: COMMIT
[0m20:19:02.064983 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:19:02.065268 [debug] [MainThread]: On master: Close
[0m20:19:02.066398 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.fact_waterlevel
[0m20:19:02.066785 [info ] [Thread-1 (]: 1 of 1 START sql incremental model fact.fact_waterlevel ........................ [RUN]
[0m20:19:02.067128 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_dim, now model.etl_waterlevel.fact_waterlevel)
[0m20:19:02.067404 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.fact_waterlevel
[0m20:19:02.074297 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.fact_waterlevel"
[0m20:19:02.075500 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.fact_waterlevel
[0m20:19:02.103747 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m20:19:02.104109 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

    
  
    

  create temporary table "fact_waterlevel__dbt_tmp201902091756"
  
  
    as
  
  (
    

with main as (
    select
        distinct
        concat("stationId",'_',"stationCode") as station_key,
        "stationId" as station_id,
        "stationCode" as station_code,
        "waterLevel" as water_level,
        "waterlevelStatus" as waterlevel_status,
        case
            when "waterlevelStatus" = 3 then '🚨 Beyond Danger'
            when "waterlevelStatus" = 2 then '⚠️ Between Warning and Danger'
            when "waterlevelStatus" = 1 then '🔶 Between Alert and Warning'
            when "waterlevelStatus" = 0 then '✅ Between Normal and Alert'
            when "waterlevelStatus" = -1 then '🟢 Below Normal (Safe)'
            else '❓ Unknown Status'
        end as waterlevel_condition,
        "stationName",
        "districtName",
        to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp AS last_update
    from
        raw.waterlevels w
    where
        "stationStatus" = 1

        
        and to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp >= (
            select max(last_update) - interval '1 hour' from "airflow"."fact"."fact_waterlevel"
        )
        
)

select * from main
  );
  
  
[0m20:19:02.104489 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:19:02.119513 [debug] [Thread-1 (]: SQL status: SELECT 146 in 0.015 seconds
[0m20:19:02.126720 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m20:19:02.127038 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: BEGIN
[0m20:19:02.127454 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m20:19:02.127758 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m20:19:02.128053 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp201902091756'
        
      order by ordinal_position

  
[0m20:19:02.130958 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.003 seconds
[0m20:19:02.133656 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m20:19:02.133965 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m20:19:02.135350 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m20:19:02.141760 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m20:19:02.142076 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp201902091756'
        
      order by ordinal_position

  
[0m20:19:02.143290 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m20:19:02.145034 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m20:19:02.145332 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m20:19:02.146547 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m20:19:02.151176 [debug] [Thread-1 (]: 
    In "airflow"."fact"."fact_waterlevel":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m20:19:02.156387 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.fact_waterlevel"
[0m20:19:02.158042 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m20:19:02.158345 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      
        
        
        delete from "airflow"."fact"."fact_waterlevel" as DBT_INTERNAL_DEST
        where (station_key) in (
            select distinct station_key
            from "fact_waterlevel__dbt_tmp201902091756" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airflow"."fact"."fact_waterlevel" ("station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update")
    (
        select "station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update"
        from "fact_waterlevel__dbt_tmp201902091756"
    )
  
[0m20:19:02.159329 [debug] [Thread-1 (]: SQL status: INSERT 0 146 in 0.001 seconds
[0m20:19:02.166782 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m20:19:02.167102 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m20:19:02.167383 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m20:19:02.168526 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m20:19:02.169768 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: Close
[0m20:19:02.170897 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a44872db-1277-462b-9f49-dd2c16eb7a3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93a5a350>]}
[0m20:19:02.171346 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model fact.fact_waterlevel ................... [[32mINSERT 0 146[0m in 0.10s]
[0m20:19:02.171744 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.fact_waterlevel
[0m20:19:02.172419 [debug] [MainThread]: Using postgres connection "master"
[0m20:19:02.172682 [debug] [MainThread]: On master: BEGIN
[0m20:19:02.172897 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:19:02.174427 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m20:19:02.174687 [debug] [MainThread]: On master: COMMIT
[0m20:19:02.174922 [debug] [MainThread]: Using postgres connection "master"
[0m20:19:02.175123 [debug] [MainThread]: On master: COMMIT
[0m20:19:02.175370 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:19:02.175580 [debug] [MainThread]: On master: Close
[0m20:19:02.175855 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:19:02.176082 [debug] [MainThread]: Connection 'model.etl_waterlevel.fact_waterlevel' was properly closed.
[0m20:19:02.176333 [info ] [MainThread]: 
[0m20:19:02.176561 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.19 seconds (0.19s).
[0m20:19:02.176946 [debug] [MainThread]: Command end result
[0m20:19:02.192554 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m20:19:02.193818 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m20:19:02.197250 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m20:19:02.197482 [info ] [MainThread]: 
[0m20:19:02.197748 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:19:02.197965 [info ] [MainThread]: 
[0m20:19:02.198189 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:19:02.198705 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.52453583, "process_in_blocks": "0", "process_kernel_time": 0.114861, "process_mem_max_rss": "111260", "process_out_blocks": "1702", "process_user_time": 1.228515}
[0m20:19:02.199024 [debug] [MainThread]: Command `dbt run` succeeded at 20:19:02.198979 after 0.52 seconds
[0m20:19:02.199268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91890340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff918fe290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fbe4640>]}
[0m20:19:02.199533 [debug] [MainThread]: Flushing usage events
[0m20:19:03.526278 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:16:29.339763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa63c370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9747d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9747d00>]}


============================== 21:16:29.343787 | b47bc108-048b-434e-8970-e2ad6bd66a4e ==============================
[0m21:16:29.343787 [info ] [MainThread]: Running with dbt=1.9.0
[0m21:16:29.344192 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'debug': 'False', 'profiles_dir': '/home/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --models fact_waterlevel', 'send_anonymous_usage_stats': 'True'}
[0m21:16:29.433294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b47bc108-048b-434e-8970-e2ad6bd66a4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa6cc310>]}
[0m21:16:29.459798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b47bc108-048b-434e-8970-e2ad6bd66a4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa588220>]}
[0m21:16:29.460281 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:16:29.494822 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m21:16:29.546572 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:16:29.546913 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:16:29.550089 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m21:16:29.562033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b47bc108-048b-434e-8970-e2ad6bd66a4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa896c580>]}
[0m21:16:29.599248 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m21:16:29.603162 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m21:16:29.612355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b47bc108-048b-434e-8970-e2ad6bd66a4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa898b220>]}
[0m21:16:29.612679 [info ] [MainThread]: Found 3 models, 434 macros
[0m21:16:29.612906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b47bc108-048b-434e-8970-e2ad6bd66a4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa898b1c0>]}
[0m21:16:29.613587 [info ] [MainThread]: 
[0m21:16:29.613884 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:16:29.614225 [info ] [MainThread]: 
[0m21:16:29.614678 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:16:29.615307 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m21:16:29.655762 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m21:16:29.656175 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m21:16:29.656453 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:16:29.659363 [debug] [ThreadPool]: SQL status: SELECT 20 in 0.003 seconds
[0m21:16:29.660176 [debug] [ThreadPool]: On list_airflow: Close
[0m21:16:29.662821 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_dim)
[0m21:16:29.666069 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m21:16:29.666352 [debug] [ThreadPool]: On list_airflow_dim: BEGIN
[0m21:16:29.666599 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:16:29.668467 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m21:16:29.668736 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m21:16:29.669025 [debug] [ThreadPool]: On list_airflow_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dim'
  
[0m21:16:29.670549 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.001 seconds
[0m21:16:29.671213 [debug] [ThreadPool]: On list_airflow_dim: ROLLBACK
[0m21:16:29.671547 [debug] [ThreadPool]: On list_airflow_dim: Close
[0m21:16:29.671972 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_dim, now list_airflow_fact)
[0m21:16:29.673356 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m21:16:29.673612 [debug] [ThreadPool]: On list_airflow_fact: BEGIN
[0m21:16:29.673868 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:16:29.675347 [debug] [ThreadPool]: SQL status: BEGIN in 0.001 seconds
[0m21:16:29.675587 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m21:16:29.675880 [debug] [ThreadPool]: On list_airflow_fact: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_fact"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'fact'
  
[0m21:16:29.677094 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m21:16:29.677735 [debug] [ThreadPool]: On list_airflow_fact: ROLLBACK
[0m21:16:29.678054 [debug] [ThreadPool]: On list_airflow_fact: Close
[0m21:16:29.680471 [debug] [MainThread]: Using postgres connection "master"
[0m21:16:29.680760 [debug] [MainThread]: On master: BEGIN
[0m21:16:29.680992 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:16:29.682541 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m21:16:29.682894 [debug] [MainThread]: Using postgres connection "master"
[0m21:16:29.683193 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:16:29.686456 [debug] [MainThread]: SQL status: SELECT 2 in 0.003 seconds
[0m21:16:29.687112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b47bc108-048b-434e-8970-e2ad6bd66a4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa898ad10>]}
[0m21:16:29.687442 [debug] [MainThread]: On master: ROLLBACK
[0m21:16:29.687771 [debug] [MainThread]: Using postgres connection "master"
[0m21:16:29.688012 [debug] [MainThread]: On master: BEGIN
[0m21:16:29.688415 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m21:16:29.688669 [debug] [MainThread]: On master: COMMIT
[0m21:16:29.688913 [debug] [MainThread]: Using postgres connection "master"
[0m21:16:29.689143 [debug] [MainThread]: On master: COMMIT
[0m21:16:29.689451 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:16:29.689706 [debug] [MainThread]: On master: Close
[0m21:16:29.690811 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.fact_waterlevel
[0m21:16:29.691204 [info ] [Thread-1 (]: 1 of 1 START sql incremental model fact.fact_waterlevel ........................ [RUN]
[0m21:16:29.691556 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_fact, now model.etl_waterlevel.fact_waterlevel)
[0m21:16:29.691845 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.fact_waterlevel
[0m21:16:29.698842 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.fact_waterlevel"
[0m21:16:29.699849 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.fact_waterlevel
[0m21:16:29.728837 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m21:16:29.729327 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

    
  
    

  create temporary table "fact_waterlevel__dbt_tmp211629716241"
  
  
    as
  
  (
    

with main as (
    select
        distinct
        concat("stationId",'_',"stationCode") as station_key,
        "stationId" as station_id,
        "stationCode" as station_code,
        "waterLevel" as water_level,
        "waterlevelStatus" as waterlevel_status,
        case
            when "waterlevelStatus" = 3 then '🚨 Beyond Danger'
            when "waterlevelStatus" = 2 then '⚠️ Between Warning and Danger'
            when "waterlevelStatus" = 1 then '🔶 Between Alert and Warning'
            when "waterlevelStatus" = 0 then '✅ Between Normal and Alert'
            when "waterlevelStatus" = -1 then '🟢 Below Normal (Safe)'
            else '❓ Unknown Status'
        end as waterlevel_condition,
        "stationName",
        "districtName",
        to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp AS last_update
    from
        raw.waterlevels w
    where
        "stationStatus" = 1

        
        and to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp >= (
            select max(last_update) - interval '1 hour' from "airflow"."fact"."fact_waterlevel"
        )
        
)

select * from main
  );
  
  
[0m21:16:29.729704 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:16:29.746368 [debug] [Thread-1 (]: SQL status: SELECT 162 in 0.017 seconds
[0m21:16:29.753700 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m21:16:29.754021 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: BEGIN
[0m21:16:29.754458 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m21:16:29.754736 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m21:16:29.755035 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp211629716241'
        
      order by ordinal_position

  
[0m21:16:29.758254 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.003 seconds
[0m21:16:29.760929 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m21:16:29.761239 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m21:16:29.762699 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m21:16:29.769186 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m21:16:29.769497 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp211629716241'
        
      order by ordinal_position

  
[0m21:16:29.770771 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m21:16:29.772450 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m21:16:29.772740 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m21:16:29.773938 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m21:16:29.778458 [debug] [Thread-1 (]: 
    In "airflow"."fact"."fact_waterlevel":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m21:16:29.783620 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.fact_waterlevel"
[0m21:16:29.784487 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m21:16:29.784810 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      
        
        
        delete from "airflow"."fact"."fact_waterlevel" as DBT_INTERNAL_DEST
        where (station_key) in (
            select distinct station_key
            from "fact_waterlevel__dbt_tmp211629716241" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airflow"."fact"."fact_waterlevel" ("station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update")
    (
        select "station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update"
        from "fact_waterlevel__dbt_tmp211629716241"
    )
  
[0m21:16:29.785721 [debug] [Thread-1 (]: SQL status: INSERT 0 162 in 0.001 seconds
[0m21:16:29.793255 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m21:16:29.793572 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m21:16:29.793863 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m21:16:29.795318 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m21:16:29.796556 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: Close
[0m21:16:29.797810 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b47bc108-048b-434e-8970-e2ad6bd66a4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac85e800>]}
[0m21:16:29.798319 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model fact.fact_waterlevel ................... [[32mINSERT 0 162[0m in 0.11s]
[0m21:16:29.798704 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.fact_waterlevel
[0m21:16:29.799379 [debug] [MainThread]: Using postgres connection "master"
[0m21:16:29.799644 [debug] [MainThread]: On master: BEGIN
[0m21:16:29.799874 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:16:29.801378 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m21:16:29.801623 [debug] [MainThread]: On master: COMMIT
[0m21:16:29.801848 [debug] [MainThread]: Using postgres connection "master"
[0m21:16:29.802048 [debug] [MainThread]: On master: COMMIT
[0m21:16:29.802289 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:16:29.802483 [debug] [MainThread]: On master: Close
[0m21:16:29.802746 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:16:29.802985 [debug] [MainThread]: Connection 'model.etl_waterlevel.fact_waterlevel' was properly closed.
[0m21:16:29.803199 [info ] [MainThread]: 
[0m21:16:29.803425 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.19 seconds (0.19s).
[0m21:16:29.803801 [debug] [MainThread]: Command end result
[0m21:16:29.819279 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m21:16:29.820337 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m21:16:29.824128 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m21:16:29.824339 [info ] [MainThread]: 
[0m21:16:29.824587 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:16:29.824801 [info ] [MainThread]: 
[0m21:16:29.825036 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m21:16:29.825600 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.51146436, "process_in_blocks": "0", "process_kernel_time": 0.088509, "process_mem_max_rss": "111496", "process_out_blocks": "1702", "process_user_time": 1.22521}
[0m21:16:29.825942 [debug] [MainThread]: Command `dbt run` succeeded at 21:16:29.825895 after 0.51 seconds
[0m21:16:29.826186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa63c370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa6cc310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa6c1d50>]}
[0m21:16:29.826425 [debug] [MainThread]: Flushing usage events
[0m21:16:31.034576 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:05:14.325506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaae94370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9f74520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9f74580>]}


============================== 22:05:14.329585 | 848aac10-be36-4762-951e-80fc845f7e5a ==============================
[0m22:05:14.329585 [info ] [MainThread]: Running with dbt=1.9.0
[0m22:05:14.329954 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --models fact_waterlevel', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:05:14.415806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '848aac10-be36-4762-951e-80fc845f7e5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaaf24310>]}
[0m22:05:14.443431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '848aac10-be36-4762-951e-80fc845f7e5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac84d810>]}
[0m22:05:14.443952 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:05:14.478406 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m22:05:14.527471 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:05:14.527779 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:05:14.531035 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m22:05:14.542946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '848aac10-be36-4762-951e-80fc845f7e5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa92185b0>]}
[0m22:05:14.578898 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m22:05:14.582462 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m22:05:14.591537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '848aac10-be36-4762-951e-80fc845f7e5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9237220>]}
[0m22:05:14.591846 [info ] [MainThread]: Found 3 models, 434 macros
[0m22:05:14.592075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '848aac10-be36-4762-951e-80fc845f7e5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa92371c0>]}
[0m22:05:14.592824 [info ] [MainThread]: 
[0m22:05:14.593068 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:05:14.593305 [info ] [MainThread]: 
[0m22:05:14.593765 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:05:14.594372 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m22:05:14.634320 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m22:05:14.634742 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m22:05:14.635023 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:14.637761 [debug] [ThreadPool]: SQL status: SELECT 22 in 0.003 seconds
[0m22:05:14.638514 [debug] [ThreadPool]: On list_airflow: Close
[0m22:05:14.641204 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_fact)
[0m22:05:14.644464 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m22:05:14.644746 [debug] [ThreadPool]: On list_airflow_fact: BEGIN
[0m22:05:14.644997 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:14.646626 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m22:05:14.646917 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m22:05:14.647187 [debug] [ThreadPool]: On list_airflow_fact: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_fact"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'fact'
  
[0m22:05:14.648540 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m22:05:14.649197 [debug] [ThreadPool]: On list_airflow_fact: ROLLBACK
[0m22:05:14.649520 [debug] [ThreadPool]: On list_airflow_fact: Close
[0m22:05:14.649913 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_fact, now list_airflow_dim)
[0m22:05:14.651233 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m22:05:14.651497 [debug] [ThreadPool]: On list_airflow_dim: BEGIN
[0m22:05:14.651733 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:14.653267 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m22:05:14.653535 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m22:05:14.653789 [debug] [ThreadPool]: On list_airflow_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dim'
  
[0m22:05:14.655033 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.001 seconds
[0m22:05:14.655677 [debug] [ThreadPool]: On list_airflow_dim: ROLLBACK
[0m22:05:14.656012 [debug] [ThreadPool]: On list_airflow_dim: Close
[0m22:05:14.658497 [debug] [MainThread]: Using postgres connection "master"
[0m22:05:14.658765 [debug] [MainThread]: On master: BEGIN
[0m22:05:14.659001 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:05:14.660528 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m22:05:14.660802 [debug] [MainThread]: Using postgres connection "master"
[0m22:05:14.661107 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:05:14.664352 [debug] [MainThread]: SQL status: SELECT 2 in 0.003 seconds
[0m22:05:14.664994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '848aac10-be36-4762-951e-80fc845f7e5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad053700>]}
[0m22:05:14.665384 [debug] [MainThread]: On master: ROLLBACK
[0m22:05:14.665743 [debug] [MainThread]: Using postgres connection "master"
[0m22:05:14.665985 [debug] [MainThread]: On master: BEGIN
[0m22:05:14.666417 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m22:05:14.666690 [debug] [MainThread]: On master: COMMIT
[0m22:05:14.666931 [debug] [MainThread]: Using postgres connection "master"
[0m22:05:14.667200 [debug] [MainThread]: On master: COMMIT
[0m22:05:14.667500 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:05:14.667781 [debug] [MainThread]: On master: Close
[0m22:05:14.668943 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.fact_waterlevel
[0m22:05:14.669310 [info ] [Thread-1 (]: 1 of 1 START sql incremental model fact.fact_waterlevel ........................ [RUN]
[0m22:05:14.669637 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_dim, now model.etl_waterlevel.fact_waterlevel)
[0m22:05:14.669911 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.fact_waterlevel
[0m22:05:14.676861 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.fact_waterlevel"
[0m22:05:14.678465 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.fact_waterlevel
[0m22:05:14.706536 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m22:05:14.706892 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

    
  
    

  create temporary table "fact_waterlevel__dbt_tmp220514694697"
  
  
    as
  
  (
    

with main as (
    select
        distinct
        concat("stationId",'_',"stationCode") as station_key,
        "stationId" as station_id,
        "stationCode" as station_code,
        "waterLevel" as water_level,
        "waterlevelStatus" as waterlevel_status,
        case
            when "waterlevelStatus" = 3 then '🚨 Beyond Danger'
            when "waterlevelStatus" = 2 then '⚠️ Between Warning and Danger'
            when "waterlevelStatus" = 1 then '🔶 Between Alert and Warning'
            when "waterlevelStatus" = 0 then '✅ Between Normal and Alert'
            when "waterlevelStatus" = -1 then '🟢 Below Normal (Safe)'
            else '❓ Unknown Status'
        end as waterlevel_condition,
        "stationName",
        "districtName",
        to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp AS last_update
    from
        raw.waterlevels w
    where
        "stationStatus" = 1

        
        and to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp >= (
            select max(last_update) - interval '1 hour' from "airflow"."fact"."fact_waterlevel"
        )
        
)

select * from main
  );
  
  
[0m22:05:14.707227 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:05:14.719624 [debug] [Thread-1 (]: SQL status: SELECT 140 in 0.012 seconds
[0m22:05:14.726706 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m22:05:14.727012 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: BEGIN
[0m22:05:14.727426 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m22:05:14.727712 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m22:05:14.728002 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp220514694697'
        
      order by ordinal_position

  
[0m22:05:14.730799 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.002 seconds
[0m22:05:14.733410 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m22:05:14.733718 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m22:05:14.735125 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m22:05:14.741482 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m22:05:14.741793 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp220514694697'
        
      order by ordinal_position

  
[0m22:05:14.743015 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m22:05:14.744701 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m22:05:14.744998 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m22:05:14.746171 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m22:05:14.750677 [debug] [Thread-1 (]: 
    In "airflow"."fact"."fact_waterlevel":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m22:05:14.755868 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.fact_waterlevel"
[0m22:05:14.756766 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m22:05:14.757100 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      
        
        
        delete from "airflow"."fact"."fact_waterlevel" as DBT_INTERNAL_DEST
        where (station_key) in (
            select distinct station_key
            from "fact_waterlevel__dbt_tmp220514694697" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airflow"."fact"."fact_waterlevel" ("station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update")
    (
        select "station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update"
        from "fact_waterlevel__dbt_tmp220514694697"
    )
  
[0m22:05:14.757963 [debug] [Thread-1 (]: SQL status: INSERT 0 140 in 0.001 seconds
[0m22:05:14.765498 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m22:05:14.765799 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m22:05:14.766077 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m22:05:14.767841 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m22:05:14.768933 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: Close
[0m22:05:14.770221 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '848aac10-be36-4762-951e-80fc845f7e5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad053700>]}
[0m22:05:14.770972 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model fact.fact_waterlevel ................... [[32mINSERT 0 140[0m in 0.10s]
[0m22:05:14.771600 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.fact_waterlevel
[0m22:05:14.772521 [debug] [MainThread]: Using postgres connection "master"
[0m22:05:14.772842 [debug] [MainThread]: On master: BEGIN
[0m22:05:14.773124 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:05:14.775212 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m22:05:14.775771 [debug] [MainThread]: On master: COMMIT
[0m22:05:14.776231 [debug] [MainThread]: Using postgres connection "master"
[0m22:05:14.776622 [debug] [MainThread]: On master: COMMIT
[0m22:05:14.777033 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:05:14.777293 [debug] [MainThread]: On master: Close
[0m22:05:14.777610 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:05:14.777870 [debug] [MainThread]: Connection 'model.etl_waterlevel.fact_waterlevel' was properly closed.
[0m22:05:14.778155 [info ] [MainThread]: 
[0m22:05:14.778443 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.18 seconds (0.18s).
[0m22:05:14.778873 [debug] [MainThread]: Command end result
[0m22:05:14.794395 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m22:05:14.795513 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m22:05:14.799267 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m22:05:14.799504 [info ] [MainThread]: 
[0m22:05:14.799784 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:05:14.799992 [info ] [MainThread]: 
[0m22:05:14.800232 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m22:05:14.800764 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.50134194, "process_in_blocks": "0", "process_kernel_time": 0.06887, "process_mem_max_rss": "111292", "process_out_blocks": "1702", "process_user_time": 1.244661}
[0m22:05:14.801094 [debug] [MainThread]: Command `dbt run` succeeded at 22:05:14.801044 after 0.50 seconds
[0m22:05:14.801339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaae94370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaaf028f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa86b0580>]}
[0m22:05:14.801586 [debug] [MainThread]: Flushing usage events
[0m22:05:16.142229 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:17:49.925384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b53c310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a63c520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a63c580>]}


============================== 23:17:49.930302 | 42cf1854-4c75-4429-aba1-3403bb33603c ==============================
[0m23:17:49.930302 [info ] [MainThread]: Running with dbt=1.9.0
[0m23:17:49.931647 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'profiles_dir': '/home/airflow/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --models fact_waterlevel', 'send_anonymous_usage_stats': 'True'}
[0m23:17:50.104620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '42cf1854-4c75-4429-aba1-3403bb33603c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89cf2290>]}
[0m23:17:50.138294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '42cf1854-4c75-4429-aba1-3403bb33603c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b4881c0>]}
[0m23:17:50.139038 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:17:50.191175 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m23:17:50.247562 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:17:50.247961 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:17:50.252344 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m23:17:50.264393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '42cf1854-4c75-4429-aba1-3403bb33603c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89860550>]}
[0m23:17:50.302235 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m23:17:50.306467 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m23:17:50.316336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '42cf1854-4c75-4429-aba1-3403bb33603c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8987f220>]}
[0m23:17:50.316730 [info ] [MainThread]: Found 3 models, 434 macros
[0m23:17:50.317040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '42cf1854-4c75-4429-aba1-3403bb33603c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8987f1c0>]}
[0m23:17:50.317836 [info ] [MainThread]: 
[0m23:17:50.318199 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:17:50.318499 [info ] [MainThread]: 
[0m23:17:50.318933 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:17:50.319611 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m23:17:50.363368 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m23:17:50.363782 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m23:17:50.364056 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:17:50.367558 [debug] [ThreadPool]: SQL status: SELECT 24 in 0.003 seconds
[0m23:17:50.368304 [debug] [ThreadPool]: On list_airflow: Close
[0m23:17:50.370984 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_fact)
[0m23:17:50.374185 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m23:17:50.374484 [debug] [ThreadPool]: On list_airflow_fact: BEGIN
[0m23:17:50.374736 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:17:50.376594 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m23:17:50.376966 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m23:17:50.377231 [debug] [ThreadPool]: On list_airflow_fact: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_fact"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'fact'
  
[0m23:17:50.378831 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m23:17:50.379508 [debug] [ThreadPool]: On list_airflow_fact: ROLLBACK
[0m23:17:50.379855 [debug] [ThreadPool]: On list_airflow_fact: Close
[0m23:17:50.380239 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_fact, now list_airflow_dim)
[0m23:17:50.381572 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m23:17:50.381820 [debug] [ThreadPool]: On list_airflow_dim: BEGIN
[0m23:17:50.382056 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:17:50.383676 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m23:17:50.383934 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m23:17:50.384213 [debug] [ThreadPool]: On list_airflow_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dim'
  
[0m23:17:50.385516 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.001 seconds
[0m23:17:50.386149 [debug] [ThreadPool]: On list_airflow_dim: ROLLBACK
[0m23:17:50.386478 [debug] [ThreadPool]: On list_airflow_dim: Close
[0m23:17:50.388983 [debug] [MainThread]: Using postgres connection "master"
[0m23:17:50.389243 [debug] [MainThread]: On master: BEGIN
[0m23:17:50.389493 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:17:50.391021 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m23:17:50.391271 [debug] [MainThread]: Using postgres connection "master"
[0m23:17:50.391563 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:17:50.394912 [debug] [MainThread]: SQL status: SELECT 2 in 0.003 seconds
[0m23:17:50.395751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '42cf1854-4c75-4429-aba1-3403bb33603c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d05df00>]}
[0m23:17:50.396135 [debug] [MainThread]: On master: ROLLBACK
[0m23:17:50.396578 [debug] [MainThread]: Using postgres connection "master"
[0m23:17:50.396881 [debug] [MainThread]: On master: BEGIN
[0m23:17:50.397315 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:17:50.397593 [debug] [MainThread]: On master: COMMIT
[0m23:17:50.397855 [debug] [MainThread]: Using postgres connection "master"
[0m23:17:50.398116 [debug] [MainThread]: On master: COMMIT
[0m23:17:50.398505 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:17:50.398756 [debug] [MainThread]: On master: Close
[0m23:17:50.399891 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.fact_waterlevel
[0m23:17:50.400282 [info ] [Thread-1 (]: 1 of 1 START sql incremental model fact.fact_waterlevel ........................ [RUN]
[0m23:17:50.400711 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_dim, now model.etl_waterlevel.fact_waterlevel)
[0m23:17:50.401041 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.fact_waterlevel
[0m23:17:50.408063 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.fact_waterlevel"
[0m23:17:50.409299 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.fact_waterlevel
[0m23:17:50.437930 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m23:17:50.438295 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

    
  
    

  create temporary table "fact_waterlevel__dbt_tmp231750425901"
  
  
    as
  
  (
    

with main as (
    select
        distinct
        concat("stationId",'_',"stationCode") as station_key,
        "stationId" as station_id,
        "stationCode" as station_code,
        "waterLevel" as water_level,
        "waterlevelStatus" as waterlevel_status,
        case
            when "waterlevelStatus" = 3 then '🚨 Beyond Danger'
            when "waterlevelStatus" = 2 then '⚠️ Between Warning and Danger'
            when "waterlevelStatus" = 1 then '🔶 Between Alert and Warning'
            when "waterlevelStatus" = 0 then '✅ Between Normal and Alert'
            when "waterlevelStatus" = -1 then '🟢 Below Normal (Safe)'
            else '❓ Unknown Status'
        end as waterlevel_condition,
        "stationName",
        "districtName",
        to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp AS last_update
    from
        raw.waterlevels w
    where
        "stationStatus" = 1

        
        and to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp >= (
            select max(last_update) - interval '1 hour' from "airflow"."fact"."fact_waterlevel"
        )
        
)

select * from main
  );
  
  
[0m23:17:50.438636 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:17:50.454372 [debug] [Thread-1 (]: SQL status: SELECT 210 in 0.016 seconds
[0m23:17:50.461963 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m23:17:50.462254 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: BEGIN
[0m23:17:50.462611 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m23:17:50.462887 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m23:17:50.463185 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp231750425901'
        
      order by ordinal_position

  
[0m23:17:50.466391 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.003 seconds
[0m23:17:50.469107 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m23:17:50.469445 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m23:17:50.471107 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m23:17:50.477931 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m23:17:50.478220 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp231750425901'
        
      order by ordinal_position

  
[0m23:17:50.479370 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m23:17:50.481120 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m23:17:50.481614 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m23:17:50.483107 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m23:17:50.488265 [debug] [Thread-1 (]: 
    In "airflow"."fact"."fact_waterlevel":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m23:17:50.493552 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.fact_waterlevel"
[0m23:17:50.494509 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m23:17:50.494812 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      
        
        
        delete from "airflow"."fact"."fact_waterlevel" as DBT_INTERNAL_DEST
        where (station_key) in (
            select distinct station_key
            from "fact_waterlevel__dbt_tmp231750425901" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airflow"."fact"."fact_waterlevel" ("station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update")
    (
        select "station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update"
        from "fact_waterlevel__dbt_tmp231750425901"
    )
  
[0m23:17:50.495848 [debug] [Thread-1 (]: SQL status: INSERT 0 210 in 0.001 seconds
[0m23:17:50.503894 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m23:17:50.504195 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m23:17:50.504442 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m23:17:50.505746 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:17:50.506903 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: Close
[0m23:17:50.508185 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42cf1854-4c75-4429-aba1-3403bb33603c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d05df00>]}
[0m23:17:50.508698 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model fact.fact_waterlevel ................... [[32mINSERT 0 210[0m in 0.11s]
[0m23:17:50.509117 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.fact_waterlevel
[0m23:17:50.509797 [debug] [MainThread]: Using postgres connection "master"
[0m23:17:50.510084 [debug] [MainThread]: On master: BEGIN
[0m23:17:50.510309 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:17:50.511940 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m23:17:50.512200 [debug] [MainThread]: On master: COMMIT
[0m23:17:50.512420 [debug] [MainThread]: Using postgres connection "master"
[0m23:17:50.512621 [debug] [MainThread]: On master: COMMIT
[0m23:17:50.512876 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:17:50.513074 [debug] [MainThread]: On master: Close
[0m23:17:50.513361 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:17:50.513629 [debug] [MainThread]: Connection 'model.etl_waterlevel.fact_waterlevel' was properly closed.
[0m23:17:50.513873 [info ] [MainThread]: 
[0m23:17:50.514098 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.20 seconds (0.20s).
[0m23:17:50.514526 [debug] [MainThread]: Command end result
[0m23:17:50.529563 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m23:17:50.531069 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m23:17:50.535169 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m23:17:50.535444 [info ] [MainThread]: 
[0m23:17:50.535857 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:17:50.536114 [info ] [MainThread]: 
[0m23:17:50.536371 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:17:50.536963 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.6731422, "process_in_blocks": "0", "process_kernel_time": 0.100931, "process_mem_max_rss": "111324", "process_out_blocks": "1702", "process_user_time": 1.339097}
[0m23:17:50.537352 [debug] [MainThread]: Command `dbt run` succeeded at 23:17:50.537297 after 0.67 seconds
[0m23:17:50.537649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b53c310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89cf2290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b5ab6d0>]}
[0m23:17:50.537954 [debug] [MainThread]: Flushing usage events
[0m23:17:51.865686 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:18:41.108810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f288310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e368520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e368580>]}


============================== 00:18:41.113088 | 4de1a6db-009c-49ed-8be6-61cbc8f48079 ==============================
[0m00:18:41.113088 [info ] [MainThread]: Running with dbt=1.9.0
[0m00:18:41.113440 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --models fact_waterlevel', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:18:41.202015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4de1a6db-009c-49ed-8be6-61cbc8f48079', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9dade290>]}
[0m00:18:41.229239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4de1a6db-009c-49ed-8be6-61cbc8f48079', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f1d81c0>]}
[0m00:18:41.229736 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m00:18:41.264328 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m00:18:41.314900 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:18:41.315249 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:18:41.318458 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m00:18:41.331563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4de1a6db-009c-49ed-8be6-61cbc8f48079', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d668550>]}
[0m00:18:41.367120 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m00:18:41.370677 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m00:18:41.379861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4de1a6db-009c-49ed-8be6-61cbc8f48079', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d687220>]}
[0m00:18:41.380206 [info ] [MainThread]: Found 3 models, 434 macros
[0m00:18:41.380473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4de1a6db-009c-49ed-8be6-61cbc8f48079', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d6871c0>]}
[0m00:18:41.381390 [info ] [MainThread]: 
[0m00:18:41.381716 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:18:41.381979 [info ] [MainThread]: 
[0m00:18:41.382334 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:18:41.383121 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m00:18:41.426788 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m00:18:41.427221 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m00:18:41.427511 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:18:41.430451 [debug] [ThreadPool]: SQL status: SELECT 24 in 0.003 seconds
[0m00:18:41.431226 [debug] [ThreadPool]: On list_airflow: Close
[0m00:18:41.433918 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_fact)
[0m00:18:41.437138 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m00:18:41.437428 [debug] [ThreadPool]: On list_airflow_fact: BEGIN
[0m00:18:41.437696 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:18:41.439349 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m00:18:41.439626 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m00:18:41.439894 [debug] [ThreadPool]: On list_airflow_fact: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_fact"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'fact'
  
[0m00:18:41.441261 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m00:18:41.441925 [debug] [ThreadPool]: On list_airflow_fact: ROLLBACK
[0m00:18:41.442259 [debug] [ThreadPool]: On list_airflow_fact: Close
[0m00:18:41.442640 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_fact, now list_airflow_dim)
[0m00:18:41.443969 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m00:18:41.444239 [debug] [ThreadPool]: On list_airflow_dim: BEGIN
[0m00:18:41.444489 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:18:41.445987 [debug] [ThreadPool]: SQL status: BEGIN in 0.001 seconds
[0m00:18:41.446258 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m00:18:41.446513 [debug] [ThreadPool]: On list_airflow_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dim'
  
[0m00:18:41.447783 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.001 seconds
[0m00:18:41.448434 [debug] [ThreadPool]: On list_airflow_dim: ROLLBACK
[0m00:18:41.448751 [debug] [ThreadPool]: On list_airflow_dim: Close
[0m00:18:41.451263 [debug] [MainThread]: Using postgres connection "master"
[0m00:18:41.451525 [debug] [MainThread]: On master: BEGIN
[0m00:18:41.451768 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:18:41.453251 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m00:18:41.453513 [debug] [MainThread]: Using postgres connection "master"
[0m00:18:41.453810 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:18:41.456810 [debug] [MainThread]: SQL status: SELECT 2 in 0.003 seconds
[0m00:18:41.457479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4de1a6db-009c-49ed-8be6-61cbc8f48079', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0cc1f00>]}
[0m00:18:41.457808 [debug] [MainThread]: On master: ROLLBACK
[0m00:18:41.458179 [debug] [MainThread]: Using postgres connection "master"
[0m00:18:41.458419 [debug] [MainThread]: On master: BEGIN
[0m00:18:41.458823 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m00:18:41.459129 [debug] [MainThread]: On master: COMMIT
[0m00:18:41.459370 [debug] [MainThread]: Using postgres connection "master"
[0m00:18:41.459614 [debug] [MainThread]: On master: COMMIT
[0m00:18:41.459933 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:18:41.460183 [debug] [MainThread]: On master: Close
[0m00:18:41.461311 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.fact_waterlevel
[0m00:18:41.461712 [info ] [Thread-1 (]: 1 of 1 START sql incremental model fact.fact_waterlevel ........................ [RUN]
[0m00:18:41.462037 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_dim, now model.etl_waterlevel.fact_waterlevel)
[0m00:18:41.462378 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.fact_waterlevel
[0m00:18:41.469337 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.fact_waterlevel"
[0m00:18:41.471023 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.fact_waterlevel
[0m00:18:41.499052 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m00:18:41.499408 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

    
  
    

  create temporary table "fact_waterlevel__dbt_tmp001841487066"
  
  
    as
  
  (
    

with main as (
    select
        distinct
        concat("stationId",'_',"stationCode") as station_key,
        "stationId" as station_id,
        "stationCode" as station_code,
        "waterLevel" as water_level,
        "waterlevelStatus" as waterlevel_status,
        case
            when "waterlevelStatus" = 3 then '🚨 Beyond Danger'
            when "waterlevelStatus" = 2 then '⚠️ Between Warning and Danger'
            when "waterlevelStatus" = 1 then '🔶 Between Alert and Warning'
            when "waterlevelStatus" = 0 then '✅ Between Normal and Alert'
            when "waterlevelStatus" = -1 then '🟢 Below Normal (Safe)'
            else '❓ Unknown Status'
        end as waterlevel_condition,
        "stationName",
        "districtName",
        to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp AS last_update
    from
        raw.waterlevels w
    where
        "stationStatus" = 1

        
        and to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp >= (
            select max(last_update) - interval '1 hour' from "airflow"."fact"."fact_waterlevel"
        )
        
)

select * from main
  );
  
  
[0m00:18:41.499736 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:18:41.512247 [debug] [Thread-1 (]: SQL status: SELECT 141 in 0.012 seconds
[0m00:18:41.519406 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m00:18:41.519712 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: BEGIN
[0m00:18:41.520152 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m00:18:41.520442 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m00:18:41.520720 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp001841487066'
        
      order by ordinal_position

  
[0m00:18:41.523480 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.002 seconds
[0m00:18:41.526098 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m00:18:41.526403 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m00:18:41.527749 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m00:18:41.534178 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m00:18:41.534485 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp001841487066'
        
      order by ordinal_position

  
[0m00:18:41.535697 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m00:18:41.537330 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m00:18:41.537616 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m00:18:41.538859 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m00:18:41.543438 [debug] [Thread-1 (]: 
    In "airflow"."fact"."fact_waterlevel":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m00:18:41.548608 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.fact_waterlevel"
[0m00:18:41.549523 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m00:18:41.549828 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      
        
        
        delete from "airflow"."fact"."fact_waterlevel" as DBT_INTERNAL_DEST
        where (station_key) in (
            select distinct station_key
            from "fact_waterlevel__dbt_tmp001841487066" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airflow"."fact"."fact_waterlevel" ("station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update")
    (
        select "station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update"
        from "fact_waterlevel__dbt_tmp001841487066"
    )
  
[0m00:18:41.550671 [debug] [Thread-1 (]: SQL status: INSERT 0 141 in 0.001 seconds
[0m00:18:41.558140 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m00:18:41.558454 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m00:18:41.558734 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m00:18:41.560004 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m00:18:41.561180 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: Close
[0m00:18:41.562413 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4de1a6db-009c-49ed-8be6-61cbc8f48079', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0cc1f00>]}
[0m00:18:41.562936 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model fact.fact_waterlevel ................... [[32mINSERT 0 141[0m in 0.10s]
[0m00:18:41.563337 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.fact_waterlevel
[0m00:18:41.564012 [debug] [MainThread]: Using postgres connection "master"
[0m00:18:41.564297 [debug] [MainThread]: On master: BEGIN
[0m00:18:41.564522 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:18:41.566055 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m00:18:41.566298 [debug] [MainThread]: On master: COMMIT
[0m00:18:41.566526 [debug] [MainThread]: Using postgres connection "master"
[0m00:18:41.566768 [debug] [MainThread]: On master: COMMIT
[0m00:18:41.567088 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:18:41.567299 [debug] [MainThread]: On master: Close
[0m00:18:41.567572 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:18:41.567788 [debug] [MainThread]: Connection 'model.etl_waterlevel.fact_waterlevel' was properly closed.
[0m00:18:41.568012 [info ] [MainThread]: 
[0m00:18:41.568231 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.19 seconds (0.19s).
[0m00:18:41.568600 [debug] [MainThread]: Command end result
[0m00:18:41.584307 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m00:18:41.585453 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m00:18:41.589116 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m00:18:41.589341 [info ] [MainThread]: 
[0m00:18:41.589615 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:18:41.589830 [info ] [MainThread]: 
[0m00:18:41.590058 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m00:18:41.590601 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.5080191, "process_in_blocks": "0", "process_kernel_time": 0.086174, "process_mem_max_rss": "111292", "process_out_blocks": "1702", "process_user_time": 1.222475}
[0m00:18:41.590928 [debug] [MainThread]: Command `dbt run` succeeded at 00:18:41.590874 after 0.51 seconds
[0m00:18:41.591167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f288310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9dade290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa24e53c0>]}
[0m00:18:41.591442 [debug] [MainThread]: Flushing usage events
[0m00:18:42.806697 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:06:13.670136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c350340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b453d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b453d00>]}


============================== 01:06:13.673938 | c6de9e4a-cfd1-4d2a-ad25-4ab7a976da4b ==============================
[0m01:06:13.673938 [info ] [MainThread]: Running with dbt=1.9.0
[0m01:06:13.674348 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'profiles_dir': '/home/airflow/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models fact_waterlevel', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:06:13.759186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c6de9e4a-cfd1-4d2a-ad25-4ab7a976da4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e5727a0>]}
[0m01:06:13.785907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c6de9e4a-cfd1-4d2a-ad25-4ab7a976da4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b7f0220>]}
[0m01:06:13.786473 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m01:06:13.820570 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m01:06:13.870234 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:06:13.870591 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:06:13.873759 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m01:06:13.885524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c6de9e4a-cfd1-4d2a-ad25-4ab7a976da4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a698550>]}
[0m01:06:13.921387 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m01:06:13.925139 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m01:06:13.933899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c6de9e4a-cfd1-4d2a-ad25-4ab7a976da4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a6b7220>]}
[0m01:06:13.934215 [info ] [MainThread]: Found 3 models, 434 macros
[0m01:06:13.934456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c6de9e4a-cfd1-4d2a-ad25-4ab7a976da4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a6b71c0>]}
[0m01:06:13.935180 [info ] [MainThread]: 
[0m01:06:13.935442 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:06:13.935653 [info ] [MainThread]: 
[0m01:06:13.935957 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:06:13.936526 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m01:06:13.975831 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m01:06:13.976242 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m01:06:13.976559 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:06:13.979344 [debug] [ThreadPool]: SQL status: SELECT 24 in 0.003 seconds
[0m01:06:13.980102 [debug] [ThreadPool]: On list_airflow: Close
[0m01:06:13.982707 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_dim)
[0m01:06:13.985901 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m01:06:13.986187 [debug] [ThreadPool]: On list_airflow_dim: BEGIN
[0m01:06:13.986461 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:06:13.988032 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m01:06:13.988310 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m01:06:13.988616 [debug] [ThreadPool]: On list_airflow_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dim'
  
[0m01:06:13.989948 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.001 seconds
[0m01:06:13.990616 [debug] [ThreadPool]: On list_airflow_dim: ROLLBACK
[0m01:06:13.990949 [debug] [ThreadPool]: On list_airflow_dim: Close
[0m01:06:13.991363 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_dim, now list_airflow_fact)
[0m01:06:13.992821 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m01:06:13.993068 [debug] [ThreadPool]: On list_airflow_fact: BEGIN
[0m01:06:13.993307 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:06:13.994756 [debug] [ThreadPool]: SQL status: BEGIN in 0.001 seconds
[0m01:06:13.995014 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m01:06:13.995281 [debug] [ThreadPool]: On list_airflow_fact: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_fact"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'fact'
  
[0m01:06:13.996514 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m01:06:13.997133 [debug] [ThreadPool]: On list_airflow_fact: ROLLBACK
[0m01:06:13.997458 [debug] [ThreadPool]: On list_airflow_fact: Close
[0m01:06:13.999879 [debug] [MainThread]: Using postgres connection "master"
[0m01:06:14.000142 [debug] [MainThread]: On master: BEGIN
[0m01:06:14.000377 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:06:14.001876 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m01:06:14.002143 [debug] [MainThread]: Using postgres connection "master"
[0m01:06:14.002436 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m01:06:14.005416 [debug] [MainThread]: SQL status: SELECT 2 in 0.003 seconds
[0m01:06:14.006063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c6de9e4a-cfd1-4d2a-ad25-4ab7a976da4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a6b6c50>]}
[0m01:06:14.006379 [debug] [MainThread]: On master: ROLLBACK
[0m01:06:14.006689 [debug] [MainThread]: Using postgres connection "master"
[0m01:06:14.006948 [debug] [MainThread]: On master: BEGIN
[0m01:06:14.007341 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m01:06:14.007598 [debug] [MainThread]: On master: COMMIT
[0m01:06:14.007844 [debug] [MainThread]: Using postgres connection "master"
[0m01:06:14.008077 [debug] [MainThread]: On master: COMMIT
[0m01:06:14.008392 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:06:14.008631 [debug] [MainThread]: On master: Close
[0m01:06:14.009801 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.fact_waterlevel
[0m01:06:14.010171 [info ] [Thread-1 (]: 1 of 1 START sql incremental model fact.fact_waterlevel ........................ [RUN]
[0m01:06:14.010517 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_fact, now model.etl_waterlevel.fact_waterlevel)
[0m01:06:14.010807 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.fact_waterlevel
[0m01:06:14.017715 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.fact_waterlevel"
[0m01:06:14.019284 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.fact_waterlevel
[0m01:06:14.047491 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m01:06:14.047852 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

    
  
    

  create temporary table "fact_waterlevel__dbt_tmp010614035412"
  
  
    as
  
  (
    

with main as (
    select
        distinct
        concat("stationId",'_',"stationCode") as station_key,
        "stationId" as station_id,
        "stationCode" as station_code,
        "waterLevel" as water_level,
        "waterlevelStatus" as waterlevel_status,
        case
            when "waterlevelStatus" = 3 then '🚨 Beyond Danger'
            when "waterlevelStatus" = 2 then '⚠️ Between Warning and Danger'
            when "waterlevelStatus" = 1 then '🔶 Between Alert and Warning'
            when "waterlevelStatus" = 0 then '✅ Between Normal and Alert'
            when "waterlevelStatus" = -1 then '🟢 Below Normal (Safe)'
            else '❓ Unknown Status'
        end as waterlevel_condition,
        "stationName",
        "districtName",
        to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp AS last_update
    from
        raw.waterlevels w
    where
        "stationStatus" = 1

        
        and to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp >= (
            select max(last_update) - interval '1 hour' from "airflow"."fact"."fact_waterlevel"
        )
        
)

select * from main
  );
  
  
[0m01:06:14.048161 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:06:14.060549 [debug] [Thread-1 (]: SQL status: SELECT 186 in 0.012 seconds
[0m01:06:14.067645 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m01:06:14.067956 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: BEGIN
[0m01:06:14.068367 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m01:06:14.068648 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m01:06:14.068929 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp010614035412'
        
      order by ordinal_position

  
[0m01:06:14.071690 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.002 seconds
[0m01:06:14.074285 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m01:06:14.074593 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m01:06:14.075942 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m01:06:14.082455 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m01:06:14.082774 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp010614035412'
        
      order by ordinal_position

  
[0m01:06:14.084021 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m01:06:14.085728 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m01:06:14.086030 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m01:06:14.087182 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m01:06:14.091725 [debug] [Thread-1 (]: 
    In "airflow"."fact"."fact_waterlevel":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m01:06:14.096888 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.fact_waterlevel"
[0m01:06:14.097750 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m01:06:14.098079 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      
        
        
        delete from "airflow"."fact"."fact_waterlevel" as DBT_INTERNAL_DEST
        where (station_key) in (
            select distinct station_key
            from "fact_waterlevel__dbt_tmp010614035412" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airflow"."fact"."fact_waterlevel" ("station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update")
    (
        select "station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update"
        from "fact_waterlevel__dbt_tmp010614035412"
    )
  
[0m01:06:14.099020 [debug] [Thread-1 (]: SQL status: INSERT 0 186 in 0.001 seconds
[0m01:06:14.106817 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m01:06:14.107127 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m01:06:14.107408 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m01:06:14.108416 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m01:06:14.109475 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: Close
[0m01:06:14.110639 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c6de9e4a-cfd1-4d2a-ad25-4ab7a976da4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8de91f60>]}
[0m01:06:14.111150 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model fact.fact_waterlevel ................... [[32mINSERT 0 186[0m in 0.10s]
[0m01:06:14.111599 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.fact_waterlevel
[0m01:06:14.112364 [debug] [MainThread]: Using postgres connection "master"
[0m01:06:14.112598 [debug] [MainThread]: On master: BEGIN
[0m01:06:14.112804 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:06:14.114362 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m01:06:14.114629 [debug] [MainThread]: On master: COMMIT
[0m01:06:14.114866 [debug] [MainThread]: Using postgres connection "master"
[0m01:06:14.115067 [debug] [MainThread]: On master: COMMIT
[0m01:06:14.115314 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:06:14.115516 [debug] [MainThread]: On master: Close
[0m01:06:14.115779 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:06:14.115991 [debug] [MainThread]: Connection 'model.etl_waterlevel.fact_waterlevel' was properly closed.
[0m01:06:14.116210 [info ] [MainThread]: 
[0m01:06:14.116445 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.18 seconds (0.18s).
[0m01:06:14.116821 [debug] [MainThread]: Command end result
[0m01:06:14.132698 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m01:06:14.133789 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m01:06:14.137423 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m01:06:14.137658 [info ] [MainThread]: 
[0m01:06:14.137911 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:06:14.138112 [info ] [MainThread]: 
[0m01:06:14.138325 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m01:06:14.138830 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.4943798, "process_in_blocks": "0", "process_kernel_time": 0.054297, "process_mem_max_rss": "111544", "process_out_blocks": "1702", "process_user_time": 1.212637}
[0m01:06:14.139175 [debug] [MainThread]: Command `dbt run` succeeded at 01:06:14.139131 after 0.49 seconds
[0m01:06:14.139425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c350340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b7f0220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c3be290>]}
[0m01:06:14.139730 [debug] [MainThread]: Flushing usage events
[0m01:06:15.452528 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:20:20.967732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d780370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c86fd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c86fd30>]}


============================== 02:20:20.971641 | 1813bb5c-ba84-48df-ac5b-f00244567633 ==============================
[0m02:20:20.971641 [info ] [MainThread]: Running with dbt=1.9.0
[0m02:20:20.972057 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --models fact_waterlevel', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m02:20:21.062175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1813bb5c-ba84-48df-ac5b-f00244567633', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d810310>]}
[0m02:20:21.089054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1813bb5c-ba84-48df-ac5b-f00244567633', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d129810>]}
[0m02:20:21.089599 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m02:20:21.123888 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m02:20:21.174117 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:20:21.174446 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:20:21.177527 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m02:20:21.189335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1813bb5c-ba84-48df-ac5b-f00244567633', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9bb705b0>]}
[0m02:20:21.223908 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m02:20:21.227331 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m02:20:21.236765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1813bb5c-ba84-48df-ac5b-f00244567633', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9bb8f220>]}
[0m02:20:21.237077 [info ] [MainThread]: Found 3 models, 434 macros
[0m02:20:21.237308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1813bb5c-ba84-48df-ac5b-f00244567633', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9bb8f1c0>]}
[0m02:20:21.238015 [info ] [MainThread]: 
[0m02:20:21.238287 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:20:21.238563 [info ] [MainThread]: 
[0m02:20:21.238927 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:20:21.239673 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m02:20:21.280023 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m02:20:21.280443 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m02:20:21.280743 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:20:21.283722 [debug] [ThreadPool]: SQL status: SELECT 24 in 0.003 seconds
[0m02:20:21.284512 [debug] [ThreadPool]: On list_airflow: Close
[0m02:20:21.287143 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_fact)
[0m02:20:21.290491 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m02:20:21.290792 [debug] [ThreadPool]: On list_airflow_fact: BEGIN
[0m02:20:21.291047 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:20:21.292646 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m02:20:21.292908 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m02:20:21.293177 [debug] [ThreadPool]: On list_airflow_fact: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_fact"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'fact'
  
[0m02:20:21.294565 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m02:20:21.295211 [debug] [ThreadPool]: On list_airflow_fact: ROLLBACK
[0m02:20:21.295540 [debug] [ThreadPool]: On list_airflow_fact: Close
[0m02:20:21.295927 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_fact, now list_airflow_dim)
[0m02:20:21.297258 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m02:20:21.297532 [debug] [ThreadPool]: On list_airflow_dim: BEGIN
[0m02:20:21.297772 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:20:21.299252 [debug] [ThreadPool]: SQL status: BEGIN in 0.001 seconds
[0m02:20:21.299514 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m02:20:21.299773 [debug] [ThreadPool]: On list_airflow_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dim'
  
[0m02:20:21.301020 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.001 seconds
[0m02:20:21.301664 [debug] [ThreadPool]: On list_airflow_dim: ROLLBACK
[0m02:20:21.301985 [debug] [ThreadPool]: On list_airflow_dim: Close
[0m02:20:21.304454 [debug] [MainThread]: Using postgres connection "master"
[0m02:20:21.304713 [debug] [MainThread]: On master: BEGIN
[0m02:20:21.304949 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:20:21.306478 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m02:20:21.306744 [debug] [MainThread]: Using postgres connection "master"
[0m02:20:21.307034 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:20:21.310076 [debug] [MainThread]: SQL status: SELECT 2 in 0.003 seconds
[0m02:20:21.310741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1813bb5c-ba84-48df-ac5b-f00244567633', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f917700>]}
[0m02:20:21.311072 [debug] [MainThread]: On master: ROLLBACK
[0m02:20:21.311430 [debug] [MainThread]: Using postgres connection "master"
[0m02:20:21.311699 [debug] [MainThread]: On master: BEGIN
[0m02:20:21.312105 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m02:20:21.312363 [debug] [MainThread]: On master: COMMIT
[0m02:20:21.312643 [debug] [MainThread]: Using postgres connection "master"
[0m02:20:21.312879 [debug] [MainThread]: On master: COMMIT
[0m02:20:21.313197 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m02:20:21.313457 [debug] [MainThread]: On master: Close
[0m02:20:21.314598 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.fact_waterlevel
[0m02:20:21.314962 [info ] [Thread-1 (]: 1 of 1 START sql incremental model fact.fact_waterlevel ........................ [RUN]
[0m02:20:21.315283 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_dim, now model.etl_waterlevel.fact_waterlevel)
[0m02:20:21.315555 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.fact_waterlevel
[0m02:20:21.322546 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.fact_waterlevel"
[0m02:20:21.324162 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.fact_waterlevel
[0m02:20:21.352527 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m02:20:21.352899 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

    
  
    

  create temporary table "fact_waterlevel__dbt_tmp022021340340"
  
  
    as
  
  (
    

with main as (
    select
        distinct
        concat("stationId",'_',"stationCode") as station_key,
        "stationId" as station_id,
        "stationCode" as station_code,
        "waterLevel" as water_level,
        "waterlevelStatus" as waterlevel_status,
        case
            when "waterlevelStatus" = 3 then '🚨 Beyond Danger'
            when "waterlevelStatus" = 2 then '⚠️ Between Warning and Danger'
            when "waterlevelStatus" = 1 then '🔶 Between Alert and Warning'
            when "waterlevelStatus" = 0 then '✅ Between Normal and Alert'
            when "waterlevelStatus" = -1 then '🟢 Below Normal (Safe)'
            else '❓ Unknown Status'
        end as waterlevel_condition,
        "stationName",
        "districtName",
        to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp AS last_update
    from
        raw.waterlevels w
    where
        "stationStatus" = 1

        
        and to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp >= (
            select max(last_update) - interval '1 hour' from "airflow"."fact"."fact_waterlevel"
        )
        
)

select * from main
  );
  
  
[0m02:20:21.353279 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:20:21.367632 [debug] [Thread-1 (]: SQL status: SELECT 185 in 0.014 seconds
[0m02:20:21.374802 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m02:20:21.375108 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: BEGIN
[0m02:20:21.375536 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m02:20:21.375816 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m02:20:21.376097 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp022021340340'
        
      order by ordinal_position

  
[0m02:20:21.378901 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.003 seconds
[0m02:20:21.381899 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m02:20:21.382198 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m02:20:21.383597 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m02:20:21.391490 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m02:20:21.391882 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp022021340340'
        
      order by ordinal_position

  
[0m02:20:21.393273 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m02:20:21.397283 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m02:20:21.397596 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m02:20:21.398853 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m02:20:21.403613 [debug] [Thread-1 (]: 
    In "airflow"."fact"."fact_waterlevel":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m02:20:21.408921 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.fact_waterlevel"
[0m02:20:21.409833 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m02:20:21.410137 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      
        
        
        delete from "airflow"."fact"."fact_waterlevel" as DBT_INTERNAL_DEST
        where (station_key) in (
            select distinct station_key
            from "fact_waterlevel__dbt_tmp022021340340" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airflow"."fact"."fact_waterlevel" ("station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update")
    (
        select "station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update"
        from "fact_waterlevel__dbt_tmp022021340340"
    )
  
[0m02:20:21.411346 [debug] [Thread-1 (]: SQL status: INSERT 0 185 in 0.001 seconds
[0m02:20:21.419087 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m02:20:21.419363 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m02:20:21.419605 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m02:20:21.420355 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m02:20:21.421488 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: Close
[0m02:20:21.422694 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1813bb5c-ba84-48df-ac5b-f00244567633', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f917700>]}
[0m02:20:21.423248 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model fact.fact_waterlevel ................... [[32mINSERT 0 185[0m in 0.11s]
[0m02:20:21.423761 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.fact_waterlevel
[0m02:20:21.424521 [debug] [MainThread]: Using postgres connection "master"
[0m02:20:21.424775 [debug] [MainThread]: On master: BEGIN
[0m02:20:21.424972 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:20:21.426498 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m02:20:21.426755 [debug] [MainThread]: On master: COMMIT
[0m02:20:21.426986 [debug] [MainThread]: Using postgres connection "master"
[0m02:20:21.427177 [debug] [MainThread]: On master: COMMIT
[0m02:20:21.427410 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m02:20:21.427630 [debug] [MainThread]: On master: Close
[0m02:20:21.427901 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:20:21.428111 [debug] [MainThread]: Connection 'model.etl_waterlevel.fact_waterlevel' was properly closed.
[0m02:20:21.428337 [info ] [MainThread]: 
[0m02:20:21.428575 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.19 seconds (0.19s).
[0m02:20:21.428950 [debug] [MainThread]: Command end result
[0m02:20:21.444151 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m02:20:21.445369 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m02:20:21.449019 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m02:20:21.449252 [info ] [MainThread]: 
[0m02:20:21.449529 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:20:21.449746 [info ] [MainThread]: 
[0m02:20:21.449994 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m02:20:21.450614 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.5094011, "process_in_blocks": "0", "process_kernel_time": 0.081069, "process_mem_max_rss": "111672", "process_out_blocks": "1702", "process_user_time": 1.216049}
[0m02:20:21.450966 [debug] [MainThread]: Command `dbt run` succeeded at 02:20:21.450917 after 0.51 seconds
[0m02:20:21.451224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d780370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d810310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa09dc4f0>]}
[0m02:20:21.451496 [debug] [MainThread]: Flushing usage events
[0m02:20:22.673954 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:05:11.471015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb168c2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0768520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0768580>]}


============================== 03:05:11.474077 | 1359050e-38e5-4459-9c8c-a0862aa39861 ==============================
[0m03:05:11.474077 [info ] [MainThread]: Running with dbt=1.9.0
[0m03:05:11.474473 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models fact_waterlevel', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m03:05:11.565765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1359050e-38e5-4459-9c8c-a0862aa39861', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3817d60>]}
[0m03:05:11.592666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1359050e-38e5-4459-9c8c-a0862aa39861', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb15d8100>]}
[0m03:05:11.593171 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m03:05:11.627535 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m03:05:11.677049 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:05:11.677393 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:05:11.680652 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m03:05:11.692459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1359050e-38e5-4459-9c8c-a0862aa39861', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffafa304f0>]}
[0m03:05:11.728824 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m03:05:11.732420 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m03:05:11.741675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1359050e-38e5-4459-9c8c-a0862aa39861', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffafa4f220>]}
[0m03:05:11.742013 [info ] [MainThread]: Found 3 models, 434 macros
[0m03:05:11.742247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1359050e-38e5-4459-9c8c-a0862aa39861', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffafa4f1c0>]}
[0m03:05:11.742955 [info ] [MainThread]: 
[0m03:05:11.743221 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:05:11.743506 [info ] [MainThread]: 
[0m03:05:11.743984 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m03:05:11.744594 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m03:05:11.785015 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m03:05:11.787393 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m03:05:11.787798 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:05:11.790729 [debug] [ThreadPool]: SQL status: SELECT 24 in 0.003 seconds
[0m03:05:11.791562 [debug] [ThreadPool]: On list_airflow: Close
[0m03:05:11.794248 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_dim)
[0m03:05:11.797463 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m03:05:11.797757 [debug] [ThreadPool]: On list_airflow_dim: BEGIN
[0m03:05:11.798009 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:05:11.799624 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m03:05:11.799892 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m03:05:11.800153 [debug] [ThreadPool]: On list_airflow_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dim'
  
[0m03:05:11.801488 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.001 seconds
[0m03:05:11.802160 [debug] [ThreadPool]: On list_airflow_dim: ROLLBACK
[0m03:05:11.802494 [debug] [ThreadPool]: On list_airflow_dim: Close
[0m03:05:11.802923 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_dim, now list_airflow_fact)
[0m03:05:11.804377 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m03:05:11.804628 [debug] [ThreadPool]: On list_airflow_fact: BEGIN
[0m03:05:11.804870 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:05:11.806421 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m03:05:11.806681 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m03:05:11.806938 [debug] [ThreadPool]: On list_airflow_fact: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_fact"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'fact'
  
[0m03:05:11.808222 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m03:05:11.808873 [debug] [ThreadPool]: On list_airflow_fact: ROLLBACK
[0m03:05:11.809194 [debug] [ThreadPool]: On list_airflow_fact: Close
[0m03:05:11.811672 [debug] [MainThread]: Using postgres connection "master"
[0m03:05:11.811963 [debug] [MainThread]: On master: BEGIN
[0m03:05:11.812197 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:05:11.813632 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m03:05:11.813887 [debug] [MainThread]: Using postgres connection "master"
[0m03:05:11.814191 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m03:05:11.817295 [debug] [MainThread]: SQL status: SELECT 2 in 0.003 seconds
[0m03:05:11.817973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1359050e-38e5-4459-9c8c-a0862aa39861', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffafa4eb30>]}
[0m03:05:11.818309 [debug] [MainThread]: On master: ROLLBACK
[0m03:05:11.818645 [debug] [MainThread]: Using postgres connection "master"
[0m03:05:11.818885 [debug] [MainThread]: On master: BEGIN
[0m03:05:11.819290 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m03:05:11.819576 [debug] [MainThread]: On master: COMMIT
[0m03:05:11.819843 [debug] [MainThread]: Using postgres connection "master"
[0m03:05:11.820077 [debug] [MainThread]: On master: COMMIT
[0m03:05:11.820392 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m03:05:11.820645 [debug] [MainThread]: On master: Close
[0m03:05:11.821798 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.fact_waterlevel
[0m03:05:11.822201 [info ] [Thread-1 (]: 1 of 1 START sql incremental model fact.fact_waterlevel ........................ [RUN]
[0m03:05:11.822500 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_fact, now model.etl_waterlevel.fact_waterlevel)
[0m03:05:11.822745 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.fact_waterlevel
[0m03:05:11.829708 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.fact_waterlevel"
[0m03:05:11.830620 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.fact_waterlevel
[0m03:05:11.858452 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m03:05:11.858821 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

    
  
    

  create temporary table "fact_waterlevel__dbt_tmp030511846574"
  
  
    as
  
  (
    

with main as (
    select
        distinct
        concat("stationId",'_',"stationCode") as station_key,
        "stationId" as station_id,
        "stationCode" as station_code,
        "waterLevel" as water_level,
        "waterlevelStatus" as waterlevel_status,
        case
            when "waterlevelStatus" = 3 then '🚨 Beyond Danger'
            when "waterlevelStatus" = 2 then '⚠️ Between Warning and Danger'
            when "waterlevelStatus" = 1 then '🔶 Between Alert and Warning'
            when "waterlevelStatus" = 0 then '✅ Between Normal and Alert'
            when "waterlevelStatus" = -1 then '🟢 Below Normal (Safe)'
            else '❓ Unknown Status'
        end as waterlevel_condition,
        "stationName",
        "districtName",
        to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp AS last_update
    from
        raw.waterlevels w
    where
        "stationStatus" = 1

        
        and to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp >= (
            select max(last_update) - interval '1 hour' from "airflow"."fact"."fact_waterlevel"
        )
        
)

select * from main
  );
  
  
[0m03:05:11.859166 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:05:11.871510 [debug] [Thread-1 (]: SQL status: SELECT 141 in 0.012 seconds
[0m03:05:11.878745 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m03:05:11.879062 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: BEGIN
[0m03:05:11.879488 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m03:05:11.879809 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m03:05:11.880094 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp030511846574'
        
      order by ordinal_position

  
[0m03:05:11.882845 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.002 seconds
[0m03:05:11.885522 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m03:05:11.885836 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m03:05:11.887217 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m03:05:11.893627 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m03:05:11.893937 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp030511846574'
        
      order by ordinal_position

  
[0m03:05:11.895184 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m03:05:11.896870 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m03:05:11.897184 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m03:05:11.898373 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m03:05:11.902944 [debug] [Thread-1 (]: 
    In "airflow"."fact"."fact_waterlevel":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m03:05:11.908169 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.fact_waterlevel"
[0m03:05:11.908988 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m03:05:11.909294 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      
        
        
        delete from "airflow"."fact"."fact_waterlevel" as DBT_INTERNAL_DEST
        where (station_key) in (
            select distinct station_key
            from "fact_waterlevel__dbt_tmp030511846574" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airflow"."fact"."fact_waterlevel" ("station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update")
    (
        select "station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update"
        from "fact_waterlevel__dbt_tmp030511846574"
    )
  
[0m03:05:11.910171 [debug] [Thread-1 (]: SQL status: INSERT 0 141 in 0.001 seconds
[0m03:05:11.917589 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m03:05:11.917890 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m03:05:11.918170 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m03:05:11.919119 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m03:05:11.920136 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: Close
[0m03:05:11.921311 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1359050e-38e5-4459-9c8c-a0862aa39861', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb387caf0>]}
[0m03:05:11.921836 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model fact.fact_waterlevel ................... [[32mINSERT 0 141[0m in 0.10s]
[0m03:05:11.922309 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.fact_waterlevel
[0m03:05:11.923069 [debug] [MainThread]: Using postgres connection "master"
[0m03:05:11.923332 [debug] [MainThread]: On master: BEGIN
[0m03:05:11.923598 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:05:11.925091 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m03:05:11.925342 [debug] [MainThread]: On master: COMMIT
[0m03:05:11.925568 [debug] [MainThread]: Using postgres connection "master"
[0m03:05:11.925765 [debug] [MainThread]: On master: COMMIT
[0m03:05:11.926018 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m03:05:11.926216 [debug] [MainThread]: On master: Close
[0m03:05:11.926480 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:05:11.926706 [debug] [MainThread]: Connection 'model.etl_waterlevel.fact_waterlevel' was properly closed.
[0m03:05:11.926924 [info ] [MainThread]: 
[0m03:05:11.927167 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.18 seconds (0.18s).
[0m03:05:11.927581 [debug] [MainThread]: Command end result
[0m03:05:11.942829 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m03:05:11.944072 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m03:05:11.947935 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m03:05:11.948191 [info ] [MainThread]: 
[0m03:05:11.948469 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:05:11.948731 [info ] [MainThread]: 
[0m03:05:11.949049 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m03:05:11.949681 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.5048164, "process_in_blocks": "0", "process_kernel_time": 0.097899, "process_mem_max_rss": "111392", "process_out_blocks": "1702", "process_user_time": 1.224741}
[0m03:05:11.950027 [debug] [MainThread]: Command `dbt run` succeeded at 03:05:11.949979 after 0.51 seconds
[0m03:05:11.950278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb168c2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb15d8100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb16a1bd0>]}
[0m03:05:11.950536 [debug] [MainThread]: Flushing usage events
[0m03:05:13.222250 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m04:05:06.056840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92c80370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91d60520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91d60580>]}


============================== 04:05:06.060899 | b97958d5-6676-47a9-9d46-c43397615e9a ==============================
[0m04:05:06.060899 [info ] [MainThread]: Running with dbt=1.9.0
[0m04:05:06.061272 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'profiles_dir': '/home/airflow/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --models fact_waterlevel', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m04:05:06.152154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b97958d5-6676-47a9-9d46-c43397615e9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92d10310>]}
[0m04:05:06.179116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b97958d5-6676-47a9-9d46-c43397615e9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92629810>]}
[0m04:05:06.179644 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m04:05:06.214602 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m04:05:06.266202 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:05:06.266522 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:05:06.269693 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m04:05:06.281397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b97958d5-6676-47a9-9d46-c43397615e9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90fd05b0>]}
[0m04:05:06.317137 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m04:05:06.320976 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m04:05:06.330301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b97958d5-6676-47a9-9d46-c43397615e9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90fef220>]}
[0m04:05:06.330631 [info ] [MainThread]: Found 3 models, 434 macros
[0m04:05:06.330878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b97958d5-6676-47a9-9d46-c43397615e9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90fef1c0>]}
[0m04:05:06.331577 [info ] [MainThread]: 
[0m04:05:06.331840 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:05:06.332044 [info ] [MainThread]: 
[0m04:05:06.332340 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m04:05:06.332900 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m04:05:06.374789 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m04:05:06.375193 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m04:05:06.375464 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:05:06.378588 [debug] [ThreadPool]: SQL status: SELECT 24 in 0.003 seconds
[0m04:05:06.379352 [debug] [ThreadPool]: On list_airflow: Close
[0m04:05:06.381994 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_dim)
[0m04:05:06.385211 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m04:05:06.385501 [debug] [ThreadPool]: On list_airflow_dim: BEGIN
[0m04:05:06.385746 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:05:06.387391 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m04:05:06.387736 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m04:05:06.387994 [debug] [ThreadPool]: On list_airflow_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dim'
  
[0m04:05:06.389708 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.001 seconds
[0m04:05:06.390388 [debug] [ThreadPool]: On list_airflow_dim: ROLLBACK
[0m04:05:06.390717 [debug] [ThreadPool]: On list_airflow_dim: Close
[0m04:05:06.391106 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_dim, now list_airflow_fact)
[0m04:05:06.392470 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m04:05:06.392691 [debug] [ThreadPool]: On list_airflow_fact: BEGIN
[0m04:05:06.392883 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:05:06.394282 [debug] [ThreadPool]: SQL status: BEGIN in 0.001 seconds
[0m04:05:06.394551 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m04:05:06.394776 [debug] [ThreadPool]: On list_airflow_fact: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_fact"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'fact'
  
[0m04:05:06.396097 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m04:05:06.396757 [debug] [ThreadPool]: On list_airflow_fact: ROLLBACK
[0m04:05:06.397075 [debug] [ThreadPool]: On list_airflow_fact: Close
[0m04:05:06.399514 [debug] [MainThread]: Using postgres connection "master"
[0m04:05:06.399785 [debug] [MainThread]: On master: BEGIN
[0m04:05:06.400025 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:05:06.401432 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m04:05:06.401687 [debug] [MainThread]: Using postgres connection "master"
[0m04:05:06.401981 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m04:05:06.405044 [debug] [MainThread]: SQL status: SELECT 2 in 0.003 seconds
[0m04:05:06.405709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b97958d5-6676-47a9-9d46-c43397615e9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92628fd0>]}
[0m04:05:06.406036 [debug] [MainThread]: On master: ROLLBACK
[0m04:05:06.406377 [debug] [MainThread]: Using postgres connection "master"
[0m04:05:06.406617 [debug] [MainThread]: On master: BEGIN
[0m04:05:06.407018 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m04:05:06.407277 [debug] [MainThread]: On master: COMMIT
[0m04:05:06.407540 [debug] [MainThread]: Using postgres connection "master"
[0m04:05:06.407770 [debug] [MainThread]: On master: COMMIT
[0m04:05:06.408082 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m04:05:06.408344 [debug] [MainThread]: On master: Close
[0m04:05:06.409531 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.fact_waterlevel
[0m04:05:06.409900 [info ] [Thread-1 (]: 1 of 1 START sql incremental model fact.fact_waterlevel ........................ [RUN]
[0m04:05:06.410230 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_fact, now model.etl_waterlevel.fact_waterlevel)
[0m04:05:06.410527 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.fact_waterlevel
[0m04:05:06.417900 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.fact_waterlevel"
[0m04:05:06.418982 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.fact_waterlevel
[0m04:05:06.447181 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m04:05:06.447552 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

    
  
    

  create temporary table "fact_waterlevel__dbt_tmp040506434843"
  
  
    as
  
  (
    

with main as (
    select
        distinct
        concat("stationId",'_',"stationCode") as station_key,
        "stationId" as station_id,
        "stationCode" as station_code,
        "waterLevel" as water_level,
        "waterlevelStatus" as waterlevel_status,
        case
            when "waterlevelStatus" = 3 then '🚨 Beyond Danger'
            when "waterlevelStatus" = 2 then '⚠️ Between Warning and Danger'
            when "waterlevelStatus" = 1 then '🔶 Between Alert and Warning'
            when "waterlevelStatus" = 0 then '✅ Between Normal and Alert'
            when "waterlevelStatus" = -1 then '🟢 Below Normal (Safe)'
            else '❓ Unknown Status'
        end as waterlevel_condition,
        "stationName",
        "districtName",
        to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp AS last_update
    from
        raw.waterlevels w
    where
        "stationStatus" = 1

        
        and to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp >= (
            select max(last_update) - interval '1 hour' from "airflow"."fact"."fact_waterlevel"
        )
        
)

select * from main
  );
  
  
[0m04:05:06.447889 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:05:06.463647 [debug] [Thread-1 (]: SQL status: SELECT 209 in 0.016 seconds
[0m04:05:06.471137 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m04:05:06.471457 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: BEGIN
[0m04:05:06.471901 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m04:05:06.472196 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m04:05:06.472516 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp040506434843'
        
      order by ordinal_position

  
[0m04:05:06.475613 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.003 seconds
[0m04:05:06.478349 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m04:05:06.478651 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m04:05:06.479983 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m04:05:06.486344 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m04:05:06.486650 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp040506434843'
        
      order by ordinal_position

  
[0m04:05:06.487913 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m04:05:06.489613 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m04:05:06.489916 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m04:05:06.491103 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m04:05:06.495711 [debug] [Thread-1 (]: 
    In "airflow"."fact"."fact_waterlevel":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m04:05:06.500860 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.fact_waterlevel"
[0m04:05:06.501752 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m04:05:06.502069 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      
        
        
        delete from "airflow"."fact"."fact_waterlevel" as DBT_INTERNAL_DEST
        where (station_key) in (
            select distinct station_key
            from "fact_waterlevel__dbt_tmp040506434843" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airflow"."fact"."fact_waterlevel" ("station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update")
    (
        select "station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update"
        from "fact_waterlevel__dbt_tmp040506434843"
    )
  
[0m04:05:06.503073 [debug] [Thread-1 (]: SQL status: INSERT 0 209 in 0.001 seconds
[0m04:05:06.510482 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m04:05:06.510783 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m04:05:06.511045 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m04:05:06.512606 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m04:05:06.513631 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: Close
[0m04:05:06.514824 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b97958d5-6676-47a9-9d46-c43397615e9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94dfe800>]}
[0m04:05:06.515315 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model fact.fact_waterlevel ................... [[32mINSERT 0 209[0m in 0.10s]
[0m04:05:06.515710 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.fact_waterlevel
[0m04:05:06.516372 [debug] [MainThread]: Using postgres connection "master"
[0m04:05:06.516658 [debug] [MainThread]: On master: BEGIN
[0m04:05:06.516883 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m04:05:06.518337 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m04:05:06.518574 [debug] [MainThread]: On master: COMMIT
[0m04:05:06.518792 [debug] [MainThread]: Using postgres connection "master"
[0m04:05:06.518989 [debug] [MainThread]: On master: COMMIT
[0m04:05:06.519238 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m04:05:06.519448 [debug] [MainThread]: On master: Close
[0m04:05:06.519714 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:05:06.519934 [debug] [MainThread]: Connection 'model.etl_waterlevel.fact_waterlevel' was properly closed.
[0m04:05:06.520166 [info ] [MainThread]: 
[0m04:05:06.520444 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.19 seconds (0.19s).
[0m04:05:06.520866 [debug] [MainThread]: Command end result
[0m04:05:06.535983 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m04:05:06.537111 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m04:05:06.540730 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m04:05:06.540961 [info ] [MainThread]: 
[0m04:05:06.541214 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:05:06.541433 [info ] [MainThread]: 
[0m04:05:06.541673 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m04:05:06.542252 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.5116693, "process_in_blocks": "0", "process_kernel_time": 0.096903, "process_mem_max_rss": "111120", "process_out_blocks": "1702", "process_user_time": 1.231773}
[0m04:05:06.542599 [debug] [MainThread]: Command `dbt run` succeeded at 04:05:06.542552 after 0.51 seconds
[0m04:05:06.542854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92c80370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92d10310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92cee8f0>]}
[0m04:05:06.543091 [debug] [MainThread]: Flushing usage events
[0m04:05:07.983382 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m05:09:42.190581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb777c2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6864520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6864580>]}


============================== 05:09:42.194841 | afff3cea-45e3-429d-a41c-100d56edca3c ==============================
[0m05:09:42.194841 [info ] [MainThread]: Running with dbt=1.9.0
[0m05:09:42.195259 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models fact_waterlevel', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m05:09:42.290113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'afff3cea-45e3-429d-a41c-100d56edca3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5fb29e0>]}
[0m05:09:42.320795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'afff3cea-45e3-429d-a41c-100d56edca3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6864040>]}
[0m05:09:42.321319 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m05:09:42.360096 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m05:09:42.415783 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:09:42.416184 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:09:42.419961 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m05:09:42.434477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'afff3cea-45e3-429d-a41c-100d56edca3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5b3c520>]}
[0m05:09:42.478068 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m05:09:42.482676 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m05:09:42.493421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'afff3cea-45e3-429d-a41c-100d56edca3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5b5b220>]}
[0m05:09:42.493827 [info ] [MainThread]: Found 3 models, 434 macros
[0m05:09:42.494171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'afff3cea-45e3-429d-a41c-100d56edca3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5b5b1c0>]}
[0m05:09:42.495042 [info ] [MainThread]: 
[0m05:09:42.495384 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m05:09:42.495708 [info ] [MainThread]: 
[0m05:09:42.496121 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m05:09:42.496792 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m05:09:42.541297 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m05:09:42.541775 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m05:09:42.542121 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:09:42.545366 [debug] [ThreadPool]: SQL status: SELECT 24 in 0.003 seconds
[0m05:09:42.546286 [debug] [ThreadPool]: On list_airflow: Close
[0m05:09:42.549397 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_dim)
[0m05:09:42.553312 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m05:09:42.553642 [debug] [ThreadPool]: On list_airflow_dim: BEGIN
[0m05:09:42.553932 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:09:42.555647 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m05:09:42.555969 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m05:09:42.556295 [debug] [ThreadPool]: On list_airflow_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dim'
  
[0m05:09:42.557885 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.001 seconds
[0m05:09:42.558729 [debug] [ThreadPool]: On list_airflow_dim: ROLLBACK
[0m05:09:42.559129 [debug] [ThreadPool]: On list_airflow_dim: Close
[0m05:09:42.559574 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_dim, now list_airflow_fact)
[0m05:09:42.561325 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m05:09:42.561624 [debug] [ThreadPool]: On list_airflow_fact: BEGIN
[0m05:09:42.561896 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:09:42.563492 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m05:09:42.563779 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m05:09:42.564078 [debug] [ThreadPool]: On list_airflow_fact: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_fact"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'fact'
  
[0m05:09:42.565635 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m05:09:42.566425 [debug] [ThreadPool]: On list_airflow_fact: ROLLBACK
[0m05:09:42.566787 [debug] [ThreadPool]: On list_airflow_fact: Close
[0m05:09:42.569689 [debug] [MainThread]: Using postgres connection "master"
[0m05:09:42.570020 [debug] [MainThread]: On master: BEGIN
[0m05:09:42.570302 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:09:42.571842 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m05:09:42.572127 [debug] [MainThread]: Using postgres connection "master"
[0m05:09:42.572471 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m05:09:42.576108 [debug] [MainThread]: SQL status: SELECT 2 in 0.003 seconds
[0m05:09:42.576903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'afff3cea-45e3-429d-a41c-100d56edca3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5b5ac50>]}
[0m05:09:42.577309 [debug] [MainThread]: On master: ROLLBACK
[0m05:09:42.577685 [debug] [MainThread]: Using postgres connection "master"
[0m05:09:42.578041 [debug] [MainThread]: On master: BEGIN
[0m05:09:42.578459 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m05:09:42.578747 [debug] [MainThread]: On master: COMMIT
[0m05:09:42.579046 [debug] [MainThread]: Using postgres connection "master"
[0m05:09:42.579306 [debug] [MainThread]: On master: COMMIT
[0m05:09:42.579638 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m05:09:42.579921 [debug] [MainThread]: On master: Close
[0m05:09:42.581160 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.fact_waterlevel
[0m05:09:42.581612 [info ] [Thread-1 (]: 1 of 1 START sql incremental model fact.fact_waterlevel ........................ [RUN]
[0m05:09:42.582039 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_fact, now model.etl_waterlevel.fact_waterlevel)
[0m05:09:42.582358 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.fact_waterlevel
[0m05:09:42.591137 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.fact_waterlevel"
[0m05:09:42.593119 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.fact_waterlevel
[0m05:09:42.627762 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m05:09:42.628195 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

    
  
    

  create temporary table "fact_waterlevel__dbt_tmp050942612945"
  
  
    as
  
  (
    

with main as (
    select
        distinct
        concat("stationId",'_',"stationCode") as station_key,
        "stationId" as station_id,
        "stationCode" as station_code,
        "waterLevel" as water_level,
        "waterlevelStatus" as waterlevel_status,
        case
            when "waterlevelStatus" = 3 then '🚨 Beyond Danger'
            when "waterlevelStatus" = 2 then '⚠️ Between Warning and Danger'
            when "waterlevelStatus" = 1 then '🔶 Between Alert and Warning'
            when "waterlevelStatus" = 0 then '✅ Between Normal and Alert'
            when "waterlevelStatus" = -1 then '🟢 Below Normal (Safe)'
            else '❓ Unknown Status'
        end as waterlevel_condition,
        "stationName",
        "districtName",
        to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp AS last_update
    from
        raw.waterlevels w
    where
        "stationStatus" = 1

        
        and to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp >= (
            select max(last_update) - interval '1 hour' from "airflow"."fact"."fact_waterlevel"
        )
        
)

select * from main
  );
  
  
[0m05:09:42.628640 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:09:42.644160 [debug] [Thread-1 (]: SQL status: SELECT 140 in 0.016 seconds
[0m05:09:42.653278 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m05:09:42.653614 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: BEGIN
[0m05:09:42.654020 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m05:09:42.654349 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m05:09:42.654686 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp050942612945'
        
      order by ordinal_position

  
[0m05:09:42.657907 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.003 seconds
[0m05:09:42.661198 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m05:09:42.661569 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m05:09:42.663239 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m05:09:42.671322 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m05:09:42.671697 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp050942612945'
        
      order by ordinal_position

  
[0m05:09:42.673167 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m05:09:42.675257 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m05:09:42.675612 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m05:09:42.677107 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m05:09:42.682811 [debug] [Thread-1 (]: 
    In "airflow"."fact"."fact_waterlevel":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m05:09:42.689337 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.fact_waterlevel"
[0m05:09:42.690220 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m05:09:42.690576 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      
        
        
        delete from "airflow"."fact"."fact_waterlevel" as DBT_INTERNAL_DEST
        where (station_key) in (
            select distinct station_key
            from "fact_waterlevel__dbt_tmp050942612945" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airflow"."fact"."fact_waterlevel" ("station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update")
    (
        select "station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update"
        from "fact_waterlevel__dbt_tmp050942612945"
    )
  
[0m05:09:42.691613 [debug] [Thread-1 (]: SQL status: INSERT 0 140 in 0.001 seconds
[0m05:09:42.700951 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m05:09:42.701305 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m05:09:42.701645 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m05:09:42.702578 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m05:09:42.703823 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: Close
[0m05:09:42.705104 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'afff3cea-45e3-429d-a41c-100d56edca3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9962770>]}
[0m05:09:42.705648 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model fact.fact_waterlevel ................... [[32mINSERT 0 140[0m in 0.12s]
[0m05:09:42.706142 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.fact_waterlevel
[0m05:09:42.706952 [debug] [MainThread]: Using postgres connection "master"
[0m05:09:42.707259 [debug] [MainThread]: On master: BEGIN
[0m05:09:42.707517 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:09:42.709169 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m05:09:42.709453 [debug] [MainThread]: On master: COMMIT
[0m05:09:42.709721 [debug] [MainThread]: Using postgres connection "master"
[0m05:09:42.709951 [debug] [MainThread]: On master: COMMIT
[0m05:09:42.710254 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m05:09:42.710490 [debug] [MainThread]: On master: Close
[0m05:09:42.710794 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:09:42.711040 [debug] [MainThread]: Connection 'model.etl_waterlevel.fact_waterlevel' was properly closed.
[0m05:09:42.711294 [info ] [MainThread]: 
[0m05:09:42.711552 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.22 seconds (0.22s).
[0m05:09:42.712010 [debug] [MainThread]: Command end result
[0m05:09:42.729261 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m05:09:42.730637 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m05:09:42.735109 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m05:09:42.735390 [info ] [MainThread]: 
[0m05:09:42.735741 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:09:42.736021 [info ] [MainThread]: 
[0m05:09:42.736284 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m05:09:42.736888 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.57578486, "process_in_blocks": "0", "process_kernel_time": 0.076122, "process_mem_max_rss": "111488", "process_out_blocks": "1702", "process_user_time": 1.30811}
[0m05:09:42.737290 [debug] [MainThread]: Command `dbt run` succeeded at 05:09:42.737230 after 0.58 seconds
[0m05:09:42.737589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb777c2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6868100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5b08820>]}
[0m05:09:42.737881 [debug] [MainThread]: Flushing usage events
[0m05:09:44.159894 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:34:15.629785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e450310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d54c520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d54c580>]}


============================== 06:34:15.632805 | 4431000b-20bb-4f06-947e-d7ba659d6b1c ==============================
[0m06:34:15.632805 [info ] [MainThread]: Running with dbt=1.9.0
[0m06:34:15.633177 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --models fact_waterlevel', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:34:15.719403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4431000b-20bb-4f06-947e-d7ba659d6b1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cbe6290>]}
[0m06:34:15.745611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4431000b-20bb-4f06-947e-d7ba659d6b1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e39c1c0>]}
[0m06:34:15.746059 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m06:34:15.780099 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m06:34:15.829314 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:34:15.829636 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:34:15.832760 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m06:34:15.844368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4431000b-20bb-4f06-947e-d7ba659d6b1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c770550>]}
[0m06:34:15.880157 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m06:34:15.884027 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m06:34:15.892391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4431000b-20bb-4f06-947e-d7ba659d6b1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c78f220>]}
[0m06:34:15.892701 [info ] [MainThread]: Found 3 models, 434 macros
[0m06:34:15.892936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4431000b-20bb-4f06-947e-d7ba659d6b1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c78f1c0>]}
[0m06:34:15.893634 [info ] [MainThread]: 
[0m06:34:15.893888 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:34:15.894109 [info ] [MainThread]: 
[0m06:34:15.894463 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:34:15.895040 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m06:34:15.933586 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m06:34:15.933982 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m06:34:15.934277 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:34:15.937075 [debug] [ThreadPool]: SQL status: SELECT 24 in 0.003 seconds
[0m06:34:15.937841 [debug] [ThreadPool]: On list_airflow: Close
[0m06:34:15.940469 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_dim)
[0m06:34:15.943639 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m06:34:15.943947 [debug] [ThreadPool]: On list_airflow_dim: BEGIN
[0m06:34:15.944195 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:34:15.945761 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m06:34:15.946078 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m06:34:15.946344 [debug] [ThreadPool]: On list_airflow_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dim'
  
[0m06:34:15.947638 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.001 seconds
[0m06:34:15.948302 [debug] [ThreadPool]: On list_airflow_dim: ROLLBACK
[0m06:34:15.948630 [debug] [ThreadPool]: On list_airflow_dim: Close
[0m06:34:15.949024 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_dim, now list_airflow_fact)
[0m06:34:15.950403 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m06:34:15.950662 [debug] [ThreadPool]: On list_airflow_fact: BEGIN
[0m06:34:15.950912 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:34:15.952407 [debug] [ThreadPool]: SQL status: BEGIN in 0.001 seconds
[0m06:34:15.952660 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m06:34:15.952930 [debug] [ThreadPool]: On list_airflow_fact: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_fact"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'fact'
  
[0m06:34:15.954208 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m06:34:15.954834 [debug] [ThreadPool]: On list_airflow_fact: ROLLBACK
[0m06:34:15.955152 [debug] [ThreadPool]: On list_airflow_fact: Close
[0m06:34:15.957527 [debug] [MainThread]: Using postgres connection "master"
[0m06:34:15.957798 [debug] [MainThread]: On master: BEGIN
[0m06:34:15.958038 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:34:15.959500 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m06:34:15.959752 [debug] [MainThread]: Using postgres connection "master"
[0m06:34:15.960085 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:34:15.962945 [debug] [MainThread]: SQL status: SELECT 2 in 0.003 seconds
[0m06:34:15.963579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4431000b-20bb-4f06-947e-d7ba659d6b1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7fd8fe50>]}
[0m06:34:15.963898 [debug] [MainThread]: On master: ROLLBACK
[0m06:34:15.964223 [debug] [MainThread]: Using postgres connection "master"
[0m06:34:15.964479 [debug] [MainThread]: On master: BEGIN
[0m06:34:15.964873 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m06:34:15.965125 [debug] [MainThread]: On master: COMMIT
[0m06:34:15.965372 [debug] [MainThread]: Using postgres connection "master"
[0m06:34:15.965645 [debug] [MainThread]: On master: COMMIT
[0m06:34:15.965968 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:34:15.966226 [debug] [MainThread]: On master: Close
[0m06:34:15.967351 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.fact_waterlevel
[0m06:34:15.967722 [info ] [Thread-1 (]: 1 of 1 START sql incremental model fact.fact_waterlevel ........................ [RUN]
[0m06:34:15.968076 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_fact, now model.etl_waterlevel.fact_waterlevel)
[0m06:34:15.968347 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.fact_waterlevel
[0m06:34:15.975261 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.fact_waterlevel"
[0m06:34:15.976117 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.fact_waterlevel
[0m06:34:16.004173 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m06:34:16.004523 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

    
  
    

  create temporary table "fact_waterlevel__dbt_tmp063415992135"
  
  
    as
  
  (
    

with main as (
    select
        distinct
        concat("stationId",'_',"stationCode") as station_key,
        "stationId" as station_id,
        "stationCode" as station_code,
        "waterLevel" as water_level,
        "waterlevelStatus" as waterlevel_status,
        case
            when "waterlevelStatus" = 3 then '🚨 Beyond Danger'
            when "waterlevelStatus" = 2 then '⚠️ Between Warning and Danger'
            when "waterlevelStatus" = 1 then '🔶 Between Alert and Warning'
            when "waterlevelStatus" = 0 then '✅ Between Normal and Alert'
            when "waterlevelStatus" = -1 then '🟢 Below Normal (Safe)'
            else '❓ Unknown Status'
        end as waterlevel_condition,
        "stationName",
        "districtName",
        to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp AS last_update
    from
        raw.waterlevels w
    where
        "stationStatus" = 1

        
        and to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp >= (
            select max(last_update) - interval '1 hour' from "airflow"."fact"."fact_waterlevel"
        )
        
)

select * from main
  );
  
  
[0m06:34:16.004860 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:34:16.016984 [debug] [Thread-1 (]: SQL status: SELECT 140 in 0.012 seconds
[0m06:34:16.024102 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m06:34:16.024411 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: BEGIN
[0m06:34:16.024814 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m06:34:16.025092 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m06:34:16.025379 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp063415992135'
        
      order by ordinal_position

  
[0m06:34:16.028073 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.002 seconds
[0m06:34:16.030669 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m06:34:16.030987 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m06:34:16.032323 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m06:34:16.038722 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m06:34:16.039041 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp063415992135'
        
      order by ordinal_position

  
[0m06:34:16.040273 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m06:34:16.042024 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m06:34:16.042318 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m06:34:16.043512 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m06:34:16.048022 [debug] [Thread-1 (]: 
    In "airflow"."fact"."fact_waterlevel":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m06:34:16.053159 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.fact_waterlevel"
[0m06:34:16.054001 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m06:34:16.054312 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      
        
        
        delete from "airflow"."fact"."fact_waterlevel" as DBT_INTERNAL_DEST
        where (station_key) in (
            select distinct station_key
            from "fact_waterlevel__dbt_tmp063415992135" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airflow"."fact"."fact_waterlevel" ("station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update")
    (
        select "station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update"
        from "fact_waterlevel__dbt_tmp063415992135"
    )
  
[0m06:34:16.055104 [debug] [Thread-1 (]: SQL status: INSERT 0 140 in 0.001 seconds
[0m06:34:16.062479 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m06:34:16.062794 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m06:34:16.063072 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m06:34:16.063803 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m06:34:16.064809 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: Close
[0m06:34:16.065947 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4431000b-20bb-4f06-947e-d7ba659d6b1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff805c27a0>]}
[0m06:34:16.066415 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model fact.fact_waterlevel ................... [[32mINSERT 0 140[0m in 0.10s]
[0m06:34:16.066864 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.fact_waterlevel
[0m06:34:16.067524 [debug] [MainThread]: Using postgres connection "master"
[0m06:34:16.067795 [debug] [MainThread]: On master: BEGIN
[0m06:34:16.068019 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:34:16.069424 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m06:34:16.069669 [debug] [MainThread]: On master: COMMIT
[0m06:34:16.069928 [debug] [MainThread]: Using postgres connection "master"
[0m06:34:16.070142 [debug] [MainThread]: On master: COMMIT
[0m06:34:16.070410 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:34:16.070640 [debug] [MainThread]: On master: Close
[0m06:34:16.070924 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:34:16.071137 [debug] [MainThread]: Connection 'model.etl_waterlevel.fact_waterlevel' was properly closed.
[0m06:34:16.071351 [info ] [MainThread]: 
[0m06:34:16.071571 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.18 seconds (0.18s).
[0m06:34:16.071947 [debug] [MainThread]: Command end result
[0m06:34:16.087131 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m06:34:16.088292 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m06:34:16.091616 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m06:34:16.091851 [info ] [MainThread]: 
[0m06:34:16.092125 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:34:16.092337 [info ] [MainThread]: 
[0m06:34:16.092556 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m06:34:16.093072 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.4902288, "process_in_blocks": "0", "process_kernel_time": 0.061429, "process_mem_max_rss": "111368", "process_out_blocks": "1702", "process_user_time": 1.26484}
[0m06:34:16.093436 [debug] [MainThread]: Command `dbt run` succeeded at 06:34:16.093384 after 0.49 seconds
[0m06:34:16.093685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e450310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cbe6290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e4bb6d0>]}
[0m06:34:16.093942 [debug] [MainThread]: Flushing usage events
[0m06:34:22.054762 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:50:37.599374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7958340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6a63d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6a63d00>]}


============================== 07:50:37.602345 | 0c8d3f7c-215c-40e8-b1bf-c6b3b74cef14 ==============================
[0m07:50:37.602345 [info ] [MainThread]: Running with dbt=1.9.0
[0m07:50:37.602733 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'profiles_dir': '/home/airflow/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models fact_waterlevel', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m07:50:37.686372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0c8d3f7c-215c-40e8-b1bf-c6b3b74cef14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9aca7a0>]}
[0m07:50:37.712845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0c8d3f7c-215c-40e8-b1bf-c6b3b74cef14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6dfc220>]}
[0m07:50:37.713307 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m07:50:37.746998 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m07:50:37.794836 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:50:37.795137 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:50:37.798266 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m07:50:37.809905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0c8d3f7c-215c-40e8-b1bf-c6b3b74cef14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5c7c550>]}
[0m07:50:37.845574 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m07:50:37.849059 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m07:50:37.882973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0c8d3f7c-215c-40e8-b1bf-c6b3b74cef14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5c9b220>]}
[0m07:50:37.884022 [info ] [MainThread]: Found 3 models, 434 macros
[0m07:50:37.885135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0c8d3f7c-215c-40e8-b1bf-c6b3b74cef14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5c9b1c0>]}
[0m07:50:37.887694 [info ] [MainThread]: 
[0m07:50:37.888433 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:50:37.889453 [info ] [MainThread]: 
[0m07:50:37.890359 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:50:37.891474 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m07:50:37.932453 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m07:50:37.932916 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m07:50:37.933223 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:50:37.936032 [debug] [ThreadPool]: SQL status: SELECT 24 in 0.003 seconds
[0m07:50:37.936815 [debug] [ThreadPool]: On list_airflow: Close
[0m07:50:37.939468 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_fact)
[0m07:50:37.942699 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m07:50:37.942986 [debug] [ThreadPool]: On list_airflow_fact: BEGIN
[0m07:50:37.943242 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:50:37.944987 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m07:50:37.945264 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m07:50:37.945542 [debug] [ThreadPool]: On list_airflow_fact: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_fact"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'fact'
  
[0m07:50:37.946881 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m07:50:37.947548 [debug] [ThreadPool]: On list_airflow_fact: ROLLBACK
[0m07:50:37.947883 [debug] [ThreadPool]: On list_airflow_fact: Close
[0m07:50:37.948289 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_fact, now list_airflow_dim)
[0m07:50:37.949666 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m07:50:37.949931 [debug] [ThreadPool]: On list_airflow_dim: BEGIN
[0m07:50:37.950163 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:50:37.951717 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m07:50:37.951987 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m07:50:37.952238 [debug] [ThreadPool]: On list_airflow_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dim'
  
[0m07:50:37.953412 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.001 seconds
[0m07:50:37.954079 [debug] [ThreadPool]: On list_airflow_dim: ROLLBACK
[0m07:50:37.954408 [debug] [ThreadPool]: On list_airflow_dim: Close
[0m07:50:37.956871 [debug] [MainThread]: Using postgres connection "master"
[0m07:50:37.957163 [debug] [MainThread]: On master: BEGIN
[0m07:50:37.957390 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:50:37.958839 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m07:50:37.959096 [debug] [MainThread]: Using postgres connection "master"
[0m07:50:37.959385 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:50:37.962304 [debug] [MainThread]: SQL status: SELECT 2 in 0.003 seconds
[0m07:50:37.962935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0c8d3f7c-215c-40e8-b1bf-c6b3b74cef14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb92e9f60>]}
[0m07:50:37.963290 [debug] [MainThread]: On master: ROLLBACK
[0m07:50:37.963624 [debug] [MainThread]: Using postgres connection "master"
[0m07:50:37.963868 [debug] [MainThread]: On master: BEGIN
[0m07:50:37.964260 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m07:50:37.964540 [debug] [MainThread]: On master: COMMIT
[0m07:50:37.964841 [debug] [MainThread]: Using postgres connection "master"
[0m07:50:37.965070 [debug] [MainThread]: On master: COMMIT
[0m07:50:37.965391 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:50:37.965655 [debug] [MainThread]: On master: Close
[0m07:50:37.966776 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.fact_waterlevel
[0m07:50:37.967163 [info ] [Thread-1 (]: 1 of 1 START sql incremental model fact.fact_waterlevel ........................ [RUN]
[0m07:50:37.967481 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_dim, now model.etl_waterlevel.fact_waterlevel)
[0m07:50:37.967776 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.fact_waterlevel
[0m07:50:37.975830 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.fact_waterlevel"
[0m07:50:37.976689 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.fact_waterlevel
[0m07:50:38.004787 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m07:50:38.005140 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

    
  
    

  create temporary table "fact_waterlevel__dbt_tmp075037992868"
  
  
    as
  
  (
    

with main as (
    select
        distinct
        concat("stationId",'_',"stationCode") as station_key,
        "stationId" as station_id,
        "stationCode" as station_code,
        "waterLevel" as water_level,
        "waterlevelStatus" as waterlevel_status,
        case
            when "waterlevelStatus" = 3 then '🚨 Beyond Danger'
            when "waterlevelStatus" = 2 then '⚠️ Between Warning and Danger'
            when "waterlevelStatus" = 1 then '🔶 Between Alert and Warning'
            when "waterlevelStatus" = 0 then '✅ Between Normal and Alert'
            when "waterlevelStatus" = -1 then '🟢 Below Normal (Safe)'
            else '❓ Unknown Status'
        end as waterlevel_condition,
        "stationName",
        "districtName",
        to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp AS last_update
    from
        raw.waterlevels w
    where
        "stationStatus" = 1

        
        and to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp >= (
            select max(last_update) - interval '1 hour' from "airflow"."fact"."fact_waterlevel"
        )
        
)

select * from main
  );
  
  
[0m07:50:38.005465 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:50:38.018023 [debug] [Thread-1 (]: SQL status: SELECT 139 in 0.013 seconds
[0m07:50:38.025290 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m07:50:38.025648 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: BEGIN
[0m07:50:38.026100 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m07:50:38.026444 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m07:50:38.026763 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp075037992868'
        
      order by ordinal_position

  
[0m07:50:38.029692 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.003 seconds
[0m07:50:38.032775 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m07:50:38.033122 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m07:50:38.034623 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m07:50:38.041348 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m07:50:38.041641 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp075037992868'
        
      order by ordinal_position

  
[0m07:50:38.042846 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m07:50:38.044479 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m07:50:38.044752 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m07:50:38.045862 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m07:50:38.050605 [debug] [Thread-1 (]: 
    In "airflow"."fact"."fact_waterlevel":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m07:50:38.055721 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.fact_waterlevel"
[0m07:50:38.056366 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m07:50:38.056632 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      
        
        
        delete from "airflow"."fact"."fact_waterlevel" as DBT_INTERNAL_DEST
        where (station_key) in (
            select distinct station_key
            from "fact_waterlevel__dbt_tmp075037992868" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airflow"."fact"."fact_waterlevel" ("station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update")
    (
        select "station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update"
        from "fact_waterlevel__dbt_tmp075037992868"
    )
  
[0m07:50:38.057433 [debug] [Thread-1 (]: SQL status: INSERT 0 139 in 0.001 seconds
[0m07:50:38.064931 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m07:50:38.065237 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m07:50:38.065513 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m07:50:38.066229 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m07:50:38.067299 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: Close
[0m07:50:38.068389 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c8d3f7c-215c-40e8-b1bf-c6b3b74cef14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb92e9f60>]}
[0m07:50:38.068898 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model fact.fact_waterlevel ................... [[32mINSERT 0 139[0m in 0.10s]
[0m07:50:38.069304 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.fact_waterlevel
[0m07:50:38.069999 [debug] [MainThread]: Using postgres connection "master"
[0m07:50:38.070242 [debug] [MainThread]: On master: BEGIN
[0m07:50:38.070443 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:50:38.071974 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m07:50:38.072253 [debug] [MainThread]: On master: COMMIT
[0m07:50:38.072481 [debug] [MainThread]: Using postgres connection "master"
[0m07:50:38.072681 [debug] [MainThread]: On master: COMMIT
[0m07:50:38.072933 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:50:38.073131 [debug] [MainThread]: On master: Close
[0m07:50:38.073389 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:50:38.073607 [debug] [MainThread]: Connection 'model.etl_waterlevel.fact_waterlevel' was properly closed.
[0m07:50:38.073820 [info ] [MainThread]: 
[0m07:50:38.074040 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.18 seconds (0.18s).
[0m07:50:38.074403 [debug] [MainThread]: Command end result
[0m07:50:38.089405 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m07:50:38.090551 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m07:50:38.093902 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m07:50:38.094165 [info ] [MainThread]: 
[0m07:50:38.094457 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:50:38.094699 [info ] [MainThread]: 
[0m07:50:38.094924 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m07:50:38.095433 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.5222386, "process_in_blocks": "0", "process_kernel_time": 0.071051, "process_mem_max_rss": "111212", "process_out_blocks": "1702", "process_user_time": 1.238894}
[0m07:50:38.095768 [debug] [MainThread]: Command `dbt run` succeeded at 07:50:38.095723 after 0.52 seconds
[0m07:50:38.096023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7958340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb79dc790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5c7c970>]}
[0m07:50:38.096269 [debug] [MainThread]: Flushing usage events
[0m07:50:39.273557 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:03:47.595691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98088340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97177d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97177d30>]}


============================== 09:03:47.598719 | 658fee21-a92a-4f45-9b0f-1d71efd8f6d2 ==============================
[0m09:03:47.598719 [info ] [MainThread]: Running with dbt=1.9.0
[0m09:03:47.599119 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'profiles_dir': '/home/airflow/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models fact_waterlevel', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:03:47.694923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '658fee21-a92a-4f45-9b0f-1d71efd8f6d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a2067a0>]}
[0m09:03:47.721580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '658fee21-a92a-4f45-9b0f-1d71efd8f6d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97f4a7a0>]}
[0m09:03:47.722072 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:03:47.756621 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m09:03:47.807199 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:03:47.807547 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:03:47.810717 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m09:03:47.822438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '658fee21-a92a-4f45-9b0f-1d71efd8f6d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff963f8580>]}
[0m09:03:47.858820 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m09:03:47.862710 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m09:03:47.871933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '658fee21-a92a-4f45-9b0f-1d71efd8f6d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96417220>]}
[0m09:03:47.872261 [info ] [MainThread]: Found 3 models, 434 macros
[0m09:03:47.872516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '658fee21-a92a-4f45-9b0f-1d71efd8f6d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff964171c0>]}
[0m09:03:47.873246 [info ] [MainThread]: 
[0m09:03:47.873544 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:03:47.873845 [info ] [MainThread]: 
[0m09:03:47.874184 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:03:47.874779 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m09:03:47.915488 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m09:03:47.915953 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m09:03:47.916226 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:03:47.919242 [debug] [ThreadPool]: SQL status: SELECT 24 in 0.003 seconds
[0m09:03:47.920007 [debug] [ThreadPool]: On list_airflow: Close
[0m09:03:47.923381 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_dim)
[0m09:03:47.926537 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m09:03:47.926812 [debug] [ThreadPool]: On list_airflow_dim: BEGIN
[0m09:03:47.927060 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:03:47.928647 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m09:03:47.928947 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m09:03:47.929208 [debug] [ThreadPool]: On list_airflow_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dim'
  
[0m09:03:47.930664 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.001 seconds
[0m09:03:47.931331 [debug] [ThreadPool]: On list_airflow_dim: ROLLBACK
[0m09:03:47.931681 [debug] [ThreadPool]: On list_airflow_dim: Close
[0m09:03:47.932086 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_dim, now list_airflow_fact)
[0m09:03:47.933498 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m09:03:47.933757 [debug] [ThreadPool]: On list_airflow_fact: BEGIN
[0m09:03:47.933990 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:03:47.935451 [debug] [ThreadPool]: SQL status: BEGIN in 0.001 seconds
[0m09:03:47.935705 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m09:03:47.935967 [debug] [ThreadPool]: On list_airflow_fact: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_fact"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'fact'
  
[0m09:03:47.937221 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m09:03:47.937851 [debug] [ThreadPool]: On list_airflow_fact: ROLLBACK
[0m09:03:47.938167 [debug] [ThreadPool]: On list_airflow_fact: Close
[0m09:03:47.940631 [debug] [MainThread]: Using postgres connection "master"
[0m09:03:47.940928 [debug] [MainThread]: On master: BEGIN
[0m09:03:47.941163 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:03:47.942650 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m09:03:47.942900 [debug] [MainThread]: Using postgres connection "master"
[0m09:03:47.943198 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:03:47.946327 [debug] [MainThread]: SQL status: SELECT 2 in 0.003 seconds
[0m09:03:47.946982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '658fee21-a92a-4f45-9b0f-1d71efd8f6d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96416d10>]}
[0m09:03:47.947312 [debug] [MainThread]: On master: ROLLBACK
[0m09:03:47.947689 [debug] [MainThread]: Using postgres connection "master"
[0m09:03:47.947950 [debug] [MainThread]: On master: BEGIN
[0m09:03:47.948343 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m09:03:47.948636 [debug] [MainThread]: On master: COMMIT
[0m09:03:47.948881 [debug] [MainThread]: Using postgres connection "master"
[0m09:03:47.949118 [debug] [MainThread]: On master: COMMIT
[0m09:03:47.949437 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:03:47.949680 [debug] [MainThread]: On master: Close
[0m09:03:47.950766 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.fact_waterlevel
[0m09:03:47.951135 [info ] [Thread-1 (]: 1 of 1 START sql incremental model fact.fact_waterlevel ........................ [RUN]
[0m09:03:47.951488 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_fact, now model.etl_waterlevel.fact_waterlevel)
[0m09:03:47.951773 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.fact_waterlevel
[0m09:03:47.958729 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.fact_waterlevel"
[0m09:03:47.960311 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.fact_waterlevel
[0m09:03:47.988376 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m09:03:47.988744 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

    
  
    

  create temporary table "fact_waterlevel__dbt_tmp090347976320"
  
  
    as
  
  (
    

with main as (
    select
        distinct
        concat("stationId",'_',"stationCode") as station_key,
        "stationId" as station_id,
        "stationCode" as station_code,
        "waterLevel" as water_level,
        "waterlevelStatus" as waterlevel_status,
        case
            when "waterlevelStatus" = 3 then '🚨 Beyond Danger'
            when "waterlevelStatus" = 2 then '⚠️ Between Warning and Danger'
            when "waterlevelStatus" = 1 then '🔶 Between Alert and Warning'
            when "waterlevelStatus" = 0 then '✅ Between Normal and Alert'
            when "waterlevelStatus" = -1 then '🟢 Below Normal (Safe)'
            else '❓ Unknown Status'
        end as waterlevel_condition,
        "stationName",
        "districtName",
        to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp AS last_update
    from
        raw.waterlevels w
    where
        "stationStatus" = 1

        
        and to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp >= (
            select max(last_update) - interval '1 hour' from "airflow"."fact"."fact_waterlevel"
        )
        
)

select * from main
  );
  
  
[0m09:03:47.989105 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:03:48.004438 [debug] [Thread-1 (]: SQL status: SELECT 138 in 0.015 seconds
[0m09:03:48.011529 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m09:03:48.011837 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: BEGIN
[0m09:03:48.012243 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m09:03:48.012548 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m09:03:48.012837 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp090347976320'
        
      order by ordinal_position

  
[0m09:03:48.015622 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.003 seconds
[0m09:03:48.018229 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m09:03:48.018540 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m09:03:48.019922 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m09:03:48.026369 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m09:03:48.026702 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp090347976320'
        
      order by ordinal_position

  
[0m09:03:48.027952 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m09:03:48.029620 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m09:03:48.029965 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m09:03:48.031127 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m09:03:48.035639 [debug] [Thread-1 (]: 
    In "airflow"."fact"."fact_waterlevel":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m09:03:48.040816 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.fact_waterlevel"
[0m09:03:48.041656 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m09:03:48.041975 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      
        
        
        delete from "airflow"."fact"."fact_waterlevel" as DBT_INTERNAL_DEST
        where (station_key) in (
            select distinct station_key
            from "fact_waterlevel__dbt_tmp090347976320" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airflow"."fact"."fact_waterlevel" ("station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update")
    (
        select "station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update"
        from "fact_waterlevel__dbt_tmp090347976320"
    )
  
[0m09:03:48.042827 [debug] [Thread-1 (]: SQL status: INSERT 0 138 in 0.001 seconds
[0m09:03:48.050222 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m09:03:48.050520 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m09:03:48.050791 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m09:03:48.051768 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m09:03:48.052795 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: Close
[0m09:03:48.053971 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '658fee21-a92a-4f45-9b0f-1d71efd8f6d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff964179d0>]}
[0m09:03:48.054505 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model fact.fact_waterlevel ................... [[32mINSERT 0 138[0m in 0.10s]
[0m09:03:48.054937 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.fact_waterlevel
[0m09:03:48.055728 [debug] [MainThread]: Using postgres connection "master"
[0m09:03:48.055952 [debug] [MainThread]: On master: BEGIN
[0m09:03:48.056145 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:03:48.057670 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m09:03:48.057912 [debug] [MainThread]: On master: COMMIT
[0m09:03:48.058131 [debug] [MainThread]: Using postgres connection "master"
[0m09:03:48.058323 [debug] [MainThread]: On master: COMMIT
[0m09:03:48.058592 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:03:48.058794 [debug] [MainThread]: On master: Close
[0m09:03:48.059054 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:03:48.059271 [debug] [MainThread]: Connection 'model.etl_waterlevel.fact_waterlevel' was properly closed.
[0m09:03:48.059498 [info ] [MainThread]: 
[0m09:03:48.059723 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.19 seconds (0.19s).
[0m09:03:48.060222 [debug] [MainThread]: Command end result
[0m09:03:48.075498 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m09:03:48.076785 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m09:03:48.080442 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m09:03:48.080703 [info ] [MainThread]: 
[0m09:03:48.080993 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:03:48.081201 [info ] [MainThread]: 
[0m09:03:48.081420 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m09:03:48.081939 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.5122488, "process_in_blocks": "0", "process_kernel_time": 0.117221, "process_mem_max_rss": "111360", "process_out_blocks": "1702", "process_user_time": 1.217295}
[0m09:03:48.082279 [debug] [MainThread]: Command `dbt run` succeeded at 09:03:48.082228 after 0.51 seconds
[0m09:03:48.082546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98088340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff963c4640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff971b8bb0>]}
[0m09:03:48.082804 [debug] [MainThread]: Flushing usage events
[0m09:03:49.409818 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:12:50.969003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e18c2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d277cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d277c70>]}


============================== 10:12:50.972190 | 754d79b9-5d7e-4826-93b8-aaf40aea4397 ==============================
[0m10:12:50.972190 [info ] [MainThread]: Running with dbt=1.9.0
[0m10:12:50.972986 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'debug': 'False', 'profiles_dir': '/home/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --models fact_waterlevel', 'send_anonymous_usage_stats': 'True'}
[0m10:12:50.974511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9014c370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f253d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f253d30>]}


============================== 10:12:50.977862 | 7dffb971-f9ce-4cf9-9a6c-33f9d61d58b9 ==============================
[0m10:12:50.977862 [info ] [MainThread]: Running with dbt=1.9.0
[0m10:12:50.978396 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --models fact_waterlevel', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:12:51.079552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '754d79b9-5d7e-4826-93b8-aaf40aea4397', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff802a3d60>]}
[0m10:12:51.081376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7dffb971-f9ce-4cf9-9a6c-33f9d61d58b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff901dc310>]}
[0m10:12:51.107432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '754d79b9-5d7e-4826-93b8-aaf40aea4397', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e0d8100>]}
[0m10:12:51.107962 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:12:51.111388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7dffb971-f9ce-4cf9-9a6c-33f9d61d58b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fad9810>]}
[0m10:12:51.113781 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:12:51.147119 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m10:12:51.152466 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m10:12:51.206907 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:12:51.208024 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:12:51.208292 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:12:51.208571 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:12:51.211765 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m10:12:51.214890 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m10:12:51.228233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7dffb971-f9ce-4cf9-9a6c-33f9d61d58b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e4505b0>]}
[0m10:12:51.230137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '754d79b9-5d7e-4826-93b8-aaf40aea4397', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c4cc4f0>]}
[0m10:12:51.281078 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m10:12:51.285561 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m10:12:51.286489 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m10:12:51.292542 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m10:12:51.300434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7dffb971-f9ce-4cf9-9a6c-33f9d61d58b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e46f220>]}
[0m10:12:51.301081 [info ] [MainThread]: Found 3 models, 434 macros
[0m10:12:51.301612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7dffb971-f9ce-4cf9-9a6c-33f9d61d58b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e46f1c0>]}
[0m10:12:51.302072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '754d79b9-5d7e-4826-93b8-aaf40aea4397', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c4eb220>]}
[0m10:12:51.302814 [info ] [MainThread]: 
[0m10:12:51.303472 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:12:51.303192 [info ] [MainThread]: Found 3 models, 434 macros
[0m10:12:51.303709 [info ] [MainThread]: 
[0m10:12:51.303938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '754d79b9-5d7e-4826-93b8-aaf40aea4397', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c4eb1c0>]}
[0m10:12:51.304293 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:12:51.305048 [info ] [MainThread]: 
[0m10:12:51.305537 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:12:51.305993 [info ] [MainThread]: 
[0m10:12:51.305979 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m10:12:51.306379 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:12:51.306981 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m10:12:51.355422 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m10:12:51.355902 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m10:12:51.356003 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m10:12:51.356240 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:12:51.356490 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m10:12:51.356874 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:12:51.359668 [debug] [ThreadPool]: SQL status: SELECT 24 in 0.003 seconds
[0m10:12:51.359667 [debug] [ThreadPool]: SQL status: SELECT 24 in 0.003 seconds
[0m10:12:51.360595 [debug] [ThreadPool]: On list_airflow: Close
[0m10:12:51.360652 [debug] [ThreadPool]: On list_airflow: Close
[0m10:12:51.363524 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_fact)
[0m10:12:51.364156 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_fact)
[0m10:12:51.367042 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m10:12:51.367399 [debug] [ThreadPool]: On list_airflow_fact: BEGIN
[0m10:12:51.367604 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m10:12:51.367707 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:12:51.367964 [debug] [ThreadPool]: On list_airflow_fact: BEGIN
[0m10:12:51.368379 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:12:51.369580 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m10:12:51.369910 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m10:12:51.369998 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m10:12:51.370246 [debug] [ThreadPool]: On list_airflow_fact: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_fact"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'fact'
  
[0m10:12:51.370517 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m10:12:51.370867 [debug] [ThreadPool]: On list_airflow_fact: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_fact"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'fact'
  
[0m10:12:51.371792 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m10:12:51.372540 [debug] [ThreadPool]: On list_airflow_fact: ROLLBACK
[0m10:12:51.372174 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m10:12:51.372896 [debug] [ThreadPool]: On list_airflow_fact: Close
[0m10:12:51.373309 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_fact, now list_airflow_dim)
[0m10:12:51.373370 [debug] [ThreadPool]: On list_airflow_fact: ROLLBACK
[0m10:12:51.374688 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m10:12:51.374991 [debug] [ThreadPool]: On list_airflow_dim: BEGIN
[0m10:12:51.374979 [debug] [ThreadPool]: On list_airflow_fact: Close
[0m10:12:51.375277 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:12:51.375641 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_fact, now list_airflow_dim)
[0m10:12:51.377017 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m10:12:51.377191 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m10:12:51.377347 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m10:12:51.377533 [debug] [ThreadPool]: On list_airflow_dim: BEGIN
[0m10:12:51.377740 [debug] [ThreadPool]: On list_airflow_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dim'
  
[0m10:12:51.377857 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:12:51.379231 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.001 seconds
[0m10:12:51.379323 [debug] [ThreadPool]: SQL status: BEGIN in 0.001 seconds
[0m10:12:51.379606 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m10:12:51.379944 [debug] [ThreadPool]: On list_airflow_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dim'
  
[0m10:12:51.380019 [debug] [ThreadPool]: On list_airflow_dim: ROLLBACK
[0m10:12:51.380426 [debug] [ThreadPool]: On list_airflow_dim: Close
[0m10:12:51.381329 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.001 seconds
[0m10:12:51.383191 [debug] [MainThread]: Using postgres connection "master"
[0m10:12:51.383515 [debug] [MainThread]: On master: BEGIN
[0m10:12:51.383779 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:12:51.383889 [debug] [ThreadPool]: On list_airflow_dim: ROLLBACK
[0m10:12:51.384359 [debug] [ThreadPool]: On list_airflow_dim: Close
[0m10:12:51.385538 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m10:12:51.387460 [debug] [MainThread]: Using postgres connection "master"
[0m10:12:51.387668 [debug] [MainThread]: Using postgres connection "master"
[0m10:12:51.387934 [debug] [MainThread]: On master: BEGIN
[0m10:12:51.388235 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:12:51.388552 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:12:51.390101 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m10:12:51.390389 [debug] [MainThread]: Using postgres connection "master"
[0m10:12:51.390728 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:12:51.391688 [debug] [MainThread]: SQL status: SELECT 2 in 0.003 seconds
[0m10:12:51.392421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '754d79b9-5d7e-4826-93b8-aaf40aea4397', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d410100>]}
[0m10:12:51.392792 [debug] [MainThread]: On master: ROLLBACK
[0m10:12:51.393167 [debug] [MainThread]: Using postgres connection "master"
[0m10:12:51.393437 [debug] [MainThread]: On master: BEGIN
[0m10:12:51.393846 [debug] [MainThread]: SQL status: SELECT 2 in 0.003 seconds
[0m10:12:51.394055 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:12:51.394389 [debug] [MainThread]: On master: COMMIT
[0m10:12:51.395273 [debug] [MainThread]: Using postgres connection "master"
[0m10:12:51.395525 [debug] [MainThread]: On master: COMMIT
[0m10:12:51.395002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7dffb971-f9ce-4cf9-9a6c-33f9d61d58b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92253700>]}
[0m10:12:51.395839 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:12:51.396105 [debug] [MainThread]: On master: ROLLBACK
[0m10:12:51.396400 [debug] [MainThread]: On master: Close
[0m10:12:51.396719 [debug] [MainThread]: Using postgres connection "master"
[0m10:12:51.397280 [debug] [MainThread]: On master: BEGIN
[0m10:12:51.397862 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:12:51.398303 [debug] [MainThread]: On master: COMMIT
[0m10:12:51.398343 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.fact_waterlevel
[0m10:12:51.398589 [debug] [MainThread]: Using postgres connection "master"
[0m10:12:51.398881 [debug] [MainThread]: On master: COMMIT
[0m10:12:51.398906 [info ] [Thread-1 (]: 1 of 1 START sql incremental model fact.fact_waterlevel ........................ [RUN]
[0m10:12:51.399215 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:12:51.399266 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_dim, now model.etl_waterlevel.fact_waterlevel)
[0m10:12:51.399548 [debug] [MainThread]: On master: Close
[0m10:12:51.399794 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.fact_waterlevel
[0m10:12:51.400691 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.fact_waterlevel
[0m10:12:51.401177 [info ] [Thread-1 (]: 1 of 1 START sql incremental model fact.fact_waterlevel ........................ [RUN]
[0m10:12:51.401585 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_dim, now model.etl_waterlevel.fact_waterlevel)
[0m10:12:51.401977 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.fact_waterlevel
[0m10:12:51.407525 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.fact_waterlevel"
[0m10:12:51.408593 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.fact_waterlevel
[0m10:12:51.409626 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.fact_waterlevel"
[0m10:12:51.417609 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.fact_waterlevel
[0m10:12:51.439369 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m10:12:51.440486 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

    
  
    

  create temporary table "fact_waterlevel__dbt_tmp101251426998"
  
  
    as
  
  (
    

with main as (
    select
        distinct
        concat("stationId",'_',"stationCode") as station_key,
        "stationId" as station_id,
        "stationCode" as station_code,
        "waterLevel" as water_level,
        "waterlevelStatus" as waterlevel_status,
        case
            when "waterlevelStatus" = 3 then '🚨 Beyond Danger'
            when "waterlevelStatus" = 2 then '⚠️ Between Warning and Danger'
            when "waterlevelStatus" = 1 then '🔶 Between Alert and Warning'
            when "waterlevelStatus" = 0 then '✅ Between Normal and Alert'
            when "waterlevelStatus" = -1 then '🟢 Below Normal (Safe)'
            else '❓ Unknown Status'
        end as waterlevel_condition,
        "stationName",
        "districtName",
        to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp AS last_update
    from
        raw.waterlevels w
    where
        "stationStatus" = 1

        
        and to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp >= (
            select max(last_update) - interval '1 hour' from "airflow"."fact"."fact_waterlevel"
        )
        
)

select * from main
  );
  
  
[0m10:12:51.442445 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:12:51.448131 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m10:12:51.448537 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

    
  
    

  create temporary table "fact_waterlevel__dbt_tmp101251435540"
  
  
    as
  
  (
    

with main as (
    select
        distinct
        concat("stationId",'_',"stationCode") as station_key,
        "stationId" as station_id,
        "stationCode" as station_code,
        "waterLevel" as water_level,
        "waterlevelStatus" as waterlevel_status,
        case
            when "waterlevelStatus" = 3 then '🚨 Beyond Danger'
            when "waterlevelStatus" = 2 then '⚠️ Between Warning and Danger'
            when "waterlevelStatus" = 1 then '🔶 Between Alert and Warning'
            when "waterlevelStatus" = 0 then '✅ Between Normal and Alert'
            when "waterlevelStatus" = -1 then '🟢 Below Normal (Safe)'
            else '❓ Unknown Status'
        end as waterlevel_condition,
        "stationName",
        "districtName",
        to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp AS last_update
    from
        raw.waterlevels w
    where
        "stationStatus" = 1

        
        and to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp >= (
            select max(last_update) - interval '1 hour' from "airflow"."fact"."fact_waterlevel"
        )
        
)

select * from main
  );
  
  
[0m10:12:51.448924 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:12:51.456798 [debug] [Thread-1 (]: SQL status: SELECT 138 in 0.014 seconds
[0m10:12:51.461590 [debug] [Thread-1 (]: SQL status: SELECT 138 in 0.013 seconds
[0m10:12:51.464506 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m10:12:51.465529 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: BEGIN
[0m10:12:51.468542 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m10:12:51.468839 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m10:12:51.469108 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp101251426998'
        
      order by ordinal_position

  
[0m10:12:51.471949 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.003 seconds
[0m10:12:51.474319 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m10:12:51.475319 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: BEGIN
[0m10:12:51.475014 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m10:12:51.476013 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m10:12:51.475755 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m10:12:51.476397 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m10:12:51.476705 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp101251435540'
        
      order by ordinal_position

  
[0m10:12:51.477502 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m10:12:51.479416 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.002 seconds
[0m10:12:51.484257 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m10:12:51.484591 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp101251426998'
        
      order by ordinal_position

  
[0m10:12:51.485019 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m10:12:51.485362 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m10:12:51.485934 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m10:12:51.486835 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m10:12:51.487717 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m10:12:51.488053 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m10:12:51.491358 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m10:12:51.494687 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m10:12:51.495032 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp101251435540'
        
      order by ordinal_position

  
[0m10:12:51.496326 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m10:12:51.498115 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m10:12:51.498435 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m10:12:51.498554 [debug] [Thread-1 (]: 
    In "airflow"."fact"."fact_waterlevel":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m10:12:51.499705 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m10:12:51.503847 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.fact_waterlevel"
[0m10:12:51.507988 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m10:12:51.508294 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      
        
        
        delete from "airflow"."fact"."fact_waterlevel" as DBT_INTERNAL_DEST
        where (station_key) in (
            select distinct station_key
            from "fact_waterlevel__dbt_tmp101251426998" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airflow"."fact"."fact_waterlevel" ("station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update")
    (
        select "station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update"
        from "fact_waterlevel__dbt_tmp101251426998"
    )
  
[0m10:12:51.509218 [debug] [Thread-1 (]: SQL status: INSERT 0 138 in 0.001 seconds
[0m10:12:51.509624 [debug] [Thread-1 (]: 
    In "airflow"."fact"."fact_waterlevel":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m10:12:51.518364 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.fact_waterlevel"
[0m10:12:51.519064 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m10:12:51.519427 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      
        
        
        delete from "airflow"."fact"."fact_waterlevel" as DBT_INTERNAL_DEST
        where (station_key) in (
            select distinct station_key
            from "fact_waterlevel__dbt_tmp101251435540" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airflow"."fact"."fact_waterlevel" ("station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update")
    (
        select "station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update"
        from "fact_waterlevel__dbt_tmp101251435540"
    )
  
[0m10:12:51.519927 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m10:12:51.520245 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m10:12:51.520537 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m10:12:51.522353 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m10:12:51.522659 [debug] [Thread-1 (]: SQL status: INSERT 0 138 in 0.003 seconds
[0m10:12:51.523467 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: Close
[0m10:12:51.524585 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '754d79b9-5d7e-4826-93b8-aaf40aea4397', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8029c610>]}
[0m10:12:51.525055 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model fact.fact_waterlevel ................... [[32mINSERT 0 138[0m in 0.12s]
[0m10:12:51.525433 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.fact_waterlevel
[0m10:12:51.526179 [debug] [MainThread]: Using postgres connection "master"
[0m10:12:51.526454 [debug] [MainThread]: On master: BEGIN
[0m10:12:51.526664 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:12:51.528355 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m10:12:51.528625 [debug] [MainThread]: On master: COMMIT
[0m10:12:51.528893 [debug] [MainThread]: Using postgres connection "master"
[0m10:12:51.529146 [debug] [MainThread]: On master: COMMIT
[0m10:12:51.529443 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:12:51.529672 [debug] [MainThread]: On master: Close
[0m10:12:51.529977 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:12:51.530217 [debug] [MainThread]: Connection 'model.etl_waterlevel.fact_waterlevel' was properly closed.
[0m10:12:51.530468 [info ] [MainThread]: 
[0m10:12:51.530724 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.22 seconds (0.22s).
[0m10:12:51.531138 [debug] [MainThread]: Command end result
[0m10:12:51.532584 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m10:12:51.535460 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m10:12:51.535881 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m10:12:51.536575 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m10:12:51.538230 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: Close
[0m10:12:51.539428 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7dffb971-f9ce-4cf9-9a6c-33f9d61d58b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92253700>]}
[0m10:12:51.540111 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model fact.fact_waterlevel ................... [[32mINSERT 0 138[0m in 0.14s]
[0m10:12:51.540918 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.fact_waterlevel
[0m10:12:51.542195 [debug] [MainThread]: Using postgres connection "master"
[0m10:12:51.542576 [debug] [MainThread]: On master: BEGIN
[0m10:12:51.542974 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:12:51.545238 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m10:12:51.545623 [debug] [MainThread]: On master: COMMIT
[0m10:12:51.546021 [debug] [MainThread]: Using postgres connection "master"
[0m10:12:51.546639 [debug] [MainThread]: On master: COMMIT
[0m10:12:51.547270 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:12:51.547778 [debug] [MainThread]: On master: Close
[0m10:12:51.548416 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:12:51.548779 [debug] [MainThread]: Connection 'model.etl_waterlevel.fact_waterlevel' was properly closed.
[0m10:12:51.549195 [info ] [MainThread]: 
[0m10:12:51.549800 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.25 seconds (0.25s).
[0m10:12:51.550374 [debug] [MainThread]: Command end result
[0m10:12:51.556014 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m10:12:51.557995 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m10:12:51.562203 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m10:12:51.562645 [info ] [MainThread]: 
[0m10:12:51.563066 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:12:51.563629 [info ] [MainThread]: 
[0m10:12:51.564183 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:12:51.564931 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.6244425, "process_in_blocks": "0", "process_kernel_time": 0.064943, "process_mem_max_rss": "111116", "process_out_blocks": "1702", "process_user_time": 1.28188}
[0m10:12:51.565721 [debug] [MainThread]: Command `dbt run` succeeded at 10:12:51.565669 after 0.63 seconds
[0m10:12:51.566195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e18c2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e0d8100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e1a5bd0>]}
[0m10:12:51.566740 [debug] [MainThread]: Flushing usage events
[0m10:12:51.572142 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m10:12:51.573223 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m10:12:51.576578 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m10:12:51.576815 [info ] [MainThread]: 
[0m10:12:51.577125 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:12:51.577395 [info ] [MainThread]: 
[0m10:12:51.577625 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:12:51.578144 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.6335284, "process_in_blocks": "0", "process_kernel_time": 0.055187, "process_mem_max_rss": "111176", "process_out_blocks": "1702", "process_user_time": 1.280358}
[0m10:12:51.578466 [debug] [MainThread]: Command `dbt run` succeeded at 10:12:51.578421 after 0.63 seconds
[0m10:12:51.578723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9014c370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff901dc310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff901ba8f0>]}
[0m10:12:51.579000 [debug] [MainThread]: Flushing usage events
[0m10:12:52.977896 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:12:52.976573 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:28:06.440479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8db80310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cc6fd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cc6fca0>]}


============================== 11:28:06.443457 | a38d3203-8bc6-4860-9d93-df24aa781681 ==============================
[0m11:28:06.443457 [info ] [MainThread]: Running with dbt=1.9.0
[0m11:28:06.443851 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'profiles_dir': '/home/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --models fact_waterlevel', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:28:06.528152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a38d3203-8bc6-4860-9d93-df24aa781681', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fcfa770>]}
[0m11:28:06.554643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a38d3203-8bc6-4860-9d93-df24aa781681', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8dad01c0>]}
[0m11:28:06.555131 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m11:28:06.589099 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m11:28:06.636054 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:28:06.636377 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:28:06.639666 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m11:28:06.651511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a38d3203-8bc6-4860-9d93-df24aa781681', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bec4520>]}
[0m11:28:06.687351 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m11:28:06.690773 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m11:28:06.699697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a38d3203-8bc6-4860-9d93-df24aa781681', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bee3220>]}
[0m11:28:06.700011 [info ] [MainThread]: Found 3 models, 434 macros
[0m11:28:06.700236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a38d3203-8bc6-4860-9d93-df24aa781681', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bee31c0>]}
[0m11:28:06.700933 [info ] [MainThread]: 
[0m11:28:06.701180 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:28:06.701407 [info ] [MainThread]: 
[0m11:28:06.701695 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:28:06.702308 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m11:28:06.741550 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m11:28:06.741972 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m11:28:06.742256 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:28:06.745037 [debug] [ThreadPool]: SQL status: SELECT 24 in 0.003 seconds
[0m11:28:06.745816 [debug] [ThreadPool]: On list_airflow: Close
[0m11:28:06.748467 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_dim)
[0m11:28:06.751685 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m11:28:06.751963 [debug] [ThreadPool]: On list_airflow_dim: BEGIN
[0m11:28:06.752203 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:28:06.753816 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m11:28:06.754119 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m11:28:06.754378 [debug] [ThreadPool]: On list_airflow_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dim'
  
[0m11:28:06.755719 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.001 seconds
[0m11:28:06.756412 [debug] [ThreadPool]: On list_airflow_dim: ROLLBACK
[0m11:28:06.756742 [debug] [ThreadPool]: On list_airflow_dim: Close
[0m11:28:06.757123 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_dim, now list_airflow_fact)
[0m11:28:06.758526 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m11:28:06.758791 [debug] [ThreadPool]: On list_airflow_fact: BEGIN
[0m11:28:06.759038 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:28:06.760527 [debug] [ThreadPool]: SQL status: BEGIN in 0.001 seconds
[0m11:28:06.760781 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m11:28:06.761038 [debug] [ThreadPool]: On list_airflow_fact: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_fact"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'fact'
  
[0m11:28:06.762292 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m11:28:06.762931 [debug] [ThreadPool]: On list_airflow_fact: ROLLBACK
[0m11:28:06.763253 [debug] [ThreadPool]: On list_airflow_fact: Close
[0m11:28:06.765677 [debug] [MainThread]: Using postgres connection "master"
[0m11:28:06.765970 [debug] [MainThread]: On master: BEGIN
[0m11:28:06.766201 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:28:06.767657 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m11:28:06.767968 [debug] [MainThread]: Using postgres connection "master"
[0m11:28:06.768268 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:28:06.771220 [debug] [MainThread]: SQL status: SELECT 2 in 0.003 seconds
[0m11:28:06.771872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a38d3203-8bc6-4860-9d93-df24aa781681', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bee29b0>]}
[0m11:28:06.772214 [debug] [MainThread]: On master: ROLLBACK
[0m11:28:06.772553 [debug] [MainThread]: Using postgres connection "master"
[0m11:28:06.772794 [debug] [MainThread]: On master: BEGIN
[0m11:28:06.773186 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m11:28:06.773434 [debug] [MainThread]: On master: COMMIT
[0m11:28:06.773672 [debug] [MainThread]: Using postgres connection "master"
[0m11:28:06.773901 [debug] [MainThread]: On master: COMMIT
[0m11:28:06.774228 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:28:06.774479 [debug] [MainThread]: On master: Close
[0m11:28:06.775531 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.fact_waterlevel
[0m11:28:06.775877 [info ] [Thread-1 (]: 1 of 1 START sql incremental model fact.fact_waterlevel ........................ [RUN]
[0m11:28:06.776229 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_fact, now model.etl_waterlevel.fact_waterlevel)
[0m11:28:06.776497 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.fact_waterlevel
[0m11:28:06.783530 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.fact_waterlevel"
[0m11:28:06.784362 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.fact_waterlevel
[0m11:28:06.813210 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m11:28:06.813578 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

    
  
    

  create temporary table "fact_waterlevel__dbt_tmp112806800999"
  
  
    as
  
  (
    

with main as (
    select
        distinct
        concat("stationId",'_',"stationCode") as station_key,
        "stationId" as station_id,
        "stationCode" as station_code,
        "waterLevel" as water_level,
        "waterlevelStatus" as waterlevel_status,
        case
            when "waterlevelStatus" = 3 then '🚨 Beyond Danger'
            when "waterlevelStatus" = 2 then '⚠️ Between Warning and Danger'
            when "waterlevelStatus" = 1 then '🔶 Between Alert and Warning'
            when "waterlevelStatus" = 0 then '✅ Between Normal and Alert'
            when "waterlevelStatus" = -1 then '🟢 Below Normal (Safe)'
            else '❓ Unknown Status'
        end as waterlevel_condition,
        "stationName",
        "districtName",
        to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp AS last_update
    from
        raw.waterlevels w
    where
        "stationStatus" = 1

        
        and to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp >= (
            select max(last_update) - interval '1 hour' from "airflow"."fact"."fact_waterlevel"
        )
        
)

select * from main
  );
  
  
[0m11:28:06.813889 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:28:06.826947 [debug] [Thread-1 (]: SQL status: SELECT 139 in 0.013 seconds
[0m11:28:06.834282 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m11:28:06.834586 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: BEGIN
[0m11:28:06.834985 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m11:28:06.835274 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m11:28:06.835546 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp112806800999'
        
      order by ordinal_position

  
[0m11:28:06.838227 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.002 seconds
[0m11:28:06.840909 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m11:28:06.841221 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m11:28:06.842598 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m11:28:06.849251 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m11:28:06.849557 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp112806800999'
        
      order by ordinal_position

  
[0m11:28:06.850788 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m11:28:06.852508 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m11:28:06.852793 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m11:28:06.853959 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m11:28:06.858551 [debug] [Thread-1 (]: 
    In "airflow"."fact"."fact_waterlevel":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m11:28:06.863852 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.fact_waterlevel"
[0m11:28:06.864581 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m11:28:06.864870 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      
        
        
        delete from "airflow"."fact"."fact_waterlevel" as DBT_INTERNAL_DEST
        where (station_key) in (
            select distinct station_key
            from "fact_waterlevel__dbt_tmp112806800999" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airflow"."fact"."fact_waterlevel" ("station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update")
    (
        select "station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update"
        from "fact_waterlevel__dbt_tmp112806800999"
    )
  
[0m11:28:06.865694 [debug] [Thread-1 (]: SQL status: INSERT 0 139 in 0.001 seconds
[0m11:28:06.873287 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m11:28:06.873561 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m11:28:06.873783 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m11:28:06.874525 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m11:28:06.875554 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: Close
[0m11:28:06.876567 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a38d3203-8bc6-4860-9d93-df24aa781681', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8dadcd30>]}
[0m11:28:06.877157 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model fact.fact_waterlevel ................... [[32mINSERT 0 139[0m in 0.10s]
[0m11:28:06.877570 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.fact_waterlevel
[0m11:28:06.878311 [debug] [MainThread]: Using postgres connection "master"
[0m11:28:06.878541 [debug] [MainThread]: On master: BEGIN
[0m11:28:06.878730 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:28:06.880168 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m11:28:06.880418 [debug] [MainThread]: On master: COMMIT
[0m11:28:06.880646 [debug] [MainThread]: Using postgres connection "master"
[0m11:28:06.880843 [debug] [MainThread]: On master: COMMIT
[0m11:28:06.881088 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:28:06.881283 [debug] [MainThread]: On master: Close
[0m11:28:06.881548 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:28:06.881790 [debug] [MainThread]: Connection 'model.etl_waterlevel.fact_waterlevel' was properly closed.
[0m11:28:06.882007 [info ] [MainThread]: 
[0m11:28:06.882223 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.18 seconds (0.18s).
[0m11:28:06.882590 [debug] [MainThread]: Command end result
[0m11:28:06.897618 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m11:28:06.898877 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m11:28:06.902319 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m11:28:06.902553 [info ] [MainThread]: 
[0m11:28:06.902808 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:28:06.903026 [info ] [MainThread]: 
[0m11:28:06.903242 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:28:06.903776 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.48915467, "process_in_blocks": "0", "process_kernel_time": 0.064158, "process_mem_max_rss": "111376", "process_out_blocks": "1702", "process_user_time": 1.206977}
[0m11:28:06.904107 [debug] [MainThread]: Command `dbt run` succeeded at 11:28:06.904064 after 0.49 seconds
[0m11:28:06.904368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8db80310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8da43880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8be90ca0>]}
[0m11:28:06.904628 [debug] [MainThread]: Flushing usage events
[0m11:28:08.398296 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:45:03.317178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffacc7c2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffabc67d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffabc67ca0>]}


============================== 12:45:03.322180 | 80465259-f598-46d1-a9f0-7b8ea3d553c4 ==============================
[0m12:45:03.322180 [info ] [MainThread]: Running with dbt=1.9.0
[0m12:45:03.322837 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'profiles_dir': '/home/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --models fact_waterlevel', 'send_anonymous_usage_stats': 'True'}
[0m12:45:03.426564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '80465259-f598-46d1-a9f0-7b8ea3d553c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab3aa9e0>]}
[0m12:45:03.456855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '80465259-f598-46d1-a9f0-7b8ea3d553c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffabc64bb0>]}
[0m12:45:03.457566 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:45:03.497224 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m12:45:03.554851 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:45:03.555427 [debug] [MainThread]: Partial parsing: updated file: etl_waterlevel://models/facts/fact_waterlevel.sql
[0m12:45:03.676254 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m12:45:03.679191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '80465259-f598-46d1-a9f0-7b8ea3d553c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaace24a0>]}
[0m12:45:03.756276 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m12:45:03.760378 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m12:45:03.770921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '80465259-f598-46d1-a9f0-7b8ea3d553c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffabc16470>]}
[0m12:45:03.771267 [info ] [MainThread]: Found 3 models, 434 macros
[0m12:45:03.771527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '80465259-f598-46d1-a9f0-7b8ea3d553c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffabc16020>]}
[0m12:45:03.772374 [info ] [MainThread]: 
[0m12:45:03.772682 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:45:03.773084 [info ] [MainThread]: 
[0m12:45:03.773630 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:45:03.774209 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m12:45:03.797294 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m12:45:03.797704 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m12:45:03.797972 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:45:03.801916 [debug] [ThreadPool]: SQL status: SELECT 24 in 0.004 seconds
[0m12:45:03.802831 [debug] [ThreadPool]: On list_airflow: Close
[0m12:45:03.805928 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_fact)
[0m12:45:03.809376 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m12:45:03.809666 [debug] [ThreadPool]: On list_airflow_fact: BEGIN
[0m12:45:03.809919 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:45:03.811864 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m12:45:03.812288 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m12:45:03.812615 [debug] [ThreadPool]: On list_airflow_fact: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_fact"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'fact'
  
[0m12:45:03.814191 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m12:45:03.814993 [debug] [ThreadPool]: On list_airflow_fact: ROLLBACK
[0m12:45:03.815397 [debug] [ThreadPool]: On list_airflow_fact: Close
[0m12:45:03.815828 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_fact, now list_airflow_dim)
[0m12:45:03.817426 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m12:45:03.817706 [debug] [ThreadPool]: On list_airflow_dim: BEGIN
[0m12:45:03.818001 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:45:03.820184 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m12:45:03.820465 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m12:45:03.820755 [debug] [ThreadPool]: On list_airflow_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dim'
  
[0m12:45:03.822474 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.001 seconds
[0m12:45:03.823241 [debug] [ThreadPool]: On list_airflow_dim: ROLLBACK
[0m12:45:03.823623 [debug] [ThreadPool]: On list_airflow_dim: Close
[0m12:45:03.826388 [debug] [MainThread]: Using postgres connection "master"
[0m12:45:03.826683 [debug] [MainThread]: On master: BEGIN
[0m12:45:03.826906 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:45:03.829022 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m12:45:03.829298 [debug] [MainThread]: Using postgres connection "master"
[0m12:45:03.829717 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:45:03.834477 [debug] [MainThread]: SQL status: SELECT 2 in 0.004 seconds
[0m12:45:03.835228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '80465259-f598-46d1-a9f0-7b8ea3d553c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaed98ca0>]}
[0m12:45:03.835567 [debug] [MainThread]: On master: ROLLBACK
[0m12:45:03.835839 [debug] [MainThread]: Using postgres connection "master"
[0m12:45:03.836045 [debug] [MainThread]: On master: BEGIN
[0m12:45:03.836369 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:45:03.836638 [debug] [MainThread]: On master: COMMIT
[0m12:45:03.836878 [debug] [MainThread]: Using postgres connection "master"
[0m12:45:03.837084 [debug] [MainThread]: On master: COMMIT
[0m12:45:03.837338 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:45:03.837608 [debug] [MainThread]: On master: Close
[0m12:45:03.838689 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.fact_waterlevel
[0m12:45:03.839067 [info ] [Thread-1 (]: 1 of 1 START sql incremental model fact.fact_waterlevel ........................ [RUN]
[0m12:45:03.839391 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_dim, now model.etl_waterlevel.fact_waterlevel)
[0m12:45:03.839636 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.fact_waterlevel
[0m12:45:03.846001 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.fact_waterlevel"
[0m12:45:03.846838 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.fact_waterlevel
[0m12:45:03.877637 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m12:45:03.878112 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

    
  
    

  create temporary table "fact_waterlevel__dbt_tmp124503864880"
  
  
    as
  
  (
    

with main as (
    select
        distinct
        concat("stationId",'_',"stationCode") as station_key,
        "stationId" as station_id,
        "stationCode" as station_code,
        "waterLevel" as water_level,
        "waterlevelStatus" as waterlevel_status,
        case
            when "waterlevelStatus" = 3 then '🚨 Beyond Danger'
            when "waterlevelStatus" = 2 then '⚠️ Between Warning and Danger'
            when "waterlevelStatus" = 1 then '🔶 Between Alert and Warning'
            when "waterlevelStatus" = 0 then '✅ Between Normal and Alert'
            when "waterlevelStatus" = -1 then '🟢 Below Normal (Safe)'
            else '❓ Unknown Status'
        end as waterlevel_condition,
        "stationName",
        "districtName",
        to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp AS last_update
    from
        raw.waterlevels w
    where
        "stationStatus" = 1

        
        and to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp >= (
            select max(last_update) - interval '1 hour' from "airflow"."fact"."fact_waterlevel"
        )
        
)

select * from main
  );
  
  
[0m12:45:03.878476 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:45:03.897854 [debug] [Thread-1 (]: SQL status: SELECT 140 in 0.019 seconds
[0m12:45:03.905914 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m12:45:03.906265 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: BEGIN
[0m12:45:03.906714 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m12:45:03.907021 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m12:45:03.907319 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp124503864880'
        
      order by ordinal_position

  
[0m12:45:03.911143 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.003 seconds
[0m12:45:03.913997 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m12:45:03.914307 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m12:45:03.915823 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m12:45:03.922576 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m12:45:03.922905 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp124503864880'
        
      order by ordinal_position

  
[0m12:45:03.924221 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m12:45:03.926595 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m12:45:03.926901 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m12:45:03.928128 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m12:45:03.934552 [debug] [Thread-1 (]: 
    In "airflow"."fact"."fact_waterlevel":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m12:45:03.941415 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.fact_waterlevel"
[0m12:45:03.943401 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m12:45:03.943789 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      
        
        
        delete from "airflow"."fact"."fact_waterlevel" as DBT_INTERNAL_DEST
        where (station_key) in (
            select distinct station_key
            from "fact_waterlevel__dbt_tmp124503864880" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airflow"."fact"."fact_waterlevel" ("station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update")
    (
        select "station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update"
        from "fact_waterlevel__dbt_tmp124503864880"
    )
  
[0m12:45:03.945174 [debug] [Thread-1 (]: SQL status: INSERT 0 140 in 0.001 seconds
[0m12:45:03.953156 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m12:45:03.953518 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m12:45:03.953846 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m12:45:03.954627 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m12:45:03.955931 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: Close
[0m12:45:03.957196 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80465259-f598-46d1-a9f0-7b8ea3d553c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffacb3f370>]}
[0m12:45:03.958391 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model fact.fact_waterlevel ................... [[32mINSERT 0 140[0m in 0.12s]
[0m12:45:03.958895 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.fact_waterlevel
[0m12:45:03.959780 [debug] [MainThread]: Using postgres connection "master"
[0m12:45:03.960016 [debug] [MainThread]: On master: BEGIN
[0m12:45:03.960222 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:45:03.962455 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m12:45:03.962700 [debug] [MainThread]: On master: COMMIT
[0m12:45:03.962907 [debug] [MainThread]: Using postgres connection "master"
[0m12:45:03.963103 [debug] [MainThread]: On master: COMMIT
[0m12:45:03.963368 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:45:03.963576 [debug] [MainThread]: On master: Close
[0m12:45:03.963861 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:45:03.964150 [debug] [MainThread]: Connection 'model.etl_waterlevel.fact_waterlevel' was properly closed.
[0m12:45:03.964444 [info ] [MainThread]: 
[0m12:45:03.964797 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.19 seconds (0.19s).
[0m12:45:03.965314 [debug] [MainThread]: Command end result
[0m12:45:03.981442 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m12:45:03.982941 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m12:45:03.986439 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m12:45:03.986679 [info ] [MainThread]: 
[0m12:45:03.986951 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:45:03.987164 [info ] [MainThread]: 
[0m12:45:03.987387 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:45:03.987958 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.7073923, "process_in_blocks": "0", "process_kernel_time": 0.241891, "process_mem_max_rss": "113956", "process_out_blocks": "2533", "process_user_time": 1.626219}
[0m12:45:03.988296 [debug] [MainThread]: Command `dbt run` succeeded at 12:45:03.988250 after 0.71 seconds
[0m12:45:03.988563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffacc7c2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffacc97550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaaf59db0>]}
[0m12:45:03.988812 [debug] [MainThread]: Flushing usage events
[0m12:45:05.760677 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:05:06.774446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffafe80370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaef5c520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaef5c550>]}


============================== 13:05:06.777883 | 84130c92-ffd4-4477-b6e1-ae767c1d24fa ==============================
[0m13:05:06.777883 [info ] [MainThread]: Running with dbt=1.9.0
[0m13:05:06.778266 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/airflow/.dbt', 'log_path': '/usr/app/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --models fact_waterlevel', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:05:06.871432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '84130c92-ffd4-4477-b6e1-ae767c1d24fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaff14070>]}
[0m13:05:06.898843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '84130c92-ffd4-4477-b6e1-ae767c1d24fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaef63340>]}
[0m13:05:06.899379 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:05:06.934463 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m13:05:06.984900 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:05:06.985315 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:05:06.988807 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m13:05:07.001954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '84130c92-ffd4-4477-b6e1-ae767c1d24fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae1d05b0>]}
[0m13:05:07.039406 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m13:05:07.043422 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m13:05:07.053891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '84130c92-ffd4-4477-b6e1-ae767c1d24fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae1eb220>]}
[0m13:05:07.054263 [info ] [MainThread]: Found 3 models, 434 macros
[0m13:05:07.054559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '84130c92-ffd4-4477-b6e1-ae767c1d24fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae1eb1c0>]}
[0m13:05:07.055293 [info ] [MainThread]: 
[0m13:05:07.055583 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:05:07.055807 [info ] [MainThread]: 
[0m13:05:07.056120 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:05:07.056708 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m13:05:07.097151 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m13:05:07.097559 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m13:05:07.097842 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:05:07.101173 [debug] [ThreadPool]: SQL status: SELECT 24 in 0.003 seconds
[0m13:05:07.101933 [debug] [ThreadPool]: On list_airflow: Close
[0m13:05:07.104600 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_fact)
[0m13:05:07.107848 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m13:05:07.108134 [debug] [ThreadPool]: On list_airflow_fact: BEGIN
[0m13:05:07.108381 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:05:07.109977 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m13:05:07.110310 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m13:05:07.110577 [debug] [ThreadPool]: On list_airflow_fact: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_fact"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'fact'
  
[0m13:05:07.112227 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m13:05:07.112906 [debug] [ThreadPool]: On list_airflow_fact: ROLLBACK
[0m13:05:07.113242 [debug] [ThreadPool]: On list_airflow_fact: Close
[0m13:05:07.113632 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_fact, now list_airflow_dim)
[0m13:05:07.114977 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m13:05:07.115234 [debug] [ThreadPool]: On list_airflow_dim: BEGIN
[0m13:05:07.115472 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:05:07.116966 [debug] [ThreadPool]: SQL status: BEGIN in 0.001 seconds
[0m13:05:07.117297 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m13:05:07.117552 [debug] [ThreadPool]: On list_airflow_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dim'
  
[0m13:05:07.118899 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.001 seconds
[0m13:05:07.119545 [debug] [ThreadPool]: On list_airflow_dim: ROLLBACK
[0m13:05:07.119863 [debug] [ThreadPool]: On list_airflow_dim: Close
[0m13:05:07.122356 [debug] [MainThread]: Using postgres connection "master"
[0m13:05:07.122630 [debug] [MainThread]: On master: BEGIN
[0m13:05:07.122884 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:05:07.124324 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m13:05:07.124631 [debug] [MainThread]: Using postgres connection "master"
[0m13:05:07.124953 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:05:07.128245 [debug] [MainThread]: SQL status: SELECT 2 in 0.003 seconds
[0m13:05:07.128919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '84130c92-ffd4-4477-b6e1-ae767c1d24fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb192e020>]}
[0m13:05:07.129248 [debug] [MainThread]: On master: ROLLBACK
[0m13:05:07.129589 [debug] [MainThread]: Using postgres connection "master"
[0m13:05:07.129837 [debug] [MainThread]: On master: BEGIN
[0m13:05:07.130229 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m13:05:07.130522 [debug] [MainThread]: On master: COMMIT
[0m13:05:07.130758 [debug] [MainThread]: Using postgres connection "master"
[0m13:05:07.131058 [debug] [MainThread]: On master: COMMIT
[0m13:05:07.131405 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:05:07.131642 [debug] [MainThread]: On master: Close
[0m13:05:07.132746 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.fact_waterlevel
[0m13:05:07.133235 [info ] [Thread-1 (]: 1 of 1 START sql incremental model fact.fact_waterlevel ........................ [RUN]
[0m13:05:07.133617 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_dim, now model.etl_waterlevel.fact_waterlevel)
[0m13:05:07.133914 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.fact_waterlevel
[0m13:05:07.141096 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.fact_waterlevel"
[0m13:05:07.142134 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.fact_waterlevel
[0m13:05:07.170378 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m13:05:07.170751 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

    
  
    

  create temporary table "fact_waterlevel__dbt_tmp130507158403"
  
  
    as
  
  (
    

with main as (
    select
        distinct
        concat("stationId",'_',"stationCode") as station_key,
        "stationId" as station_id,
        "stationCode" as station_code,
        "waterLevel" as water_level,
        "waterlevelStatus" as waterlevel_status,
        case
            when "waterlevelStatus" = 3 then '🚨 Beyond Danger'
            when "waterlevelStatus" = 2 then '⚠️ Between Warning and Danger'
            when "waterlevelStatus" = 1 then '🔶 Between Alert and Warning'
            when "waterlevelStatus" = 0 then '✅ Between Normal and Alert'
            when "waterlevelStatus" = -1 then '🟢 Below Normal (Safe)'
            else '❓ Unknown Status'
        end as waterlevel_condition,
        "stationName",
        "districtName",
        to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp AS last_update
    from
        raw.waterlevels w
    where
        "stationStatus" = 1

        
        and to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp >= (
            select max(last_update) - interval '1 hour' from "airflow"."fact"."fact_waterlevel"
        )
        
)

select * from main
  );
  
  
[0m13:05:07.171154 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:05:07.197499 [debug] [Thread-1 (]: SQL status: SELECT 159 in 0.026 seconds
[0m13:05:07.205179 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m13:05:07.205485 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: BEGIN
[0m13:05:07.205860 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m13:05:07.206173 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m13:05:07.206451 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp130507158403'
        
      order by ordinal_position

  
[0m13:05:07.209655 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.003 seconds
[0m13:05:07.212557 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m13:05:07.212885 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m13:05:07.214358 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m13:05:07.221321 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m13:05:07.221668 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp130507158403'
        
      order by ordinal_position

  
[0m13:05:07.223095 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m13:05:07.224872 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m13:05:07.225191 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m13:05:07.226413 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m13:05:07.231069 [debug] [Thread-1 (]: 
    In "airflow"."fact"."fact_waterlevel":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m13:05:07.236335 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.fact_waterlevel"
[0m13:05:07.237348 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m13:05:07.237664 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      
        
        
        delete from "airflow"."fact"."fact_waterlevel" as DBT_INTERNAL_DEST
        where (station_key) in (
            select distinct station_key
            from "fact_waterlevel__dbt_tmp130507158403" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airflow"."fact"."fact_waterlevel" ("station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update")
    (
        select "station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update"
        from "fact_waterlevel__dbt_tmp130507158403"
    )
  
[0m13:05:07.238804 [debug] [Thread-1 (]: SQL status: INSERT 0 159 in 0.001 seconds
[0m13:05:07.246382 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m13:05:07.246685 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m13:05:07.246979 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m13:05:07.248914 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m13:05:07.250092 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: Close
[0m13:05:07.251332 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84130c92-ffd4-4477-b6e1-ae767c1d24fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1c89e40>]}
[0m13:05:07.251830 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model fact.fact_waterlevel ................... [[32mINSERT 0 159[0m in 0.12s]
[0m13:05:07.252233 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.fact_waterlevel
[0m13:05:07.253000 [debug] [MainThread]: Using postgres connection "master"
[0m13:05:07.253261 [debug] [MainThread]: On master: BEGIN
[0m13:05:07.253465 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:05:07.255659 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m13:05:07.255952 [debug] [MainThread]: On master: COMMIT
[0m13:05:07.256206 [debug] [MainThread]: Using postgres connection "master"
[0m13:05:07.256418 [debug] [MainThread]: On master: COMMIT
[0m13:05:07.256666 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:05:07.256893 [debug] [MainThread]: On master: Close
[0m13:05:07.257159 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:05:07.257377 [debug] [MainThread]: Connection 'model.etl_waterlevel.fact_waterlevel' was properly closed.
[0m13:05:07.257606 [info ] [MainThread]: 
[0m13:05:07.257852 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.20 seconds (0.20s).
[0m13:05:07.258253 [debug] [MainThread]: Command end result
[0m13:05:07.277302 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m13:05:07.278611 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m13:05:07.283027 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m13:05:07.283343 [info ] [MainThread]: 
[0m13:05:07.283666 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:05:07.283900 [info ] [MainThread]: 
[0m13:05:07.284122 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:05:07.284797 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.5386583, "process_in_blocks": "0", "process_kernel_time": 0.140229, "process_mem_max_rss": "111448", "process_out_blocks": "2638", "process_user_time": 1.314151}
[0m13:05:07.285186 [debug] [MainThread]: Command `dbt run` succeeded at 13:05:07.285136 after 0.54 seconds
[0m13:05:07.285453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffafe80370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffafef3dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae1d06a0>]}
[0m13:05:07.285757 [debug] [MainThread]: Flushing usage events
[0m13:05:08.494146 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:05:05.390801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3b80340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2c6fd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2c6fd30>]}


============================== 14:05:05.394357 | f0ea513e-f1bd-41fe-8a82-a9698a8a88a7 ==============================
[0m14:05:05.394357 [info ] [MainThread]: Running with dbt=1.9.0
[0m14:05:05.394705 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/logs', 'version_check': 'True', 'profiles_dir': '/home/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --models fact_waterlevel', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:05:05.486659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f0ea513e-f1bd-41fe-8a82-a9698a8a88a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5d867a0>]}
[0m14:05:05.513691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f0ea513e-f1bd-41fe-8a82-a9698a8a88a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3a427a0>]}
[0m14:05:05.514181 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:05:05.549154 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m14:05:05.600262 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:05:05.600623 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:05:05.603842 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m14:05:05.616289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f0ea513e-f1bd-41fe-8a82-a9698a8a88a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1ec4580>]}
[0m14:05:05.654943 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m14:05:05.658843 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m14:05:05.668845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f0ea513e-f1bd-41fe-8a82-a9698a8a88a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1ee3220>]}
[0m14:05:05.669160 [info ] [MainThread]: Found 3 models, 434 macros
[0m14:05:05.669393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f0ea513e-f1bd-41fe-8a82-a9698a8a88a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1ee31c0>]}
[0m14:05:05.670143 [info ] [MainThread]: 
[0m14:05:05.670487 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:05:05.670802 [info ] [MainThread]: 
[0m14:05:05.671259 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:05:05.671897 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m14:05:05.713853 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m14:05:05.714286 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m14:05:05.714568 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:05.718183 [debug] [ThreadPool]: SQL status: SELECT 26 in 0.004 seconds
[0m14:05:05.718955 [debug] [ThreadPool]: On list_airflow: Close
[0m14:05:05.721665 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_fact)
[0m14:05:05.724940 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m14:05:05.725219 [debug] [ThreadPool]: On list_airflow_fact: BEGIN
[0m14:05:05.725483 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:05.727477 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m14:05:05.727827 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m14:05:05.728094 [debug] [ThreadPool]: On list_airflow_fact: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_fact"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'fact'
  
[0m14:05:05.729796 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m14:05:05.730475 [debug] [ThreadPool]: On list_airflow_fact: ROLLBACK
[0m14:05:05.730820 [debug] [ThreadPool]: On list_airflow_fact: Close
[0m14:05:05.731217 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_fact, now list_airflow_dim)
[0m14:05:05.732597 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m14:05:05.732858 [debug] [ThreadPool]: On list_airflow_dim: BEGIN
[0m14:05:05.733093 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:05.734648 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m14:05:05.734944 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m14:05:05.735205 [debug] [ThreadPool]: On list_airflow_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dim'
  
[0m14:05:05.736493 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.001 seconds
[0m14:05:05.737138 [debug] [ThreadPool]: On list_airflow_dim: ROLLBACK
[0m14:05:05.737509 [debug] [ThreadPool]: On list_airflow_dim: Close
[0m14:05:05.740076 [debug] [MainThread]: Using postgres connection "master"
[0m14:05:05.740374 [debug] [MainThread]: On master: BEGIN
[0m14:05:05.740628 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:05.742154 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m14:05:05.742483 [debug] [MainThread]: Using postgres connection "master"
[0m14:05:05.742784 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:05:05.746019 [debug] [MainThread]: SQL status: SELECT 2 in 0.003 seconds
[0m14:05:05.746707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f0ea513e-f1bd-41fe-8a82-a9698a8a88a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5d16350>]}
[0m14:05:05.747038 [debug] [MainThread]: On master: ROLLBACK
[0m14:05:05.747379 [debug] [MainThread]: Using postgres connection "master"
[0m14:05:05.747648 [debug] [MainThread]: On master: BEGIN
[0m14:05:05.748052 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:05:05.748356 [debug] [MainThread]: On master: COMMIT
[0m14:05:05.748642 [debug] [MainThread]: Using postgres connection "master"
[0m14:05:05.748899 [debug] [MainThread]: On master: COMMIT
[0m14:05:05.749208 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:05:05.749478 [debug] [MainThread]: On master: Close
[0m14:05:05.750542 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.fact_waterlevel
[0m14:05:05.750956 [info ] [Thread-1 (]: 1 of 1 START sql incremental model fact.fact_waterlevel ........................ [RUN]
[0m14:05:05.751324 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_dim, now model.etl_waterlevel.fact_waterlevel)
[0m14:05:05.751705 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.fact_waterlevel
[0m14:05:05.758898 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.fact_waterlevel"
[0m14:05:05.760658 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.fact_waterlevel
[0m14:05:05.789615 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m14:05:05.789984 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

    
  
    

  create temporary table "fact_waterlevel__dbt_tmp140505777347"
  
  
    as
  
  (
    

with main as (
    select
        distinct
        concat("stationId",'_',"stationCode") as station_key,
        "stationId" as station_id,
        "stationCode" as station_code,
        "waterLevel" as water_level,
        "waterlevelStatus" as waterlevel_status,
        case
            when "waterlevelStatus" = 3 then '🚨 Beyond Danger'
            when "waterlevelStatus" = 2 then '⚠️ Between Warning and Danger'
            when "waterlevelStatus" = 1 then '🔶 Between Alert and Warning'
            when "waterlevelStatus" = 0 then '✅ Between Normal and Alert'
            when "waterlevelStatus" = -1 then '🟢 Below Normal (Safe)'
            else '❓ Unknown Status'
        end as waterlevel_condition,
        "stationName",
        "districtName",
        to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp AS last_update
    from
        raw.waterlevels w
    where
        "stationStatus" = 1

        
        and to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp >= (
            select max(last_update) - interval '1 hour' from "airflow"."fact"."fact_waterlevel"
        )
        
)

select * from main
  );
  
  
[0m14:05:05.790315 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:05.809297 [debug] [Thread-1 (]: SQL status: SELECT 210 in 0.019 seconds
[0m14:05:05.816677 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m14:05:05.816991 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: BEGIN
[0m14:05:05.817390 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m14:05:05.817747 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m14:05:05.818040 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp140505777347'
        
      order by ordinal_position

  
[0m14:05:05.821025 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.003 seconds
[0m14:05:05.823788 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m14:05:05.824092 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m14:05:05.825520 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m14:05:05.832264 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m14:05:05.832585 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp140505777347'
        
      order by ordinal_position

  
[0m14:05:05.833854 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m14:05:05.835564 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m14:05:05.835869 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m14:05:05.837044 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m14:05:05.841671 [debug] [Thread-1 (]: 
    In "airflow"."fact"."fact_waterlevel":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m14:05:05.846949 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.fact_waterlevel"
[0m14:05:05.847852 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m14:05:05.848161 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      
        
        
        delete from "airflow"."fact"."fact_waterlevel" as DBT_INTERNAL_DEST
        where (station_key) in (
            select distinct station_key
            from "fact_waterlevel__dbt_tmp140505777347" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airflow"."fact"."fact_waterlevel" ("station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update")
    (
        select "station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update"
        from "fact_waterlevel__dbt_tmp140505777347"
    )
  
[0m14:05:05.872652 [debug] [Thread-1 (]: SQL status: INSERT 0 210 in 0.024 seconds
[0m14:05:05.880690 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m14:05:05.881022 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m14:05:05.881303 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m14:05:05.882921 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m14:05:05.884040 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: Close
[0m14:05:05.885220 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0ea513e-f1bd-41fe-8a82-a9698a8a88a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5d867d0>]}
[0m14:05:05.885732 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model fact.fact_waterlevel ................... [[32mINSERT 0 210[0m in 0.13s]
[0m14:05:05.886102 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.fact_waterlevel
[0m14:05:05.886843 [debug] [MainThread]: Using postgres connection "master"
[0m14:05:05.887077 [debug] [MainThread]: On master: BEGIN
[0m14:05:05.887270 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:05:05.888939 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m14:05:05.889248 [debug] [MainThread]: On master: COMMIT
[0m14:05:05.889477 [debug] [MainThread]: Using postgres connection "master"
[0m14:05:05.889697 [debug] [MainThread]: On master: COMMIT
[0m14:05:05.889950 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:05:05.890147 [debug] [MainThread]: On master: Close
[0m14:05:05.890417 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:05.890632 [debug] [MainThread]: Connection 'model.etl_waterlevel.fact_waterlevel' was properly closed.
[0m14:05:05.890858 [info ] [MainThread]: 
[0m14:05:05.891118 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.22 seconds (0.22s).
[0m14:05:05.891550 [debug] [MainThread]: Command end result
[0m14:05:05.907111 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m14:05:05.908375 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m14:05:05.912037 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m14:05:05.912267 [info ] [MainThread]: 
[0m14:05:05.912540 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:05.912749 [info ] [MainThread]: 
[0m14:05:05.912988 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:05:05.913559 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.5511607, "process_in_blocks": "0", "process_kernel_time": 0.109475, "process_mem_max_rss": "111488", "process_out_blocks": "1702", "process_user_time": 1.245409}
[0m14:05:05.913903 [debug] [MainThread]: Command `dbt run` succeeded at 14:05:05.913857 after 0.55 seconds
[0m14:05:05.914146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3b80340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa21e5420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3c04790>]}
[0m14:05:05.914388 [debug] [MainThread]: Flushing usage events
[0m14:05:07.459522 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:06:19.413749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbae8c2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9f7bd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9f7bca0>]}


============================== 15:06:19.417405 | b528964d-9204-46f0-ba19-51b4c06550ce ==============================
[0m15:06:19.417405 [info ] [MainThread]: Running with dbt=1.9.0
[0m15:06:19.417756 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --models fact_waterlevel', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:06:19.511951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b528964d-9204-46f0-ba19-51b4c06550ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb96429e0>]}
[0m15:06:19.538835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b528964d-9204-46f0-ba19-51b4c06550ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9f78bb0>]}
[0m15:06:19.539325 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:06:19.574539 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m15:06:19.626721 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:06:19.627160 [debug] [MainThread]: Partial parsing: updated file: etl_waterlevel://models/facts/fact_waterlevel.sql
[0m15:06:19.713711 [error] [MainThread]: Encountered an error:
Compilation Error in model fact_waterlevel (models/facts/fact_waterlevel.sql)
  invalid syntax for function call expression
    line 1
      {{ config(
[0m15:06:19.714467 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.3283827, "process_in_blocks": "0", "process_kernel_time": 0.109914, "process_mem_max_rss": "103976", "process_out_blocks": "4", "process_user_time": 1.102144}
[0m15:06:19.714848 [debug] [MainThread]: Command `dbt run` failed at 15:06:19.714790 after 0.33 seconds
[0m15:06:19.715164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbae8c2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9057100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9057190>]}
[0m15:06:19.715499 [debug] [MainThread]: Flushing usage events
[0m15:06:21.362750 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:20:01.948930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86e8c310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85f7bd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85f7bcd0>]}


============================== 15:20:01.952281 | c8c74a5c-39dc-48db-b0f6-379be78629f2 ==============================
[0m15:20:01.952281 [info ] [MainThread]: Running with dbt=1.9.0
[0m15:20:01.952711 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models fact_waterlevel', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:20:02.041660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c8c74a5c-39dc-48db-b0f6-379be78629f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85642290>]}
[0m15:20:02.068827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c8c74a5c-39dc-48db-b0f6-379be78629f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86ddc1c0>]}
[0m15:20:02.069344 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:20:02.104438 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m15:20:02.155724 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:20:02.156229 [debug] [MainThread]: Partial parsing: updated file: etl_waterlevel://models/facts/fact_waterlevel.sql
[0m15:20:02.242751 [error] [MainThread]: Encountered an error:
Compilation Error in model fact_waterlevel (models/facts/fact_waterlevel.sql)
  invalid syntax for function call expression
    line 1
      {{ config(
[0m15:20:02.243571 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.32092154, "process_in_blocks": "0", "process_kernel_time": 0.085118, "process_mem_max_rss": "103968", "process_out_blocks": "4", "process_user_time": 1.163623}
[0m15:20:02.243962 [debug] [MainThread]: Command `dbt run` failed at 15:20:02.243908 after 0.32 seconds
[0m15:20:02.244282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86e8c310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85057100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85057190>]}
[0m15:20:02.244580 [debug] [MainThread]: Flushing usage events
[0m15:20:03.646817 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:21:06.133024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaed60340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffade6bd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffade6bd30>]}


============================== 15:21:06.137590 | 148f91ed-efcd-4f81-a723-56a56ebbef6c ==============================
[0m15:21:06.137590 [info ] [MainThread]: Running with dbt=1.9.0
[0m15:21:06.137995 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --models fact_waterlevel', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:21:06.242897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '148f91ed-efcd-4f81-a723-56a56ebbef6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0f4e7a0>]}
[0m15:21:06.271227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '148f91ed-efcd-4f81-a723-56a56ebbef6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaec1e7a0>]}
[0m15:21:06.271823 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:21:06.308502 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m15:21:06.362492 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:21:06.363029 [debug] [MainThread]: Partial parsing: updated file: etl_waterlevel://models/facts/fact_waterlevel.sql
[0m15:21:06.459769 [error] [MainThread]: Encountered an error:
Compilation Error in model fact_waterlevel (models/facts/fact_waterlevel.sql)
  invalid syntax for function call expression
    line 1
      {{ config(
[0m15:21:06.460615 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.35537755, "process_in_blocks": "0", "process_kernel_time": 0.205054, "process_mem_max_rss": "103992", "process_out_blocks": "4", "process_user_time": 1.423199}
[0m15:21:06.461055 [debug] [MainThread]: Command `dbt run` failed at 15:21:06.460985 after 0.36 seconds
[0m15:21:06.461391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaed60340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffacf33100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffacf33190>]}
[0m15:21:06.461770 [debug] [MainThread]: Flushing usage events
[0m15:21:07.557728 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:22:10.062993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9af4c370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a053d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a053d30>]}


============================== 15:22:10.067846 | c517dc00-2562-4501-9f5a-ed0086d916a8 ==============================
[0m15:22:10.067846 [info ] [MainThread]: Running with dbt=1.9.0
[0m15:22:10.068233 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --models fact_waterlevel', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:22:10.180141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c517dc00-2562-4501-9f5a-ed0086d916a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9afdc310>]}
[0m15:22:10.217513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c517dc00-2562-4501-9f5a-ed0086d916a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a8d9810>]}
[0m15:22:10.218300 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:22:10.264371 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m15:22:10.325666 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:22:10.326280 [debug] [MainThread]: Partial parsing: updated file: etl_waterlevel://models/facts/fact_waterlevel.sql
[0m15:22:10.424015 [error] [MainThread]: Encountered an error:
Compilation Error in model fact_waterlevel (models/facts/fact_waterlevel.sql)
  invalid syntax for function call expression
    line 1
      {{ config(
[0m15:22:10.424935 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.3959023, "process_in_blocks": "0", "process_kernel_time": 0.184193, "process_mem_max_rss": "103808", "process_out_blocks": "4", "process_user_time": 1.432281}
[0m15:22:10.425391 [debug] [MainThread]: Command `dbt run` failed at 15:22:10.425323 after 0.40 seconds
[0m15:22:10.425729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9af4c370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9911b100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9911b190>]}
[0m15:22:10.426051 [debug] [MainThread]: Flushing usage events
[0m15:22:11.665242 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:05:05.137008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2b6c310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1c50550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1c50580>]}


============================== 16:05:05.140446 | 2ad009cf-8957-4a73-9159-13812c905ea3 ==============================
[0m16:05:05.140446 [info ] [MainThread]: Running with dbt=1.9.0
[0m16:05:05.140801 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --models fact_waterlevel', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:05:05.233818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2ad009cf-8957-4a73-9159-13812c905ea3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1c54550>]}
[0m16:05:05.260621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2ad009cf-8957-4a73-9159-13812c905ea3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2c27550>]}
[0m16:05:05.261115 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:05:05.298980 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m16:05:05.352054 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:05:05.352581 [debug] [MainThread]: Partial parsing: updated file: etl_waterlevel://models/facts/fact_waterlevel.sql
[0m16:05:05.462971 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m16:05:05.465652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2ad009cf-8957-4a73-9159-13812c905ea3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0d0a4d0>]}
[0m16:05:05.527861 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m16:05:05.531947 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m16:05:05.542622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2ad009cf-8957-4a73-9159-13812c905ea3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1c093c0>]}
[0m16:05:05.542959 [info ] [MainThread]: Found 3 models, 434 macros
[0m16:05:05.543194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2ad009cf-8957-4a73-9159-13812c905ea3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1c099f0>]}
[0m16:05:05.543952 [info ] [MainThread]: 
[0m16:05:05.544217 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:05:05.544475 [info ] [MainThread]: 
[0m16:05:05.544803 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:05:05.545360 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m16:05:05.562882 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m16:05:05.563245 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m16:05:05.563574 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:05:05.566601 [debug] [ThreadPool]: SQL status: SELECT 26 in 0.003 seconds
[0m16:05:05.567404 [debug] [ThreadPool]: On list_airflow: Close
[0m16:05:05.570129 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_dim)
[0m16:05:05.573295 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m16:05:05.573584 [debug] [ThreadPool]: On list_airflow_dim: BEGIN
[0m16:05:05.573846 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:05:05.575471 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m16:05:05.575856 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m16:05:05.576155 [debug] [ThreadPool]: On list_airflow_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dim'
  
[0m16:05:05.577674 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.001 seconds
[0m16:05:05.578396 [debug] [ThreadPool]: On list_airflow_dim: ROLLBACK
[0m16:05:05.578699 [debug] [ThreadPool]: On list_airflow_dim: Close
[0m16:05:05.579095 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_dim, now list_airflow_fact)
[0m16:05:05.580563 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m16:05:05.580821 [debug] [ThreadPool]: On list_airflow_fact: BEGIN
[0m16:05:05.581059 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:05:05.582502 [debug] [ThreadPool]: SQL status: BEGIN in 0.001 seconds
[0m16:05:05.582770 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m16:05:05.583025 [debug] [ThreadPool]: On list_airflow_fact: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_fact"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'fact'
  
[0m16:05:05.584307 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m16:05:05.584965 [debug] [ThreadPool]: On list_airflow_fact: ROLLBACK
[0m16:05:05.585284 [debug] [ThreadPool]: On list_airflow_fact: Close
[0m16:05:05.587759 [debug] [MainThread]: Using postgres connection "master"
[0m16:05:05.588027 [debug] [MainThread]: On master: BEGIN
[0m16:05:05.588238 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:05:05.589511 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m16:05:05.589786 [debug] [MainThread]: Using postgres connection "master"
[0m16:05:05.590059 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:05:05.593046 [debug] [MainThread]: SQL status: SELECT 2 in 0.003 seconds
[0m16:05:05.593701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2ad009cf-8957-4a73-9159-13812c905ea3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1c09210>]}
[0m16:05:05.594020 [debug] [MainThread]: On master: ROLLBACK
[0m16:05:05.594384 [debug] [MainThread]: Using postgres connection "master"
[0m16:05:05.594626 [debug] [MainThread]: On master: BEGIN
[0m16:05:05.595026 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m16:05:05.595362 [debug] [MainThread]: On master: COMMIT
[0m16:05:05.595608 [debug] [MainThread]: Using postgres connection "master"
[0m16:05:05.595838 [debug] [MainThread]: On master: COMMIT
[0m16:05:05.596149 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:05:05.596387 [debug] [MainThread]: On master: Close
[0m16:05:05.597563 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.fact_waterlevel
[0m16:05:05.597951 [info ] [Thread-1 (]: 1 of 1 START sql incremental model fact.fact_waterlevel ........................ [RUN]
[0m16:05:05.598335 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_fact, now model.etl_waterlevel.fact_waterlevel)
[0m16:05:05.598673 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.fact_waterlevel
[0m16:05:05.604789 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.fact_waterlevel"
[0m16:05:05.606241 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.fact_waterlevel
[0m16:05:05.634779 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m16:05:05.636184 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

    
  
    

  create temporary table "fact_waterlevel__dbt_tmp160505622399"
  
  
    as
  
  (
    

with main as (
    select
        distinct
        concat("stationId",'_',"stationCode") as station_key,
        "stationId" as station_id,
        "stationCode" as station_code,
        "waterLevel" as water_level,
        "waterlevelStatus" as waterlevel_status,
        case
            when "waterlevelStatus" = 3 then '🚨 Beyond Danger'
            when "waterlevelStatus" = 2 then '⚠️ Between Warning and Danger'
            when "waterlevelStatus" = 1 then '🔶 Between Alert and Warning'
            when "waterlevelStatus" = 0 then '✅ Between Normal and Alert'
            when "waterlevelStatus" = -1 then '🟢 Below Normal (Safe)'
            else '❓ Unknown Status'
        end as waterlevel_condition,
        "stationName",
        "districtName",
        to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp AS last_update
    from
        raw.waterlevels w
    where
        "stationStatus" = 1

        
        /* This condition is important to avoid reprocessing old data */
        and to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp > (
            select max(last_update) from "airflow"."fact"."fact_waterlevel"
        )
        
)

select * from main
  );
  
  
[0m16:05:05.636628 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:05:05.656414 [debug] [Thread-1 (]: SQL status: SELECT 69 in 0.020 seconds
[0m16:05:05.664044 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m16:05:05.664370 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: BEGIN
[0m16:05:05.664800 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m16:05:05.665148 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m16:05:05.665449 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp160505622399'
        
      order by ordinal_position

  
[0m16:05:05.668405 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.003 seconds
[0m16:05:05.671098 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m16:05:05.671430 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m16:05:05.672797 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m16:05:05.679360 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m16:05:05.679679 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp160505622399'
        
      order by ordinal_position

  
[0m16:05:05.680937 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m16:05:05.683197 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m16:05:05.683529 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m16:05:05.684734 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m16:05:05.689300 [debug] [Thread-1 (]: 
    In "airflow"."fact"."fact_waterlevel":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m16:05:05.692735 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.fact_waterlevel"
[0m16:05:05.693902 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m16:05:05.694191 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      insert into "airflow"."fact"."fact_waterlevel" ("station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update")
    (
        select "station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update"
        from "fact_waterlevel__dbt_tmp160505622399"
    )


  
[0m16:05:05.694812 [debug] [Thread-1 (]: SQL status: INSERT 0 69 in 0.000 seconds
[0m16:05:05.701860 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m16:05:05.702153 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m16:05:05.702417 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m16:05:05.703357 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m16:05:05.704419 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: Close
[0m16:05:05.705580 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ad009cf-8957-4a73-9159-13812c905ea3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4fda6e0>]}
[0m16:05:05.706128 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model fact.fact_waterlevel ................... [[32mINSERT 0 69[0m in 0.11s]
[0m16:05:05.706584 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.fact_waterlevel
[0m16:05:05.707341 [debug] [MainThread]: Using postgres connection "master"
[0m16:05:05.707616 [debug] [MainThread]: On master: BEGIN
[0m16:05:05.707843 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:05:05.709402 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m16:05:05.709674 [debug] [MainThread]: On master: COMMIT
[0m16:05:05.709906 [debug] [MainThread]: Using postgres connection "master"
[0m16:05:05.710103 [debug] [MainThread]: On master: COMMIT
[0m16:05:05.710353 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:05:05.710604 [debug] [MainThread]: On master: Close
[0m16:05:05.710911 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:05:05.711139 [debug] [MainThread]: Connection 'model.etl_waterlevel.fact_waterlevel' was properly closed.
[0m16:05:05.711382 [info ] [MainThread]: 
[0m16:05:05.711628 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.17 seconds (0.17s).
[0m16:05:05.712012 [debug] [MainThread]: Command end result
[0m16:05:05.734004 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m16:05:05.735133 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m16:05:05.738673 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m16:05:05.738910 [info ] [MainThread]: 
[0m16:05:05.739196 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:05:05.739414 [info ] [MainThread]: 
[0m16:05:05.739622 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:05:05.740169 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.6316012, "process_in_blocks": "0", "process_kernel_time": 0.131438, "process_mem_max_rss": "114368", "process_out_blocks": "3468", "process_user_time": 1.418728}
[0m16:05:05.740515 [debug] [MainThread]: Command `dbt run` succeeded at 16:05:05.740464 after 0.63 seconds
[0m16:05:05.740767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2b6c310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1c54550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2bdcbb0>]}
[0m16:05:05.741011 [debug] [MainThread]: Flushing usage events
[0m16:05:07.178428 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:16:05.189211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1968280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0a57ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0a57c40>]}


============================== 17:16:05.193902 | 065fcfcc-652b-4680-a1af-c8cd0b28e012 ==============================
[0m17:16:05.193902 [info ] [MainThread]: Running with dbt=1.9.0
[0m17:16:05.194353 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'version_check': 'True', 'profiles_dir': '/home/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models fact_waterlevel', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:16:05.288961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '065fcfcc-652b-4680-a1af-c8cd0b28e012', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0132170>]}
[0m17:16:05.315695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '065fcfcc-652b-4680-a1af-c8cd0b28e012', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa19f6f80>]}
[0m17:16:05.316176 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:16:05.352640 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m17:16:05.402701 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:16:05.403031 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:16:05.406201 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m17:16:05.417783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '065fcfcc-652b-4680-a1af-c8cd0b28e012', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9fcc44c0>]}
[0m17:16:05.452856 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m17:16:05.456310 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m17:16:05.466154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '065fcfcc-652b-4680-a1af-c8cd0b28e012', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9fce3220>]}
[0m17:16:05.466529 [info ] [MainThread]: Found 3 models, 434 macros
[0m17:16:05.466785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '065fcfcc-652b-4680-a1af-c8cd0b28e012', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9fce31c0>]}
[0m17:16:05.467541 [info ] [MainThread]: 
[0m17:16:05.467864 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:16:05.468170 [info ] [MainThread]: 
[0m17:16:05.468528 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:16:05.469143 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m17:16:05.508609 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m17:16:05.509034 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m17:16:05.509314 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:16:05.512406 [debug] [ThreadPool]: SQL status: SELECT 28 in 0.003 seconds
[0m17:16:05.513199 [debug] [ThreadPool]: On list_airflow: Close
[0m17:16:05.515870 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_dim)
[0m17:16:05.519087 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m17:16:05.519374 [debug] [ThreadPool]: On list_airflow_dim: BEGIN
[0m17:16:05.519621 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:16:05.521244 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m17:16:05.521620 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m17:16:05.521911 [debug] [ThreadPool]: On list_airflow_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dim'
  
[0m17:16:05.523293 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.001 seconds
[0m17:16:05.523983 [debug] [ThreadPool]: On list_airflow_dim: ROLLBACK
[0m17:16:05.524316 [debug] [ThreadPool]: On list_airflow_dim: Close
[0m17:16:05.524708 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_dim, now list_airflow_fact)
[0m17:16:05.526129 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m17:16:05.526382 [debug] [ThreadPool]: On list_airflow_fact: BEGIN
[0m17:16:05.526614 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:16:05.528169 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m17:16:05.528540 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m17:16:05.528812 [debug] [ThreadPool]: On list_airflow_fact: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_fact"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'fact'
  
[0m17:16:05.530152 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m17:16:05.530797 [debug] [ThreadPool]: On list_airflow_fact: ROLLBACK
[0m17:16:05.531131 [debug] [ThreadPool]: On list_airflow_fact: Close
[0m17:16:05.533535 [debug] [MainThread]: Using postgres connection "master"
[0m17:16:05.533817 [debug] [MainThread]: On master: BEGIN
[0m17:16:05.534056 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:16:05.535594 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m17:16:05.535918 [debug] [MainThread]: Using postgres connection "master"
[0m17:16:05.536218 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:16:05.539229 [debug] [MainThread]: SQL status: SELECT 2 in 0.003 seconds
[0m17:16:05.539879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '065fcfcc-652b-4680-a1af-c8cd0b28e012', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0089c00>]}
[0m17:16:05.540201 [debug] [MainThread]: On master: ROLLBACK
[0m17:16:05.540538 [debug] [MainThread]: Using postgres connection "master"
[0m17:16:05.540767 [debug] [MainThread]: On master: BEGIN
[0m17:16:05.541139 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m17:16:05.541435 [debug] [MainThread]: On master: COMMIT
[0m17:16:05.541676 [debug] [MainThread]: Using postgres connection "master"
[0m17:16:05.541940 [debug] [MainThread]: On master: COMMIT
[0m17:16:05.542270 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:16:05.542510 [debug] [MainThread]: On master: Close
[0m17:16:05.543645 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.fact_waterlevel
[0m17:16:05.544111 [info ] [Thread-1 (]: 1 of 1 START sql incremental model fact.fact_waterlevel ........................ [RUN]
[0m17:16:05.544441 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_fact, now model.etl_waterlevel.fact_waterlevel)
[0m17:16:05.544709 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.fact_waterlevel
[0m17:16:05.551675 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.fact_waterlevel"
[0m17:16:05.553342 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.fact_waterlevel
[0m17:16:05.581221 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m17:16:05.581562 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

    
  
    

  create temporary table "fact_waterlevel__dbt_tmp171605569182"
  
  
    as
  
  (
    

with main as (
    select
        distinct
        concat("stationId",'_',"stationCode") as station_key,
        "stationId" as station_id,
        "stationCode" as station_code,
        "waterLevel" as water_level,
        "waterlevelStatus" as waterlevel_status,
        case
            when "waterlevelStatus" = 3 then '🚨 Beyond Danger'
            when "waterlevelStatus" = 2 then '⚠️ Between Warning and Danger'
            when "waterlevelStatus" = 1 then '🔶 Between Alert and Warning'
            when "waterlevelStatus" = 0 then '✅ Between Normal and Alert'
            when "waterlevelStatus" = -1 then '🟢 Below Normal (Safe)'
            else '❓ Unknown Status'
        end as waterlevel_condition,
        "stationName",
        "districtName",
        to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp AS last_update
    from
        raw.waterlevels w
    where
        "stationStatus" = 1

        
        /* This condition is important to avoid reprocessing old data */
        and to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp > (
            select max(last_update) from "airflow"."fact"."fact_waterlevel"
        )
        
)

select * from main
  );
  
  
[0m17:16:05.581887 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:16:05.599364 [debug] [Thread-1 (]: SQL status: SELECT 69 in 0.017 seconds
[0m17:16:05.606492 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m17:16:05.606815 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: BEGIN
[0m17:16:05.607227 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m17:16:05.607560 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m17:16:05.607842 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp171605569182'
        
      order by ordinal_position

  
[0m17:16:05.610938 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.003 seconds
[0m17:16:05.613540 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m17:16:05.613876 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m17:16:05.615239 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m17:16:05.621648 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m17:16:05.621976 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp171605569182'
        
      order by ordinal_position

  
[0m17:16:05.623217 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m17:16:05.624912 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m17:16:05.625207 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m17:16:05.626447 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m17:16:05.631029 [debug] [Thread-1 (]: 
    In "airflow"."fact"."fact_waterlevel":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m17:16:05.634504 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.fact_waterlevel"
[0m17:16:05.636148 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m17:16:05.636446 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      insert into "airflow"."fact"."fact_waterlevel" ("station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update")
    (
        select "station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update"
        from "fact_waterlevel__dbt_tmp171605569182"
    )


  
[0m17:16:05.637044 [debug] [Thread-1 (]: SQL status: INSERT 0 69 in 0.000 seconds
[0m17:16:05.644478 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m17:16:05.644801 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m17:16:05.645069 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m17:16:05.646203 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m17:16:05.647205 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: Close
[0m17:16:05.648307 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '065fcfcc-652b-4680-a1af-c8cd0b28e012', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9fce2ad0>]}
[0m17:16:05.648926 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model fact.fact_waterlevel ................... [[32mINSERT 0 69[0m in 0.10s]
[0m17:16:05.649343 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.fact_waterlevel
[0m17:16:05.650079 [debug] [MainThread]: Using postgres connection "master"
[0m17:16:05.650300 [debug] [MainThread]: On master: BEGIN
[0m17:16:05.650492 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:16:05.651960 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m17:16:05.652224 [debug] [MainThread]: On master: COMMIT
[0m17:16:05.652469 [debug] [MainThread]: Using postgres connection "master"
[0m17:16:05.652657 [debug] [MainThread]: On master: COMMIT
[0m17:16:05.652923 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:16:05.653167 [debug] [MainThread]: On master: Close
[0m17:16:05.653470 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:16:05.653688 [debug] [MainThread]: Connection 'model.etl_waterlevel.fact_waterlevel' was properly closed.
[0m17:16:05.653941 [info ] [MainThread]: 
[0m17:16:05.654165 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.19 seconds (0.19s).
[0m17:16:05.654553 [debug] [MainThread]: Command end result
[0m17:16:05.669562 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m17:16:05.670674 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m17:16:05.674155 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m17:16:05.674389 [info ] [MainThread]: 
[0m17:16:05.674642 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:16:05.674873 [info ] [MainThread]: 
[0m17:16:05.675093 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:16:05.675630 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.51235044, "process_in_blocks": "0", "process_kernel_time": 0.103538, "process_mem_max_rss": "111536", "process_out_blocks": "1701", "process_user_time": 1.228385}
[0m17:16:05.675963 [debug] [MainThread]: Command `dbt run` succeeded at 17:16:05.675919 after 0.51 seconds
[0m17:16:05.676202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1968280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0132170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa19faa40>]}
[0m17:16:05.676443 [debug] [MainThread]: Flushing usage events
[0m17:16:07.086097 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:05:32.020072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9fe90340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ef7bd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ef7bd30>]}


============================== 18:05:32.023616 | 32e4da37-8f64-4bd7-a04e-d2971a3f53da ==============================
[0m18:05:32.023616 [info ] [MainThread]: Running with dbt=1.9.0
[0m18:05:32.024007 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'profiles_dir': '/home/airflow/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --models fact_waterlevel', 'send_anonymous_usage_stats': 'True'}
[0m18:05:32.117500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '32e4da37-8f64-4bd7-a04e-d2971a3f53da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa207a7a0>]}
[0m18:05:32.146698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '32e4da37-8f64-4bd7-a04e-d2971a3f53da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9fd527a0>]}
[0m18:05:32.147282 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:05:32.181948 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m18:05:32.233572 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:05:32.233910 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:05:32.236971 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m18:05:32.248656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '32e4da37-8f64-4bd7-a04e-d2971a3f53da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e1cc580>]}
[0m18:05:32.284639 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m18:05:32.288583 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m18:05:32.297629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '32e4da37-8f64-4bd7-a04e-d2971a3f53da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e1eb220>]}
[0m18:05:32.297955 [info ] [MainThread]: Found 3 models, 434 macros
[0m18:05:32.298201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '32e4da37-8f64-4bd7-a04e-d2971a3f53da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e1eb1c0>]}
[0m18:05:32.298867 [info ] [MainThread]: 
[0m18:05:32.299121 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:05:32.299327 [info ] [MainThread]: 
[0m18:05:32.299617 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:05:32.300190 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m18:05:32.340498 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m18:05:32.340918 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m18:05:32.341183 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:05:32.344133 [debug] [ThreadPool]: SQL status: SELECT 30 in 0.003 seconds
[0m18:05:32.344912 [debug] [ThreadPool]: On list_airflow: Close
[0m18:05:32.347600 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_fact)
[0m18:05:32.350752 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m18:05:32.351039 [debug] [ThreadPool]: On list_airflow_fact: BEGIN
[0m18:05:32.351277 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:05:32.352853 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m18:05:32.353207 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m18:05:32.353512 [debug] [ThreadPool]: On list_airflow_fact: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_fact"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'fact'
  
[0m18:05:32.354908 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m18:05:32.355551 [debug] [ThreadPool]: On list_airflow_fact: ROLLBACK
[0m18:05:32.355935 [debug] [ThreadPool]: On list_airflow_fact: Close
[0m18:05:32.356320 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_fact, now list_airflow_dim)
[0m18:05:32.357617 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m18:05:32.357890 [debug] [ThreadPool]: On list_airflow_dim: BEGIN
[0m18:05:32.358137 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:05:32.359627 [debug] [ThreadPool]: SQL status: BEGIN in 0.001 seconds
[0m18:05:32.359938 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m18:05:32.360214 [debug] [ThreadPool]: On list_airflow_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dim'
  
[0m18:05:32.361488 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.001 seconds
[0m18:05:32.362178 [debug] [ThreadPool]: On list_airflow_dim: ROLLBACK
[0m18:05:32.362512 [debug] [ThreadPool]: On list_airflow_dim: Close
[0m18:05:32.365101 [debug] [MainThread]: Using postgres connection "master"
[0m18:05:32.365386 [debug] [MainThread]: On master: BEGIN
[0m18:05:32.365635 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:05:32.367195 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m18:05:32.367481 [debug] [MainThread]: Using postgres connection "master"
[0m18:05:32.367813 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:05:32.370934 [debug] [MainThread]: SQL status: SELECT 2 in 0.003 seconds
[0m18:05:32.371609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '32e4da37-8f64-4bd7-a04e-d2971a3f53da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa200e350>]}
[0m18:05:32.371951 [debug] [MainThread]: On master: ROLLBACK
[0m18:05:32.372302 [debug] [MainThread]: Using postgres connection "master"
[0m18:05:32.372549 [debug] [MainThread]: On master: BEGIN
[0m18:05:32.372971 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m18:05:32.373251 [debug] [MainThread]: On master: COMMIT
[0m18:05:32.373513 [debug] [MainThread]: Using postgres connection "master"
[0m18:05:32.373752 [debug] [MainThread]: On master: COMMIT
[0m18:05:32.374097 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:05:32.374350 [debug] [MainThread]: On master: Close
[0m18:05:32.375439 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.fact_waterlevel
[0m18:05:32.375873 [info ] [Thread-1 (]: 1 of 1 START sql incremental model fact.fact_waterlevel ........................ [RUN]
[0m18:05:32.376267 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_dim, now model.etl_waterlevel.fact_waterlevel)
[0m18:05:32.376589 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.fact_waterlevel
[0m18:05:32.383850 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.fact_waterlevel"
[0m18:05:32.385008 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.fact_waterlevel
[0m18:05:32.413260 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m18:05:32.413623 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

    
  
    

  create temporary table "fact_waterlevel__dbt_tmp180532401104"
  
  
    as
  
  (
    

with main as (
    select
        distinct
        concat("stationId",'_',"stationCode") as station_key,
        "stationId" as station_id,
        "stationCode" as station_code,
        "waterLevel" as water_level,
        "waterlevelStatus" as waterlevel_status,
        case
            when "waterlevelStatus" = 3 then '🚨 Beyond Danger'
            when "waterlevelStatus" = 2 then '⚠️ Between Warning and Danger'
            when "waterlevelStatus" = 1 then '🔶 Between Alert and Warning'
            when "waterlevelStatus" = 0 then '✅ Between Normal and Alert'
            when "waterlevelStatus" = -1 then '🟢 Below Normal (Safe)'
            else '❓ Unknown Status'
        end as waterlevel_condition,
        "stationName",
        "districtName",
        to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp AS last_update
    from
        raw.waterlevels w
    where
        "stationStatus" = 1

        
        /* This condition is important to avoid reprocessing old data */
        and to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp > (
            select max(last_update) from "airflow"."fact"."fact_waterlevel"
        )
        
)

select * from main
  );
  
  
[0m18:05:32.413967 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:05:32.431907 [debug] [Thread-1 (]: SQL status: SELECT 68 in 0.018 seconds
[0m18:05:32.440188 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m18:05:32.440536 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: BEGIN
[0m18:05:32.440991 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m18:05:32.441344 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m18:05:32.441693 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp180532401104'
        
      order by ordinal_position

  
[0m18:05:32.444733 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.003 seconds
[0m18:05:32.447559 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m18:05:32.447875 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m18:05:32.449204 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m18:05:32.455731 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m18:05:32.456054 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp180532401104'
        
      order by ordinal_position

  
[0m18:05:32.457290 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m18:05:32.458992 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m18:05:32.459289 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m18:05:32.460473 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m18:05:32.465039 [debug] [Thread-1 (]: 
    In "airflow"."fact"."fact_waterlevel":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m18:05:32.468516 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.fact_waterlevel"
[0m18:05:32.469344 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m18:05:32.469636 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      insert into "airflow"."fact"."fact_waterlevel" ("station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update")
    (
        select "station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update"
        from "fact_waterlevel__dbt_tmp180532401104"
    )


  
[0m18:05:32.470234 [debug] [Thread-1 (]: SQL status: INSERT 0 68 in 0.000 seconds
[0m18:05:32.477835 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m18:05:32.478132 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m18:05:32.478351 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m18:05:32.479070 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m18:05:32.480112 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: Close
[0m18:05:32.481203 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32e4da37-8f64-4bd7-a04e-d2971a3f53da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa207a7d0>]}
[0m18:05:32.481697 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model fact.fact_waterlevel ................... [[32mINSERT 0 68[0m in 0.10s]
[0m18:05:32.482191 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.fact_waterlevel
[0m18:05:32.482973 [debug] [MainThread]: Using postgres connection "master"
[0m18:05:32.483219 [debug] [MainThread]: On master: BEGIN
[0m18:05:32.483416 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:05:32.484990 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m18:05:32.485275 [debug] [MainThread]: On master: COMMIT
[0m18:05:32.485533 [debug] [MainThread]: Using postgres connection "master"
[0m18:05:32.485759 [debug] [MainThread]: On master: COMMIT
[0m18:05:32.486016 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:05:32.486220 [debug] [MainThread]: On master: Close
[0m18:05:32.486480 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:05:32.486712 [debug] [MainThread]: Connection 'model.etl_waterlevel.fact_waterlevel' was properly closed.
[0m18:05:32.486945 [info ] [MainThread]: 
[0m18:05:32.487168 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.19 seconds (0.19s).
[0m18:05:32.487553 [debug] [MainThread]: Command end result
[0m18:05:32.501711 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m18:05:32.502910 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m18:05:32.507169 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m18:05:32.507440 [info ] [MainThread]: 
[0m18:05:32.507731 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:05:32.507952 [info ] [MainThread]: 
[0m18:05:32.508166 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:05:32.508707 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.51482725, "process_in_blocks": "0", "process_kernel_time": 0.101288, "process_mem_max_rss": "111216", "process_out_blocks": "1701", "process_user_time": 1.226499}
[0m18:05:32.509043 [debug] [MainThread]: Command `dbt run` succeeded at 18:05:32.508990 after 0.52 seconds
[0m18:05:32.509290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9fe90340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9fefe290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d548ee0>]}
[0m18:05:32.509532 [debug] [MainThread]: Flushing usage events
[0m18:05:34.242679 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:16:32.524679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ef94280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e074520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e074580>]}


============================== 19:16:32.528943 | 40147e26-484c-4f3a-81d7-0388fb02bd29 ==============================
[0m19:16:32.528943 [info ] [MainThread]: Running with dbt=1.9.0
[0m19:16:32.529391 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --models fact_waterlevel', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:16:32.622801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '40147e26-484c-4f3a-81d7-0388fb02bd29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d7e2170>]}
[0m19:16:32.650034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '40147e26-484c-4f3a-81d7-0388fb02bd29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f022f80>]}
[0m19:16:32.650529 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m19:16:32.686855 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m19:16:32.736411 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:16:32.736717 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:16:32.739882 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m19:16:32.751551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '40147e26-484c-4f3a-81d7-0388fb02bd29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d3844c0>]}
[0m19:16:32.787457 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m19:16:32.790997 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m19:16:32.800631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '40147e26-484c-4f3a-81d7-0388fb02bd29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d3a3220>]}
[0m19:16:32.800964 [info ] [MainThread]: Found 3 models, 434 macros
[0m19:16:32.801253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '40147e26-484c-4f3a-81d7-0388fb02bd29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d3a31c0>]}
[0m19:16:32.801973 [info ] [MainThread]: 
[0m19:16:32.802255 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:16:32.802511 [info ] [MainThread]: 
[0m19:16:32.802862 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:16:32.803534 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m19:16:32.843269 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m19:16:32.843673 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m19:16:32.843967 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:16:32.847034 [debug] [ThreadPool]: SQL status: SELECT 30 in 0.003 seconds
[0m19:16:32.847848 [debug] [ThreadPool]: On list_airflow: Close
[0m19:16:32.850438 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_dim)
[0m19:16:32.853587 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m19:16:32.853932 [debug] [ThreadPool]: On list_airflow_dim: BEGIN
[0m19:16:32.854179 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:16:32.855822 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m19:16:32.856176 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m19:16:32.856443 [debug] [ThreadPool]: On list_airflow_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dim'
  
[0m19:16:32.857860 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.001 seconds
[0m19:16:32.858515 [debug] [ThreadPool]: On list_airflow_dim: ROLLBACK
[0m19:16:32.858852 [debug] [ThreadPool]: On list_airflow_dim: Close
[0m19:16:32.859239 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_dim, now list_airflow_fact)
[0m19:16:32.860569 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m19:16:32.860836 [debug] [ThreadPool]: On list_airflow_fact: BEGIN
[0m19:16:32.861067 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:16:32.862575 [debug] [ThreadPool]: SQL status: BEGIN in 0.001 seconds
[0m19:16:32.862926 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m19:16:32.863227 [debug] [ThreadPool]: On list_airflow_fact: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_fact"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'fact'
  
[0m19:16:32.864437 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m19:16:32.865068 [debug] [ThreadPool]: On list_airflow_fact: ROLLBACK
[0m19:16:32.865389 [debug] [ThreadPool]: On list_airflow_fact: Close
[0m19:16:32.867811 [debug] [MainThread]: Using postgres connection "master"
[0m19:16:32.868085 [debug] [MainThread]: On master: BEGIN
[0m19:16:32.868327 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:16:32.869842 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m19:16:32.870151 [debug] [MainThread]: Using postgres connection "master"
[0m19:16:32.870452 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:16:32.873527 [debug] [MainThread]: SQL status: SELECT 2 in 0.003 seconds
[0m19:16:32.874168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '40147e26-484c-4f3a-81d7-0388fb02bd29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9effcbb0>]}
[0m19:16:32.874492 [debug] [MainThread]: On master: ROLLBACK
[0m19:16:32.874854 [debug] [MainThread]: Using postgres connection "master"
[0m19:16:32.875110 [debug] [MainThread]: On master: BEGIN
[0m19:16:32.875527 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m19:16:32.875853 [debug] [MainThread]: On master: COMMIT
[0m19:16:32.876126 [debug] [MainThread]: Using postgres connection "master"
[0m19:16:32.876358 [debug] [MainThread]: On master: COMMIT
[0m19:16:32.876670 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:16:32.876914 [debug] [MainThread]: On master: Close
[0m19:16:32.878052 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.fact_waterlevel
[0m19:16:32.878422 [info ] [Thread-1 (]: 1 of 1 START sql incremental model fact.fact_waterlevel ........................ [RUN]
[0m19:16:32.878739 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_fact, now model.etl_waterlevel.fact_waterlevel)
[0m19:16:32.879043 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.fact_waterlevel
[0m19:16:32.886036 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.fact_waterlevel"
[0m19:16:32.887712 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.fact_waterlevel
[0m19:16:32.915681 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m19:16:32.916061 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

    
  
    

  create temporary table "fact_waterlevel__dbt_tmp191632903724"
  
  
    as
  
  (
    

with main as (
    select
        distinct
        concat("stationId",'_',"stationCode") as station_key,
        "stationId" as station_id,
        "stationCode" as station_code,
        "waterLevel" as water_level,
        "waterlevelStatus" as waterlevel_status,
        case
            when "waterlevelStatus" = 3 then '🚨 Beyond Danger'
            when "waterlevelStatus" = 2 then '⚠️ Between Warning and Danger'
            when "waterlevelStatus" = 1 then '🔶 Between Alert and Warning'
            when "waterlevelStatus" = 0 then '✅ Between Normal and Alert'
            when "waterlevelStatus" = -1 then '🟢 Below Normal (Safe)'
            else '❓ Unknown Status'
        end as waterlevel_condition,
        "stationName",
        "districtName",
        to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp AS last_update
    from
        raw.waterlevels w
    where
        "stationStatus" = 1

        
        /* This condition is important to avoid reprocessing old data */
        and to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp > (
            select max(last_update) from "airflow"."fact"."fact_waterlevel"
        )
        
)

select * from main
  );
  
  
[0m19:16:32.916417 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:16:32.933604 [debug] [Thread-1 (]: SQL status: SELECT 69 in 0.017 seconds
[0m19:16:32.940842 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m19:16:32.941153 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: BEGIN
[0m19:16:32.941568 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m19:16:32.941934 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m19:16:32.942222 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp191632903724'
        
      order by ordinal_position

  
[0m19:16:32.945099 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.003 seconds
[0m19:16:32.947719 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m19:16:32.948029 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m19:16:32.949351 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m19:16:32.955849 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m19:16:32.956176 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp191632903724'
        
      order by ordinal_position

  
[0m19:16:32.957418 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m19:16:32.959195 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m19:16:32.959491 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m19:16:32.960675 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m19:16:32.965220 [debug] [Thread-1 (]: 
    In "airflow"."fact"."fact_waterlevel":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m19:16:32.968610 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.fact_waterlevel"
[0m19:16:32.969520 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m19:16:32.969846 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      insert into "airflow"."fact"."fact_waterlevel" ("station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update")
    (
        select "station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update"
        from "fact_waterlevel__dbt_tmp191632903724"
    )


  
[0m19:16:32.970399 [debug] [Thread-1 (]: SQL status: INSERT 0 69 in 0.000 seconds
[0m19:16:32.977857 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m19:16:32.978155 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m19:16:32.978430 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m19:16:32.979556 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m19:16:32.980581 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: Close
[0m19:16:32.981736 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40147e26-484c-4f3a-81d7-0388fb02bd29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d3a2b30>]}
[0m19:16:32.982261 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model fact.fact_waterlevel ................... [[32mINSERT 0 69[0m in 0.10s]
[0m19:16:32.982685 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.fact_waterlevel
[0m19:16:32.983531 [debug] [MainThread]: Using postgres connection "master"
[0m19:16:32.983842 [debug] [MainThread]: On master: BEGIN
[0m19:16:32.984067 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:16:32.985625 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m19:16:32.985903 [debug] [MainThread]: On master: COMMIT
[0m19:16:32.986153 [debug] [MainThread]: Using postgres connection "master"
[0m19:16:32.986382 [debug] [MainThread]: On master: COMMIT
[0m19:16:32.986632 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:16:32.986832 [debug] [MainThread]: On master: Close
[0m19:16:32.987102 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:16:32.987345 [debug] [MainThread]: Connection 'model.etl_waterlevel.fact_waterlevel' was properly closed.
[0m19:16:32.987578 [info ] [MainThread]: 
[0m19:16:32.987811 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.18 seconds (0.18s).
[0m19:16:32.988193 [debug] [MainThread]: Command end result
[0m19:16:33.003274 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m19:16:33.004384 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m19:16:33.008156 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m19:16:33.008374 [info ] [MainThread]: 
[0m19:16:33.008625 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:16:33.008839 [info ] [MainThread]: 
[0m19:16:33.009058 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:16:33.009632 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.5112938, "process_in_blocks": "0", "process_kernel_time": 0.126142, "process_mem_max_rss": "111180", "process_out_blocks": "1701", "process_user_time": 1.207365}
[0m19:16:33.010014 [debug] [MainThread]: Command `dbt run` succeeded at 19:16:33.009966 after 0.51 seconds
[0m19:16:33.010276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ef94280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d7e2170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f026a40>]}
[0m19:16:33.010524 [debug] [MainThread]: Flushing usage events
[0m19:16:34.226489 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:16:50.784265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d74c2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c848520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c848580>]}


============================== 20:16:50.788060 | c4834b97-d799-4410-a838-2a7c65753ec7 ==============================
[0m20:16:50.788060 [info ] [MainThread]: Running with dbt=1.9.0
[0m20:16:50.788431 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'profiles_dir': '/home/airflow/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models fact_waterlevel', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:16:50.879227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c4834b97-d799-4410-a838-2a7c65753ec7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9bed69e0>]}
[0m20:16:50.905631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c4834b97-d799-4410-a838-2a7c65753ec7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c848040>]}
[0m20:16:50.906098 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m20:16:50.941114 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m20:16:50.991986 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:16:50.992319 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:16:50.995355 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m20:16:51.007073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c4834b97-d799-4410-a838-2a7c65753ec7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ba48520>]}
[0m20:16:51.044113 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m20:16:51.047696 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m20:16:51.057318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c4834b97-d799-4410-a838-2a7c65753ec7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ba67220>]}
[0m20:16:51.057639 [info ] [MainThread]: Found 3 models, 434 macros
[0m20:16:51.057879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c4834b97-d799-4410-a838-2a7c65753ec7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ba671c0>]}
[0m20:16:51.058608 [info ] [MainThread]: 
[0m20:16:51.058885 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:16:51.059106 [info ] [MainThread]: 
[0m20:16:51.059408 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:16:51.059984 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m20:16:51.102363 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m20:16:51.102771 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m20:16:51.103044 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:16:51.106098 [debug] [ThreadPool]: SQL status: SELECT 30 in 0.003 seconds
[0m20:16:51.106849 [debug] [ThreadPool]: On list_airflow: Close
[0m20:16:51.109494 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_dim)
[0m20:16:51.112704 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m20:16:51.112993 [debug] [ThreadPool]: On list_airflow_dim: BEGIN
[0m20:16:51.113248 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:16:51.114809 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m20:16:51.115167 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m20:16:51.115431 [debug] [ThreadPool]: On list_airflow_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dim'
  
[0m20:16:51.116868 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.001 seconds
[0m20:16:51.117525 [debug] [ThreadPool]: On list_airflow_dim: ROLLBACK
[0m20:16:51.117864 [debug] [ThreadPool]: On list_airflow_dim: Close
[0m20:16:51.118249 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_dim, now list_airflow_fact)
[0m20:16:51.119639 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m20:16:51.119920 [debug] [ThreadPool]: On list_airflow_fact: BEGIN
[0m20:16:51.120157 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:16:51.121621 [debug] [ThreadPool]: SQL status: BEGIN in 0.001 seconds
[0m20:16:51.121922 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m20:16:51.122174 [debug] [ThreadPool]: On list_airflow_fact: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_fact"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'fact'
  
[0m20:16:51.123365 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m20:16:51.124003 [debug] [ThreadPool]: On list_airflow_fact: ROLLBACK
[0m20:16:51.124326 [debug] [ThreadPool]: On list_airflow_fact: Close
[0m20:16:51.126784 [debug] [MainThread]: Using postgres connection "master"
[0m20:16:51.127083 [debug] [MainThread]: On master: BEGIN
[0m20:16:51.127318 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:16:51.128870 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m20:16:51.129227 [debug] [MainThread]: Using postgres connection "master"
[0m20:16:51.129520 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:16:51.132518 [debug] [MainThread]: SQL status: SELECT 2 in 0.003 seconds
[0m20:16:51.133169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c4834b97-d799-4410-a838-2a7c65753ec7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ba66c50>]}
[0m20:16:51.133499 [debug] [MainThread]: On master: ROLLBACK
[0m20:16:51.133838 [debug] [MainThread]: Using postgres connection "master"
[0m20:16:51.134104 [debug] [MainThread]: On master: BEGIN
[0m20:16:51.134518 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m20:16:51.134841 [debug] [MainThread]: On master: COMMIT
[0m20:16:51.135077 [debug] [MainThread]: Using postgres connection "master"
[0m20:16:51.135314 [debug] [MainThread]: On master: COMMIT
[0m20:16:51.135637 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:16:51.135902 [debug] [MainThread]: On master: Close
[0m20:16:51.137018 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.fact_waterlevel
[0m20:16:51.137371 [info ] [Thread-1 (]: 1 of 1 START sql incremental model fact.fact_waterlevel ........................ [RUN]
[0m20:16:51.137705 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_fact, now model.etl_waterlevel.fact_waterlevel)
[0m20:16:51.137980 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.fact_waterlevel
[0m20:16:51.144907 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.fact_waterlevel"
[0m20:16:51.146469 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.fact_waterlevel
[0m20:16:51.174435 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m20:16:51.174805 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

    
  
    

  create temporary table "fact_waterlevel__dbt_tmp201651162220"
  
  
    as
  
  (
    

with main as (
    select
        distinct
        concat("stationId",'_',"stationCode") as station_key,
        "stationId" as station_id,
        "stationCode" as station_code,
        "waterLevel" as water_level,
        "waterlevelStatus" as waterlevel_status,
        case
            when "waterlevelStatus" = 3 then '🚨 Beyond Danger'
            when "waterlevelStatus" = 2 then '⚠️ Between Warning and Danger'
            when "waterlevelStatus" = 1 then '🔶 Between Alert and Warning'
            when "waterlevelStatus" = 0 then '✅ Between Normal and Alert'
            when "waterlevelStatus" = -1 then '🟢 Below Normal (Safe)'
            else '❓ Unknown Status'
        end as waterlevel_condition,
        "stationName",
        "districtName",
        to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp AS last_update
    from
        raw.waterlevels w
    where
        "stationStatus" = 1

        
        /* This condition is important to avoid reprocessing old data */
        and to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp > (
            select max(last_update) from "airflow"."fact"."fact_waterlevel"
        )
        
)

select * from main
  );
  
  
[0m20:16:51.175127 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:16:51.192288 [debug] [Thread-1 (]: SQL status: SELECT 69 in 0.017 seconds
[0m20:16:51.199513 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m20:16:51.199820 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: BEGIN
[0m20:16:51.200237 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m20:16:51.200589 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m20:16:51.200913 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp201651162220'
        
      order by ordinal_position

  
[0m20:16:51.203898 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.003 seconds
[0m20:16:51.206517 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m20:16:51.206836 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m20:16:51.208155 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m20:16:51.214575 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m20:16:51.214917 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp201651162220'
        
      order by ordinal_position

  
[0m20:16:51.216179 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m20:16:51.217860 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m20:16:51.218166 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m20:16:51.219339 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m20:16:51.223975 [debug] [Thread-1 (]: 
    In "airflow"."fact"."fact_waterlevel":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m20:16:51.227391 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.fact_waterlevel"
[0m20:16:51.228945 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m20:16:51.229237 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      insert into "airflow"."fact"."fact_waterlevel" ("station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update")
    (
        select "station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update"
        from "fact_waterlevel__dbt_tmp201651162220"
    )


  
[0m20:16:51.229801 [debug] [Thread-1 (]: SQL status: INSERT 0 69 in 0.000 seconds
[0m20:16:51.237193 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m20:16:51.237496 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m20:16:51.237780 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m20:16:51.238945 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m20:16:51.239961 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: Close
[0m20:16:51.241124 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4834b97-d799-4410-a838-2a7c65753ec7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f8aa770>]}
[0m20:16:51.241657 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model fact.fact_waterlevel ................... [[32mINSERT 0 69[0m in 0.10s]
[0m20:16:51.242119 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.fact_waterlevel
[0m20:16:51.242838 [debug] [MainThread]: Using postgres connection "master"
[0m20:16:51.243068 [debug] [MainThread]: On master: BEGIN
[0m20:16:51.243258 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:16:51.244730 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m20:16:51.245002 [debug] [MainThread]: On master: COMMIT
[0m20:16:51.245232 [debug] [MainThread]: Using postgres connection "master"
[0m20:16:51.245426 [debug] [MainThread]: On master: COMMIT
[0m20:16:51.245673 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:16:51.245885 [debug] [MainThread]: On master: Close
[0m20:16:51.246160 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:16:51.246426 [debug] [MainThread]: Connection 'model.etl_waterlevel.fact_waterlevel' was properly closed.
[0m20:16:51.246651 [info ] [MainThread]: 
[0m20:16:51.246878 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.19 seconds (0.19s).
[0m20:16:51.247241 [debug] [MainThread]: Command end result
[0m20:16:51.262301 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m20:16:51.263495 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m20:16:51.267348 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m20:16:51.267581 [info ] [MainThread]: 
[0m20:16:51.267853 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:16:51.268065 [info ] [MainThread]: 
[0m20:16:51.268285 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:16:51.268855 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.5115018, "process_in_blocks": "0", "process_kernel_time": 0.098047, "process_mem_max_rss": "111268", "process_out_blocks": "1701", "process_user_time": 1.217591}
[0m20:16:51.269184 [debug] [MainThread]: Command `dbt run` succeeded at 20:16:51.269138 after 0.51 seconds
[0m20:16:51.269458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d74c2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d767550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ba150c0>]}
[0m20:16:51.269758 [debug] [MainThread]: Flushing usage events
[0m20:16:52.503232 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:14:30.308475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff814782e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80567c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80567c10>]}


============================== 21:14:30.312961 | 8fa9c5a0-c091-474d-be5c-fdebb0cb071c ==============================
[0m21:14:30.312961 [info ] [MainThread]: Running with dbt=1.9.0
[0m21:14:30.313375 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --models fact_waterlevel', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:14:30.406718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8fa9c5a0-c091-474d-be5c-fdebb0cb071c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8365ac20>]}
[0m21:14:30.433196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8fa9c5a0-c091-474d-be5c-fdebb0cb071c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8055cc70>]}
[0m21:14:30.433666 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:14:30.468413 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m21:14:30.517086 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:14:30.517403 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:14:30.520572 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m21:14:30.532450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8fa9c5a0-c091-474d-be5c-fdebb0cb071c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f8244f0>]}
[0m21:14:30.568821 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m21:14:30.572551 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m21:14:30.582529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8fa9c5a0-c091-474d-be5c-fdebb0cb071c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f843220>]}
[0m21:14:30.582876 [info ] [MainThread]: Found 3 models, 434 macros
[0m21:14:30.583188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8fa9c5a0-c091-474d-be5c-fdebb0cb071c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f8431c0>]}
[0m21:14:30.583929 [info ] [MainThread]: 
[0m21:14:30.584244 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:14:30.584572 [info ] [MainThread]: 
[0m21:14:30.585031 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:14:30.585739 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m21:14:30.627357 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m21:14:30.627752 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m21:14:30.628033 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:14:30.631198 [debug] [ThreadPool]: SQL status: SELECT 30 in 0.003 seconds
[0m21:14:30.631983 [debug] [ThreadPool]: On list_airflow: Close
[0m21:14:30.634672 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_dim)
[0m21:14:30.637800 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m21:14:30.638074 [debug] [ThreadPool]: On list_airflow_dim: BEGIN
[0m21:14:30.638317 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:14:30.640029 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m21:14:30.640428 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m21:14:30.640687 [debug] [ThreadPool]: On list_airflow_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dim'
  
[0m21:14:30.642093 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.001 seconds
[0m21:14:30.642749 [debug] [ThreadPool]: On list_airflow_dim: ROLLBACK
[0m21:14:30.643094 [debug] [ThreadPool]: On list_airflow_dim: Close
[0m21:14:30.643492 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_dim, now list_airflow_fact)
[0m21:14:30.644859 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m21:14:30.645137 [debug] [ThreadPool]: On list_airflow_fact: BEGIN
[0m21:14:30.645416 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:14:30.647126 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m21:14:30.647466 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m21:14:30.647725 [debug] [ThreadPool]: On list_airflow_fact: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_fact"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'fact'
  
[0m21:14:30.649066 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m21:14:30.649695 [debug] [ThreadPool]: On list_airflow_fact: ROLLBACK
[0m21:14:30.650018 [debug] [ThreadPool]: On list_airflow_fact: Close
[0m21:14:30.652455 [debug] [MainThread]: Using postgres connection "master"
[0m21:14:30.652746 [debug] [MainThread]: On master: BEGIN
[0m21:14:30.652992 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:14:30.654592 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m21:14:30.654905 [debug] [MainThread]: Using postgres connection "master"
[0m21:14:30.655244 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:14:30.658239 [debug] [MainThread]: SQL status: SELECT 2 in 0.003 seconds
[0m21:14:30.658863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8fa9c5a0-c091-474d-be5c-fdebb0cb071c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80e1e440>]}
[0m21:14:30.659292 [debug] [MainThread]: On master: ROLLBACK
[0m21:14:30.659628 [debug] [MainThread]: Using postgres connection "master"
[0m21:14:30.659864 [debug] [MainThread]: On master: BEGIN
[0m21:14:30.660264 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m21:14:30.660568 [debug] [MainThread]: On master: COMMIT
[0m21:14:30.660808 [debug] [MainThread]: Using postgres connection "master"
[0m21:14:30.661038 [debug] [MainThread]: On master: COMMIT
[0m21:14:30.661364 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:14:30.661636 [debug] [MainThread]: On master: Close
[0m21:14:30.662792 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.fact_waterlevel
[0m21:14:30.663167 [info ] [Thread-1 (]: 1 of 1 START sql incremental model fact.fact_waterlevel ........................ [RUN]
[0m21:14:30.663492 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_fact, now model.etl_waterlevel.fact_waterlevel)
[0m21:14:30.663761 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.fact_waterlevel
[0m21:14:30.670720 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.fact_waterlevel"
[0m21:14:30.672383 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.fact_waterlevel
[0m21:14:30.700573 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m21:14:30.700927 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

    
  
    

  create temporary table "fact_waterlevel__dbt_tmp211430688519"
  
  
    as
  
  (
    

with main as (
    select
        distinct
        concat("stationId",'_',"stationCode") as station_key,
        "stationId" as station_id,
        "stationCode" as station_code,
        "waterLevel" as water_level,
        "waterlevelStatus" as waterlevel_status,
        case
            when "waterlevelStatus" = 3 then '🚨 Beyond Danger'
            when "waterlevelStatus" = 2 then '⚠️ Between Warning and Danger'
            when "waterlevelStatus" = 1 then '🔶 Between Alert and Warning'
            when "waterlevelStatus" = 0 then '✅ Between Normal and Alert'
            when "waterlevelStatus" = -1 then '🟢 Below Normal (Safe)'
            else '❓ Unknown Status'
        end as waterlevel_condition,
        "stationName",
        "districtName",
        to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp AS last_update
    from
        raw.waterlevels w
    where
        "stationStatus" = 1

        
        /* This condition is important to avoid reprocessing old data */
        and to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp > (
            select max(last_update) from "airflow"."fact"."fact_waterlevel"
        )
        
)

select * from main
  );
  
  
[0m21:14:30.701286 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:14:30.718819 [debug] [Thread-1 (]: SQL status: SELECT 69 in 0.018 seconds
[0m21:14:30.726054 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m21:14:30.726356 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: BEGIN
[0m21:14:30.726755 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m21:14:30.727124 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m21:14:30.727403 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp211430688519'
        
      order by ordinal_position

  
[0m21:14:30.730388 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.003 seconds
[0m21:14:30.732977 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m21:14:30.733278 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m21:14:30.734596 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m21:14:30.740962 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m21:14:30.741283 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp211430688519'
        
      order by ordinal_position

  
[0m21:14:30.742533 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m21:14:30.744193 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m21:14:30.744488 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m21:14:30.745665 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m21:14:30.750173 [debug] [Thread-1 (]: 
    In "airflow"."fact"."fact_waterlevel":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m21:14:30.753572 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.fact_waterlevel"
[0m21:14:30.754364 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m21:14:30.754652 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      insert into "airflow"."fact"."fact_waterlevel" ("station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update")
    (
        select "station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update"
        from "fact_waterlevel__dbt_tmp211430688519"
    )


  
[0m21:14:30.755226 [debug] [Thread-1 (]: SQL status: INSERT 0 69 in 0.000 seconds
[0m21:14:30.762670 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m21:14:30.762993 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m21:14:30.763259 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m21:14:30.764128 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m21:14:30.765139 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: Close
[0m21:14:30.766332 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8fa9c5a0-c091-474d-be5c-fdebb0cb071c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8365a770>]}
[0m21:14:30.766962 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model fact.fact_waterlevel ................... [[32mINSERT 0 69[0m in 0.10s]
[0m21:14:30.767456 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.fact_waterlevel
[0m21:14:30.768170 [debug] [MainThread]: Using postgres connection "master"
[0m21:14:30.768410 [debug] [MainThread]: On master: BEGIN
[0m21:14:30.768605 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:14:30.770180 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m21:14:30.770451 [debug] [MainThread]: On master: COMMIT
[0m21:14:30.770670 [debug] [MainThread]: Using postgres connection "master"
[0m21:14:30.770857 [debug] [MainThread]: On master: COMMIT
[0m21:14:30.771147 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:14:30.771394 [debug] [MainThread]: On master: Close
[0m21:14:30.771672 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:14:30.771884 [debug] [MainThread]: Connection 'model.etl_waterlevel.fact_waterlevel' was properly closed.
[0m21:14:30.772116 [info ] [MainThread]: 
[0m21:14:30.772369 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.19 seconds (0.19s).
[0m21:14:30.772785 [debug] [MainThread]: Command end result
[0m21:14:30.788839 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m21:14:30.790126 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m21:14:30.793769 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m21:14:30.794007 [info ] [MainThread]: 
[0m21:14:30.794279 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:14:30.794485 [info ] [MainThread]: 
[0m21:14:30.794700 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m21:14:30.795236 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.51248336, "process_in_blocks": "0", "process_kernel_time": 0.1051, "process_mem_max_rss": "111460", "process_out_blocks": "1701", "process_user_time": 1.211155}
[0m21:14:30.795571 [debug] [MainThread]: Command `dbt run` succeeded at 21:14:30.795527 after 0.51 seconds
[0m21:14:30.795828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff814782e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f7f1300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8055c160>]}
[0m21:14:30.796118 [debug] [MainThread]: Flushing usage events
[0m21:14:32.486152 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:15:31.058574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f05c2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e15c580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e15c5e0>]}


============================== 22:15:31.062571 | 6c766189-8765-4a23-9e0b-8a24f0711ad6 ==============================
[0m22:15:31.062571 [info ] [MainThread]: Running with dbt=1.9.0
[0m22:15:31.062946 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'profiles_dir': '/home/airflow/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --models fact_waterlevel', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:15:31.157739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6c766189-8765-4a23-9e0b-8a24f0711ad6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff911d2c20>]}
[0m22:15:31.184893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6c766189-8765-4a23-9e0b-8a24f0711ad6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e160c70>]}
[0m22:15:31.185397 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:15:31.222354 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m22:15:31.273060 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:15:31.273353 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:15:31.276568 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m22:15:31.288534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6c766189-8765-4a23-9e0b-8a24f0711ad6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d38c4f0>]}
[0m22:15:31.326949 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m22:15:31.330500 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m22:15:31.340240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6c766189-8765-4a23-9e0b-8a24f0711ad6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d3ab220>]}
[0m22:15:31.340546 [info ] [MainThread]: Found 3 models, 434 macros
[0m22:15:31.340783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6c766189-8765-4a23-9e0b-8a24f0711ad6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d3ab1c0>]}
[0m22:15:31.341492 [info ] [MainThread]: 
[0m22:15:31.341810 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:15:31.342141 [info ] [MainThread]: 
[0m22:15:31.342499 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:15:31.343118 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m22:15:31.383458 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m22:15:31.383886 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m22:15:31.384150 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:15:31.387265 [debug] [ThreadPool]: SQL status: SELECT 30 in 0.003 seconds
[0m22:15:31.388053 [debug] [ThreadPool]: On list_airflow: Close
[0m22:15:31.390721 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_dim)
[0m22:15:31.394067 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m22:15:31.394363 [debug] [ThreadPool]: On list_airflow_dim: BEGIN
[0m22:15:31.394609 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:15:31.396299 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m22:15:31.396808 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m22:15:31.397178 [debug] [ThreadPool]: On list_airflow_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dim'
  
[0m22:15:31.398713 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.001 seconds
[0m22:15:31.399401 [debug] [ThreadPool]: On list_airflow_dim: ROLLBACK
[0m22:15:31.399764 [debug] [ThreadPool]: On list_airflow_dim: Close
[0m22:15:31.400188 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_dim, now list_airflow_fact)
[0m22:15:31.401629 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m22:15:31.401946 [debug] [ThreadPool]: On list_airflow_fact: BEGIN
[0m22:15:31.402181 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:15:31.403698 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m22:15:31.404019 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m22:15:31.404286 [debug] [ThreadPool]: On list_airflow_fact: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_fact"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'fact'
  
[0m22:15:31.405563 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m22:15:31.406154 [debug] [ThreadPool]: On list_airflow_fact: ROLLBACK
[0m22:15:31.406480 [debug] [ThreadPool]: On list_airflow_fact: Close
[0m22:15:31.408947 [debug] [MainThread]: Using postgres connection "master"
[0m22:15:31.409242 [debug] [MainThread]: On master: BEGIN
[0m22:15:31.409477 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:15:31.410979 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m22:15:31.411275 [debug] [MainThread]: Using postgres connection "master"
[0m22:15:31.411573 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:15:31.414564 [debug] [MainThread]: SQL status: SELECT 2 in 0.003 seconds
[0m22:15:31.415197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6c766189-8765-4a23-9e0b-8a24f0711ad6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e9ea440>]}
[0m22:15:31.415524 [debug] [MainThread]: On master: ROLLBACK
[0m22:15:31.415871 [debug] [MainThread]: Using postgres connection "master"
[0m22:15:31.416118 [debug] [MainThread]: On master: BEGIN
[0m22:15:31.416510 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m22:15:31.416814 [debug] [MainThread]: On master: COMMIT
[0m22:15:31.417082 [debug] [MainThread]: Using postgres connection "master"
[0m22:15:31.417324 [debug] [MainThread]: On master: COMMIT
[0m22:15:31.417645 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:15:31.417890 [debug] [MainThread]: On master: Close
[0m22:15:31.419026 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.fact_waterlevel
[0m22:15:31.419391 [info ] [Thread-1 (]: 1 of 1 START sql incremental model fact.fact_waterlevel ........................ [RUN]
[0m22:15:31.419707 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_fact, now model.etl_waterlevel.fact_waterlevel)
[0m22:15:31.420000 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.fact_waterlevel
[0m22:15:31.427793 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.fact_waterlevel"
[0m22:15:31.428982 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.fact_waterlevel
[0m22:15:31.457921 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m22:15:31.458307 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

    
  
    

  create temporary table "fact_waterlevel__dbt_tmp221531445783"
  
  
    as
  
  (
    

with main as (
    select
        distinct
        concat("stationId",'_',"stationCode") as station_key,
        "stationId" as station_id,
        "stationCode" as station_code,
        "waterLevel" as water_level,
        "waterlevelStatus" as waterlevel_status,
        case
            when "waterlevelStatus" = 3 then '🚨 Beyond Danger'
            when "waterlevelStatus" = 2 then '⚠️ Between Warning and Danger'
            when "waterlevelStatus" = 1 then '🔶 Between Alert and Warning'
            when "waterlevelStatus" = 0 then '✅ Between Normal and Alert'
            when "waterlevelStatus" = -1 then '🟢 Below Normal (Safe)'
            else '❓ Unknown Status'
        end as waterlevel_condition,
        "stationName",
        "districtName",
        to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp AS last_update
    from
        raw.waterlevels w
    where
        "stationStatus" = 1

        
        /* This condition is important to avoid reprocessing old data */
        and to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp > (
            select max(last_update) from "airflow"."fact"."fact_waterlevel"
        )
        
)

select * from main
  );
  
  
[0m22:15:31.458702 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:15:31.476582 [debug] [Thread-1 (]: SQL status: SELECT 69 in 0.018 seconds
[0m22:15:31.484238 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m22:15:31.484560 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: BEGIN
[0m22:15:31.484985 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m22:15:31.485348 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m22:15:31.485639 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp221531445783'
        
      order by ordinal_position

  
[0m22:15:31.488533 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.003 seconds
[0m22:15:31.491208 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m22:15:31.491522 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m22:15:31.492826 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m22:15:31.499338 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m22:15:31.499653 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp221531445783'
        
      order by ordinal_position

  
[0m22:15:31.500905 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m22:15:31.502580 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m22:15:31.502898 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m22:15:31.504069 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m22:15:31.508574 [debug] [Thread-1 (]: 
    In "airflow"."fact"."fact_waterlevel":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m22:15:31.512015 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.fact_waterlevel"
[0m22:15:31.512940 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m22:15:31.513275 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      insert into "airflow"."fact"."fact_waterlevel" ("station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update")
    (
        select "station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update"
        from "fact_waterlevel__dbt_tmp221531445783"
    )


  
[0m22:15:31.513865 [debug] [Thread-1 (]: SQL status: INSERT 0 69 in 0.000 seconds
[0m22:15:31.521332 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m22:15:31.521618 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m22:15:31.521871 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m22:15:31.522652 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m22:15:31.523654 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: Close
[0m22:15:31.524673 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c766189-8765-4a23-9e0b-8a24f0711ad6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff911d2770>]}
[0m22:15:31.525127 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model fact.fact_waterlevel ................... [[32mINSERT 0 69[0m in 0.10s]
[0m22:15:31.525509 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.fact_waterlevel
[0m22:15:31.526291 [debug] [MainThread]: Using postgres connection "master"
[0m22:15:31.526536 [debug] [MainThread]: On master: BEGIN
[0m22:15:31.526742 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:15:31.528231 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m22:15:31.528509 [debug] [MainThread]: On master: COMMIT
[0m22:15:31.528727 [debug] [MainThread]: Using postgres connection "master"
[0m22:15:31.528927 [debug] [MainThread]: On master: COMMIT
[0m22:15:31.529182 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:15:31.529384 [debug] [MainThread]: On master: Close
[0m22:15:31.529645 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:15:31.529867 [debug] [MainThread]: Connection 'model.etl_waterlevel.fact_waterlevel' was properly closed.
[0m22:15:31.530081 [info ] [MainThread]: 
[0m22:15:31.530302 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.19 seconds (0.19s).
[0m22:15:31.530673 [debug] [MainThread]: Command end result
[0m22:15:31.545175 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m22:15:31.546376 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m22:15:31.549886 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m22:15:31.550122 [info ] [MainThread]: 
[0m22:15:31.550425 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:15:31.550678 [info ] [MainThread]: 
[0m22:15:31.550912 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m22:15:31.551439 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.5189224, "process_in_blocks": "0", "process_kernel_time": 0.1047, "process_mem_max_rss": "111520", "process_out_blocks": "1701", "process_user_time": 1.226489}
[0m22:15:31.551768 [debug] [MainThread]: Command `dbt run` succeeded at 22:15:31.551714 after 0.52 seconds
[0m22:15:31.552005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f05c2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d358a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e160160>]}
[0m22:15:31.552283 [debug] [MainThread]: Flushing usage events
[0m22:15:32.957528 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:18:58.872542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1f6c310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa105fd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa105fcd0>]}


============================== 23:18:58.876538 | f9a8d020-8e09-4a14-8d49-53176ca613e9 ==============================
[0m23:18:58.876538 [info ] [MainThread]: Running with dbt=1.9.0
[0m23:18:58.876939 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/airflow/.dbt', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --models fact_waterlevel', 'send_anonymous_usage_stats': 'True'}
[0m23:18:58.978626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f9a8d020-8e09-4a14-8d49-53176ca613e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa07a2290>]}
[0m23:18:59.006362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f9a8d020-8e09-4a14-8d49-53176ca613e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1ebc1c0>]}
[0m23:18:59.006924 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:18:59.042238 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m23:18:59.092492 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:18:59.092828 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:18:59.095894 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m23:18:59.107745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f9a8d020-8e09-4a14-8d49-53176ca613e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa032c550>]}
[0m23:18:59.142912 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m23:18:59.146370 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m23:18:59.156272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f9a8d020-8e09-4a14-8d49-53176ca613e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa034b220>]}
[0m23:18:59.156607 [info ] [MainThread]: Found 3 models, 434 macros
[0m23:18:59.156923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f9a8d020-8e09-4a14-8d49-53176ca613e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa034b1c0>]}
[0m23:18:59.157676 [info ] [MainThread]: 
[0m23:18:59.157977 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:18:59.158252 [info ] [MainThread]: 
[0m23:18:59.158637 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:18:59.159360 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m23:18:59.198605 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m23:18:59.199013 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m23:18:59.199292 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:18:59.202448 [debug] [ThreadPool]: SQL status: SELECT 30 in 0.003 seconds
[0m23:18:59.203197 [debug] [ThreadPool]: On list_airflow: Close
[0m23:18:59.205773 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_fact)
[0m23:18:59.209009 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m23:18:59.209289 [debug] [ThreadPool]: On list_airflow_fact: BEGIN
[0m23:18:59.209540 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:18:59.211251 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m23:18:59.211618 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m23:18:59.211927 [debug] [ThreadPool]: On list_airflow_fact: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_fact"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'fact'
  
[0m23:18:59.213357 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m23:18:59.214030 [debug] [ThreadPool]: On list_airflow_fact: ROLLBACK
[0m23:18:59.214363 [debug] [ThreadPool]: On list_airflow_fact: Close
[0m23:18:59.214781 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_fact, now list_airflow_dim)
[0m23:18:59.216161 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m23:18:59.216426 [debug] [ThreadPool]: On list_airflow_dim: BEGIN
[0m23:18:59.216674 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:18:59.218261 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m23:18:59.218571 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m23:18:59.218858 [debug] [ThreadPool]: On list_airflow_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dim'
  
[0m23:18:59.220127 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.001 seconds
[0m23:18:59.220790 [debug] [ThreadPool]: On list_airflow_dim: ROLLBACK
[0m23:18:59.221114 [debug] [ThreadPool]: On list_airflow_dim: Close
[0m23:18:59.223582 [debug] [MainThread]: Using postgres connection "master"
[0m23:18:59.223876 [debug] [MainThread]: On master: BEGIN
[0m23:18:59.224120 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:18:59.225649 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m23:18:59.225968 [debug] [MainThread]: Using postgres connection "master"
[0m23:18:59.226302 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:18:59.229316 [debug] [MainThread]: SQL status: SELECT 2 in 0.003 seconds
[0m23:18:59.229988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f9a8d020-8e09-4a14-8d49-53176ca613e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3a71f00>]}
[0m23:18:59.230383 [debug] [MainThread]: On master: ROLLBACK
[0m23:18:59.230762 [debug] [MainThread]: Using postgres connection "master"
[0m23:18:59.231018 [debug] [MainThread]: On master: BEGIN
[0m23:18:59.231413 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:18:59.231729 [debug] [MainThread]: On master: COMMIT
[0m23:18:59.231982 [debug] [MainThread]: Using postgres connection "master"
[0m23:18:59.232225 [debug] [MainThread]: On master: COMMIT
[0m23:18:59.232546 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:18:59.232808 [debug] [MainThread]: On master: Close
[0m23:18:59.233966 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.fact_waterlevel
[0m23:18:59.234325 [info ] [Thread-1 (]: 1 of 1 START sql incremental model fact.fact_waterlevel ........................ [RUN]
[0m23:18:59.234657 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_dim, now model.etl_waterlevel.fact_waterlevel)
[0m23:18:59.234935 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.fact_waterlevel
[0m23:18:59.242067 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.fact_waterlevel"
[0m23:18:59.243745 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.fact_waterlevel
[0m23:18:59.272112 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m23:18:59.272512 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

    
  
    

  create temporary table "fact_waterlevel__dbt_tmp231859259981"
  
  
    as
  
  (
    

with main as (
    select
        distinct
        concat("stationId",'_',"stationCode") as station_key,
        "stationId" as station_id,
        "stationCode" as station_code,
        "waterLevel" as water_level,
        "waterlevelStatus" as waterlevel_status,
        case
            when "waterlevelStatus" = 3 then '🚨 Beyond Danger'
            when "waterlevelStatus" = 2 then '⚠️ Between Warning and Danger'
            when "waterlevelStatus" = 1 then '🔶 Between Alert and Warning'
            when "waterlevelStatus" = 0 then '✅ Between Normal and Alert'
            when "waterlevelStatus" = -1 then '🟢 Below Normal (Safe)'
            else '❓ Unknown Status'
        end as waterlevel_condition,
        "stationName",
        "districtName",
        to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp AS last_update
    from
        raw.waterlevels w
    where
        "stationStatus" = 1

        
        /* This condition is important to avoid reprocessing old data */
        and to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp > (
            select max(last_update) from "airflow"."fact"."fact_waterlevel"
        )
        
)

select * from main
  );
  
  
[0m23:18:59.272871 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:18:59.291261 [debug] [Thread-1 (]: SQL status: SELECT 70 in 0.018 seconds
[0m23:18:59.298390 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m23:18:59.298700 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: BEGIN
[0m23:18:59.299114 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m23:18:59.299511 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m23:18:59.299809 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp231859259981'
        
      order by ordinal_position

  
[0m23:18:59.302838 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.003 seconds
[0m23:18:59.305528 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m23:18:59.305854 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m23:18:59.307203 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m23:18:59.313706 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m23:18:59.314019 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp231859259981'
        
      order by ordinal_position

  
[0m23:18:59.315252 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m23:18:59.316921 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m23:18:59.317222 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m23:18:59.318484 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m23:18:59.323013 [debug] [Thread-1 (]: 
    In "airflow"."fact"."fact_waterlevel":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m23:18:59.326362 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.fact_waterlevel"
[0m23:18:59.327263 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m23:18:59.327566 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      insert into "airflow"."fact"."fact_waterlevel" ("station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update")
    (
        select "station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update"
        from "fact_waterlevel__dbt_tmp231859259981"
    )


  
[0m23:18:59.328161 [debug] [Thread-1 (]: SQL status: INSERT 0 70 in 0.000 seconds
[0m23:18:59.335981 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m23:18:59.336277 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m23:18:59.336544 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m23:18:59.337912 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:18:59.338955 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: Close
[0m23:18:59.340345 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9a8d020-8e09-4a14-8d49-53176ca613e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa40e1ae0>]}
[0m23:18:59.341161 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model fact.fact_waterlevel ................... [[32mINSERT 0 70[0m in 0.10s]
[0m23:18:59.341830 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.fact_waterlevel
[0m23:18:59.342778 [debug] [MainThread]: Using postgres connection "master"
[0m23:18:59.343044 [debug] [MainThread]: On master: BEGIN
[0m23:18:59.343347 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:18:59.345545 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m23:18:59.345827 [debug] [MainThread]: On master: COMMIT
[0m23:18:59.346053 [debug] [MainThread]: Using postgres connection "master"
[0m23:18:59.346249 [debug] [MainThread]: On master: COMMIT
[0m23:18:59.346510 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:18:59.346743 [debug] [MainThread]: On master: Close
[0m23:18:59.347016 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:18:59.347231 [debug] [MainThread]: Connection 'model.etl_waterlevel.fact_waterlevel' was properly closed.
[0m23:18:59.347451 [info ] [MainThread]: 
[0m23:18:59.347671 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.19 seconds (0.19s).
[0m23:18:59.348041 [debug] [MainThread]: Command end result
[0m23:18:59.362841 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m23:18:59.363946 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m23:18:59.367616 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m23:18:59.367852 [info ] [MainThread]: 
[0m23:18:59.368171 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:18:59.368412 [info ] [MainThread]: 
[0m23:18:59.368714 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:18:59.369255 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.5229844, "process_in_blocks": "0", "process_kernel_time": 0.125379, "process_mem_max_rss": "111464", "process_out_blocks": "1701", "process_user_time": 1.204648}
[0m23:18:59.369587 [debug] [MainThread]: Command `dbt run` succeeded at 23:18:59.369541 after 0.52 seconds
[0m23:18:59.369836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1f6c310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa07a2290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa51b5c60>]}
[0m23:18:59.370097 [debug] [MainThread]: Flushing usage events
[0m23:19:00.804710 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:16:13.932055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9bc80370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ad6bd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ad6bd30>]}


============================== 00:16:13.935377 | 216158d9-a336-4140-87a0-b8d402b98d57 ==============================
[0m00:16:13.935377 [info ] [MainThread]: Running with dbt=1.9.0
[0m00:16:13.935788 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'profiles_dir': '/home/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --models fact_waterlevel', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:16:14.028567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '216158d9-a336-4140-87a0-b8d402b98d57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9bd10310>]}
[0m00:16:14.055206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '216158d9-a336-4140-87a0-b8d402b98d57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b629810>]}
[0m00:16:14.055670 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m00:16:14.090425 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m00:16:14.141202 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:16:14.141544 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:16:14.144705 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m00:16:14.156596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '216158d9-a336-4140-87a0-b8d402b98d57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99fd05b0>]}
[0m00:16:14.192651 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m00:16:14.196329 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m00:16:14.205723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '216158d9-a336-4140-87a0-b8d402b98d57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99fef220>]}
[0m00:16:14.206075 [info ] [MainThread]: Found 3 models, 434 macros
[0m00:16:14.206317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '216158d9-a336-4140-87a0-b8d402b98d57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99fef1c0>]}
[0m00:16:14.207025 [info ] [MainThread]: 
[0m00:16:14.207305 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:16:14.207615 [info ] [MainThread]: 
[0m00:16:14.208063 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:16:14.208628 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m00:16:14.247962 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m00:16:14.248387 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m00:16:14.248659 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:16:14.251788 [debug] [ThreadPool]: SQL status: SELECT 30 in 0.003 seconds
[0m00:16:14.252535 [debug] [ThreadPool]: On list_airflow: Close
[0m00:16:14.255166 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_fact)
[0m00:16:14.258333 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m00:16:14.258613 [debug] [ThreadPool]: On list_airflow_fact: BEGIN
[0m00:16:14.258857 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:16:14.260483 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m00:16:14.260878 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m00:16:14.261145 [debug] [ThreadPool]: On list_airflow_fact: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_fact"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'fact'
  
[0m00:16:14.262619 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m00:16:14.263256 [debug] [ThreadPool]: On list_airflow_fact: ROLLBACK
[0m00:16:14.263585 [debug] [ThreadPool]: On list_airflow_fact: Close
[0m00:16:14.263968 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_fact, now list_airflow_dim)
[0m00:16:14.265295 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m00:16:14.265548 [debug] [ThreadPool]: On list_airflow_dim: BEGIN
[0m00:16:14.265797 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:16:14.267272 [debug] [ThreadPool]: SQL status: BEGIN in 0.001 seconds
[0m00:16:14.267550 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m00:16:14.267819 [debug] [ThreadPool]: On list_airflow_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dim'
  
[0m00:16:14.269029 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.001 seconds
[0m00:16:14.269638 [debug] [ThreadPool]: On list_airflow_dim: ROLLBACK
[0m00:16:14.269967 [debug] [ThreadPool]: On list_airflow_dim: Close
[0m00:16:14.272430 [debug] [MainThread]: Using postgres connection "master"
[0m00:16:14.272715 [debug] [MainThread]: On master: BEGIN
[0m00:16:14.272974 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:16:14.274751 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m00:16:14.275088 [debug] [MainThread]: Using postgres connection "master"
[0m00:16:14.275396 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:16:14.278565 [debug] [MainThread]: SQL status: SELECT 2 in 0.003 seconds
[0m00:16:14.279232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '216158d9-a336-4140-87a0-b8d402b98d57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9dd8f700>]}
[0m00:16:14.279576 [debug] [MainThread]: On master: ROLLBACK
[0m00:16:14.279938 [debug] [MainThread]: Using postgres connection "master"
[0m00:16:14.280216 [debug] [MainThread]: On master: BEGIN
[0m00:16:14.280622 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m00:16:14.280980 [debug] [MainThread]: On master: COMMIT
[0m00:16:14.281227 [debug] [MainThread]: Using postgres connection "master"
[0m00:16:14.281461 [debug] [MainThread]: On master: COMMIT
[0m00:16:14.281793 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:16:14.282034 [debug] [MainThread]: On master: Close
[0m00:16:14.283178 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.fact_waterlevel
[0m00:16:14.283548 [info ] [Thread-1 (]: 1 of 1 START sql incremental model fact.fact_waterlevel ........................ [RUN]
[0m00:16:14.283865 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_dim, now model.etl_waterlevel.fact_waterlevel)
[0m00:16:14.284139 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.fact_waterlevel
[0m00:16:14.291034 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.fact_waterlevel"
[0m00:16:14.292025 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.fact_waterlevel
[0m00:16:14.319978 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m00:16:14.320358 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

    
  
    

  create temporary table "fact_waterlevel__dbt_tmp001614307701"
  
  
    as
  
  (
    

with main as (
    select
        distinct
        concat("stationId",'_',"stationCode") as station_key,
        "stationId" as station_id,
        "stationCode" as station_code,
        "waterLevel" as water_level,
        "waterlevelStatus" as waterlevel_status,
        case
            when "waterlevelStatus" = 3 then '🚨 Beyond Danger'
            when "waterlevelStatus" = 2 then '⚠️ Between Warning and Danger'
            when "waterlevelStatus" = 1 then '🔶 Between Alert and Warning'
            when "waterlevelStatus" = 0 then '✅ Between Normal and Alert'
            when "waterlevelStatus" = -1 then '🟢 Below Normal (Safe)'
            else '❓ Unknown Status'
        end as waterlevel_condition,
        "stationName",
        "districtName",
        to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp AS last_update
    from
        raw.waterlevels w
    where
        "stationStatus" = 1

        
        /* This condition is important to avoid reprocessing old data */
        and to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp > (
            select max(last_update) from "airflow"."fact"."fact_waterlevel"
        )
        
)

select * from main
  );
  
  
[0m00:16:14.320684 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:16:14.338343 [debug] [Thread-1 (]: SQL status: SELECT 41 in 0.018 seconds
[0m00:16:14.345432 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m00:16:14.345736 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: BEGIN
[0m00:16:14.346156 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m00:16:14.346498 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m00:16:14.346797 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp001614307701'
        
      order by ordinal_position

  
[0m00:16:14.349796 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.003 seconds
[0m00:16:14.352333 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m00:16:14.352668 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m00:16:14.354061 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m00:16:14.360393 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m00:16:14.360696 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp001614307701'
        
      order by ordinal_position

  
[0m00:16:14.361936 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m00:16:14.363564 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m00:16:14.363860 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m00:16:14.365078 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m00:16:14.369576 [debug] [Thread-1 (]: 
    In "airflow"."fact"."fact_waterlevel":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m00:16:14.372959 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.fact_waterlevel"
[0m00:16:14.374227 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m00:16:14.374521 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      insert into "airflow"."fact"."fact_waterlevel" ("station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update")
    (
        select "station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update"
        from "fact_waterlevel__dbt_tmp001614307701"
    )


  
[0m00:16:14.374993 [debug] [Thread-1 (]: SQL status: INSERT 0 41 in 0.000 seconds
[0m00:16:14.382390 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m00:16:14.382697 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m00:16:14.382983 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m00:16:14.383846 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m00:16:14.384844 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: Close
[0m00:16:14.386003 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '216158d9-a336-4140-87a0-b8d402b98d57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99fef9d0>]}
[0m00:16:14.386503 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model fact.fact_waterlevel ................... [[32mINSERT 0 41[0m in 0.10s]
[0m00:16:14.387058 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.fact_waterlevel
[0m00:16:14.387756 [debug] [MainThread]: Using postgres connection "master"
[0m00:16:14.388020 [debug] [MainThread]: On master: BEGIN
[0m00:16:14.388236 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:16:14.389641 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m00:16:14.389928 [debug] [MainThread]: On master: COMMIT
[0m00:16:14.390162 [debug] [MainThread]: Using postgres connection "master"
[0m00:16:14.390382 [debug] [MainThread]: On master: COMMIT
[0m00:16:14.390643 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:16:14.390843 [debug] [MainThread]: On master: Close
[0m00:16:14.391099 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:16:14.391308 [debug] [MainThread]: Connection 'model.etl_waterlevel.fact_waterlevel' was properly closed.
[0m00:16:14.391520 [info ] [MainThread]: 
[0m00:16:14.391753 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.18 seconds (0.18s).
[0m00:16:14.392160 [debug] [MainThread]: Command end result
[0m00:16:14.407229 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m00:16:14.408299 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m00:16:14.411625 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m00:16:14.411855 [info ] [MainThread]: 
[0m00:16:14.412167 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:16:14.412456 [info ] [MainThread]: 
[0m00:16:14.412706 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m00:16:14.413278 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.51051676, "process_in_blocks": "0", "process_kernel_time": 0.112973, "process_mem_max_rss": "111140", "process_out_blocks": "1701", "process_user_time": 1.231714}
[0m00:16:14.413614 [debug] [MainThread]: Command `dbt run` succeeded at 00:16:14.413569 after 0.51 seconds
[0m00:16:14.413868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9bc80370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9bd05d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9948b970>]}
[0m00:16:14.414118 [debug] [MainThread]: Flushing usage events
[0m00:16:20.439836 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:05:06.121839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94d58340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93e584f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93e58550>]}


============================== 01:05:06.126192 | 88b51c81-6a9a-4232-8f92-f01f03da068e ==============================
[0m01:05:06.126192 [info ] [MainThread]: Running with dbt=1.9.0
[0m01:05:06.126573 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --models fact_waterlevel', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m01:05:06.225475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '88b51c81-6a9a-4232-8f92-f01f03da068e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96eca7a0>]}
[0m01:05:06.252391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '88b51c81-6a9a-4232-8f92-f01f03da068e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94c167a0>]}
[0m01:05:06.252921 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m01:05:06.288186 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m01:05:06.341029 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:05:06.341393 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:05:06.344657 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m01:05:06.357050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '88b51c81-6a9a-4232-8f92-f01f03da068e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9307c580>]}
[0m01:05:06.395669 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m01:05:06.399562 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m01:05:06.409840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '88b51c81-6a9a-4232-8f92-f01f03da068e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9309b220>]}
[0m01:05:06.410160 [info ] [MainThread]: Found 3 models, 434 macros
[0m01:05:06.410405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '88b51c81-6a9a-4232-8f92-f01f03da068e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9309b1c0>]}
[0m01:05:06.411142 [info ] [MainThread]: 
[0m01:05:06.411390 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:05:06.411586 [info ] [MainThread]: 
[0m01:05:06.411886 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:05:06.412495 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m01:05:06.453065 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m01:05:06.453482 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m01:05:06.453779 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:05:06.456905 [debug] [ThreadPool]: SQL status: SELECT 30 in 0.003 seconds
[0m01:05:06.457646 [debug] [ThreadPool]: On list_airflow: Close
[0m01:05:06.460295 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_dim)
[0m01:05:06.463554 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m01:05:06.463842 [debug] [ThreadPool]: On list_airflow_dim: BEGIN
[0m01:05:06.464092 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:05:06.465985 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m01:05:06.466355 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m01:05:06.466622 [debug] [ThreadPool]: On list_airflow_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dim'
  
[0m01:05:06.468437 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.001 seconds
[0m01:05:06.469112 [debug] [ThreadPool]: On list_airflow_dim: ROLLBACK
[0m01:05:06.469461 [debug] [ThreadPool]: On list_airflow_dim: Close
[0m01:05:06.469866 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_dim, now list_airflow_fact)
[0m01:05:06.471290 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m01:05:06.471563 [debug] [ThreadPool]: On list_airflow_fact: BEGIN
[0m01:05:06.471813 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:05:06.473522 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m01:05:06.473854 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m01:05:06.474107 [debug] [ThreadPool]: On list_airflow_fact: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_fact"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'fact'
  
[0m01:05:06.475593 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m01:05:06.476229 [debug] [ThreadPool]: On list_airflow_fact: ROLLBACK
[0m01:05:06.476548 [debug] [ThreadPool]: On list_airflow_fact: Close
[0m01:05:06.479053 [debug] [MainThread]: Using postgres connection "master"
[0m01:05:06.479338 [debug] [MainThread]: On master: BEGIN
[0m01:05:06.479579 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:05:06.481353 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m01:05:06.481714 [debug] [MainThread]: Using postgres connection "master"
[0m01:05:06.482058 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m01:05:06.488483 [debug] [MainThread]: SQL status: SELECT 2 in 0.006 seconds
[0m01:05:06.489283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '88b51c81-6a9a-4232-8f92-f01f03da068e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9309ad10>]}
[0m01:05:06.489659 [debug] [MainThread]: On master: ROLLBACK
[0m01:05:06.490015 [debug] [MainThread]: Using postgres connection "master"
[0m01:05:06.490257 [debug] [MainThread]: On master: BEGIN
[0m01:05:06.490649 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m01:05:06.490975 [debug] [MainThread]: On master: COMMIT
[0m01:05:06.491215 [debug] [MainThread]: Using postgres connection "master"
[0m01:05:06.491446 [debug] [MainThread]: On master: COMMIT
[0m01:05:06.491774 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:05:06.492037 [debug] [MainThread]: On master: Close
[0m01:05:06.493416 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.fact_waterlevel
[0m01:05:06.493945 [info ] [Thread-1 (]: 1 of 1 START sql incremental model fact.fact_waterlevel ........................ [RUN]
[0m01:05:06.494381 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_fact, now model.etl_waterlevel.fact_waterlevel)
[0m01:05:06.494749 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.fact_waterlevel
[0m01:05:06.502567 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.fact_waterlevel"
[0m01:05:06.503812 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.fact_waterlevel
[0m01:05:06.532870 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m01:05:06.533278 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

    
  
    

  create temporary table "fact_waterlevel__dbt_tmp010506520496"
  
  
    as
  
  (
    

with main as (
    select
        distinct
        concat("stationId",'_',"stationCode") as station_key,
        "stationId" as station_id,
        "stationCode" as station_code,
        "waterLevel" as water_level,
        "waterlevelStatus" as waterlevel_status,
        case
            when "waterlevelStatus" = 3 then '🚨 Beyond Danger'
            when "waterlevelStatus" = 2 then '⚠️ Between Warning and Danger'
            when "waterlevelStatus" = 1 then '🔶 Between Alert and Warning'
            when "waterlevelStatus" = 0 then '✅ Between Normal and Alert'
            when "waterlevelStatus" = -1 then '🟢 Below Normal (Safe)'
            else '❓ Unknown Status'
        end as waterlevel_condition,
        "stationName",
        "districtName",
        to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp AS last_update
    from
        raw.waterlevels w
    where
        "stationStatus" = 1

        
        /* This condition is important to avoid reprocessing old data */
        and to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp > (
            select max(last_update) from "airflow"."fact"."fact_waterlevel"
        )
        
)

select * from main
  );
  
  
[0m01:05:06.533655 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:05:06.552274 [debug] [Thread-1 (]: SQL status: SELECT 41 in 0.019 seconds
[0m01:05:06.560013 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m01:05:06.560334 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: BEGIN
[0m01:05:06.560769 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m01:05:06.561135 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m01:05:06.561423 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp010506520496'
        
      order by ordinal_position

  
[0m01:05:06.564717 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.003 seconds
[0m01:05:06.567520 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m01:05:06.567832 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m01:05:06.569250 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m01:05:06.575816 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m01:05:06.576133 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp010506520496'
        
      order by ordinal_position

  
[0m01:05:06.577381 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m01:05:06.579135 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m01:05:06.579446 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m01:05:06.580654 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m01:05:06.585349 [debug] [Thread-1 (]: 
    In "airflow"."fact"."fact_waterlevel":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m01:05:06.588878 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.fact_waterlevel"
[0m01:05:06.589778 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m01:05:06.590081 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      insert into "airflow"."fact"."fact_waterlevel" ("station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update")
    (
        select "station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update"
        from "fact_waterlevel__dbt_tmp010506520496"
    )


  
[0m01:05:06.590791 [debug] [Thread-1 (]: SQL status: INSERT 0 41 in 0.000 seconds
[0m01:05:06.598505 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m01:05:06.598801 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m01:05:06.599068 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m01:05:06.599871 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m01:05:06.600985 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: Close
[0m01:05:06.602237 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '88b51c81-6a9a-4232-8f92-f01f03da068e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96eca7d0>]}
[0m01:05:06.602724 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model fact.fact_waterlevel ................... [[32mINSERT 0 41[0m in 0.11s]
[0m01:05:06.603121 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.fact_waterlevel
[0m01:05:06.603846 [debug] [MainThread]: Using postgres connection "master"
[0m01:05:06.604069 [debug] [MainThread]: On master: BEGIN
[0m01:05:06.604258 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:05:06.605810 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m01:05:06.606100 [debug] [MainThread]: On master: COMMIT
[0m01:05:06.606351 [debug] [MainThread]: Using postgres connection "master"
[0m01:05:06.606564 [debug] [MainThread]: On master: COMMIT
[0m01:05:06.606817 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:05:06.607068 [debug] [MainThread]: On master: Close
[0m01:05:06.607351 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:05:06.607561 [debug] [MainThread]: Connection 'model.etl_waterlevel.fact_waterlevel' was properly closed.
[0m01:05:06.607777 [info ] [MainThread]: 
[0m01:05:06.608009 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.20 seconds (0.20s).
[0m01:05:06.608376 [debug] [MainThread]: Command end result
[0m01:05:06.623232 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m01:05:06.624415 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m01:05:06.628172 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m01:05:06.628397 [info ] [MainThread]: 
[0m01:05:06.628661 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:05:06.628919 [info ] [MainThread]: 
[0m01:05:06.629199 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m01:05:06.629818 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.5343144, "process_in_blocks": "0", "process_kernel_time": 0.120018, "process_mem_max_rss": "111200", "process_out_blocks": "1701", "process_user_time": 1.25719}
[0m01:05:06.630168 [debug] [MainThread]: Command `dbt run` succeeded at 01:05:06.630117 after 0.53 seconds
[0m01:05:06.630423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94d58340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff933ac0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97f1c550>]}
[0m01:05:06.630661 [debug] [MainThread]: Flushing usage events
[0m01:05:07.954985 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:05:05.801268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb01442b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf247cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf247c70>]}


============================== 02:05:05.805273 | 75a1384c-a021-45bf-9700-08c6af81ecae ==============================
[0m02:05:05.805273 [info ] [MainThread]: Running with dbt=1.9.0
[0m02:05:05.805670 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/airflow/.dbt', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --models fact_waterlevel', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m02:05:05.910295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '75a1384c-a021-45bf-9700-08c6af81ecae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2243d60>]}
[0m02:05:05.940530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '75a1384c-a021-45bf-9700-08c6af81ecae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb008c100>]}
[0m02:05:05.941108 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m02:05:05.978437 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m02:05:06.034477 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:05:06.034867 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:05:06.038171 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m02:05:06.051379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '75a1384c-a021-45bf-9700-08c6af81ecae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae4444f0>]}
[0m02:05:06.091581 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m02:05:06.095411 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m02:05:06.105704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '75a1384c-a021-45bf-9700-08c6af81ecae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae463220>]}
[0m02:05:06.106040 [info ] [MainThread]: Found 3 models, 434 macros
[0m02:05:06.106288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '75a1384c-a021-45bf-9700-08c6af81ecae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae4631c0>]}
[0m02:05:06.107049 [info ] [MainThread]: 
[0m02:05:06.107420 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:05:06.107848 [info ] [MainThread]: 
[0m02:05:06.108334 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:05:06.108967 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m02:05:06.152653 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m02:05:06.153081 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m02:05:06.153431 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:05:06.157440 [debug] [ThreadPool]: SQL status: SELECT 30 in 0.004 seconds
[0m02:05:06.158324 [debug] [ThreadPool]: On list_airflow: Close
[0m02:05:06.161153 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_fact)
[0m02:05:06.164574 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m02:05:06.164861 [debug] [ThreadPool]: On list_airflow_fact: BEGIN
[0m02:05:06.165112 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:05:06.166814 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m02:05:06.167273 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m02:05:06.167541 [debug] [ThreadPool]: On list_airflow_fact: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_fact"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'fact'
  
[0m02:05:06.168998 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m02:05:06.169695 [debug] [ThreadPool]: On list_airflow_fact: ROLLBACK
[0m02:05:06.170014 [debug] [ThreadPool]: On list_airflow_fact: Close
[0m02:05:06.170419 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_fact, now list_airflow_dim)
[0m02:05:06.171836 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m02:05:06.172094 [debug] [ThreadPool]: On list_airflow_dim: BEGIN
[0m02:05:06.172335 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:05:06.174016 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m02:05:06.174321 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m02:05:06.174594 [debug] [ThreadPool]: On list_airflow_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dim'
  
[0m02:05:06.175889 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.001 seconds
[0m02:05:06.176559 [debug] [ThreadPool]: On list_airflow_dim: ROLLBACK
[0m02:05:06.176866 [debug] [ThreadPool]: On list_airflow_dim: Close
[0m02:05:06.179541 [debug] [MainThread]: Using postgres connection "master"
[0m02:05:06.179814 [debug] [MainThread]: On master: BEGIN
[0m02:05:06.180050 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:05:06.181660 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m02:05:06.181972 [debug] [MainThread]: Using postgres connection "master"
[0m02:05:06.182319 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:05:06.185777 [debug] [MainThread]: SQL status: SELECT 2 in 0.003 seconds
[0m02:05:06.186501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '75a1384c-a021-45bf-9700-08c6af81ecae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf5e0100>]}
[0m02:05:06.186840 [debug] [MainThread]: On master: ROLLBACK
[0m02:05:06.187178 [debug] [MainThread]: Using postgres connection "master"
[0m02:05:06.187418 [debug] [MainThread]: On master: BEGIN
[0m02:05:06.187828 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m02:05:06.188118 [debug] [MainThread]: On master: COMMIT
[0m02:05:06.188369 [debug] [MainThread]: Using postgres connection "master"
[0m02:05:06.188604 [debug] [MainThread]: On master: COMMIT
[0m02:05:06.188906 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m02:05:06.189152 [debug] [MainThread]: On master: Close
[0m02:05:06.190378 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.fact_waterlevel
[0m02:05:06.190747 [info ] [Thread-1 (]: 1 of 1 START sql incremental model fact.fact_waterlevel ........................ [RUN]
[0m02:05:06.191074 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_dim, now model.etl_waterlevel.fact_waterlevel)
[0m02:05:06.191362 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.fact_waterlevel
[0m02:05:06.199084 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.fact_waterlevel"
[0m02:05:06.200356 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.fact_waterlevel
[0m02:05:06.230664 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m02:05:06.231077 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

    
  
    

  create temporary table "fact_waterlevel__dbt_tmp020506217551"
  
  
    as
  
  (
    

with main as (
    select
        distinct
        concat("stationId",'_',"stationCode") as station_key,
        "stationId" as station_id,
        "stationCode" as station_code,
        "waterLevel" as water_level,
        "waterlevelStatus" as waterlevel_status,
        case
            when "waterlevelStatus" = 3 then '🚨 Beyond Danger'
            when "waterlevelStatus" = 2 then '⚠️ Between Warning and Danger'
            when "waterlevelStatus" = 1 then '🔶 Between Alert and Warning'
            when "waterlevelStatus" = 0 then '✅ Between Normal and Alert'
            when "waterlevelStatus" = -1 then '🟢 Below Normal (Safe)'
            else '❓ Unknown Status'
        end as waterlevel_condition,
        "stationName",
        "districtName",
        to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp AS last_update
    from
        raw.waterlevels w
    where
        "stationStatus" = 1

        
        /* This condition is important to avoid reprocessing old data */
        and to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp > (
            select max(last_update) from "airflow"."fact"."fact_waterlevel"
        )
        
)

select * from main
  );
  
  
[0m02:05:06.231462 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:05:06.252094 [debug] [Thread-1 (]: SQL status: SELECT 41 in 0.021 seconds
[0m02:05:06.260749 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m02:05:06.261120 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: BEGIN
[0m02:05:06.261627 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m02:05:06.261940 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m02:05:06.262223 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp020506217551'
        
      order by ordinal_position

  
[0m02:05:06.265447 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.003 seconds
[0m02:05:06.268590 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m02:05:06.268923 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m02:05:06.270372 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m02:05:06.277832 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m02:05:06.278193 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp020506217551'
        
      order by ordinal_position

  
[0m02:05:06.279558 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m02:05:06.281388 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m02:05:06.281699 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m02:05:06.282960 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m02:05:06.288131 [debug] [Thread-1 (]: 
    In "airflow"."fact"."fact_waterlevel":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m02:05:06.292106 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.fact_waterlevel"
[0m02:05:06.293124 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m02:05:06.293459 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      insert into "airflow"."fact"."fact_waterlevel" ("station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update")
    (
        select "station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update"
        from "fact_waterlevel__dbt_tmp020506217551"
    )


  
[0m02:05:06.294099 [debug] [Thread-1 (]: SQL status: INSERT 0 41 in 0.000 seconds
[0m02:05:06.302881 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m02:05:06.303207 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m02:05:06.303448 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m02:05:06.304156 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m02:05:06.307070 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: Close
[0m02:05:06.309446 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '75a1384c-a021-45bf-9700-08c6af81ecae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb22acaf0>]}
[0m02:05:06.310007 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model fact.fact_waterlevel ................... [[32mINSERT 0 41[0m in 0.12s]
[0m02:05:06.310479 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.fact_waterlevel
[0m02:05:06.311223 [debug] [MainThread]: Using postgres connection "master"
[0m02:05:06.311509 [debug] [MainThread]: On master: BEGIN
[0m02:05:06.311753 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:05:06.313616 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m02:05:06.313929 [debug] [MainThread]: On master: COMMIT
[0m02:05:06.314178 [debug] [MainThread]: Using postgres connection "master"
[0m02:05:06.314418 [debug] [MainThread]: On master: COMMIT
[0m02:05:06.314682 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m02:05:06.314886 [debug] [MainThread]: On master: Close
[0m02:05:06.315169 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:05:06.315684 [debug] [MainThread]: Connection 'model.etl_waterlevel.fact_waterlevel' was properly closed.
[0m02:05:06.316233 [info ] [MainThread]: 
[0m02:05:06.316484 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.21 seconds (0.21s).
[0m02:05:06.316879 [debug] [MainThread]: Command end result
[0m02:05:06.332629 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m02:05:06.334478 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m02:05:06.338289 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m02:05:06.338555 [info ] [MainThread]: 
[0m02:05:06.338820 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:05:06.339040 [info ] [MainThread]: 
[0m02:05:06.339377 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m02:05:06.339983 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.5690945, "process_in_blocks": "0", "process_kernel_time": 0.136622, "process_mem_max_rss": "111388", "process_out_blocks": "1701", "process_user_time": 1.436543}
[0m02:05:06.340530 [debug] [MainThread]: Command `dbt run` succeeded at 02:05:06.340465 after 0.57 seconds
[0m02:05:06.340800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb01442b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2243d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0159bd0>]}
[0m02:05:06.341058 [debug] [MainThread]: Flushing usage events
[0m02:05:07.875634 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:05:05.977556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa22882e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1368520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1368580>]}


============================== 03:05:05.981403 | 5addd299-06e0-4236-9879-aa8228b3dccf ==============================
[0m03:05:05.981403 [info ] [MainThread]: Running with dbt=1.9.0
[0m03:05:05.981788 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'profiles_dir': '/home/airflow/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --models fact_waterlevel', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m03:05:06.079096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5addd299-06e0-4236-9879-aa8228b3dccf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0aaa9e0>]}
[0m03:05:06.108873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5addd299-06e0-4236-9879-aa8228b3dccf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1368040>]}
[0m03:05:06.109455 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m03:05:06.145533 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m03:05:06.200109 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:05:06.200510 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:05:06.204069 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m03:05:06.216714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5addd299-06e0-4236-9879-aa8228b3dccf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0618520>]}
[0m03:05:06.255279 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m03:05:06.259690 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m03:05:06.281028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5addd299-06e0-4236-9879-aa8228b3dccf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0637220>]}
[0m03:05:06.281444 [info ] [MainThread]: Found 3 models, 434 macros
[0m03:05:06.281694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5addd299-06e0-4236-9879-aa8228b3dccf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa06371c0>]}
[0m03:05:06.282453 [info ] [MainThread]: 
[0m03:05:06.282710 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:05:06.282915 [info ] [MainThread]: 
[0m03:05:06.283244 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m03:05:06.283869 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m03:05:06.330527 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m03:05:06.330977 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m03:05:06.331256 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:05:06.334360 [debug] [ThreadPool]: SQL status: SELECT 30 in 0.003 seconds
[0m03:05:06.335244 [debug] [ThreadPool]: On list_airflow: Close
[0m03:05:06.338219 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_dim)
[0m03:05:06.341903 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m03:05:06.342203 [debug] [ThreadPool]: On list_airflow_dim: BEGIN
[0m03:05:06.342457 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:05:06.344456 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m03:05:06.344934 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m03:05:06.345519 [debug] [ThreadPool]: On list_airflow_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dim'
  
[0m03:05:06.347304 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.001 seconds
[0m03:05:06.348106 [debug] [ThreadPool]: On list_airflow_dim: ROLLBACK
[0m03:05:06.348622 [debug] [ThreadPool]: On list_airflow_dim: Close
[0m03:05:06.349110 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_dim, now list_airflow_fact)
[0m03:05:06.351102 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m03:05:06.351405 [debug] [ThreadPool]: On list_airflow_fact: BEGIN
[0m03:05:06.351744 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:05:06.353503 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m03:05:06.353972 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m03:05:06.354279 [debug] [ThreadPool]: On list_airflow_fact: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_fact"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'fact'
  
[0m03:05:06.355771 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m03:05:06.356651 [debug] [ThreadPool]: On list_airflow_fact: ROLLBACK
[0m03:05:06.357016 [debug] [ThreadPool]: On list_airflow_fact: Close
[0m03:05:06.359752 [debug] [MainThread]: Using postgres connection "master"
[0m03:05:06.360163 [debug] [MainThread]: On master: BEGIN
[0m03:05:06.360560 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:05:06.362296 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m03:05:06.362703 [debug] [MainThread]: Using postgres connection "master"
[0m03:05:06.363088 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m03:05:06.366603 [debug] [MainThread]: SQL status: SELECT 2 in 0.003 seconds
[0m03:05:06.367360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5addd299-06e0-4236-9879-aa8228b3dccf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0636c50>]}
[0m03:05:06.367741 [debug] [MainThread]: On master: ROLLBACK
[0m03:05:06.368366 [debug] [MainThread]: Using postgres connection "master"
[0m03:05:06.368658 [debug] [MainThread]: On master: BEGIN
[0m03:05:06.369153 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m03:05:06.369693 [debug] [MainThread]: On master: COMMIT
[0m03:05:06.370002 [debug] [MainThread]: Using postgres connection "master"
[0m03:05:06.370271 [debug] [MainThread]: On master: COMMIT
[0m03:05:06.370605 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m03:05:06.370918 [debug] [MainThread]: On master: Close
[0m03:05:06.372541 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.fact_waterlevel
[0m03:05:06.372964 [info ] [Thread-1 (]: 1 of 1 START sql incremental model fact.fact_waterlevel ........................ [RUN]
[0m03:05:06.373322 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_fact, now model.etl_waterlevel.fact_waterlevel)
[0m03:05:06.373675 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.fact_waterlevel
[0m03:05:06.382373 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.fact_waterlevel"
[0m03:05:06.383999 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.fact_waterlevel
[0m03:05:06.415867 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m03:05:06.416321 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

    
  
    

  create temporary table "fact_waterlevel__dbt_tmp030506402381"
  
  
    as
  
  (
    

with main as (
    select
        distinct
        concat("stationId",'_',"stationCode") as station_key,
        "stationId" as station_id,
        "stationCode" as station_code,
        "waterLevel" as water_level,
        "waterlevelStatus" as waterlevel_status,
        case
            when "waterlevelStatus" = 3 then '🚨 Beyond Danger'
            when "waterlevelStatus" = 2 then '⚠️ Between Warning and Danger'
            when "waterlevelStatus" = 1 then '🔶 Between Alert and Warning'
            when "waterlevelStatus" = 0 then '✅ Between Normal and Alert'
            when "waterlevelStatus" = -1 then '🟢 Below Normal (Safe)'
            else '❓ Unknown Status'
        end as waterlevel_condition,
        "stationName",
        "districtName",
        to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp AS last_update
    from
        raw.waterlevels w
    where
        "stationStatus" = 1

        
        /* This condition is important to avoid reprocessing old data */
        and to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp > (
            select max(last_update) from "airflow"."fact"."fact_waterlevel"
        )
        
)

select * from main
  );
  
  
[0m03:05:06.416667 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:05:06.437590 [debug] [Thread-1 (]: SQL status: SELECT 41 in 0.021 seconds
[0m03:05:06.446946 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m03:05:06.447317 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: BEGIN
[0m03:05:06.447739 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m03:05:06.448112 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m03:05:06.448410 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp030506402381'
        
      order by ordinal_position

  
[0m03:05:06.451769 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.003 seconds
[0m03:05:06.454808 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m03:05:06.455116 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m03:05:06.456828 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m03:05:06.464211 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m03:05:06.464724 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp030506402381'
        
      order by ordinal_position

  
[0m03:05:06.466285 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m03:05:06.468169 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m03:05:06.468450 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m03:05:06.469684 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m03:05:06.475028 [debug] [Thread-1 (]: 
    In "airflow"."fact"."fact_waterlevel":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m03:05:06.478716 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.fact_waterlevel"
[0m03:05:06.479479 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m03:05:06.479774 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      insert into "airflow"."fact"."fact_waterlevel" ("station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update")
    (
        select "station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update"
        from "fact_waterlevel__dbt_tmp030506402381"
    )


  
[0m03:05:06.480397 [debug] [Thread-1 (]: SQL status: INSERT 0 41 in 0.000 seconds
[0m03:05:06.488765 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m03:05:06.489074 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m03:05:06.489312 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m03:05:06.490085 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m03:05:06.491429 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: Close
[0m03:05:06.492741 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5addd299-06e0-4236-9879-aa8228b3dccf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa43dcc40>]}
[0m03:05:06.493357 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model fact.fact_waterlevel ................... [[32mINSERT 0 41[0m in 0.12s]
[0m03:05:06.493821 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.fact_waterlevel
[0m03:05:06.496072 [debug] [MainThread]: Using postgres connection "master"
[0m03:05:06.496300 [debug] [MainThread]: On master: BEGIN
[0m03:05:06.496499 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:05:06.498388 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m03:05:06.498769 [debug] [MainThread]: On master: COMMIT
[0m03:05:06.499238 [debug] [MainThread]: Using postgres connection "master"
[0m03:05:06.499456 [debug] [MainThread]: On master: COMMIT
[0m03:05:06.499721 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m03:05:06.499928 [debug] [MainThread]: On master: Close
[0m03:05:06.500207 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:05:06.500468 [debug] [MainThread]: Connection 'model.etl_waterlevel.fact_waterlevel' was properly closed.
[0m03:05:06.500735 [info ] [MainThread]: 
[0m03:05:06.500979 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.22 seconds (0.22s).
[0m03:05:06.501411 [debug] [MainThread]: Command end result
[0m03:05:06.516514 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m03:05:06.517929 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m03:05:06.521699 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m03:05:06.522118 [info ] [MainThread]: 
[0m03:05:06.522423 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:05:06.522681 [info ] [MainThread]: 
[0m03:05:06.522930 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m03:05:06.523768 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.5769542, "process_in_blocks": "0", "process_kernel_time": 0.128991, "process_mem_max_rss": "111284", "process_out_blocks": "1701", "process_user_time": 1.570422}
[0m03:05:06.524139 [debug] [MainThread]: Command `dbt run` succeeded at 03:05:06.524090 after 0.58 seconds
[0m03:05:06.524403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa22882e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0aaa9e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa136c100>]}
[0m03:05:06.524660 [debug] [MainThread]: Flushing usage events
[0m03:05:07.857309 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m04:05:05.669582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8507c2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8416bd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8416bca0>]}


============================== 04:05:05.673786 | e3df19f0-e585-4613-bfe6-97ff5021bcce ==============================
[0m04:05:05.673786 [info ] [MainThread]: Running with dbt=1.9.0
[0m04:05:05.674174 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --models fact_waterlevel', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m04:05:05.767284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e3df19f0-e585-4613-bfe6-97ff5021bcce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff838329e0>]}
[0m04:05:05.794200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e3df19f0-e585-4613-bfe6-97ff5021bcce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84168bb0>]}
[0m04:05:05.794774 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m04:05:05.829215 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m04:05:05.880400 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:05:05.880709 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:05:05.883827 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m04:05:05.895546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e3df19f0-e585-4613-bfe6-97ff5021bcce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff833a8520>]}
[0m04:05:05.931363 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m04:05:05.935307 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m04:05:05.944816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e3df19f0-e585-4613-bfe6-97ff5021bcce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff833c7220>]}
[0m04:05:05.945130 [info ] [MainThread]: Found 3 models, 434 macros
[0m04:05:05.945379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e3df19f0-e585-4613-bfe6-97ff5021bcce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff833c71c0>]}
[0m04:05:05.946095 [info ] [MainThread]: 
[0m04:05:05.946394 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:05:05.946707 [info ] [MainThread]: 
[0m04:05:05.947062 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m04:05:05.947677 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m04:05:05.987920 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m04:05:05.988360 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m04:05:05.988671 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:05:05.991808 [debug] [ThreadPool]: SQL status: SELECT 32 in 0.003 seconds
[0m04:05:05.992643 [debug] [ThreadPool]: On list_airflow: Close
[0m04:05:05.995322 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_fact)
[0m04:05:05.998620 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m04:05:05.998904 [debug] [ThreadPool]: On list_airflow_fact: BEGIN
[0m04:05:05.999155 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:05:06.000745 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m04:05:06.001105 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m04:05:06.001374 [debug] [ThreadPool]: On list_airflow_fact: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_fact"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'fact'
  
[0m04:05:06.002828 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m04:05:06.003516 [debug] [ThreadPool]: On list_airflow_fact: ROLLBACK
[0m04:05:06.003858 [debug] [ThreadPool]: On list_airflow_fact: Close
[0m04:05:06.004257 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_fact, now list_airflow_dim)
[0m04:05:06.005585 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m04:05:06.005842 [debug] [ThreadPool]: On list_airflow_dim: BEGIN
[0m04:05:06.006077 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:05:06.007527 [debug] [ThreadPool]: SQL status: BEGIN in 0.001 seconds
[0m04:05:06.007794 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m04:05:06.008060 [debug] [ThreadPool]: On list_airflow_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dim'
  
[0m04:05:06.009314 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.001 seconds
[0m04:05:06.009928 [debug] [ThreadPool]: On list_airflow_dim: ROLLBACK
[0m04:05:06.010244 [debug] [ThreadPool]: On list_airflow_dim: Close
[0m04:05:06.012790 [debug] [MainThread]: Using postgres connection "master"
[0m04:05:06.013061 [debug] [MainThread]: On master: BEGIN
[0m04:05:06.013296 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:05:06.014818 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m04:05:06.015135 [debug] [MainThread]: Using postgres connection "master"
[0m04:05:06.015455 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m04:05:06.018460 [debug] [MainThread]: SQL status: SELECT 2 in 0.003 seconds
[0m04:05:06.019110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e3df19f0-e585-4613-bfe6-97ff5021bcce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87200ca0>]}
[0m04:05:06.019440 [debug] [MainThread]: On master: ROLLBACK
[0m04:05:06.019765 [debug] [MainThread]: Using postgres connection "master"
[0m04:05:06.020016 [debug] [MainThread]: On master: BEGIN
[0m04:05:06.020418 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m04:05:06.020711 [debug] [MainThread]: On master: COMMIT
[0m04:05:06.020952 [debug] [MainThread]: Using postgres connection "master"
[0m04:05:06.021192 [debug] [MainThread]: On master: COMMIT
[0m04:05:06.021529 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m04:05:06.021779 [debug] [MainThread]: On master: Close
[0m04:05:06.022962 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.fact_waterlevel
[0m04:05:06.023348 [info ] [Thread-1 (]: 1 of 1 START sql incremental model fact.fact_waterlevel ........................ [RUN]
[0m04:05:06.023662 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_dim, now model.etl_waterlevel.fact_waterlevel)
[0m04:05:06.023931 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.fact_waterlevel
[0m04:05:06.031069 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.fact_waterlevel"
[0m04:05:06.032904 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.fact_waterlevel
[0m04:05:06.061175 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m04:05:06.061585 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

    
  
    

  create temporary table "fact_waterlevel__dbt_tmp040506049140"
  
  
    as
  
  (
    

with main as (
    select
        distinct
        concat("stationId",'_',"stationCode") as station_key,
        "stationId" as station_id,
        "stationCode" as station_code,
        "waterLevel" as water_level,
        "waterlevelStatus" as waterlevel_status,
        case
            when "waterlevelStatus" = 3 then '🚨 Beyond Danger'
            when "waterlevelStatus" = 2 then '⚠️ Between Warning and Danger'
            when "waterlevelStatus" = 1 then '🔶 Between Alert and Warning'
            when "waterlevelStatus" = 0 then '✅ Between Normal and Alert'
            when "waterlevelStatus" = -1 then '🟢 Below Normal (Safe)'
            else '❓ Unknown Status'
        end as waterlevel_condition,
        "stationName",
        "districtName",
        to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp AS last_update
    from
        raw.waterlevels w
    where
        "stationStatus" = 1

        
        /* This condition is important to avoid reprocessing old data */
        and to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp > (
            select max(last_update) from "airflow"."fact"."fact_waterlevel"
        )
        
)

select * from main
  );
  
  
[0m04:05:06.061920 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:05:06.079584 [debug] [Thread-1 (]: SQL status: SELECT 41 in 0.018 seconds
[0m04:05:06.086815 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m04:05:06.087128 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: BEGIN
[0m04:05:06.087610 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m04:05:06.087966 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m04:05:06.088269 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp040506049140'
        
      order by ordinal_position

  
[0m04:05:06.091223 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.003 seconds
[0m04:05:06.093883 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m04:05:06.094199 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m04:05:06.095585 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m04:05:06.102078 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m04:05:06.102400 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp040506049140'
        
      order by ordinal_position

  
[0m04:05:06.103626 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m04:05:06.105330 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m04:05:06.105633 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m04:05:06.106804 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m04:05:06.111421 [debug] [Thread-1 (]: 
    In "airflow"."fact"."fact_waterlevel":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m04:05:06.114869 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.fact_waterlevel"
[0m04:05:06.115864 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m04:05:06.116175 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      insert into "airflow"."fact"."fact_waterlevel" ("station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update")
    (
        select "station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update"
        from "fact_waterlevel__dbt_tmp040506049140"
    )


  
[0m04:05:06.116733 [debug] [Thread-1 (]: SQL status: INSERT 0 41 in 0.000 seconds
[0m04:05:06.124241 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m04:05:06.124543 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m04:05:06.124817 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m04:05:06.126410 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m04:05:06.127483 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: Close
[0m04:05:06.128635 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3df19f0-e585-4613-bfe6-97ff5021bcce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8726e770>]}
[0m04:05:06.129129 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model fact.fact_waterlevel ................... [[32mINSERT 0 41[0m in 0.10s]
[0m04:05:06.129538 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.fact_waterlevel
[0m04:05:06.130234 [debug] [MainThread]: Using postgres connection "master"
[0m04:05:06.130461 [debug] [MainThread]: On master: BEGIN
[0m04:05:06.130665 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m04:05:06.132148 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m04:05:06.132434 [debug] [MainThread]: On master: COMMIT
[0m04:05:06.132658 [debug] [MainThread]: Using postgres connection "master"
[0m04:05:06.132852 [debug] [MainThread]: On master: COMMIT
[0m04:05:06.133088 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m04:05:06.133284 [debug] [MainThread]: On master: Close
[0m04:05:06.133546 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:05:06.133761 [debug] [MainThread]: Connection 'model.etl_waterlevel.fact_waterlevel' was properly closed.
[0m04:05:06.133996 [info ] [MainThread]: 
[0m04:05:06.134237 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.19 seconds (0.19s).
[0m04:05:06.134638 [debug] [MainThread]: Command end result
[0m04:05:06.149175 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m04:05:06.150352 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m04:05:06.153858 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m04:05:06.154075 [info ] [MainThread]: 
[0m04:05:06.154343 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:05:06.154601 [info ] [MainThread]: 
[0m04:05:06.154824 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m04:05:06.155334 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.5119987, "process_in_blocks": "0", "process_kernel_time": 0.090348, "process_mem_max_rss": "111356", "process_out_blocks": "1701", "process_user_time": 1.245808}
[0m04:05:06.155652 [debug] [MainThread]: Command `dbt run` succeeded at 04:05:06.155607 after 0.51 seconds
[0m04:05:06.155888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8507c2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84160100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83374820>]}
[0m04:05:06.156142 [debug] [MainThread]: Flushing usage events
[0m04:05:07.417504 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m05:05:06.164772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a76c340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff998544f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99854550>]}


============================== 05:05:06.168950 | aa86f0da-cda6-4fce-94e6-5c2e87503dc4 ==============================
[0m05:05:06.168950 [info ] [MainThread]: Running with dbt=1.9.0
[0m05:05:06.169456 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/airflow/.dbt', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --models fact_waterlevel', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m05:05:06.273246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aa86f0da-cda6-4fce-94e6-5c2e87503dc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c9527a0>]}
[0m05:05:06.303524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aa86f0da-cda6-4fce-94e6-5c2e87503dc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99bf8220>]}
[0m05:05:06.304203 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m05:05:06.344054 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m05:05:06.403476 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:05:06.404018 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:05:06.407505 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m05:05:06.420459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aa86f0da-cda6-4fce-94e6-5c2e87503dc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98b2c550>]}
[0m05:05:06.460047 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m05:05:06.464165 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m05:05:06.475942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aa86f0da-cda6-4fce-94e6-5c2e87503dc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98b4b220>]}
[0m05:05:06.476477 [info ] [MainThread]: Found 3 models, 434 macros
[0m05:05:06.476785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aa86f0da-cda6-4fce-94e6-5c2e87503dc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98b4b1c0>]}
[0m05:05:06.477640 [info ] [MainThread]: 
[0m05:05:06.477938 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m05:05:06.478176 [info ] [MainThread]: 
[0m05:05:06.478538 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m05:05:06.479304 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m05:05:06.538105 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m05:05:06.538606 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m05:05:06.538907 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:05:06.542623 [debug] [ThreadPool]: SQL status: SELECT 32 in 0.004 seconds
[0m05:05:06.543543 [debug] [ThreadPool]: On list_airflow: Close
[0m05:05:06.546665 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_dim)
[0m05:05:06.550469 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m05:05:06.550818 [debug] [ThreadPool]: On list_airflow_dim: BEGIN
[0m05:05:06.551165 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:05:06.553474 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m05:05:06.554050 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m05:05:06.554413 [debug] [ThreadPool]: On list_airflow_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dim'
  
[0m05:05:06.556136 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.001 seconds
[0m05:05:06.556989 [debug] [ThreadPool]: On list_airflow_dim: ROLLBACK
[0m05:05:06.557330 [debug] [ThreadPool]: On list_airflow_dim: Close
[0m05:05:06.557822 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_dim, now list_airflow_fact)
[0m05:05:06.559484 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m05:05:06.559756 [debug] [ThreadPool]: On list_airflow_fact: BEGIN
[0m05:05:06.559990 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:05:06.562115 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m05:05:06.562505 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m05:05:06.562805 [debug] [ThreadPool]: On list_airflow_fact: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_fact"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'fact'
  
[0m05:05:06.564343 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m05:05:06.565153 [debug] [ThreadPool]: On list_airflow_fact: ROLLBACK
[0m05:05:06.565495 [debug] [ThreadPool]: On list_airflow_fact: Close
[0m05:05:06.568691 [debug] [MainThread]: Using postgres connection "master"
[0m05:05:06.569017 [debug] [MainThread]: On master: BEGIN
[0m05:05:06.569286 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:05:06.571462 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m05:05:06.571816 [debug] [MainThread]: Using postgres connection "master"
[0m05:05:06.572146 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m05:05:06.576031 [debug] [MainThread]: SQL status: SELECT 2 in 0.003 seconds
[0m05:05:06.576858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aa86f0da-cda6-4fce-94e6-5c2e87503dc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98b4ac50>]}
[0m05:05:06.577229 [debug] [MainThread]: On master: ROLLBACK
[0m05:05:06.577619 [debug] [MainThread]: Using postgres connection "master"
[0m05:05:06.577896 [debug] [MainThread]: On master: BEGIN
[0m05:05:06.578320 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m05:05:06.578641 [debug] [MainThread]: On master: COMMIT
[0m05:05:06.578905 [debug] [MainThread]: Using postgres connection "master"
[0m05:05:06.579158 [debug] [MainThread]: On master: COMMIT
[0m05:05:06.579492 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m05:05:06.579784 [debug] [MainThread]: On master: Close
[0m05:05:06.581167 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.fact_waterlevel
[0m05:05:06.581639 [info ] [Thread-1 (]: 1 of 1 START sql incremental model fact.fact_waterlevel ........................ [RUN]
[0m05:05:06.581992 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_fact, now model.etl_waterlevel.fact_waterlevel)
[0m05:05:06.582287 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.fact_waterlevel
[0m05:05:06.590513 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.fact_waterlevel"
[0m05:05:06.592468 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.fact_waterlevel
[0m05:05:06.624488 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m05:05:06.625007 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

    
  
    

  create temporary table "fact_waterlevel__dbt_tmp050506610968"
  
  
    as
  
  (
    

with main as (
    select
        distinct
        concat("stationId",'_',"stationCode") as station_key,
        "stationId" as station_id,
        "stationCode" as station_code,
        "waterLevel" as water_level,
        "waterlevelStatus" as waterlevel_status,
        case
            when "waterlevelStatus" = 3 then '🚨 Beyond Danger'
            when "waterlevelStatus" = 2 then '⚠️ Between Warning and Danger'
            when "waterlevelStatus" = 1 then '🔶 Between Alert and Warning'
            when "waterlevelStatus" = 0 then '✅ Between Normal and Alert'
            when "waterlevelStatus" = -1 then '🟢 Below Normal (Safe)'
            else '❓ Unknown Status'
        end as waterlevel_condition,
        "stationName",
        "districtName",
        to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp AS last_update
    from
        raw.waterlevels w
    where
        "stationStatus" = 1

        
        /* This condition is important to avoid reprocessing old data */
        and to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp > (
            select max(last_update) from "airflow"."fact"."fact_waterlevel"
        )
        
)

select * from main
  );
  
  
[0m05:05:06.625418 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:05:06.646497 [debug] [Thread-1 (]: SQL status: SELECT 41 in 0.021 seconds
[0m05:05:06.655161 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m05:05:06.655642 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: BEGIN
[0m05:05:06.656212 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m05:05:06.656516 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m05:05:06.656831 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp050506610968'
        
      order by ordinal_position

  
[0m05:05:06.660181 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.003 seconds
[0m05:05:06.664533 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m05:05:06.664990 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m05:05:06.666844 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.002 seconds
[0m05:05:06.674603 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m05:05:06.675039 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp050506610968'
        
      order by ordinal_position

  
[0m05:05:06.676592 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m05:05:06.678610 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m05:05:06.678980 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m05:05:06.680440 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m05:05:06.686551 [debug] [Thread-1 (]: 
    In "airflow"."fact"."fact_waterlevel":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m05:05:06.691050 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.fact_waterlevel"
[0m05:05:06.692014 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m05:05:06.692320 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      insert into "airflow"."fact"."fact_waterlevel" ("station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update")
    (
        select "station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update"
        from "fact_waterlevel__dbt_tmp050506610968"
    )


  
[0m05:05:06.693056 [debug] [Thread-1 (]: SQL status: INSERT 0 41 in 0.000 seconds
[0m05:05:06.702120 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m05:05:06.702683 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m05:05:06.703010 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m05:05:06.704802 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m05:05:06.706102 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: Close
[0m05:05:06.707308 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aa86f0da-cda6-4fce-94e6-5c2e87503dc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c9527d0>]}
[0m05:05:06.707946 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model fact.fact_waterlevel ................... [[32mINSERT 0 41[0m in 0.12s]
[0m05:05:06.708467 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.fact_waterlevel
[0m05:05:06.709517 [debug] [MainThread]: Using postgres connection "master"
[0m05:05:06.709908 [debug] [MainThread]: On master: BEGIN
[0m05:05:06.710217 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:05:06.713803 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m05:05:06.714176 [debug] [MainThread]: On master: COMMIT
[0m05:05:06.714441 [debug] [MainThread]: Using postgres connection "master"
[0m05:05:06.714670 [debug] [MainThread]: On master: COMMIT
[0m05:05:06.714937 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m05:05:06.715153 [debug] [MainThread]: On master: Close
[0m05:05:06.715460 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:05:06.715692 [debug] [MainThread]: Connection 'model.etl_waterlevel.fact_waterlevel' was properly closed.
[0m05:05:06.715942 [info ] [MainThread]: 
[0m05:05:06.716195 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.24 seconds (0.24s).
[0m05:05:06.716629 [debug] [MainThread]: Command end result
[0m05:05:06.732511 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m05:05:06.734035 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m05:05:06.739223 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m05:05:06.739556 [info ] [MainThread]: 
[0m05:05:06.739939 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:05:06.740201 [info ] [MainThread]: 
[0m05:05:06.740441 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m05:05:06.741140 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.6058846, "process_in_blocks": "0", "process_kernel_time": 0.188039, "process_mem_max_rss": "111444", "process_out_blocks": "1701", "process_user_time": 1.777173}
[0m05:05:06.741533 [debug] [MainThread]: Command `dbt run` succeeded at 05:05:06.741481 after 0.61 seconds
[0m05:05:06.741842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a76c340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a829390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98e412a0>]}
[0m05:05:06.742141 [debug] [MainThread]: Flushing usage events
[0m05:05:08.092310 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:15:36.035329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9aa44310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99b40520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99b40580>]}


============================== 06:15:36.039041 | e3fe5354-d2ed-4a33-b994-97b623b992e5 ==============================
[0m06:15:36.039041 [info ] [MainThread]: Running with dbt=1.9.0
[0m06:15:36.039386 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/logs', 'version_check': 'True', 'profiles_dir': '/home/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models fact_waterlevel', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:15:36.133257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e3fe5354-d2ed-4a33-b994-97b623b992e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff991d6290>]}
[0m06:15:36.160066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e3fe5354-d2ed-4a33-b994-97b623b992e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a9901c0>]}
[0m06:15:36.160572 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m06:15:36.195407 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m06:15:36.244663 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:15:36.244985 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:15:36.248162 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m06:15:36.260069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e3fe5354-d2ed-4a33-b994-97b623b992e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98d64550>]}
[0m06:15:36.296750 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m06:15:36.300890 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m06:15:36.310709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e3fe5354-d2ed-4a33-b994-97b623b992e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98d83220>]}
[0m06:15:36.311039 [info ] [MainThread]: Found 3 models, 434 macros
[0m06:15:36.311360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e3fe5354-d2ed-4a33-b994-97b623b992e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98d831c0>]}
[0m06:15:36.312139 [info ] [MainThread]: 
[0m06:15:36.312495 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:15:36.312765 [info ] [MainThread]: 
[0m06:15:36.313118 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:15:36.313691 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m06:15:36.353442 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m06:15:36.353868 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m06:15:36.354151 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:15:36.357221 [debug] [ThreadPool]: SQL status: SELECT 34 in 0.003 seconds
[0m06:15:36.357986 [debug] [ThreadPool]: On list_airflow: Close
[0m06:15:36.360633 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_fact)
[0m06:15:36.363817 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m06:15:36.364097 [debug] [ThreadPool]: On list_airflow_fact: BEGIN
[0m06:15:36.364363 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:15:36.365919 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m06:15:36.366281 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m06:15:36.366566 [debug] [ThreadPool]: On list_airflow_fact: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_fact"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'fact'
  
[0m06:15:36.367974 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m06:15:36.368629 [debug] [ThreadPool]: On list_airflow_fact: ROLLBACK
[0m06:15:36.368961 [debug] [ThreadPool]: On list_airflow_fact: Close
[0m06:15:36.369365 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_fact, now list_airflow_dim)
[0m06:15:36.370705 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m06:15:36.370968 [debug] [ThreadPool]: On list_airflow_dim: BEGIN
[0m06:15:36.371196 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:15:36.372693 [debug] [ThreadPool]: SQL status: BEGIN in 0.001 seconds
[0m06:15:36.373008 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m06:15:36.373262 [debug] [ThreadPool]: On list_airflow_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dim'
  
[0m06:15:36.374519 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.001 seconds
[0m06:15:36.375248 [debug] [ThreadPool]: On list_airflow_dim: ROLLBACK
[0m06:15:36.375590 [debug] [ThreadPool]: On list_airflow_dim: Close
[0m06:15:36.378047 [debug] [MainThread]: Using postgres connection "master"
[0m06:15:36.378365 [debug] [MainThread]: On master: BEGIN
[0m06:15:36.378605 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:15:36.380055 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m06:15:36.380352 [debug] [MainThread]: Using postgres connection "master"
[0m06:15:36.380663 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:15:36.383515 [debug] [MainThread]: SQL status: SELECT 2 in 0.003 seconds
[0m06:15:36.384171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e3fe5354-d2ed-4a33-b994-97b623b992e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c4c5f00>]}
[0m06:15:36.384527 [debug] [MainThread]: On master: ROLLBACK
[0m06:15:36.384866 [debug] [MainThread]: Using postgres connection "master"
[0m06:15:36.385113 [debug] [MainThread]: On master: BEGIN
[0m06:15:36.385543 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m06:15:36.385843 [debug] [MainThread]: On master: COMMIT
[0m06:15:36.386090 [debug] [MainThread]: Using postgres connection "master"
[0m06:15:36.386359 [debug] [MainThread]: On master: COMMIT
[0m06:15:36.386724 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:15:36.386972 [debug] [MainThread]: On master: Close
[0m06:15:36.388076 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.fact_waterlevel
[0m06:15:36.388470 [info ] [Thread-1 (]: 1 of 1 START sql incremental model fact.fact_waterlevel ........................ [RUN]
[0m06:15:36.388848 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_dim, now model.etl_waterlevel.fact_waterlevel)
[0m06:15:36.389119 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.fact_waterlevel
[0m06:15:36.396091 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.fact_waterlevel"
[0m06:15:36.397853 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.fact_waterlevel
[0m06:15:36.425867 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m06:15:36.426242 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

    
  
    

  create temporary table "fact_waterlevel__dbt_tmp061536413790"
  
  
    as
  
  (
    

with main as (
    select
        distinct
        concat("stationId",'_',"stationCode") as station_key,
        "stationId" as station_id,
        "stationCode" as station_code,
        "waterLevel" as water_level,
        "waterlevelStatus" as waterlevel_status,
        case
            when "waterlevelStatus" = 3 then '🚨 Beyond Danger'
            when "waterlevelStatus" = 2 then '⚠️ Between Warning and Danger'
            when "waterlevelStatus" = 1 then '🔶 Between Alert and Warning'
            when "waterlevelStatus" = 0 then '✅ Between Normal and Alert'
            when "waterlevelStatus" = -1 then '🟢 Below Normal (Safe)'
            else '❓ Unknown Status'
        end as waterlevel_condition,
        "stationName",
        "districtName",
        to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp AS last_update
    from
        raw.waterlevels w
    where
        "stationStatus" = 1

        
        /* This condition is important to avoid reprocessing old data */
        and to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp > (
            select max(last_update) from "airflow"."fact"."fact_waterlevel"
        )
        
)

select * from main
  );
  
  
[0m06:15:36.426568 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:15:36.445389 [debug] [Thread-1 (]: SQL status: SELECT 41 in 0.019 seconds
[0m06:15:36.452734 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m06:15:36.453050 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: BEGIN
[0m06:15:36.453466 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m06:15:36.453810 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m06:15:36.454103 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp061536413790'
        
      order by ordinal_position

  
[0m06:15:36.456969 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.003 seconds
[0m06:15:36.459633 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m06:15:36.459939 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m06:15:36.461282 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m06:15:36.467800 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m06:15:36.468171 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp061536413790'
        
      order by ordinal_position

  
[0m06:15:36.469424 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m06:15:36.471110 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m06:15:36.471426 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m06:15:36.472630 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m06:15:36.477188 [debug] [Thread-1 (]: 
    In "airflow"."fact"."fact_waterlevel":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m06:15:36.480643 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.fact_waterlevel"
[0m06:15:36.481604 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m06:15:36.481897 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      insert into "airflow"."fact"."fact_waterlevel" ("station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update")
    (
        select "station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update"
        from "fact_waterlevel__dbt_tmp061536413790"
    )


  
[0m06:15:36.482457 [debug] [Thread-1 (]: SQL status: INSERT 0 41 in 0.000 seconds
[0m06:15:36.489916 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m06:15:36.490196 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m06:15:36.490434 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m06:15:36.495739 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m06:15:36.496782 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: Close
[0m06:15:36.497834 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3fe5354-d2ed-4a33-b994-97b623b992e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cbb27a0>]}
[0m06:15:36.498283 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model fact.fact_waterlevel ................... [[32mINSERT 0 41[0m in 0.11s]
[0m06:15:36.498642 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.fact_waterlevel
[0m06:15:36.499344 [debug] [MainThread]: Using postgres connection "master"
[0m06:15:36.499579 [debug] [MainThread]: On master: BEGIN
[0m06:15:36.499773 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:15:36.501240 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m06:15:36.501507 [debug] [MainThread]: On master: COMMIT
[0m06:15:36.501728 [debug] [MainThread]: Using postgres connection "master"
[0m06:15:36.501935 [debug] [MainThread]: On master: COMMIT
[0m06:15:36.502216 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:15:36.502471 [debug] [MainThread]: On master: Close
[0m06:15:36.502739 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:15:36.502946 [debug] [MainThread]: Connection 'model.etl_waterlevel.fact_waterlevel' was properly closed.
[0m06:15:36.503166 [info ] [MainThread]: 
[0m06:15:36.503400 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.19 seconds (0.19s).
[0m06:15:36.503770 [debug] [MainThread]: Command end result
[0m06:15:36.517691 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m06:15:36.518787 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m06:15:36.522723 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m06:15:36.522956 [info ] [MainThread]: 
[0m06:15:36.523225 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:15:36.523429 [info ] [MainThread]: 
[0m06:15:36.523645 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m06:15:36.524151 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.5166299, "process_in_blocks": "0", "process_kernel_time": 0.132606, "process_mem_max_rss": "111344", "process_out_blocks": "1701", "process_user_time": 1.207418}
[0m06:15:36.524495 [debug] [MainThread]: Command `dbt run` succeeded at 06:15:36.524447 after 0.52 seconds
[0m06:15:36.524737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9aa44310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff991d6290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a903880>]}
[0m06:15:36.524974 [debug] [MainThread]: Flushing usage events
[0m06:15:38.014686 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:10:25.998660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1c5c280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0d58520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0d58580>]}


============================== 07:10:26.001851 | 813d8b63-2144-4635-9541-15491c0b3314 ==============================
[0m07:10:26.001851 [info ] [MainThread]: Running with dbt=1.9.0
[0m07:10:26.002245 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models fact_waterlevel', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m07:10:26.084024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '813d8b63-2144-4635-9541-15491c0b3314', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa03f2170>]}
[0m07:10:26.110438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '813d8b63-2144-4635-9541-15491c0b3314', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1ceaf80>]}
[0m07:10:26.110920 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m07:10:26.145241 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m07:10:26.194215 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:10:26.194554 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:10:26.197717 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m07:10:26.209619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '813d8b63-2144-4635-9541-15491c0b3314', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ff7c4c0>]}
[0m07:10:26.246535 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m07:10:26.250448 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m07:10:26.259303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '813d8b63-2144-4635-9541-15491c0b3314', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ff9b220>]}
[0m07:10:26.259608 [info ] [MainThread]: Found 3 models, 434 macros
[0m07:10:26.259839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '813d8b63-2144-4635-9541-15491c0b3314', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ff9b1c0>]}
[0m07:10:26.260512 [info ] [MainThread]: 
[0m07:10:26.260790 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:10:26.261042 [info ] [MainThread]: 
[0m07:10:26.261346 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:10:26.261922 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m07:10:26.299577 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m07:10:26.299991 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m07:10:26.300289 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:10:26.303036 [debug] [ThreadPool]: SQL status: SELECT 34 in 0.003 seconds
[0m07:10:26.303795 [debug] [ThreadPool]: On list_airflow: Close
[0m07:10:26.306438 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_dim)
[0m07:10:26.309614 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m07:10:26.309893 [debug] [ThreadPool]: On list_airflow_dim: BEGIN
[0m07:10:26.310140 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:10:26.311830 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m07:10:26.312160 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m07:10:26.312439 [debug] [ThreadPool]: On list_airflow_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dim'
  
[0m07:10:26.313714 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.001 seconds
[0m07:10:26.314391 [debug] [ThreadPool]: On list_airflow_dim: ROLLBACK
[0m07:10:26.314720 [debug] [ThreadPool]: On list_airflow_dim: Close
[0m07:10:26.315128 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_dim, now list_airflow_fact)
[0m07:10:26.316546 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m07:10:26.316809 [debug] [ThreadPool]: On list_airflow_fact: BEGIN
[0m07:10:26.317052 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:10:26.318514 [debug] [ThreadPool]: SQL status: BEGIN in 0.001 seconds
[0m07:10:26.318823 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m07:10:26.319078 [debug] [ThreadPool]: On list_airflow_fact: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_fact"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'fact'
  
[0m07:10:26.320301 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m07:10:26.320908 [debug] [ThreadPool]: On list_airflow_fact: ROLLBACK
[0m07:10:26.321235 [debug] [ThreadPool]: On list_airflow_fact: Close
[0m07:10:26.323595 [debug] [MainThread]: Using postgres connection "master"
[0m07:10:26.323860 [debug] [MainThread]: On master: BEGIN
[0m07:10:26.324096 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:10:26.325567 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m07:10:26.325867 [debug] [MainThread]: Using postgres connection "master"
[0m07:10:26.326161 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:10:26.329128 [debug] [MainThread]: SQL status: SELECT 2 in 0.003 seconds
[0m07:10:26.329792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '813d8b63-2144-4635-9541-15491c0b3314', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1cc4bb0>]}
[0m07:10:26.330115 [debug] [MainThread]: On master: ROLLBACK
[0m07:10:26.330451 [debug] [MainThread]: Using postgres connection "master"
[0m07:10:26.330694 [debug] [MainThread]: On master: BEGIN
[0m07:10:26.331089 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m07:10:26.331392 [debug] [MainThread]: On master: COMMIT
[0m07:10:26.331645 [debug] [MainThread]: Using postgres connection "master"
[0m07:10:26.331883 [debug] [MainThread]: On master: COMMIT
[0m07:10:26.332207 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:10:26.332470 [debug] [MainThread]: On master: Close
[0m07:10:26.333584 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.fact_waterlevel
[0m07:10:26.333958 [info ] [Thread-1 (]: 1 of 1 START sql incremental model fact.fact_waterlevel ........................ [RUN]
[0m07:10:26.334295 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_fact, now model.etl_waterlevel.fact_waterlevel)
[0m07:10:26.334559 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.fact_waterlevel
[0m07:10:26.341601 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.fact_waterlevel"
[0m07:10:26.343101 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.fact_waterlevel
[0m07:10:26.372355 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m07:10:26.372865 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

    
  
    

  create temporary table "fact_waterlevel__dbt_tmp071026359627"
  
  
    as
  
  (
    

with main as (
    select
        distinct
        concat("stationId",'_',"stationCode") as station_key,
        "stationId" as station_id,
        "stationCode" as station_code,
        "waterLevel" as water_level,
        "waterlevelStatus" as waterlevel_status,
        case
            when "waterlevelStatus" = 3 then '🚨 Beyond Danger'
            when "waterlevelStatus" = 2 then '⚠️ Between Warning and Danger'
            when "waterlevelStatus" = 1 then '🔶 Between Alert and Warning'
            when "waterlevelStatus" = 0 then '✅ Between Normal and Alert'
            when "waterlevelStatus" = -1 then '🟢 Below Normal (Safe)'
            else '❓ Unknown Status'
        end as waterlevel_condition,
        "stationName",
        "districtName",
        to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp AS last_update
    from
        raw.waterlevels w
    where
        "stationStatus" = 1

        
        /* This condition is important to avoid reprocessing old data */
        and to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp > (
            select max(last_update) from "airflow"."fact"."fact_waterlevel"
        )
        
)

select * from main
  );
  
  
[0m07:10:26.373222 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:10:26.389771 [debug] [Thread-1 (]: SQL status: SELECT 42 in 0.016 seconds
[0m07:10:26.399279 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m07:10:26.399725 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: BEGIN
[0m07:10:26.400237 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m07:10:26.400771 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m07:10:26.401052 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp071026359627'
        
      order by ordinal_position

  
[0m07:10:26.404373 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.003 seconds
[0m07:10:26.407876 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m07:10:26.408204 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m07:10:26.410320 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.002 seconds
[0m07:10:26.417919 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m07:10:26.418320 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp071026359627'
        
      order by ordinal_position

  
[0m07:10:26.419860 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m07:10:26.421910 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m07:10:26.422257 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m07:10:26.423666 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m07:10:26.428982 [debug] [Thread-1 (]: 
    In "airflow"."fact"."fact_waterlevel":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m07:10:26.432879 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.fact_waterlevel"
[0m07:10:26.433901 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m07:10:26.434241 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      insert into "airflow"."fact"."fact_waterlevel" ("station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update")
    (
        select "station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update"
        from "fact_waterlevel__dbt_tmp071026359627"
    )


  
[0m07:10:26.435247 [debug] [Thread-1 (]: SQL status: INSERT 0 42 in 0.001 seconds
[0m07:10:26.443472 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m07:10:26.443817 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m07:10:26.444073 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m07:10:26.449173 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m07:10:26.450395 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: Close
[0m07:10:26.451493 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '813d8b63-2144-4635-9541-15491c0b3314', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ff9ac80>]}
[0m07:10:26.451953 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model fact.fact_waterlevel ................... [[32mINSERT 0 42[0m in 0.12s]
[0m07:10:26.452329 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.fact_waterlevel
[0m07:10:26.453043 [debug] [MainThread]: Using postgres connection "master"
[0m07:10:26.453317 [debug] [MainThread]: On master: BEGIN
[0m07:10:26.453556 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:10:26.455347 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m07:10:26.455624 [debug] [MainThread]: On master: COMMIT
[0m07:10:26.455847 [debug] [MainThread]: Using postgres connection "master"
[0m07:10:26.456049 [debug] [MainThread]: On master: COMMIT
[0m07:10:26.456315 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:10:26.456524 [debug] [MainThread]: On master: Close
[0m07:10:26.456809 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:10:26.457023 [debug] [MainThread]: Connection 'model.etl_waterlevel.fact_waterlevel' was properly closed.
[0m07:10:26.457266 [info ] [MainThread]: 
[0m07:10:26.457529 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.20 seconds (0.20s).
[0m07:10:26.457946 [debug] [MainThread]: Command end result
[0m07:10:26.474587 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m07:10:26.476133 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m07:10:26.480249 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m07:10:26.480504 [info ] [MainThread]: 
[0m07:10:26.480782 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:10:26.480997 [info ] [MainThread]: 
[0m07:10:26.481231 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m07:10:26.481813 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.51000386, "process_in_blocks": "0", "process_kernel_time": 0.065964, "process_mem_max_rss": "111328", "process_out_blocks": "1701", "process_user_time": 1.214349}
[0m07:10:26.482162 [debug] [MainThread]: Command `dbt run` succeeded at 07:10:26.482114 after 0.51 seconds
[0m07:10:26.482432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1c5c280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa03f2170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa48f6d70>]}
[0m07:10:26.482767 [debug] [MainThread]: Flushing usage events
[0m07:10:27.990090 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:09:41.216415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8e88310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7f77d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7f77cd0>]}


============================== 08:09:41.219395 | a87587f4-6ae8-4947-9a49-02159ab7ed37 ==============================
[0m08:09:41.219395 [info ] [MainThread]: Running with dbt=1.9.0
[0m08:09:41.219791 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models fact_waterlevel', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:09:41.304944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a87587f4-6ae8-4947-9a49-02159ab7ed37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb76aa290>]}
[0m08:09:41.331689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a87587f4-6ae8-4947-9a49-02159ab7ed37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8dd81c0>]}
[0m08:09:41.332180 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m08:09:41.366645 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m08:09:41.415283 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:09:41.415618 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:09:41.418783 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m08:09:41.430623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a87587f4-6ae8-4947-9a49-02159ab7ed37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7218550>]}
[0m08:09:41.466717 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m08:09:41.470955 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m08:09:41.479681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a87587f4-6ae8-4947-9a49-02159ab7ed37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7237220>]}
[0m08:09:41.480006 [info ] [MainThread]: Found 3 models, 434 macros
[0m08:09:41.480259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a87587f4-6ae8-4947-9a49-02159ab7ed37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb72371c0>]}
[0m08:09:41.480940 [info ] [MainThread]: 
[0m08:09:41.481185 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:09:41.481383 [info ] [MainThread]: 
[0m08:09:41.481694 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:09:41.482283 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m08:09:41.520231 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m08:09:41.520640 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m08:09:41.520918 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:09:41.523690 [debug] [ThreadPool]: SQL status: SELECT 34 in 0.003 seconds
[0m08:09:41.524489 [debug] [ThreadPool]: On list_airflow: Close
[0m08:09:41.527143 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_fact)
[0m08:09:41.530314 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m08:09:41.530590 [debug] [ThreadPool]: On list_airflow_fact: BEGIN
[0m08:09:41.530836 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:09:41.532412 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m08:09:41.532778 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m08:09:41.533040 [debug] [ThreadPool]: On list_airflow_fact: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_fact"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'fact'
  
[0m08:09:41.534398 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m08:09:41.535034 [debug] [ThreadPool]: On list_airflow_fact: ROLLBACK
[0m08:09:41.535375 [debug] [ThreadPool]: On list_airflow_fact: Close
[0m08:09:41.535779 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_fact, now list_airflow_dim)
[0m08:09:41.537123 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m08:09:41.537378 [debug] [ThreadPool]: On list_airflow_dim: BEGIN
[0m08:09:41.537615 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:09:41.539075 [debug] [ThreadPool]: SQL status: BEGIN in 0.001 seconds
[0m08:09:41.539392 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m08:09:41.539642 [debug] [ThreadPool]: On list_airflow_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dim'
  
[0m08:09:41.540889 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.001 seconds
[0m08:09:41.541532 [debug] [ThreadPool]: On list_airflow_dim: ROLLBACK
[0m08:09:41.541855 [debug] [ThreadPool]: On list_airflow_dim: Close
[0m08:09:41.544329 [debug] [MainThread]: Using postgres connection "master"
[0m08:09:41.544624 [debug] [MainThread]: On master: BEGIN
[0m08:09:41.544862 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:09:41.546140 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m08:09:41.546418 [debug] [MainThread]: Using postgres connection "master"
[0m08:09:41.546720 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:09:41.549591 [debug] [MainThread]: SQL status: SELECT 2 in 0.003 seconds
[0m08:09:41.550250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a87587f4-6ae8-4947-9a49-02159ab7ed37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba889f00>]}
[0m08:09:41.550581 [debug] [MainThread]: On master: ROLLBACK
[0m08:09:41.550888 [debug] [MainThread]: Using postgres connection "master"
[0m08:09:41.551151 [debug] [MainThread]: On master: BEGIN
[0m08:09:41.551468 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m08:09:41.551738 [debug] [MainThread]: On master: COMMIT
[0m08:09:41.551983 [debug] [MainThread]: Using postgres connection "master"
[0m08:09:41.552232 [debug] [MainThread]: On master: COMMIT
[0m08:09:41.552508 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:09:41.552744 [debug] [MainThread]: On master: Close
[0m08:09:41.554441 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.fact_waterlevel
[0m08:09:41.554817 [info ] [Thread-1 (]: 1 of 1 START sql incremental model fact.fact_waterlevel ........................ [RUN]
[0m08:09:41.555168 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_dim, now model.etl_waterlevel.fact_waterlevel)
[0m08:09:41.555451 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.fact_waterlevel
[0m08:09:41.562295 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.fact_waterlevel"
[0m08:09:41.563118 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.fact_waterlevel
[0m08:09:41.591233 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m08:09:41.591591 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

    
  
    

  create temporary table "fact_waterlevel__dbt_tmp080941578990"
  
  
    as
  
  (
    

with main as (
    select
        distinct
        concat("stationId",'_',"stationCode") as station_key,
        "stationId" as station_id,
        "stationCode" as station_code,
        "waterLevel" as water_level,
        "waterlevelStatus" as waterlevel_status,
        case
            when "waterlevelStatus" = 3 then '🚨 Beyond Danger'
            when "waterlevelStatus" = 2 then '⚠️ Between Warning and Danger'
            when "waterlevelStatus" = 1 then '🔶 Between Alert and Warning'
            when "waterlevelStatus" = 0 then '✅ Between Normal and Alert'
            when "waterlevelStatus" = -1 then '🟢 Below Normal (Safe)'
            else '❓ Unknown Status'
        end as waterlevel_condition,
        "stationName",
        "districtName",
        to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp AS last_update
    from
        raw.waterlevels w
    where
        "stationStatus" = 1

        
        /* This condition is important to avoid reprocessing old data */
        and to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp > (
            select max(last_update) from "airflow"."fact"."fact_waterlevel"
        )
        
)

select * from main
  );
  
  
[0m08:09:41.591950 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:09:41.606369 [debug] [Thread-1 (]: SQL status: SELECT 42 in 0.014 seconds
[0m08:09:41.613507 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m08:09:41.613821 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: BEGIN
[0m08:09:41.614241 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m08:09:41.614598 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m08:09:41.614889 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp080941578990'
        
      order by ordinal_position

  
[0m08:09:41.617581 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.002 seconds
[0m08:09:41.620170 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m08:09:41.620475 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m08:09:41.621769 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m08:09:41.628114 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m08:09:41.628429 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp080941578990'
        
      order by ordinal_position

  
[0m08:09:41.629592 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m08:09:41.631264 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m08:09:41.631556 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m08:09:41.632738 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m08:09:41.637246 [debug] [Thread-1 (]: 
    In "airflow"."fact"."fact_waterlevel":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m08:09:41.640714 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.fact_waterlevel"
[0m08:09:41.641551 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m08:09:41.641869 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      insert into "airflow"."fact"."fact_waterlevel" ("station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update")
    (
        select "station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update"
        from "fact_waterlevel__dbt_tmp080941578990"
    )


  
[0m08:09:41.642319 [debug] [Thread-1 (]: SQL status: INSERT 0 42 in 0.000 seconds
[0m08:09:41.649768 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m08:09:41.650074 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m08:09:41.650372 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m08:09:41.655378 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m08:09:41.656435 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: Close
[0m08:09:41.657491 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a87587f4-6ae8-4947-9a49-02159ab7ed37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbb04a7a0>]}
[0m08:09:41.657938 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model fact.fact_waterlevel ................... [[32mINSERT 0 42[0m in 0.10s]
[0m08:09:41.658322 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.fact_waterlevel
[0m08:09:41.659017 [debug] [MainThread]: Using postgres connection "master"
[0m08:09:41.659266 [debug] [MainThread]: On master: BEGIN
[0m08:09:41.659467 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:09:41.660911 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m08:09:41.661212 [debug] [MainThread]: On master: COMMIT
[0m08:09:41.661436 [debug] [MainThread]: Using postgres connection "master"
[0m08:09:41.661665 [debug] [MainThread]: On master: COMMIT
[0m08:09:41.661942 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:09:41.662144 [debug] [MainThread]: On master: Close
[0m08:09:41.662403 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:09:41.662626 [debug] [MainThread]: Connection 'model.etl_waterlevel.fact_waterlevel' was properly closed.
[0m08:09:41.662845 [info ] [MainThread]: 
[0m08:09:41.663065 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.18 seconds (0.18s).
[0m08:09:41.663443 [debug] [MainThread]: Command end result
[0m08:09:41.678120 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m08:09:41.679328 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m08:09:41.682641 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m08:09:41.682875 [info ] [MainThread]: 
[0m08:09:41.683138 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:09:41.683363 [info ] [MainThread]: 
[0m08:09:41.683610 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m08:09:41.684126 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.49372366, "process_in_blocks": "0", "process_kernel_time": 0.063117, "process_mem_max_rss": "111152", "process_out_blocks": "1701", "process_user_time": 1.200235}
[0m08:09:41.684453 [debug] [MainThread]: Command `dbt run` succeeded at 08:09:41.684407 after 0.49 seconds
[0m08:09:41.684694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8e88310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb76aa290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8ef76d0>]}
[0m08:09:41.684958 [debug] [MainThread]: Flushing usage events
[0m08:09:43.203592 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:11:07.035969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8550310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7657d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7657cd0>]}


============================== 09:11:07.038922 | 7822f1fc-3ea7-4ecf-a025-48c15c4fa160 ==============================
[0m09:11:07.038922 [info ] [MainThread]: Running with dbt=1.9.0
[0m09:11:07.039322 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/airflow/.dbt', 'log_path': '/usr/app/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --models fact_waterlevel', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:11:07.121294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7822f1fc-3ea7-4ecf-a025-48c15c4fa160', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6d0e290>]}
[0m09:11:07.147728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7822f1fc-3ea7-4ecf-a025-48c15c4fa160', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa849c1c0>]}
[0m09:11:07.148235 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:11:07.182419 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m09:11:07.231747 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:11:07.232086 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:11:07.235281 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m09:11:07.247037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7822f1fc-3ea7-4ecf-a025-48c15c4fa160', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6898550>]}
[0m09:11:07.283505 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m09:11:07.287491 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m09:11:07.296067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7822f1fc-3ea7-4ecf-a025-48c15c4fa160', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa68b7220>]}
[0m09:11:07.296404 [info ] [MainThread]: Found 3 models, 434 macros
[0m09:11:07.296691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7822f1fc-3ea7-4ecf-a025-48c15c4fa160', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa68b71c0>]}
[0m09:11:07.297457 [info ] [MainThread]: 
[0m09:11:07.297738 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:11:07.297941 [info ] [MainThread]: 
[0m09:11:07.298266 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:11:07.298849 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m09:11:07.337092 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m09:11:07.337500 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m09:11:07.337774 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:11:07.340508 [debug] [ThreadPool]: SQL status: SELECT 34 in 0.003 seconds
[0m09:11:07.341285 [debug] [ThreadPool]: On list_airflow: Close
[0m09:11:07.343837 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_fact)
[0m09:11:07.346961 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m09:11:07.347236 [debug] [ThreadPool]: On list_airflow_fact: BEGIN
[0m09:11:07.347473 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:11:07.349001 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m09:11:07.349324 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m09:11:07.349583 [debug] [ThreadPool]: On list_airflow_fact: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_fact"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'fact'
  
[0m09:11:07.350925 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m09:11:07.351580 [debug] [ThreadPool]: On list_airflow_fact: ROLLBACK
[0m09:11:07.351913 [debug] [ThreadPool]: On list_airflow_fact: Close
[0m09:11:07.352331 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_fact, now list_airflow_dim)
[0m09:11:07.353641 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m09:11:07.353905 [debug] [ThreadPool]: On list_airflow_dim: BEGIN
[0m09:11:07.354162 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:11:07.355660 [debug] [ThreadPool]: SQL status: BEGIN in 0.001 seconds
[0m09:11:07.355974 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m09:11:07.356265 [debug] [ThreadPool]: On list_airflow_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dim'
  
[0m09:11:07.357482 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.001 seconds
[0m09:11:07.358175 [debug] [ThreadPool]: On list_airflow_dim: ROLLBACK
[0m09:11:07.358516 [debug] [ThreadPool]: On list_airflow_dim: Close
[0m09:11:07.360988 [debug] [MainThread]: Using postgres connection "master"
[0m09:11:07.361254 [debug] [MainThread]: On master: BEGIN
[0m09:11:07.361492 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:11:07.362978 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m09:11:07.363285 [debug] [MainThread]: Using postgres connection "master"
[0m09:11:07.363578 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:11:07.366458 [debug] [MainThread]: SQL status: SELECT 2 in 0.003 seconds
[0m09:11:07.367110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7822f1fc-3ea7-4ecf-a025-48c15c4fa160', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa091f00>]}
[0m09:11:07.367445 [debug] [MainThread]: On master: ROLLBACK
[0m09:11:07.367784 [debug] [MainThread]: Using postgres connection "master"
[0m09:11:07.368054 [debug] [MainThread]: On master: BEGIN
[0m09:11:07.368432 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m09:11:07.368722 [debug] [MainThread]: On master: COMMIT
[0m09:11:07.368960 [debug] [MainThread]: Using postgres connection "master"
[0m09:11:07.369215 [debug] [MainThread]: On master: COMMIT
[0m09:11:07.369544 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:11:07.369784 [debug] [MainThread]: On master: Close
[0m09:11:07.371222 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.fact_waterlevel
[0m09:11:07.371567 [info ] [Thread-1 (]: 1 of 1 START sql incremental model fact.fact_waterlevel ........................ [RUN]
[0m09:11:07.371883 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_dim, now model.etl_waterlevel.fact_waterlevel)
[0m09:11:07.372158 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.fact_waterlevel
[0m09:11:07.379180 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.fact_waterlevel"
[0m09:11:07.380110 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.fact_waterlevel
[0m09:11:07.408086 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m09:11:07.408472 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

    
  
    

  create temporary table "fact_waterlevel__dbt_tmp091107395954"
  
  
    as
  
  (
    

with main as (
    select
        distinct
        concat("stationId",'_',"stationCode") as station_key,
        "stationId" as station_id,
        "stationCode" as station_code,
        "waterLevel" as water_level,
        "waterlevelStatus" as waterlevel_status,
        case
            when "waterlevelStatus" = 3 then '🚨 Beyond Danger'
            when "waterlevelStatus" = 2 then '⚠️ Between Warning and Danger'
            when "waterlevelStatus" = 1 then '🔶 Between Alert and Warning'
            when "waterlevelStatus" = 0 then '✅ Between Normal and Alert'
            when "waterlevelStatus" = -1 then '🟢 Below Normal (Safe)'
            else '❓ Unknown Status'
        end as waterlevel_condition,
        "stationName",
        "districtName",
        to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp AS last_update
    from
        raw.waterlevels w
    where
        "stationStatus" = 1

        
        /* This condition is important to avoid reprocessing old data */
        and to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp > (
            select max(last_update) from "airflow"."fact"."fact_waterlevel"
        )
        
)

select * from main
  );
  
  
[0m09:11:07.408790 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:11:07.423456 [debug] [Thread-1 (]: SQL status: SELECT 42 in 0.015 seconds
[0m09:11:07.430501 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m09:11:07.430812 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: BEGIN
[0m09:11:07.431233 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m09:11:07.431591 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m09:11:07.431872 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp091107395954'
        
      order by ordinal_position

  
[0m09:11:07.434475 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.002 seconds
[0m09:11:07.437070 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m09:11:07.437381 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m09:11:07.438731 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m09:11:07.445143 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m09:11:07.445458 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp091107395954'
        
      order by ordinal_position

  
[0m09:11:07.446655 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m09:11:07.448321 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m09:11:07.448610 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m09:11:07.449809 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m09:11:07.454347 [debug] [Thread-1 (]: 
    In "airflow"."fact"."fact_waterlevel":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m09:11:07.457780 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.fact_waterlevel"
[0m09:11:07.458670 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m09:11:07.458958 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      insert into "airflow"."fact"."fact_waterlevel" ("station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update")
    (
        select "station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update"
        from "fact_waterlevel__dbt_tmp091107395954"
    )


  
[0m09:11:07.459477 [debug] [Thread-1 (]: SQL status: INSERT 0 42 in 0.000 seconds
[0m09:11:07.466942 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m09:11:07.467249 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m09:11:07.467521 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m09:11:07.470794 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m09:11:07.471910 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: Close
[0m09:11:07.473089 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7822f1fc-3ea7-4ecf-a025-48c15c4fa160', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa7727a0>]}
[0m09:11:07.473553 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model fact.fact_waterlevel ................... [[32mINSERT 0 42[0m in 0.10s]
[0m09:11:07.473952 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.fact_waterlevel
[0m09:11:07.474628 [debug] [MainThread]: Using postgres connection "master"
[0m09:11:07.474897 [debug] [MainThread]: On master: BEGIN
[0m09:11:07.475123 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:11:07.476548 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m09:11:07.476816 [debug] [MainThread]: On master: COMMIT
[0m09:11:07.477053 [debug] [MainThread]: Using postgres connection "master"
[0m09:11:07.477252 [debug] [MainThread]: On master: COMMIT
[0m09:11:07.477503 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:11:07.477699 [debug] [MainThread]: On master: Close
[0m09:11:07.477960 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:11:07.478183 [debug] [MainThread]: Connection 'model.etl_waterlevel.fact_waterlevel' was properly closed.
[0m09:11:07.478396 [info ] [MainThread]: 
[0m09:11:07.478642 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.18 seconds (0.18s).
[0m09:11:07.479006 [debug] [MainThread]: Command end result
[0m09:11:07.494211 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m09:11:07.495225 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m09:11:07.498702 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m09:11:07.498965 [info ] [MainThread]: 
[0m09:11:07.499262 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:11:07.499515 [info ] [MainThread]: 
[0m09:11:07.499762 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m09:11:07.500295 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.49120808, "process_in_blocks": "0", "process_kernel_time": 0.062682, "process_mem_max_rss": "111596", "process_out_blocks": "1701", "process_user_time": 1.199917}
[0m09:11:07.500626 [debug] [MainThread]: Command `dbt run` succeeded at 09:11:07.500581 after 0.49 seconds
[0m09:11:07.500862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8550310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6d0e290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa85bf6d0>]}
[0m09:11:07.501101 [debug] [MainThread]: Flushing usage events
[0m09:11:09.769758 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:11:54.291958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f680340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e76fd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e76fd30>]}


============================== 10:11:54.294884 | 99d90dcc-c064-4cb0-91d5-209884aebbd8 ==============================
[0m10:11:54.294884 [info ] [MainThread]: Running with dbt=1.9.0
[0m10:11:54.295309 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --models fact_waterlevel', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:11:54.380272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '99d90dcc-c064-4cb0-91d5-209884aebbd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8186e7a0>]}
[0m10:11:54.406938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '99d90dcc-c064-4cb0-91d5-209884aebbd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f5427a0>]}
[0m10:11:54.407422 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:11:54.442770 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m10:11:54.490157 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:11:54.490447 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:11:54.493535 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m10:11:54.505229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '99d90dcc-c064-4cb0-91d5-209884aebbd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d9ac580>]}
[0m10:11:54.541221 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m10:11:54.545021 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m10:11:54.553607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '99d90dcc-c064-4cb0-91d5-209884aebbd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d9cb220>]}
[0m10:11:54.553935 [info ] [MainThread]: Found 3 models, 434 macros
[0m10:11:54.554226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '99d90dcc-c064-4cb0-91d5-209884aebbd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d9cb1c0>]}
[0m10:11:54.554943 [info ] [MainThread]: 
[0m10:11:54.555184 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:11:54.555395 [info ] [MainThread]: 
[0m10:11:54.555695 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:11:54.556264 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m10:11:54.594304 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m10:11:54.594704 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m10:11:54.594972 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:11:54.597751 [debug] [ThreadPool]: SQL status: SELECT 34 in 0.003 seconds
[0m10:11:54.598547 [debug] [ThreadPool]: On list_airflow: Close
[0m10:11:54.601154 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_fact)
[0m10:11:54.604290 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m10:11:54.604567 [debug] [ThreadPool]: On list_airflow_fact: BEGIN
[0m10:11:54.604814 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:11:54.606368 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m10:11:54.606725 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m10:11:54.606995 [debug] [ThreadPool]: On list_airflow_fact: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_fact"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'fact'
  
[0m10:11:54.608332 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m10:11:54.609004 [debug] [ThreadPool]: On list_airflow_fact: ROLLBACK
[0m10:11:54.609343 [debug] [ThreadPool]: On list_airflow_fact: Close
[0m10:11:54.609718 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_fact, now list_airflow_dim)
[0m10:11:54.611006 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m10:11:54.611290 [debug] [ThreadPool]: On list_airflow_dim: BEGIN
[0m10:11:54.611526 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:11:54.612920 [debug] [ThreadPool]: SQL status: BEGIN in 0.001 seconds
[0m10:11:54.613281 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m10:11:54.613548 [debug] [ThreadPool]: On list_airflow_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dim'
  
[0m10:11:54.614764 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.001 seconds
[0m10:11:54.615405 [debug] [ThreadPool]: On list_airflow_dim: ROLLBACK
[0m10:11:54.615763 [debug] [ThreadPool]: On list_airflow_dim: Close
[0m10:11:54.618239 [debug] [MainThread]: Using postgres connection "master"
[0m10:11:54.618521 [debug] [MainThread]: On master: BEGIN
[0m10:11:54.618757 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:11:54.620176 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m10:11:54.620489 [debug] [MainThread]: Using postgres connection "master"
[0m10:11:54.620780 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:11:54.623638 [debug] [MainThread]: SQL status: SELECT 2 in 0.003 seconds
[0m10:11:54.624271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '99d90dcc-c064-4cb0-91d5-209884aebbd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff817fe350>]}
[0m10:11:54.624640 [debug] [MainThread]: On master: ROLLBACK
[0m10:11:54.624979 [debug] [MainThread]: Using postgres connection "master"
[0m10:11:54.625230 [debug] [MainThread]: On master: BEGIN
[0m10:11:54.625646 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:11:54.625996 [debug] [MainThread]: On master: COMMIT
[0m10:11:54.626233 [debug] [MainThread]: Using postgres connection "master"
[0m10:11:54.626501 [debug] [MainThread]: On master: COMMIT
[0m10:11:54.626855 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:11:54.627106 [debug] [MainThread]: On master: Close
[0m10:11:54.628223 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.fact_waterlevel
[0m10:11:54.628615 [info ] [Thread-1 (]: 1 of 1 START sql incremental model fact.fact_waterlevel ........................ [RUN]
[0m10:11:54.628933 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_dim, now model.etl_waterlevel.fact_waterlevel)
[0m10:11:54.629199 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.fact_waterlevel
[0m10:11:54.636070 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.fact_waterlevel"
[0m10:11:54.636906 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.fact_waterlevel
[0m10:11:54.664555 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m10:11:54.664922 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

    
  
    

  create temporary table "fact_waterlevel__dbt_tmp101154652711"
  
  
    as
  
  (
    

with main as (
    select
        distinct
        concat("stationId",'_',"stationCode") as station_key,
        "stationId" as station_id,
        "stationCode" as station_code,
        "waterLevel" as water_level,
        "waterlevelStatus" as waterlevel_status,
        case
            when "waterlevelStatus" = 3 then '🚨 Beyond Danger'
            when "waterlevelStatus" = 2 then '⚠️ Between Warning and Danger'
            when "waterlevelStatus" = 1 then '🔶 Between Alert and Warning'
            when "waterlevelStatus" = 0 then '✅ Between Normal and Alert'
            when "waterlevelStatus" = -1 then '🟢 Below Normal (Safe)'
            else '❓ Unknown Status'
        end as waterlevel_condition,
        "stationName",
        "districtName",
        to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp AS last_update
    from
        raw.waterlevels w
    where
        "stationStatus" = 1

        
        /* This condition is important to avoid reprocessing old data */
        and to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp > (
            select max(last_update) from "airflow"."fact"."fact_waterlevel"
        )
        
)

select * from main
  );
  
  
[0m10:11:54.665268 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:11:54.679592 [debug] [Thread-1 (]: SQL status: SELECT 58 in 0.014 seconds
[0m10:11:54.686644 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m10:11:54.686957 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: BEGIN
[0m10:11:54.687392 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m10:11:54.687700 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m10:11:54.687985 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp101154652711'
        
      order by ordinal_position

  
[0m10:11:54.690667 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.002 seconds
[0m10:11:54.693258 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m10:11:54.693549 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m10:11:54.694875 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m10:11:54.701290 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m10:11:54.701606 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp101154652711'
        
      order by ordinal_position

  
[0m10:11:54.702832 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m10:11:54.704533 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m10:11:54.704828 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m10:11:54.706012 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m10:11:54.710580 [debug] [Thread-1 (]: 
    In "airflow"."fact"."fact_waterlevel":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m10:11:54.713982 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.fact_waterlevel"
[0m10:11:54.714802 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m10:11:54.715076 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      insert into "airflow"."fact"."fact_waterlevel" ("station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update")
    (
        select "station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update"
        from "fact_waterlevel__dbt_tmp101154652711"
    )


  
[0m10:11:54.715540 [debug] [Thread-1 (]: SQL status: INSERT 0 58 in 0.000 seconds
[0m10:11:54.723046 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m10:11:54.723332 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m10:11:54.723591 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m10:11:54.725396 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m10:11:54.726411 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: Close
[0m10:11:54.727510 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99d90dcc-c064-4cb0-91d5-209884aebbd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8186e7d0>]}
[0m10:11:54.728097 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model fact.fact_waterlevel ................... [[32mINSERT 0 58[0m in 0.10s]
[0m10:11:54.728489 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.fact_waterlevel
[0m10:11:54.729180 [debug] [MainThread]: Using postgres connection "master"
[0m10:11:54.729464 [debug] [MainThread]: On master: BEGIN
[0m10:11:54.729677 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:11:54.731164 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m10:11:54.731459 [debug] [MainThread]: On master: COMMIT
[0m10:11:54.731711 [debug] [MainThread]: Using postgres connection "master"
[0m10:11:54.731927 [debug] [MainThread]: On master: COMMIT
[0m10:11:54.732184 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:11:54.732387 [debug] [MainThread]: On master: Close
[0m10:11:54.732647 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:11:54.732856 [debug] [MainThread]: Connection 'model.etl_waterlevel.fact_waterlevel' was properly closed.
[0m10:11:54.733072 [info ] [MainThread]: 
[0m10:11:54.733293 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.18 seconds (0.18s).
[0m10:11:54.733670 [debug] [MainThread]: Command end result
[0m10:11:54.748692 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m10:11:54.749661 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m10:11:54.752995 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m10:11:54.753245 [info ] [MainThread]: 
[0m10:11:54.753543 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:11:54.753755 [info ] [MainThread]: 
[0m10:11:54.753967 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:11:54.754474 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.48848146, "process_in_blocks": "0", "process_kernel_time": 0.061974, "process_mem_max_rss": "111404", "process_out_blocks": "1701", "process_user_time": 1.201496}
[0m10:11:54.754794 [debug] [MainThread]: Command `dbt run` succeeded at 10:11:54.754751 after 0.49 seconds
[0m10:11:54.755026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f680340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d978640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e7b31f0>]}
[0m10:11:54.755266 [debug] [MainThread]: Flushing usage events
[0m10:11:56.479445 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:20:26.186214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7a88370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6b73d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6b73d30>]}


============================== 11:20:26.190287 | 32ef4932-1d91-4ba9-b0ce-24a5ecc71eca ==============================
[0m11:20:26.190287 [info ] [MainThread]: Running with dbt=1.9.0
[0m11:20:26.190676 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --models fact_waterlevel', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:20:26.285866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '32ef4932-1d91-4ba9-b0ce-24a5ecc71eca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7b18310>]}
[0m11:20:26.313309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '32ef4932-1d91-4ba9-b0ce-24a5ecc71eca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7431810>]}
[0m11:20:26.313852 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m11:20:26.350262 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m11:20:26.401055 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:20:26.401447 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:20:26.404798 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m11:20:26.416759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '32ef4932-1d91-4ba9-b0ce-24a5ecc71eca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5e685b0>]}
[0m11:20:26.453368 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m11:20:26.457226 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m11:20:26.466768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '32ef4932-1d91-4ba9-b0ce-24a5ecc71eca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5e87220>]}
[0m11:20:26.467118 [info ] [MainThread]: Found 3 models, 434 macros
[0m11:20:26.467445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '32ef4932-1d91-4ba9-b0ce-24a5ecc71eca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5e871c0>]}
[0m11:20:26.468234 [info ] [MainThread]: 
[0m11:20:26.468539 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:20:26.468983 [info ] [MainThread]: 
[0m11:20:26.469410 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:20:26.470001 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m11:20:26.509462 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m11:20:26.509883 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m11:20:26.510172 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:20:26.513469 [debug] [ThreadPool]: SQL status: SELECT 34 in 0.003 seconds
[0m11:20:26.514276 [debug] [ThreadPool]: On list_airflow: Close
[0m11:20:26.516919 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_dim)
[0m11:20:26.520170 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m11:20:26.520449 [debug] [ThreadPool]: On list_airflow_dim: BEGIN
[0m11:20:26.520694 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:20:26.522338 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m11:20:26.522788 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m11:20:26.523186 [debug] [ThreadPool]: On list_airflow_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dim'
  
[0m11:20:26.524675 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.001 seconds
[0m11:20:26.525333 [debug] [ThreadPool]: On list_airflow_dim: ROLLBACK
[0m11:20:26.525670 [debug] [ThreadPool]: On list_airflow_dim: Close
[0m11:20:26.526064 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_dim, now list_airflow_fact)
[0m11:20:26.527518 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m11:20:26.527775 [debug] [ThreadPool]: On list_airflow_fact: BEGIN
[0m11:20:26.528008 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:20:26.529572 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m11:20:26.529887 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m11:20:26.530156 [debug] [ThreadPool]: On list_airflow_fact: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_fact"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'fact'
  
[0m11:20:26.531416 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m11:20:26.532045 [debug] [ThreadPool]: On list_airflow_fact: ROLLBACK
[0m11:20:26.532389 [debug] [ThreadPool]: On list_airflow_fact: Close
[0m11:20:26.534821 [debug] [MainThread]: Using postgres connection "master"
[0m11:20:26.535090 [debug] [MainThread]: On master: BEGIN
[0m11:20:26.535345 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:20:26.536913 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m11:20:26.537263 [debug] [MainThread]: Using postgres connection "master"
[0m11:20:26.537579 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:20:26.540669 [debug] [MainThread]: SQL status: SELECT 2 in 0.003 seconds
[0m11:20:26.541337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '32ef4932-1d91-4ba9-b0ce-24a5ecc71eca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7430fd0>]}
[0m11:20:26.541658 [debug] [MainThread]: On master: ROLLBACK
[0m11:20:26.541988 [debug] [MainThread]: Using postgres connection "master"
[0m11:20:26.542211 [debug] [MainThread]: On master: BEGIN
[0m11:20:26.542599 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m11:20:26.542895 [debug] [MainThread]: On master: COMMIT
[0m11:20:26.543175 [debug] [MainThread]: Using postgres connection "master"
[0m11:20:26.543420 [debug] [MainThread]: On master: COMMIT
[0m11:20:26.543739 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:20:26.543988 [debug] [MainThread]: On master: Close
[0m11:20:26.545146 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.fact_waterlevel
[0m11:20:26.545504 [info ] [Thread-1 (]: 1 of 1 START sql incremental model fact.fact_waterlevel ........................ [RUN]
[0m11:20:26.545826 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_fact, now model.etl_waterlevel.fact_waterlevel)
[0m11:20:26.546094 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.fact_waterlevel
[0m11:20:26.553234 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.fact_waterlevel"
[0m11:20:26.554268 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.fact_waterlevel
[0m11:20:26.582746 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m11:20:26.583109 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

    
  
    

  create temporary table "fact_waterlevel__dbt_tmp112026570645"
  
  
    as
  
  (
    

with main as (
    select
        distinct
        concat("stationId",'_',"stationCode") as station_key,
        "stationId" as station_id,
        "stationCode" as station_code,
        "waterLevel" as water_level,
        "waterlevelStatus" as waterlevel_status,
        case
            when "waterlevelStatus" = 3 then '🚨 Beyond Danger'
            when "waterlevelStatus" = 2 then '⚠️ Between Warning and Danger'
            when "waterlevelStatus" = 1 then '🔶 Between Alert and Warning'
            when "waterlevelStatus" = 0 then '✅ Between Normal and Alert'
            when "waterlevelStatus" = -1 then '🟢 Below Normal (Safe)'
            else '❓ Unknown Status'
        end as waterlevel_condition,
        "stationName",
        "districtName",
        to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp AS last_update
    from
        raw.waterlevels w
    where
        "stationStatus" = 1

        
        /* This condition is important to avoid reprocessing old data */
        and to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp > (
            select max(last_update) from "airflow"."fact"."fact_waterlevel"
        )
        
)

select * from main
  );
  
  
[0m11:20:26.583482 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:20:26.602301 [debug] [Thread-1 (]: SQL status: SELECT 72 in 0.019 seconds
[0m11:20:26.609645 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m11:20:26.609961 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: BEGIN
[0m11:20:26.610367 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m11:20:26.610723 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m11:20:26.611009 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp112026570645'
        
      order by ordinal_position

  
[0m11:20:26.613898 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.003 seconds
[0m11:20:26.616554 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m11:20:26.616860 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m11:20:26.618215 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m11:20:26.624716 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m11:20:26.625036 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp112026570645'
        
      order by ordinal_position

  
[0m11:20:26.626297 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m11:20:26.628036 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m11:20:26.628363 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m11:20:26.629558 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m11:20:26.634332 [debug] [Thread-1 (]: 
    In "airflow"."fact"."fact_waterlevel":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m11:20:26.637803 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.fact_waterlevel"
[0m11:20:26.638829 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m11:20:26.639162 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      insert into "airflow"."fact"."fact_waterlevel" ("station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update")
    (
        select "station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update"
        from "fact_waterlevel__dbt_tmp112026570645"
    )


  
[0m11:20:26.639735 [debug] [Thread-1 (]: SQL status: INSERT 0 72 in 0.000 seconds
[0m11:20:26.647339 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m11:20:26.647645 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m11:20:26.647892 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m11:20:26.650471 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m11:20:26.651552 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: Close
[0m11:20:26.652613 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32ef4932-1d91-4ba9-b0ce-24a5ecc71eca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9c92800>]}
[0m11:20:26.653055 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model fact.fact_waterlevel ................... [[32mINSERT 0 72[0m in 0.11s]
[0m11:20:26.653430 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.fact_waterlevel
[0m11:20:26.654163 [debug] [MainThread]: Using postgres connection "master"
[0m11:20:26.654419 [debug] [MainThread]: On master: BEGIN
[0m11:20:26.654628 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:20:26.656170 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m11:20:26.656448 [debug] [MainThread]: On master: COMMIT
[0m11:20:26.656693 [debug] [MainThread]: Using postgres connection "master"
[0m11:20:26.656908 [debug] [MainThread]: On master: COMMIT
[0m11:20:26.657151 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:20:26.657357 [debug] [MainThread]: On master: Close
[0m11:20:26.657625 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:20:26.657830 [debug] [MainThread]: Connection 'model.etl_waterlevel.fact_waterlevel' was properly closed.
[0m11:20:26.658043 [info ] [MainThread]: 
[0m11:20:26.658273 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.19 seconds (0.19s).
[0m11:20:26.658643 [debug] [MainThread]: Command end result
[0m11:20:26.673446 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m11:20:26.674573 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m11:20:26.678033 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m11:20:26.678289 [info ] [MainThread]: 
[0m11:20:26.678555 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:20:26.678759 [info ] [MainThread]: 
[0m11:20:26.678973 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:20:26.679489 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.51957977, "process_in_blocks": "0", "process_kernel_time": 0.114419, "process_mem_max_rss": "111460", "process_out_blocks": "1701", "process_user_time": 1.248578}
[0m11:20:26.679839 [debug] [MainThread]: Command `dbt run` succeeded at 11:20:26.679782 after 0.52 seconds
[0m11:20:26.680106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7a88370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7b18310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7af68f0>]}
[0m11:20:26.680364 [debug] [MainThread]: Flushing usage events
[0m11:20:28.488029 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:05:05.814000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fa80310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8eb6bd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8eb6bcd0>]}


============================== 12:05:05.818391 | f175d977-0593-417e-b921-f537e515e0f3 ==============================
[0m12:05:05.818391 [info ] [MainThread]: Running with dbt=1.9.0
[0m12:05:05.818860 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'profiles_dir': '/home/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models fact_waterlevel', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:05:05.910598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f175d977-0593-417e-b921-f537e515e0f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e262290>]}
[0m12:05:05.937405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f175d977-0593-417e-b921-f537e515e0f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f9d01c0>]}
[0m12:05:05.937899 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:05:05.972392 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m12:05:06.021160 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:05:06.021478 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:05:06.024714 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m12:05:06.036567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f175d977-0593-417e-b921-f537e515e0f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ddd0550>]}
[0m12:05:06.071999 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m12:05:06.075877 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m12:05:06.085433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f175d977-0593-417e-b921-f537e515e0f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ddef220>]}
[0m12:05:06.085750 [info ] [MainThread]: Found 3 models, 434 macros
[0m12:05:06.085986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f175d977-0593-417e-b921-f537e515e0f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ddef1c0>]}
[0m12:05:06.086674 [info ] [MainThread]: 
[0m12:05:06.086959 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:05:06.087216 [info ] [MainThread]: 
[0m12:05:06.087608 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:05:06.088215 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m12:05:06.128944 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m12:05:06.129429 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m12:05:06.129736 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:05:06.132829 [debug] [ThreadPool]: SQL status: SELECT 36 in 0.003 seconds
[0m12:05:06.133658 [debug] [ThreadPool]: On list_airflow: Close
[0m12:05:06.136286 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_dim)
[0m12:05:06.139579 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m12:05:06.139891 [debug] [ThreadPool]: On list_airflow_dim: BEGIN
[0m12:05:06.140152 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:05:06.141833 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m12:05:06.142168 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m12:05:06.142480 [debug] [ThreadPool]: On list_airflow_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dim'
  
[0m12:05:06.144014 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.001 seconds
[0m12:05:06.144831 [debug] [ThreadPool]: On list_airflow_dim: ROLLBACK
[0m12:05:06.145175 [debug] [ThreadPool]: On list_airflow_dim: Close
[0m12:05:06.145600 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_dim, now list_airflow_fact)
[0m12:05:06.147088 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m12:05:06.147370 [debug] [ThreadPool]: On list_airflow_fact: BEGIN
[0m12:05:06.147648 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:05:06.149491 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m12:05:06.149826 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m12:05:06.150130 [debug] [ThreadPool]: On list_airflow_fact: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_fact"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'fact'
  
[0m12:05:06.151460 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m12:05:06.152177 [debug] [ThreadPool]: On list_airflow_fact: ROLLBACK
[0m12:05:06.152501 [debug] [ThreadPool]: On list_airflow_fact: Close
[0m12:05:06.155097 [debug] [MainThread]: Using postgres connection "master"
[0m12:05:06.155357 [debug] [MainThread]: On master: BEGIN
[0m12:05:06.155581 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:05:06.156953 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m12:05:06.157215 [debug] [MainThread]: Using postgres connection "master"
[0m12:05:06.157510 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:05:06.160851 [debug] [MainThread]: SQL status: SELECT 2 in 0.003 seconds
[0m12:05:06.161493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f175d977-0593-417e-b921-f537e515e0f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff914fbe50>]}
[0m12:05:06.161810 [debug] [MainThread]: On master: ROLLBACK
[0m12:05:06.162070 [debug] [MainThread]: Using postgres connection "master"
[0m12:05:06.162263 [debug] [MainThread]: On master: BEGIN
[0m12:05:06.162649 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:05:06.162996 [debug] [MainThread]: On master: COMMIT
[0m12:05:06.163271 [debug] [MainThread]: Using postgres connection "master"
[0m12:05:06.163536 [debug] [MainThread]: On master: COMMIT
[0m12:05:06.163881 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:05:06.164145 [debug] [MainThread]: On master: Close
[0m12:05:06.165306 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.fact_waterlevel
[0m12:05:06.165691 [info ] [Thread-1 (]: 1 of 1 START sql incremental model fact.fact_waterlevel ........................ [RUN]
[0m12:05:06.166030 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_fact, now model.etl_waterlevel.fact_waterlevel)
[0m12:05:06.166322 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.fact_waterlevel
[0m12:05:06.173501 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.fact_waterlevel"
[0m12:05:06.174786 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.fact_waterlevel
[0m12:05:06.203545 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m12:05:06.203908 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

    
  
    

  create temporary table "fact_waterlevel__dbt_tmp120506191529"
  
  
    as
  
  (
    

with main as (
    select
        distinct
        concat("stationId",'_',"stationCode") as station_key,
        "stationId" as station_id,
        "stationCode" as station_code,
        "waterLevel" as water_level,
        "waterlevelStatus" as waterlevel_status,
        case
            when "waterlevelStatus" = 3 then '🚨 Beyond Danger'
            when "waterlevelStatus" = 2 then '⚠️ Between Warning and Danger'
            when "waterlevelStatus" = 1 then '🔶 Between Alert and Warning'
            when "waterlevelStatus" = 0 then '✅ Between Normal and Alert'
            when "waterlevelStatus" = -1 then '🟢 Below Normal (Safe)'
            else '❓ Unknown Status'
        end as waterlevel_condition,
        "stationName",
        "districtName",
        to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp AS last_update
    from
        raw.waterlevels w
    where
        "stationStatus" = 1

        
        /* This condition is important to avoid reprocessing old data */
        and to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp > (
            select max(last_update) from "airflow"."fact"."fact_waterlevel"
        )
        
)

select * from main
  );
  
  
[0m12:05:06.204267 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:05:06.222658 [debug] [Thread-1 (]: SQL status: SELECT 72 in 0.018 seconds
[0m12:05:06.229996 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m12:05:06.230299 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: BEGIN
[0m12:05:06.230701 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m12:05:06.231058 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m12:05:06.231337 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp120506191529'
        
      order by ordinal_position

  
[0m12:05:06.234159 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.003 seconds
[0m12:05:06.236871 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m12:05:06.237176 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m12:05:06.238536 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m12:05:06.245714 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m12:05:06.246062 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp120506191529'
        
      order by ordinal_position

  
[0m12:05:06.247378 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m12:05:06.249149 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m12:05:06.249506 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m12:05:06.250647 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m12:05:06.255365 [debug] [Thread-1 (]: 
    In "airflow"."fact"."fact_waterlevel":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m12:05:06.258878 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.fact_waterlevel"
[0m12:05:06.259806 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m12:05:06.260120 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      insert into "airflow"."fact"."fact_waterlevel" ("station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update")
    (
        select "station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update"
        from "fact_waterlevel__dbt_tmp120506191529"
    )


  
[0m12:05:06.260671 [debug] [Thread-1 (]: SQL status: INSERT 0 72 in 0.000 seconds
[0m12:05:06.268344 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m12:05:06.268655 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m12:05:06.268939 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m12:05:06.272760 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m12:05:06.273824 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: Close
[0m12:05:06.274866 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f175d977-0593-417e-b921-f537e515e0f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91c0a7a0>]}
[0m12:05:06.275293 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model fact.fact_waterlevel ................... [[32mINSERT 0 72[0m in 0.11s]
[0m12:05:06.275647 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.fact_waterlevel
[0m12:05:06.276363 [debug] [MainThread]: Using postgres connection "master"
[0m12:05:06.276582 [debug] [MainThread]: On master: BEGIN
[0m12:05:06.276786 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:05:06.278291 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m12:05:06.278568 [debug] [MainThread]: On master: COMMIT
[0m12:05:06.278828 [debug] [MainThread]: Using postgres connection "master"
[0m12:05:06.279038 [debug] [MainThread]: On master: COMMIT
[0m12:05:06.279286 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:05:06.279481 [debug] [MainThread]: On master: Close
[0m12:05:06.279744 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:05:06.279950 [debug] [MainThread]: Connection 'model.etl_waterlevel.fact_waterlevel' was properly closed.
[0m12:05:06.280167 [info ] [MainThread]: 
[0m12:05:06.280385 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.19 seconds (0.19s).
[0m12:05:06.280774 [debug] [MainThread]: Command end result
[0m12:05:06.296434 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m12:05:06.297702 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m12:05:06.301243 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m12:05:06.301469 [info ] [MainThread]: 
[0m12:05:06.301753 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:05:06.301995 [info ] [MainThread]: 
[0m12:05:06.302236 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:05:06.302767 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.51508254, "process_in_blocks": "0", "process_kernel_time": 0.111981, "process_mem_max_rss": "111420", "process_out_blocks": "1701", "process_user_time": 1.220795}
[0m12:05:06.303113 [debug] [MainThread]: Command `dbt run` succeeded at 12:05:06.303062 after 0.52 seconds
[0m12:05:06.303369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fa80310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e262290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8faef6d0>]}
[0m12:05:06.303614 [debug] [MainThread]: Flushing usage events
[0m12:05:07.594260 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:05:05.256204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0574340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f65c4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f65c550>]}


============================== 13:05:05.260150 | 0ec6b551-7dd9-446a-af07-8f92ccfff667 ==============================
[0m13:05:05.260150 [info ] [MainThread]: Running with dbt=1.9.0
[0m13:05:05.260551 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/logs', 'profiles_dir': '/home/airflow/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --models fact_waterlevel', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:05:05.361791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0ec6b551-7dd9-446a-af07-8f92ccfff667', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa272a7a0>]}
[0m13:05:05.392646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0ec6b551-7dd9-446a-af07-8f92ccfff667', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa06327a0>]}
[0m13:05:05.393391 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:05:05.431259 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m13:05:05.488049 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:05:05.488492 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:05:05.491796 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m13:05:05.505040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0ec6b551-7dd9-446a-af07-8f92ccfff667', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e8d4580>]}
[0m13:05:05.543046 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m13:05:05.547055 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m13:05:05.557538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0ec6b551-7dd9-446a-af07-8f92ccfff667', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e8f3220>]}
[0m13:05:05.557917 [info ] [MainThread]: Found 3 models, 434 macros
[0m13:05:05.558221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0ec6b551-7dd9-446a-af07-8f92ccfff667', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e8f31c0>]}
[0m13:05:05.559158 [info ] [MainThread]: 
[0m13:05:05.559507 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:05:05.559813 [info ] [MainThread]: 
[0m13:05:05.560330 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:05:05.560938 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m13:05:05.603150 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m13:05:05.603573 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m13:05:05.603852 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:05:05.607007 [debug] [ThreadPool]: SQL status: SELECT 36 in 0.003 seconds
[0m13:05:05.607898 [debug] [ThreadPool]: On list_airflow: Close
[0m13:05:05.610624 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_dim)
[0m13:05:05.613911 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m13:05:05.614201 [debug] [ThreadPool]: On list_airflow_dim: BEGIN
[0m13:05:05.614450 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:05:05.616179 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m13:05:05.616581 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m13:05:05.616877 [debug] [ThreadPool]: On list_airflow_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dim'
  
[0m13:05:05.618380 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.001 seconds
[0m13:05:05.619062 [debug] [ThreadPool]: On list_airflow_dim: ROLLBACK
[0m13:05:05.619413 [debug] [ThreadPool]: On list_airflow_dim: Close
[0m13:05:05.619783 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_dim, now list_airflow_fact)
[0m13:05:05.621172 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m13:05:05.621394 [debug] [ThreadPool]: On list_airflow_fact: BEGIN
[0m13:05:05.621596 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:05:05.622959 [debug] [ThreadPool]: SQL status: BEGIN in 0.001 seconds
[0m13:05:05.623266 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m13:05:05.623525 [debug] [ThreadPool]: On list_airflow_fact: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_fact"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'fact'
  
[0m13:05:05.624860 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m13:05:05.625556 [debug] [ThreadPool]: On list_airflow_fact: ROLLBACK
[0m13:05:05.625896 [debug] [ThreadPool]: On list_airflow_fact: Close
[0m13:05:05.628409 [debug] [MainThread]: Using postgres connection "master"
[0m13:05:05.628672 [debug] [MainThread]: On master: BEGIN
[0m13:05:05.628915 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:05:05.630427 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m13:05:05.630758 [debug] [MainThread]: Using postgres connection "master"
[0m13:05:05.631053 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:05:05.634129 [debug] [MainThread]: SQL status: SELECT 2 in 0.003 seconds
[0m13:05:05.634760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0ec6b551-7dd9-446a-af07-8f92ccfff667', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e8f2d10>]}
[0m13:05:05.635105 [debug] [MainThread]: On master: ROLLBACK
[0m13:05:05.635460 [debug] [MainThread]: Using postgres connection "master"
[0m13:05:05.635707 [debug] [MainThread]: On master: BEGIN
[0m13:05:05.636112 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m13:05:05.636427 [debug] [MainThread]: On master: COMMIT
[0m13:05:05.636707 [debug] [MainThread]: Using postgres connection "master"
[0m13:05:05.636946 [debug] [MainThread]: On master: COMMIT
[0m13:05:05.637269 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:05:05.637534 [debug] [MainThread]: On master: Close
[0m13:05:05.638658 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.fact_waterlevel
[0m13:05:05.639043 [info ] [Thread-1 (]: 1 of 1 START sql incremental model fact.fact_waterlevel ........................ [RUN]
[0m13:05:05.639381 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_fact, now model.etl_waterlevel.fact_waterlevel)
[0m13:05:05.639660 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.fact_waterlevel
[0m13:05:05.646817 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.fact_waterlevel"
[0m13:05:05.647916 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.fact_waterlevel
[0m13:05:05.676818 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m13:05:05.677212 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

    
  
    

  create temporary table "fact_waterlevel__dbt_tmp130505664591"
  
  
    as
  
  (
    

with main as (
    select
        distinct
        concat("stationId",'_',"stationCode") as station_key,
        "stationId" as station_id,
        "stationCode" as station_code,
        "waterLevel" as water_level,
        "waterlevelStatus" as waterlevel_status,
        case
            when "waterlevelStatus" = 3 then '🚨 Beyond Danger'
            when "waterlevelStatus" = 2 then '⚠️ Between Warning and Danger'
            when "waterlevelStatus" = 1 then '🔶 Between Alert and Warning'
            when "waterlevelStatus" = 0 then '✅ Between Normal and Alert'
            when "waterlevelStatus" = -1 then '🟢 Below Normal (Safe)'
            else '❓ Unknown Status'
        end as waterlevel_condition,
        "stationName",
        "districtName",
        to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp AS last_update
    from
        raw.waterlevels w
    where
        "stationStatus" = 1

        
        /* This condition is important to avoid reprocessing old data */
        and to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp > (
            select max(last_update) from "airflow"."fact"."fact_waterlevel"
        )
        
)

select * from main
  );
  
  
[0m13:05:05.677548 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:05:05.695974 [debug] [Thread-1 (]: SQL status: SELECT 72 in 0.018 seconds
[0m13:05:05.704432 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m13:05:05.704774 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: BEGIN
[0m13:05:05.705273 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m13:05:05.705658 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m13:05:05.705953 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp130505664591'
        
      order by ordinal_position

  
[0m13:05:05.709012 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.003 seconds
[0m13:05:05.711809 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m13:05:05.712145 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m13:05:05.713568 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m13:05:05.720214 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m13:05:05.720533 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp130505664591'
        
      order by ordinal_position

  
[0m13:05:05.721798 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m13:05:05.723567 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m13:05:05.723869 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m13:05:05.725116 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m13:05:05.729736 [debug] [Thread-1 (]: 
    In "airflow"."fact"."fact_waterlevel":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m13:05:05.733243 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.fact_waterlevel"
[0m13:05:05.734150 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m13:05:05.734446 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      insert into "airflow"."fact"."fact_waterlevel" ("station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update")
    (
        select "station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update"
        from "fact_waterlevel__dbt_tmp130505664591"
    )


  
[0m13:05:05.735018 [debug] [Thread-1 (]: SQL status: INSERT 0 72 in 0.000 seconds
[0m13:05:05.742720 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m13:05:05.743009 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m13:05:05.743254 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m13:05:05.744025 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m13:05:05.745043 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: Close
[0m13:05:05.746223 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ec6b551-7dd9-446a-af07-8f92ccfff667', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa272a7d0>]}
[0m13:05:05.746718 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model fact.fact_waterlevel ................... [[32mINSERT 0 72[0m in 0.11s]
[0m13:05:05.747115 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.fact_waterlevel
[0m13:05:05.747832 [debug] [MainThread]: Using postgres connection "master"
[0m13:05:05.748056 [debug] [MainThread]: On master: BEGIN
[0m13:05:05.748259 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:05:05.749825 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m13:05:05.750115 [debug] [MainThread]: On master: COMMIT
[0m13:05:05.750374 [debug] [MainThread]: Using postgres connection "master"
[0m13:05:05.750588 [debug] [MainThread]: On master: COMMIT
[0m13:05:05.750829 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:05:05.751026 [debug] [MainThread]: On master: Close
[0m13:05:05.751302 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:05:05.751534 [debug] [MainThread]: Connection 'model.etl_waterlevel.fact_waterlevel' was properly closed.
[0m13:05:05.751755 [info ] [MainThread]: 
[0m13:05:05.751973 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.19 seconds (0.19s).
[0m13:05:05.752380 [debug] [MainThread]: Command end result
[0m13:05:05.766802 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m13:05:05.767962 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m13:05:05.771824 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m13:05:05.772057 [info ] [MainThread]: 
[0m13:05:05.772344 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:05:05.772560 [info ] [MainThread]: 
[0m13:05:05.772775 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:05:05.773295 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.54672927, "process_in_blocks": "0", "process_kernel_time": 0.118917, "process_mem_max_rss": "111388", "process_out_blocks": "1701", "process_user_time": 1.281106}
[0m13:05:05.773610 [debug] [MainThread]: Command `dbt run` succeeded at 13:05:05.773567 after 0.55 seconds
[0m13:05:05.773844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0574340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ebdc190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa378c4f0>]}
[0m13:05:05.774082 [debug] [MainThread]: Flushing usage events
[0m13:05:07.103642 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:05:05.717020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf880310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae96bd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae96bca0>]}


============================== 14:05:05.721304 | d59ada44-7fcd-4a74-84e6-67e3770b398e ==============================
[0m14:05:05.721304 [info ] [MainThread]: Running with dbt=1.9.0
[0m14:05:05.721683 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --models fact_waterlevel', 'send_anonymous_usage_stats': 'True'}
[0m14:05:05.816382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd59ada44-7fcd-4a74-84e6-67e3770b398e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb19fd900>]}
[0m14:05:05.843264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd59ada44-7fcd-4a74-84e6-67e3770b398e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf7d01c0>]}
[0m14:05:05.843756 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:05:05.881449 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m14:05:05.932489 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:05:05.932822 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:05:05.936026 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m14:05:05.948169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd59ada44-7fcd-4a74-84e6-67e3770b398e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffadbd0520>]}
[0m14:05:05.988451 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m14:05:05.992493 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m14:05:06.002617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd59ada44-7fcd-4a74-84e6-67e3770b398e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffadbef220>]}
[0m14:05:06.002970 [info ] [MainThread]: Found 3 models, 434 macros
[0m14:05:06.003270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd59ada44-7fcd-4a74-84e6-67e3770b398e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffadbef1c0>]}
[0m14:05:06.004029 [info ] [MainThread]: 
[0m14:05:06.004329 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:05:06.004605 [info ] [MainThread]: 
[0m14:05:06.004962 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:05:06.005576 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m14:05:06.046627 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m14:05:06.047047 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m14:05:06.047434 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:06.050723 [debug] [ThreadPool]: SQL status: SELECT 36 in 0.003 seconds
[0m14:05:06.051548 [debug] [ThreadPool]: On list_airflow: Close
[0m14:05:06.054185 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_fact)
[0m14:05:06.057433 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m14:05:06.057716 [debug] [ThreadPool]: On list_airflow_fact: BEGIN
[0m14:05:06.057961 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:06.059701 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m14:05:06.060198 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m14:05:06.060498 [debug] [ThreadPool]: On list_airflow_fact: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_fact"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'fact'
  
[0m14:05:06.061924 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m14:05:06.062595 [debug] [ThreadPool]: On list_airflow_fact: ROLLBACK
[0m14:05:06.062928 [debug] [ThreadPool]: On list_airflow_fact: Close
[0m14:05:06.063320 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_fact, now list_airflow_dim)
[0m14:05:06.064665 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m14:05:06.064919 [debug] [ThreadPool]: On list_airflow_dim: BEGIN
[0m14:05:06.065163 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:06.066709 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m14:05:06.067021 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m14:05:06.067288 [debug] [ThreadPool]: On list_airflow_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dim'
  
[0m14:05:06.068555 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.001 seconds
[0m14:05:06.069204 [debug] [ThreadPool]: On list_airflow_dim: ROLLBACK
[0m14:05:06.069532 [debug] [ThreadPool]: On list_airflow_dim: Close
[0m14:05:06.071994 [debug] [MainThread]: Using postgres connection "master"
[0m14:05:06.072267 [debug] [MainThread]: On master: BEGIN
[0m14:05:06.072504 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:06.074066 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m14:05:06.074378 [debug] [MainThread]: Using postgres connection "master"
[0m14:05:06.074672 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:05:06.078186 [debug] [MainThread]: SQL status: SELECT 2 in 0.003 seconds
[0m14:05:06.078843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd59ada44-7fcd-4a74-84e6-67e3770b398e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf22a440>]}
[0m14:05:06.079186 [debug] [MainThread]: On master: ROLLBACK
[0m14:05:06.079555 [debug] [MainThread]: Using postgres connection "master"
[0m14:05:06.079809 [debug] [MainThread]: On master: BEGIN
[0m14:05:06.080215 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:05:06.080499 [debug] [MainThread]: On master: COMMIT
[0m14:05:06.080741 [debug] [MainThread]: Using postgres connection "master"
[0m14:05:06.080977 [debug] [MainThread]: On master: COMMIT
[0m14:05:06.081321 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:05:06.081586 [debug] [MainThread]: On master: Close
[0m14:05:06.082734 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.fact_waterlevel
[0m14:05:06.083098 [info ] [Thread-1 (]: 1 of 1 START sql incremental model fact.fact_waterlevel ........................ [RUN]
[0m14:05:06.083427 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_dim, now model.etl_waterlevel.fact_waterlevel)
[0m14:05:06.083693 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.fact_waterlevel
[0m14:05:06.090790 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.fact_waterlevel"
[0m14:05:06.092555 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.fact_waterlevel
[0m14:05:06.121372 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m14:05:06.121729 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

    
  
    

  create temporary table "fact_waterlevel__dbt_tmp140506109417"
  
  
    as
  
  (
    

with main as (
    select
        distinct
        concat("stationId",'_',"stationCode") as station_key,
        "stationId" as station_id,
        "stationCode" as station_code,
        "waterLevel" as water_level,
        "waterlevelStatus" as waterlevel_status,
        case
            when "waterlevelStatus" = 3 then '🚨 Beyond Danger'
            when "waterlevelStatus" = 2 then '⚠️ Between Warning and Danger'
            when "waterlevelStatus" = 1 then '🔶 Between Alert and Warning'
            when "waterlevelStatus" = 0 then '✅ Between Normal and Alert'
            when "waterlevelStatus" = -1 then '🟢 Below Normal (Safe)'
            else '❓ Unknown Status'
        end as waterlevel_condition,
        "stationName",
        "districtName",
        to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp AS last_update
    from
        raw.waterlevels w
    where
        "stationStatus" = 1

        
        /* This condition is important to avoid reprocessing old data */
        and to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp > (
            select max(last_update) from "airflow"."fact"."fact_waterlevel"
        )
        
)

select * from main
  );
  
  
[0m14:05:06.122055 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:06.140503 [debug] [Thread-1 (]: SQL status: SELECT 72 in 0.018 seconds
[0m14:05:06.147859 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m14:05:06.148173 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: BEGIN
[0m14:05:06.148567 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m14:05:06.148919 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m14:05:06.149213 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp140506109417'
        
      order by ordinal_position

  
[0m14:05:06.152003 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.002 seconds
[0m14:05:06.154635 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m14:05:06.154940 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m14:05:06.156300 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m14:05:06.162836 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m14:05:06.163165 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp140506109417'
        
      order by ordinal_position

  
[0m14:05:06.164383 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m14:05:06.166069 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m14:05:06.166386 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m14:05:06.167553 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m14:05:06.172234 [debug] [Thread-1 (]: 
    In "airflow"."fact"."fact_waterlevel":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m14:05:06.175710 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.fact_waterlevel"
[0m14:05:06.176770 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m14:05:06.177086 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      insert into "airflow"."fact"."fact_waterlevel" ("station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update")
    (
        select "station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update"
        from "fact_waterlevel__dbt_tmp140506109417"
    )


  
[0m14:05:06.177773 [debug] [Thread-1 (]: SQL status: INSERT 0 72 in 0.000 seconds
[0m14:05:06.185597 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m14:05:06.185892 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m14:05:06.186123 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m14:05:06.186987 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m14:05:06.188073 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: Close
[0m14:05:06.189184 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd59ada44-7fcd-4a74-84e6-67e3770b398e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb198dae0>]}
[0m14:05:06.189755 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model fact.fact_waterlevel ................... [[32mINSERT 0 72[0m in 0.11s]
[0m14:05:06.190255 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.fact_waterlevel
[0m14:05:06.190965 [debug] [MainThread]: Using postgres connection "master"
[0m14:05:06.191201 [debug] [MainThread]: On master: BEGIN
[0m14:05:06.191408 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:05:06.193074 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m14:05:06.193360 [debug] [MainThread]: On master: COMMIT
[0m14:05:06.193601 [debug] [MainThread]: Using postgres connection "master"
[0m14:05:06.193801 [debug] [MainThread]: On master: COMMIT
[0m14:05:06.194039 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:05:06.194244 [debug] [MainThread]: On master: Close
[0m14:05:06.194548 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:06.194775 [debug] [MainThread]: Connection 'model.etl_waterlevel.fact_waterlevel' was properly closed.
[0m14:05:06.195011 [info ] [MainThread]: 
[0m14:05:06.195247 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.19 seconds (0.19s).
[0m14:05:06.195622 [debug] [MainThread]: Command end result
[0m14:05:06.210567 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m14:05:06.211850 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m14:05:06.215360 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m14:05:06.215579 [info ] [MainThread]: 
[0m14:05:06.215844 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:06.216081 [info ] [MainThread]: 
[0m14:05:06.216306 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:05:06.216842 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.52651614, "process_in_blocks": "0", "process_kernel_time": 0.096596, "process_mem_max_rss": "111248", "process_out_blocks": "1701", "process_user_time": 1.237826}
[0m14:05:06.217173 [debug] [MainThread]: Command `dbt run` succeeded at 14:05:06.217122 after 0.53 seconds
[0m14:05:06.217416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf880310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf743880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffadb9cca0>]}
[0m14:05:06.217664 [debug] [MainThread]: Flushing usage events
[0m14:05:07.671324 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:05:05.408770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cd8c280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7be7bca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7be7bc40>]}


============================== 15:05:05.412214 | 2fd030c0-ee8c-4604-b0a7-6b50cf338538 ==============================
[0m15:05:05.412214 [info ] [MainThread]: Running with dbt=1.9.0
[0m15:05:05.412557 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'debug': 'False', 'profiles_dir': '/home/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --models fact_waterlevel', 'send_anonymous_usage_stats': 'True'}
[0m15:05:05.506847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2fd030c0-ee8c-4604-b0a7-6b50cf338538', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b59a170>]}
[0m15:05:05.534688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2fd030c0-ee8c-4604-b0a7-6b50cf338538', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ce1af80>]}
[0m15:05:05.535192 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:05:05.570325 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m15:05:05.620659 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:05:05.621016 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:05:05.624242 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m15:05:05.636399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2fd030c0-ee8c-4604-b0a7-6b50cf338538', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b1244c0>]}
[0m15:05:05.672732 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m15:05:05.676510 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m15:05:05.687593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2fd030c0-ee8c-4604-b0a7-6b50cf338538', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b143220>]}
[0m15:05:05.687939 [info ] [MainThread]: Found 3 models, 434 macros
[0m15:05:05.688244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2fd030c0-ee8c-4604-b0a7-6b50cf338538', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b1431c0>]}
[0m15:05:05.689004 [info ] [MainThread]: 
[0m15:05:05.689307 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:05:05.689571 [info ] [MainThread]: 
[0m15:05:05.689926 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:05:05.690514 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m15:05:05.733176 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m15:05:05.733613 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m15:05:05.733894 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:05:05.737174 [debug] [ThreadPool]: SQL status: SELECT 36 in 0.003 seconds
[0m15:05:05.738144 [debug] [ThreadPool]: On list_airflow: Close
[0m15:05:05.741204 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_dim)
[0m15:05:05.745838 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m15:05:05.746181 [debug] [ThreadPool]: On list_airflow_dim: BEGIN
[0m15:05:05.746455 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:05:05.748391 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m15:05:05.748764 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m15:05:05.749078 [debug] [ThreadPool]: On list_airflow_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dim'
  
[0m15:05:05.750654 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.001 seconds
[0m15:05:05.751445 [debug] [ThreadPool]: On list_airflow_dim: ROLLBACK
[0m15:05:05.751794 [debug] [ThreadPool]: On list_airflow_dim: Close
[0m15:05:05.752221 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_dim, now list_airflow_fact)
[0m15:05:05.753682 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m15:05:05.753951 [debug] [ThreadPool]: On list_airflow_fact: BEGIN
[0m15:05:05.754277 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:05:05.755968 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m15:05:05.756306 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m15:05:05.756613 [debug] [ThreadPool]: On list_airflow_fact: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_fact"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'fact'
  
[0m15:05:05.757946 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m15:05:05.758635 [debug] [ThreadPool]: On list_airflow_fact: ROLLBACK
[0m15:05:05.759003 [debug] [ThreadPool]: On list_airflow_fact: Close
[0m15:05:05.761909 [debug] [MainThread]: Using postgres connection "master"
[0m15:05:05.762214 [debug] [MainThread]: On master: BEGIN
[0m15:05:05.762477 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:05:05.764178 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m15:05:05.764496 [debug] [MainThread]: Using postgres connection "master"
[0m15:05:05.764842 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:05:05.768024 [debug] [MainThread]: SQL status: SELECT 2 in 0.003 seconds
[0m15:05:05.768686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2fd030c0-ee8c-4604-b0a7-6b50cf338538', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cdf1480>]}
[0m15:05:05.769066 [debug] [MainThread]: On master: ROLLBACK
[0m15:05:05.769403 [debug] [MainThread]: Using postgres connection "master"
[0m15:05:05.769679 [debug] [MainThread]: On master: BEGIN
[0m15:05:05.770125 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:05:05.770490 [debug] [MainThread]: On master: COMMIT
[0m15:05:05.770769 [debug] [MainThread]: Using postgres connection "master"
[0m15:05:05.771034 [debug] [MainThread]: On master: COMMIT
[0m15:05:05.771401 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:05:05.771661 [debug] [MainThread]: On master: Close
[0m15:05:05.772904 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.fact_waterlevel
[0m15:05:05.773309 [info ] [Thread-1 (]: 1 of 1 START sql incremental model fact.fact_waterlevel ........................ [RUN]
[0m15:05:05.773695 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_fact, now model.etl_waterlevel.fact_waterlevel)
[0m15:05:05.774005 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.fact_waterlevel
[0m15:05:05.781923 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.fact_waterlevel"
[0m15:05:05.782685 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.fact_waterlevel
[0m15:05:05.811307 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m15:05:05.811664 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

    
  
    

  create temporary table "fact_waterlevel__dbt_tmp150505799298"
  
  
    as
  
  (
    

with main as (
    select
        distinct
        concat("stationId",'_',"stationCode") as station_key,
        "stationId" as station_id,
        "stationCode" as station_code,
        "waterLevel" as water_level,
        "waterlevelStatus" as waterlevel_status,
        case
            when "waterlevelStatus" = 3 then '🚨 Beyond Danger'
            when "waterlevelStatus" = 2 then '⚠️ Between Warning and Danger'
            when "waterlevelStatus" = 1 then '🔶 Between Alert and Warning'
            when "waterlevelStatus" = 0 then '✅ Between Normal and Alert'
            when "waterlevelStatus" = -1 then '🟢 Below Normal (Safe)'
            else '❓ Unknown Status'
        end as waterlevel_condition,
        "stationName",
        "districtName",
        to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp AS last_update
    from
        raw.waterlevels w
    where
        "stationStatus" = 1

        
        /* This condition is important to avoid reprocessing old data */
        and to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp > (
            select max(last_update) from "airflow"."fact"."fact_waterlevel"
        )
        
)

select * from main
  );
  
  
[0m15:05:05.812050 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:05:05.837436 [debug] [Thread-1 (]: SQL status: SELECT 72 in 0.025 seconds
[0m15:05:05.844759 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m15:05:05.845102 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: BEGIN
[0m15:05:05.845525 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m15:05:05.845883 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m15:05:05.846206 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp150505799298'
        
      order by ordinal_position

  
[0m15:05:05.849156 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.003 seconds
[0m15:05:05.851983 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m15:05:05.852299 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m15:05:05.853679 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m15:05:05.860185 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m15:05:05.860500 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp150505799298'
        
      order by ordinal_position

  
[0m15:05:05.861663 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m15:05:05.863411 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m15:05:05.863708 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m15:05:05.864933 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m15:05:05.869614 [debug] [Thread-1 (]: 
    In "airflow"."fact"."fact_waterlevel":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m15:05:05.873065 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.fact_waterlevel"
[0m15:05:05.873952 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m15:05:05.874274 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      insert into "airflow"."fact"."fact_waterlevel" ("station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update")
    (
        select "station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update"
        from "fact_waterlevel__dbt_tmp150505799298"
    )


  
[0m15:05:05.874831 [debug] [Thread-1 (]: SQL status: INSERT 0 72 in 0.000 seconds
[0m15:05:05.882295 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m15:05:05.882571 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m15:05:05.882796 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m15:05:05.885273 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m15:05:05.886445 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: Close
[0m15:05:05.887577 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2fd030c0-ee8c-4604-b0a7-6b50cf338538', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ec1d9f0>]}
[0m15:05:05.888060 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model fact.fact_waterlevel ................... [[32mINSERT 0 72[0m in 0.11s]
[0m15:05:05.888434 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.fact_waterlevel
[0m15:05:05.889150 [debug] [MainThread]: Using postgres connection "master"
[0m15:05:05.889381 [debug] [MainThread]: On master: BEGIN
[0m15:05:05.889601 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:05:05.891175 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m15:05:05.891467 [debug] [MainThread]: On master: COMMIT
[0m15:05:05.891697 [debug] [MainThread]: Using postgres connection "master"
[0m15:05:05.891912 [debug] [MainThread]: On master: COMMIT
[0m15:05:05.892217 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:05:05.892437 [debug] [MainThread]: On master: Close
[0m15:05:05.892707 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:05:05.892919 [debug] [MainThread]: Connection 'model.etl_waterlevel.fact_waterlevel' was properly closed.
[0m15:05:05.893167 [info ] [MainThread]: 
[0m15:05:05.893421 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.20 seconds (0.20s).
[0m15:05:05.893830 [debug] [MainThread]: Command end result
[0m15:05:05.908829 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m15:05:05.910538 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m15:05:05.914590 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m15:05:05.914851 [info ] [MainThread]: 
[0m15:05:05.915140 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:05:05.915361 [info ] [MainThread]: 
[0m15:05:05.915588 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:05:05.916162 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.5345564, "process_in_blocks": "0", "process_kernel_time": 0.148298, "process_mem_max_rss": "111372", "process_out_blocks": "1701", "process_user_time": 1.243121}
[0m15:05:05.916497 [debug] [MainThread]: Command `dbt run` succeeded at 15:05:05.916450 after 0.53 seconds
[0m15:05:05.916743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cd8c280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b59a170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ce1ea40>]}
[0m15:05:05.916996 [debug] [MainThread]: Flushing usage events
[0m15:05:07.454047 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:20:26.336426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8294c2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81a48520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81a48580>]}


============================== 16:20:26.339355 | 652cfd53-5dd9-4320-ade5-50ad7a903f98 ==============================
[0m16:20:26.339355 [info ] [MainThread]: Running with dbt=1.9.0
[0m16:20:26.339741 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --models fact_waterlevel', 'send_anonymous_usage_stats': 'True'}
[0m16:20:26.426162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '652cfd53-5dd9-4320-ade5-50ad7a903f98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff810d69e0>]}
[0m16:20:26.452610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '652cfd53-5dd9-4320-ade5-50ad7a903f98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81a48040>]}
[0m16:20:26.453099 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:20:26.486692 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m16:20:26.538187 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:20:26.538602 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:20:26.542002 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m16:20:26.554730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '652cfd53-5dd9-4320-ade5-50ad7a903f98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80c50520>]}
[0m16:20:26.594174 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m16:20:26.598106 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m16:20:26.607025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '652cfd53-5dd9-4320-ade5-50ad7a903f98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80c6f220>]}
[0m16:20:26.607382 [info ] [MainThread]: Found 3 models, 434 macros
[0m16:20:26.607630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '652cfd53-5dd9-4320-ade5-50ad7a903f98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80c6f1c0>]}
[0m16:20:26.608347 [info ] [MainThread]: 
[0m16:20:26.608590 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:20:26.608793 [info ] [MainThread]: 
[0m16:20:26.609098 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:20:26.609700 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m16:20:26.648457 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m16:20:26.648862 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m16:20:26.649150 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:20:26.652114 [debug] [ThreadPool]: SQL status: SELECT 36 in 0.003 seconds
[0m16:20:26.652930 [debug] [ThreadPool]: On list_airflow: Close
[0m16:20:26.655630 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_fact)
[0m16:20:26.658789 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m16:20:26.659073 [debug] [ThreadPool]: On list_airflow_fact: BEGIN
[0m16:20:26.659327 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:20:26.660956 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m16:20:26.661319 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m16:20:26.661586 [debug] [ThreadPool]: On list_airflow_fact: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_fact"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'fact'
  
[0m16:20:26.662909 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m16:20:26.663582 [debug] [ThreadPool]: On list_airflow_fact: ROLLBACK
[0m16:20:26.663926 [debug] [ThreadPool]: On list_airflow_fact: Close
[0m16:20:26.664326 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_fact, now list_airflow_dim)
[0m16:20:26.665624 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m16:20:26.665886 [debug] [ThreadPool]: On list_airflow_dim: BEGIN
[0m16:20:26.666123 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:20:26.667616 [debug] [ThreadPool]: SQL status: BEGIN in 0.001 seconds
[0m16:20:26.667915 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m16:20:26.668170 [debug] [ThreadPool]: On list_airflow_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dim'
  
[0m16:20:26.669454 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.001 seconds
[0m16:20:26.670074 [debug] [ThreadPool]: On list_airflow_dim: ROLLBACK
[0m16:20:26.670400 [debug] [ThreadPool]: On list_airflow_dim: Close
[0m16:20:26.672848 [debug] [MainThread]: Using postgres connection "master"
[0m16:20:26.673105 [debug] [MainThread]: On master: BEGIN
[0m16:20:26.673342 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:20:26.674802 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m16:20:26.675097 [debug] [MainThread]: Using postgres connection "master"
[0m16:20:26.675407 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:20:26.678236 [debug] [MainThread]: SQL status: SELECT 2 in 0.003 seconds
[0m16:20:26.678888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '652cfd53-5dd9-4320-ade5-50ad7a903f98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84a50ca0>]}
[0m16:20:26.679228 [debug] [MainThread]: On master: ROLLBACK
[0m16:20:26.679582 [debug] [MainThread]: Using postgres connection "master"
[0m16:20:26.679824 [debug] [MainThread]: On master: BEGIN
[0m16:20:26.680239 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m16:20:26.680541 [debug] [MainThread]: On master: COMMIT
[0m16:20:26.680777 [debug] [MainThread]: Using postgres connection "master"
[0m16:20:26.681014 [debug] [MainThread]: On master: COMMIT
[0m16:20:26.681353 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:20:26.681597 [debug] [MainThread]: On master: Close
[0m16:20:26.682784 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.fact_waterlevel
[0m16:20:26.683182 [info ] [Thread-1 (]: 1 of 1 START sql incremental model fact.fact_waterlevel ........................ [RUN]
[0m16:20:26.683550 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_dim, now model.etl_waterlevel.fact_waterlevel)
[0m16:20:26.683827 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.fact_waterlevel
[0m16:20:26.690680 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.fact_waterlevel"
[0m16:20:26.691940 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.fact_waterlevel
[0m16:20:26.719832 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m16:20:26.720192 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

    
  
    

  create temporary table "fact_waterlevel__dbt_tmp162026707825"
  
  
    as
  
  (
    

with main as (
    select
        distinct
        concat("stationId",'_',"stationCode") as station_key,
        "stationId" as station_id,
        "stationCode" as station_code,
        "waterLevel" as water_level,
        "waterlevelStatus" as waterlevel_status,
        case
            when "waterlevelStatus" = 3 then '🚨 Beyond Danger'
            when "waterlevelStatus" = 2 then '⚠️ Between Warning and Danger'
            when "waterlevelStatus" = 1 then '🔶 Between Alert and Warning'
            when "waterlevelStatus" = 0 then '✅ Between Normal and Alert'
            when "waterlevelStatus" = -1 then '🟢 Below Normal (Safe)'
            else '❓ Unknown Status'
        end as waterlevel_condition,
        "stationName",
        "districtName",
        to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp AS last_update
    from
        raw.waterlevels w
    where
        "stationStatus" = 1

        
        /* This condition is important to avoid reprocessing old data */
        and to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp > (
            select max(last_update) from "airflow"."fact"."fact_waterlevel"
        )
        
)

select * from main
  );
  
  
[0m16:20:26.720536 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:20:26.735307 [debug] [Thread-1 (]: SQL status: SELECT 72 in 0.015 seconds
[0m16:20:26.742382 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m16:20:26.742698 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: BEGIN
[0m16:20:26.743111 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m16:20:26.743452 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m16:20:26.743742 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp162026707825'
        
      order by ordinal_position

  
[0m16:20:26.746379 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.002 seconds
[0m16:20:26.748990 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m16:20:26.749309 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m16:20:26.750642 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m16:20:26.757017 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m16:20:26.757327 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp162026707825'
        
      order by ordinal_position

  
[0m16:20:26.758552 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m16:20:26.760251 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m16:20:26.760578 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m16:20:26.761753 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m16:20:26.766285 [debug] [Thread-1 (]: 
    In "airflow"."fact"."fact_waterlevel":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m16:20:26.769702 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.fact_waterlevel"
[0m16:20:26.770720 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m16:20:26.771010 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      insert into "airflow"."fact"."fact_waterlevel" ("station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update")
    (
        select "station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update"
        from "fact_waterlevel__dbt_tmp162026707825"
    )


  
[0m16:20:26.771527 [debug] [Thread-1 (]: SQL status: INSERT 0 72 in 0.000 seconds
[0m16:20:26.779033 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m16:20:26.779331 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m16:20:26.779571 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m16:20:26.781969 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m16:20:26.783021 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: Close
[0m16:20:26.784144 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '652cfd53-5dd9-4320-ade5-50ad7a903f98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84abe770>]}
[0m16:20:26.784673 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model fact.fact_waterlevel ................... [[32mINSERT 0 72[0m in 0.10s]
[0m16:20:26.785064 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.fact_waterlevel
[0m16:20:26.785766 [debug] [MainThread]: Using postgres connection "master"
[0m16:20:26.786044 [debug] [MainThread]: On master: BEGIN
[0m16:20:26.786276 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:20:26.787743 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m16:20:26.788002 [debug] [MainThread]: On master: COMMIT
[0m16:20:26.788242 [debug] [MainThread]: Using postgres connection "master"
[0m16:20:26.788438 [debug] [MainThread]: On master: COMMIT
[0m16:20:26.788710 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:20:26.788945 [debug] [MainThread]: On master: Close
[0m16:20:26.789225 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:20:26.789440 [debug] [MainThread]: Connection 'model.etl_waterlevel.fact_waterlevel' was properly closed.
[0m16:20:26.789658 [info ] [MainThread]: 
[0m16:20:26.789876 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.18 seconds (0.18s).
[0m16:20:26.790254 [debug] [MainThread]: Command end result
[0m16:20:26.804351 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m16:20:26.805424 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m16:20:26.808793 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m16:20:26.809028 [info ] [MainThread]: 
[0m16:20:26.809304 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:20:26.809538 [info ] [MainThread]: 
[0m16:20:26.809782 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:20:26.810301 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.50044066, "process_in_blocks": "0", "process_kernel_time": 0.074214, "process_mem_max_rss": "111400", "process_out_blocks": "1701", "process_user_time": 1.20148}
[0m16:20:26.810621 [debug] [MainThread]: Command `dbt run` succeeded at 16:20:26.810577 after 0.50 seconds
[0m16:20:26.810854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8294c2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82967550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81a20640>]}
[0m16:20:26.811113 [debug] [MainThread]: Flushing usage events
[0m16:20:28.304583 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:09:02.690340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa928c310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa837bd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa837bcd0>]}


============================== 17:09:02.694437 | eeb1d29c-1496-45bb-978f-50ced89dcbc8 ==============================
[0m17:09:02.694437 [info ] [MainThread]: Running with dbt=1.9.0
[0m17:09:02.694828 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'profiles_dir': '/home/airflow/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --models fact_waterlevel', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:09:02.780970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eeb1d29c-1496-45bb-978f-50ced89dcbc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7a42290>]}
[0m17:09:02.807331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eeb1d29c-1496-45bb-978f-50ced89dcbc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa91dc1c0>]}
[0m17:09:02.807837 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:09:02.841831 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m17:09:02.891836 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:09:02.892132 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:09:02.895267 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m17:09:02.906831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eeb1d29c-1496-45bb-978f-50ced89dcbc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa75cc550>]}
[0m17:09:02.942016 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m17:09:02.945896 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m17:09:02.954896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eeb1d29c-1496-45bb-978f-50ced89dcbc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa75eb220>]}
[0m17:09:02.955202 [info ] [MainThread]: Found 3 models, 434 macros
[0m17:09:02.955427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eeb1d29c-1496-45bb-978f-50ced89dcbc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa75eb1c0>]}
[0m17:09:02.956099 [info ] [MainThread]: 
[0m17:09:02.956368 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:09:02.956620 [info ] [MainThread]: 
[0m17:09:02.956942 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:09:02.957556 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m17:09:02.995769 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m17:09:02.996160 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m17:09:02.996458 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:09:02.999449 [debug] [ThreadPool]: SQL status: SELECT 36 in 0.003 seconds
[0m17:09:03.000275 [debug] [ThreadPool]: On list_airflow: Close
[0m17:09:03.002853 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_fact)
[0m17:09:03.005984 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m17:09:03.006280 [debug] [ThreadPool]: On list_airflow_fact: BEGIN
[0m17:09:03.006526 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:09:03.008125 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m17:09:03.008458 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m17:09:03.008745 [debug] [ThreadPool]: On list_airflow_fact: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_fact"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'fact'
  
[0m17:09:03.010222 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m17:09:03.010923 [debug] [ThreadPool]: On list_airflow_fact: ROLLBACK
[0m17:09:03.011329 [debug] [ThreadPool]: On list_airflow_fact: Close
[0m17:09:03.011718 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_fact, now list_airflow_dim)
[0m17:09:03.013074 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m17:09:03.013407 [debug] [ThreadPool]: On list_airflow_dim: BEGIN
[0m17:09:03.013674 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:09:03.015362 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m17:09:03.015676 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m17:09:03.015948 [debug] [ThreadPool]: On list_airflow_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dim'
  
[0m17:09:03.017256 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.001 seconds
[0m17:09:03.017942 [debug] [ThreadPool]: On list_airflow_dim: ROLLBACK
[0m17:09:03.018273 [debug] [ThreadPool]: On list_airflow_dim: Close
[0m17:09:03.020827 [debug] [MainThread]: Using postgres connection "master"
[0m17:09:03.021098 [debug] [MainThread]: On master: BEGIN
[0m17:09:03.021359 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:09:03.022945 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m17:09:03.023271 [debug] [MainThread]: Using postgres connection "master"
[0m17:09:03.023573 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:09:03.026546 [debug] [MainThread]: SQL status: SELECT 2 in 0.003 seconds
[0m17:09:03.027214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eeb1d29c-1496-45bb-978f-50ced89dcbc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaad29f00>]}
[0m17:09:03.027511 [debug] [MainThread]: On master: ROLLBACK
[0m17:09:03.027845 [debug] [MainThread]: Using postgres connection "master"
[0m17:09:03.028099 [debug] [MainThread]: On master: BEGIN
[0m17:09:03.028518 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m17:09:03.028800 [debug] [MainThread]: On master: COMMIT
[0m17:09:03.029039 [debug] [MainThread]: Using postgres connection "master"
[0m17:09:03.029275 [debug] [MainThread]: On master: COMMIT
[0m17:09:03.029586 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:09:03.029828 [debug] [MainThread]: On master: Close
[0m17:09:03.030971 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.fact_waterlevel
[0m17:09:03.031344 [info ] [Thread-1 (]: 1 of 1 START sql incremental model fact.fact_waterlevel ........................ [RUN]
[0m17:09:03.031661 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_dim, now model.etl_waterlevel.fact_waterlevel)
[0m17:09:03.031929 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.fact_waterlevel
[0m17:09:03.038816 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.fact_waterlevel"
[0m17:09:03.040334 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.fact_waterlevel
[0m17:09:03.068097 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m17:09:03.068476 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

    
  
    

  create temporary table "fact_waterlevel__dbt_tmp170903055901"
  
  
    as
  
  (
    

with main as (
    select
        distinct
        concat("stationId",'_',"stationCode") as station_key,
        "stationId" as station_id,
        "stationCode" as station_code,
        "waterLevel" as water_level,
        "waterlevelStatus" as waterlevel_status,
        case
            when "waterlevelStatus" = 3 then '🚨 Beyond Danger'
            when "waterlevelStatus" = 2 then '⚠️ Between Warning and Danger'
            when "waterlevelStatus" = 1 then '🔶 Between Alert and Warning'
            when "waterlevelStatus" = 0 then '✅ Between Normal and Alert'
            when "waterlevelStatus" = -1 then '🟢 Below Normal (Safe)'
            else '❓ Unknown Status'
        end as waterlevel_condition,
        "stationName",
        "districtName",
        to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp AS last_update
    from
        raw.waterlevels w
    where
        "stationStatus" = 1

        
        /* This condition is important to avoid reprocessing old data */
        and to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp > (
            select max(last_update) from "airflow"."fact"."fact_waterlevel"
        )
        
)

select * from main
  );
  
  
[0m17:09:03.068808 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:09:03.085233 [debug] [Thread-1 (]: SQL status: SELECT 72 in 0.016 seconds
[0m17:09:03.092240 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m17:09:03.092545 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: BEGIN
[0m17:09:03.092976 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m17:09:03.093400 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m17:09:03.093732 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp170903055901'
        
      order by ordinal_position

  
[0m17:09:03.096538 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.003 seconds
[0m17:09:03.099339 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m17:09:03.099654 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m17:09:03.100982 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m17:09:03.107376 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m17:09:03.107688 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp170903055901'
        
      order by ordinal_position

  
[0m17:09:03.108898 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m17:09:03.110618 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m17:09:03.110922 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m17:09:03.112085 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m17:09:03.116574 [debug] [Thread-1 (]: 
    In "airflow"."fact"."fact_waterlevel":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m17:09:03.119990 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.fact_waterlevel"
[0m17:09:03.120822 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m17:09:03.121131 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      insert into "airflow"."fact"."fact_waterlevel" ("station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update")
    (
        select "station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update"
        from "fact_waterlevel__dbt_tmp170903055901"
    )


  
[0m17:09:03.121665 [debug] [Thread-1 (]: SQL status: INSERT 0 72 in 0.000 seconds
[0m17:09:03.129016 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m17:09:03.129318 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m17:09:03.129590 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m17:09:03.131209 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m17:09:03.132224 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: Close
[0m17:09:03.133360 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eeb1d29c-1496-45bb-978f-50ced89dcbc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab379ae0>]}
[0m17:09:03.133828 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model fact.fact_waterlevel ................... [[32mINSERT 0 72[0m in 0.10s]
[0m17:09:03.134190 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.fact_waterlevel
[0m17:09:03.134848 [debug] [MainThread]: Using postgres connection "master"
[0m17:09:03.135104 [debug] [MainThread]: On master: BEGIN
[0m17:09:03.135319 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:09:03.136768 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m17:09:03.137041 [debug] [MainThread]: On master: COMMIT
[0m17:09:03.137283 [debug] [MainThread]: Using postgres connection "master"
[0m17:09:03.137508 [debug] [MainThread]: On master: COMMIT
[0m17:09:03.137770 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:09:03.137965 [debug] [MainThread]: On master: Close
[0m17:09:03.138226 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:09:03.138434 [debug] [MainThread]: Connection 'model.etl_waterlevel.fact_waterlevel' was properly closed.
[0m17:09:03.138649 [info ] [MainThread]: 
[0m17:09:03.138863 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.18 seconds (0.18s).
[0m17:09:03.139236 [debug] [MainThread]: Command end result
[0m17:09:03.154315 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m17:09:03.155357 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m17:09:03.159021 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m17:09:03.159267 [info ] [MainThread]: 
[0m17:09:03.159560 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:09:03.159805 [info ] [MainThread]: 
[0m17:09:03.160041 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:09:03.160596 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.49631926, "process_in_blocks": "0", "process_kernel_time": 0.095898, "process_mem_max_rss": "111488", "process_out_blocks": "1701", "process_user_time": 1.192737}
[0m17:09:03.160939 [debug] [MainThread]: Command `dbt run` succeeded at 17:09:03.160895 after 0.50 seconds
[0m17:09:03.161182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa928c310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7a42290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa92fb6d0>]}
[0m17:09:03.161416 [debug] [MainThread]: Flushing usage events
[0m17:09:04.484347 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:05:55.513824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaea50310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffadb57d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffadb57cd0>]}


============================== 18:05:55.516777 | 46721bb2-4135-420b-9ada-8d0ef2fa161b ==============================
[0m18:05:55.516777 [info ] [MainThread]: Running with dbt=1.9.0
[0m18:05:55.517196 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --models fact_waterlevel', 'send_anonymous_usage_stats': 'True'}
[0m18:05:55.600199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '46721bb2-4135-420b-9ada-8d0ef2fa161b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad1e6290>]}
[0m18:05:55.626527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '46721bb2-4135-420b-9ada-8d0ef2fa161b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae99c1c0>]}
[0m18:05:55.626981 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:05:55.660647 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m18:05:55.709637 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:05:55.709950 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:05:55.713113 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m18:05:55.724915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '46721bb2-4135-420b-9ada-8d0ef2fa161b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffacd5c550>]}
[0m18:05:55.761585 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m18:05:55.765469 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m18:05:55.774011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '46721bb2-4135-420b-9ada-8d0ef2fa161b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffacd7b220>]}
[0m18:05:55.774329 [info ] [MainThread]: Found 3 models, 434 macros
[0m18:05:55.774569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '46721bb2-4135-420b-9ada-8d0ef2fa161b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffacd7b1c0>]}
[0m18:05:55.775252 [info ] [MainThread]: 
[0m18:05:55.775510 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:05:55.775714 [info ] [MainThread]: 
[0m18:05:55.776055 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:05:55.776747 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m18:05:55.815989 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m18:05:55.816472 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m18:05:55.816775 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:05:55.819507 [debug] [ThreadPool]: SQL status: SELECT 36 in 0.003 seconds
[0m18:05:55.820306 [debug] [ThreadPool]: On list_airflow: Close
[0m18:05:55.822912 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_dim)
[0m18:05:55.826064 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m18:05:55.826419 [debug] [ThreadPool]: On list_airflow_dim: BEGIN
[0m18:05:55.826661 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:05:55.829110 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m18:05:55.829479 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m18:05:55.829741 [debug] [ThreadPool]: On list_airflow_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dim'
  
[0m18:05:55.831071 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.001 seconds
[0m18:05:55.831750 [debug] [ThreadPool]: On list_airflow_dim: ROLLBACK
[0m18:05:55.832094 [debug] [ThreadPool]: On list_airflow_dim: Close
[0m18:05:55.832498 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_dim, now list_airflow_fact)
[0m18:05:55.833908 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m18:05:55.834177 [debug] [ThreadPool]: On list_airflow_fact: BEGIN
[0m18:05:55.834415 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:05:55.835861 [debug] [ThreadPool]: SQL status: BEGIN in 0.001 seconds
[0m18:05:55.836197 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m18:05:55.836478 [debug] [ThreadPool]: On list_airflow_fact: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_fact"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'fact'
  
[0m18:05:55.837699 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m18:05:55.838323 [debug] [ThreadPool]: On list_airflow_fact: ROLLBACK
[0m18:05:55.838647 [debug] [ThreadPool]: On list_airflow_fact: Close
[0m18:05:55.841069 [debug] [MainThread]: Using postgres connection "master"
[0m18:05:55.841385 [debug] [MainThread]: On master: BEGIN
[0m18:05:55.841625 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:05:55.843112 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m18:05:55.843430 [debug] [MainThread]: Using postgres connection "master"
[0m18:05:55.843725 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:05:55.846594 [debug] [MainThread]: SQL status: SELECT 2 in 0.003 seconds
[0m18:05:55.847237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '46721bb2-4135-420b-9ada-8d0ef2fa161b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb037be50>]}
[0m18:05:55.847587 [debug] [MainThread]: On master: ROLLBACK
[0m18:05:55.847924 [debug] [MainThread]: Using postgres connection "master"
[0m18:05:55.848187 [debug] [MainThread]: On master: BEGIN
[0m18:05:55.848591 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m18:05:55.848879 [debug] [MainThread]: On master: COMMIT
[0m18:05:55.849140 [debug] [MainThread]: Using postgres connection "master"
[0m18:05:55.849378 [debug] [MainThread]: On master: COMMIT
[0m18:05:55.849703 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:05:55.849951 [debug] [MainThread]: On master: Close
[0m18:05:55.851073 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.fact_waterlevel
[0m18:05:55.851492 [info ] [Thread-1 (]: 1 of 1 START sql incremental model fact.fact_waterlevel ........................ [RUN]
[0m18:05:55.851810 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_fact, now model.etl_waterlevel.fact_waterlevel)
[0m18:05:55.852096 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.fact_waterlevel
[0m18:05:55.858939 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.fact_waterlevel"
[0m18:05:55.859889 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.fact_waterlevel
[0m18:05:55.887693 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m18:05:55.888050 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

    
  
    

  create temporary table "fact_waterlevel__dbt_tmp180555875811"
  
  
    as
  
  (
    

with main as (
    select
        distinct
        concat("stationId",'_',"stationCode") as station_key,
        "stationId" as station_id,
        "stationCode" as station_code,
        "waterLevel" as water_level,
        "waterlevelStatus" as waterlevel_status,
        case
            when "waterlevelStatus" = 3 then '🚨 Beyond Danger'
            when "waterlevelStatus" = 2 then '⚠️ Between Warning and Danger'
            when "waterlevelStatus" = 1 then '🔶 Between Alert and Warning'
            when "waterlevelStatus" = 0 then '✅ Between Normal and Alert'
            when "waterlevelStatus" = -1 then '🟢 Below Normal (Safe)'
            else '❓ Unknown Status'
        end as waterlevel_condition,
        "stationName",
        "districtName",
        to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp AS last_update
    from
        raw.waterlevels w
    where
        "stationStatus" = 1

        
        /* This condition is important to avoid reprocessing old data */
        and to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp > (
            select max(last_update) from "airflow"."fact"."fact_waterlevel"
        )
        
)

select * from main
  );
  
  
[0m18:05:55.888457 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:05:55.903184 [debug] [Thread-1 (]: SQL status: SELECT 71 in 0.015 seconds
[0m18:05:55.910246 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m18:05:55.910556 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: BEGIN
[0m18:05:55.910956 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m18:05:55.911307 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m18:05:55.911608 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp180555875811'
        
      order by ordinal_position

  
[0m18:05:55.914214 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.002 seconds
[0m18:05:55.916816 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m18:05:55.917163 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m18:05:55.918437 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m18:05:55.924898 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m18:05:55.925230 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp180555875811'
        
      order by ordinal_position

  
[0m18:05:55.926472 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m18:05:55.928208 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m18:05:55.928509 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m18:05:55.929676 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m18:05:55.934315 [debug] [Thread-1 (]: 
    In "airflow"."fact"."fact_waterlevel":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m18:05:55.937729 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.fact_waterlevel"
[0m18:05:55.938610 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m18:05:55.938924 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      insert into "airflow"."fact"."fact_waterlevel" ("station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update")
    (
        select "station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update"
        from "fact_waterlevel__dbt_tmp180555875811"
    )


  
[0m18:05:55.939413 [debug] [Thread-1 (]: SQL status: INSERT 0 71 in 0.000 seconds
[0m18:05:55.946922 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m18:05:55.947222 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m18:05:55.947498 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m18:05:55.950160 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m18:05:55.951263 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: Close
[0m18:05:55.952304 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46721bb2-4135-420b-9ada-8d0ef2fa161b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0bae7a0>]}
[0m18:05:55.952828 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model fact.fact_waterlevel ................... [[32mINSERT 0 71[0m in 0.10s]
[0m18:05:55.953245 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.fact_waterlevel
[0m18:05:55.953950 [debug] [MainThread]: Using postgres connection "master"
[0m18:05:55.954204 [debug] [MainThread]: On master: BEGIN
[0m18:05:55.954417 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:05:55.955864 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m18:05:55.956139 [debug] [MainThread]: On master: COMMIT
[0m18:05:55.956375 [debug] [MainThread]: Using postgres connection "master"
[0m18:05:55.956592 [debug] [MainThread]: On master: COMMIT
[0m18:05:55.956854 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:05:55.957058 [debug] [MainThread]: On master: Close
[0m18:05:55.957328 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:05:55.957545 [debug] [MainThread]: Connection 'model.etl_waterlevel.fact_waterlevel' was properly closed.
[0m18:05:55.957757 [info ] [MainThread]: 
[0m18:05:55.957979 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.18 seconds (0.18s).
[0m18:05:55.958355 [debug] [MainThread]: Command end result
[0m18:05:55.973277 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m18:05:55.974344 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m18:05:55.978172 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m18:05:55.978428 [info ] [MainThread]: 
[0m18:05:55.978727 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:05:55.978963 [info ] [MainThread]: 
[0m18:05:55.979192 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:05:55.979719 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.49154508, "process_in_blocks": "0", "process_kernel_time": 0.078262, "process_mem_max_rss": "111396", "process_out_blocks": "1701", "process_user_time": 1.182963}
[0m18:05:55.980065 [debug] [MainThread]: Command `dbt run` succeeded at 18:05:55.980021 after 0.49 seconds
[0m18:05:55.980316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaea50310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad1e6290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaeabf6d0>]}
[0m18:05:55.980568 [debug] [MainThread]: Flushing usage events
[0m18:05:57.691939 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:07:18.699789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9fc542b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ed57cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ed57c70>]}


============================== 19:07:18.703052 | e5253701-e527-43a6-9a26-b2d3f1b8fdf5 ==============================
[0m19:07:18.703052 [info ] [MainThread]: Running with dbt=1.9.0
[0m19:07:18.703494 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models fact_waterlevel', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:07:18.792369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e5253701-e527-43a6-9a26-b2d3f1b8fdf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1d5bd60>]}
[0m19:07:18.819090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e5253701-e527-43a6-9a26-b2d3f1b8fdf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9fb9c100>]}
[0m19:07:18.819594 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m19:07:18.853607 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m19:07:18.902420 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:07:18.902746 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:07:18.905991 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m19:07:18.917737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e5253701-e527-43a6-9a26-b2d3f1b8fdf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9df704f0>]}
[0m19:07:18.953767 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m19:07:18.957474 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m19:07:18.966255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e5253701-e527-43a6-9a26-b2d3f1b8fdf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9df8f220>]}
[0m19:07:18.966574 [info ] [MainThread]: Found 3 models, 434 macros
[0m19:07:18.966819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e5253701-e527-43a6-9a26-b2d3f1b8fdf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9df8f1c0>]}
[0m19:07:18.967570 [info ] [MainThread]: 
[0m19:07:18.967851 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:07:18.968070 [info ] [MainThread]: 
[0m19:07:18.968370 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:07:18.968931 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m19:07:19.007084 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m19:07:19.007499 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m19:07:19.007772 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:07:19.010474 [debug] [ThreadPool]: SQL status: SELECT 36 in 0.003 seconds
[0m19:07:19.011218 [debug] [ThreadPool]: On list_airflow: Close
[0m19:07:19.013874 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_fact)
[0m19:07:19.017053 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m19:07:19.017327 [debug] [ThreadPool]: On list_airflow_fact: BEGIN
[0m19:07:19.017575 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:07:19.019127 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m19:07:19.019453 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m19:07:19.019718 [debug] [ThreadPool]: On list_airflow_fact: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_fact"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'fact'
  
[0m19:07:19.021019 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m19:07:19.021688 [debug] [ThreadPool]: On list_airflow_fact: ROLLBACK
[0m19:07:19.022021 [debug] [ThreadPool]: On list_airflow_fact: Close
[0m19:07:19.022415 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_fact, now list_airflow_dim)
[0m19:07:19.023756 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m19:07:19.024015 [debug] [ThreadPool]: On list_airflow_dim: BEGIN
[0m19:07:19.024272 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:07:19.025699 [debug] [ThreadPool]: SQL status: BEGIN in 0.001 seconds
[0m19:07:19.025994 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m19:07:19.026246 [debug] [ThreadPool]: On list_airflow_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dim'
  
[0m19:07:19.027440 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.001 seconds
[0m19:07:19.028069 [debug] [ThreadPool]: On list_airflow_dim: ROLLBACK
[0m19:07:19.028387 [debug] [ThreadPool]: On list_airflow_dim: Close
[0m19:07:19.030897 [debug] [MainThread]: Using postgres connection "master"
[0m19:07:19.031190 [debug] [MainThread]: On master: BEGIN
[0m19:07:19.031421 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:07:19.032840 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m19:07:19.033151 [debug] [MainThread]: Using postgres connection "master"
[0m19:07:19.033445 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:07:19.036287 [debug] [MainThread]: SQL status: SELECT 2 in 0.003 seconds
[0m19:07:19.036954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e5253701-e527-43a6-9a26-b2d3f1b8fdf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f0f0100>]}
[0m19:07:19.037280 [debug] [MainThread]: On master: ROLLBACK
[0m19:07:19.037625 [debug] [MainThread]: Using postgres connection "master"
[0m19:07:19.037887 [debug] [MainThread]: On master: BEGIN
[0m19:07:19.038286 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m19:07:19.038602 [debug] [MainThread]: On master: COMMIT
[0m19:07:19.038894 [debug] [MainThread]: Using postgres connection "master"
[0m19:07:19.039136 [debug] [MainThread]: On master: COMMIT
[0m19:07:19.039454 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:07:19.039707 [debug] [MainThread]: On master: Close
[0m19:07:19.040889 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.fact_waterlevel
[0m19:07:19.041283 [info ] [Thread-1 (]: 1 of 1 START sql incremental model fact.fact_waterlevel ........................ [RUN]
[0m19:07:19.041651 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_dim, now model.etl_waterlevel.fact_waterlevel)
[0m19:07:19.041930 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.fact_waterlevel
[0m19:07:19.048864 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.fact_waterlevel"
[0m19:07:19.049714 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.fact_waterlevel
[0m19:07:19.077566 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m19:07:19.077922 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

    
  
    

  create temporary table "fact_waterlevel__dbt_tmp190719065611"
  
  
    as
  
  (
    

with main as (
    select
        distinct
        concat("stationId",'_',"stationCode") as station_key,
        "stationId" as station_id,
        "stationCode" as station_code,
        "waterLevel" as water_level,
        "waterlevelStatus" as waterlevel_status,
        case
            when "waterlevelStatus" = 3 then '🚨 Beyond Danger'
            when "waterlevelStatus" = 2 then '⚠️ Between Warning and Danger'
            when "waterlevelStatus" = 1 then '🔶 Between Alert and Warning'
            when "waterlevelStatus" = 0 then '✅ Between Normal and Alert'
            when "waterlevelStatus" = -1 then '🟢 Below Normal (Safe)'
            else '❓ Unknown Status'
        end as waterlevel_condition,
        "stationName",
        "districtName",
        to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp AS last_update
    from
        raw.waterlevels w
    where
        "stationStatus" = 1

        
        /* This condition is important to avoid reprocessing old data */
        and to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp > (
            select max(last_update) from "airflow"."fact"."fact_waterlevel"
        )
        
)

select * from main
  );
  
  
[0m19:07:19.078251 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:07:19.092784 [debug] [Thread-1 (]: SQL status: SELECT 72 in 0.015 seconds
[0m19:07:19.099889 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m19:07:19.100190 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: BEGIN
[0m19:07:19.100617 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m19:07:19.100993 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m19:07:19.101275 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp190719065611'
        
      order by ordinal_position

  
[0m19:07:19.103928 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.002 seconds
[0m19:07:19.106491 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m19:07:19.106800 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m19:07:19.108282 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m19:07:19.114658 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m19:07:19.114974 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp190719065611'
        
      order by ordinal_position

  
[0m19:07:19.116232 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m19:07:19.117880 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m19:07:19.118186 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m19:07:19.119348 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m19:07:19.123864 [debug] [Thread-1 (]: 
    In "airflow"."fact"."fact_waterlevel":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m19:07:19.127345 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.fact_waterlevel"
[0m19:07:19.128145 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m19:07:19.128437 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      insert into "airflow"."fact"."fact_waterlevel" ("station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update")
    (
        select "station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update"
        from "fact_waterlevel__dbt_tmp190719065611"
    )


  
[0m19:07:19.129275 [debug] [Thread-1 (]: SQL status: INSERT 0 72 in 0.001 seconds
[0m19:07:19.136880 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m19:07:19.137157 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m19:07:19.137386 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m19:07:19.138567 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m19:07:19.139747 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: Close
[0m19:07:19.140847 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e5253701-e527-43a6-9a26-b2d3f1b8fdf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1dc0af0>]}
[0m19:07:19.141267 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model fact.fact_waterlevel ................... [[32mINSERT 0 72[0m in 0.10s]
[0m19:07:19.141629 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.fact_waterlevel
[0m19:07:19.142324 [debug] [MainThread]: Using postgres connection "master"
[0m19:07:19.142568 [debug] [MainThread]: On master: BEGIN
[0m19:07:19.142771 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:07:19.144226 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m19:07:19.144511 [debug] [MainThread]: On master: COMMIT
[0m19:07:19.144777 [debug] [MainThread]: Using postgres connection "master"
[0m19:07:19.145007 [debug] [MainThread]: On master: COMMIT
[0m19:07:19.145274 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:07:19.145481 [debug] [MainThread]: On master: Close
[0m19:07:19.145743 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:07:19.145982 [debug] [MainThread]: Connection 'model.etl_waterlevel.fact_waterlevel' was properly closed.
[0m19:07:19.146210 [info ] [MainThread]: 
[0m19:07:19.146428 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.18 seconds (0.18s).
[0m19:07:19.146808 [debug] [MainThread]: Command end result
[0m19:07:19.161548 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m19:07:19.162647 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m19:07:19.166236 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m19:07:19.166474 [info ] [MainThread]: 
[0m19:07:19.166770 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:07:19.167001 [info ] [MainThread]: 
[0m19:07:19.167230 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:07:19.167751 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.49714833, "process_in_blocks": "0", "process_kernel_time": 0.062225, "process_mem_max_rss": "111292", "process_out_blocks": "1701", "process_user_time": 1.206364}
[0m19:07:19.168066 [debug] [MainThread]: Command `dbt run` succeeded at 19:07:19.168022 after 0.50 seconds
[0m19:07:19.168316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9fc542b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9fb9c100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9fc69bd0>]}
[0m19:07:19.168573 [debug] [MainThread]: Flushing usage events
[0m19:07:20.732424 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:07:38.615577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa6882e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9768580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa97685e0>]}


============================== 20:07:38.618494 | 59e10f94-ee12-4f52-ae23-39ad7d89115f ==============================
[0m20:07:38.618494 [info ] [MainThread]: Running with dbt=1.9.0
[0m20:07:38.618920 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/airflow/.dbt', 'log_path': '/usr/app/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --models fact_waterlevel', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:07:38.704603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '59e10f94-ee12-4f52-ae23-39ad7d89115f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac896c20>]}
[0m20:07:38.731306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '59e10f94-ee12-4f52-ae23-39ad7d89115f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa976cc70>]}
[0m20:07:38.731771 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m20:07:38.766005 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m20:07:38.814816 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:07:38.815211 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:07:38.818285 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m20:07:38.829927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '59e10f94-ee12-4f52-ae23-39ad7d89115f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8a684f0>]}
[0m20:07:38.866902 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m20:07:38.871334 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m20:07:38.884324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '59e10f94-ee12-4f52-ae23-39ad7d89115f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8a87220>]}
[0m20:07:38.885891 [info ] [MainThread]: Found 3 models, 434 macros
[0m20:07:38.886226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '59e10f94-ee12-4f52-ae23-39ad7d89115f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8a871c0>]}
[0m20:07:38.887070 [info ] [MainThread]: 
[0m20:07:38.887340 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:07:38.887581 [info ] [MainThread]: 
[0m20:07:38.887999 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:07:38.888701 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m20:07:38.931412 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m20:07:38.931866 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m20:07:38.932160 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:07:38.934950 [debug] [ThreadPool]: SQL status: SELECT 36 in 0.003 seconds
[0m20:07:38.935722 [debug] [ThreadPool]: On list_airflow: Close
[0m20:07:38.938377 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_dim)
[0m20:07:38.941621 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m20:07:38.941907 [debug] [ThreadPool]: On list_airflow_dim: BEGIN
[0m20:07:38.942147 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:07:38.943759 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m20:07:38.944083 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m20:07:38.944366 [debug] [ThreadPool]: On list_airflow_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dim'
  
[0m20:07:38.945707 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.001 seconds
[0m20:07:38.946371 [debug] [ThreadPool]: On list_airflow_dim: ROLLBACK
[0m20:07:38.946706 [debug] [ThreadPool]: On list_airflow_dim: Close
[0m20:07:38.947109 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_dim, now list_airflow_fact)
[0m20:07:38.948497 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m20:07:38.948759 [debug] [ThreadPool]: On list_airflow_fact: BEGIN
[0m20:07:38.949065 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:07:38.950526 [debug] [ThreadPool]: SQL status: BEGIN in 0.001 seconds
[0m20:07:38.950868 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m20:07:38.951142 [debug] [ThreadPool]: On list_airflow_fact: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_fact"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'fact'
  
[0m20:07:38.952358 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m20:07:38.952984 [debug] [ThreadPool]: On list_airflow_fact: ROLLBACK
[0m20:07:38.953306 [debug] [ThreadPool]: On list_airflow_fact: Close
[0m20:07:38.955738 [debug] [MainThread]: Using postgres connection "master"
[0m20:07:38.956048 [debug] [MainThread]: On master: BEGIN
[0m20:07:38.956281 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:07:38.957746 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m20:07:38.958059 [debug] [MainThread]: Using postgres connection "master"
[0m20:07:38.958350 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:07:38.961206 [debug] [MainThread]: SQL status: SELECT 2 in 0.003 seconds
[0m20:07:38.961847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '59e10f94-ee12-4f52-ae23-39ad7d89115f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa032440>]}
[0m20:07:38.962211 [debug] [MainThread]: On master: ROLLBACK
[0m20:07:38.962542 [debug] [MainThread]: Using postgres connection "master"
[0m20:07:38.962795 [debug] [MainThread]: On master: BEGIN
[0m20:07:38.963210 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m20:07:38.963520 [debug] [MainThread]: On master: COMMIT
[0m20:07:38.963758 [debug] [MainThread]: Using postgres connection "master"
[0m20:07:38.964021 [debug] [MainThread]: On master: COMMIT
[0m20:07:38.964364 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:07:38.964601 [debug] [MainThread]: On master: Close
[0m20:07:38.965730 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.fact_waterlevel
[0m20:07:38.966120 [info ] [Thread-1 (]: 1 of 1 START sql incremental model fact.fact_waterlevel ........................ [RUN]
[0m20:07:38.966424 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_fact, now model.etl_waterlevel.fact_waterlevel)
[0m20:07:38.966690 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.fact_waterlevel
[0m20:07:38.973501 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.fact_waterlevel"
[0m20:07:38.974390 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.fact_waterlevel
[0m20:07:39.002738 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m20:07:39.003126 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

    
  
    

  create temporary table "fact_waterlevel__dbt_tmp200738990615"
  
  
    as
  
  (
    

with main as (
    select
        distinct
        concat("stationId",'_',"stationCode") as station_key,
        "stationId" as station_id,
        "stationCode" as station_code,
        "waterLevel" as water_level,
        "waterlevelStatus" as waterlevel_status,
        case
            when "waterlevelStatus" = 3 then '🚨 Beyond Danger'
            when "waterlevelStatus" = 2 then '⚠️ Between Warning and Danger'
            when "waterlevelStatus" = 1 then '🔶 Between Alert and Warning'
            when "waterlevelStatus" = 0 then '✅ Between Normal and Alert'
            when "waterlevelStatus" = -1 then '🟢 Below Normal (Safe)'
            else '❓ Unknown Status'
        end as waterlevel_condition,
        "stationName",
        "districtName",
        to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp AS last_update
    from
        raw.waterlevels w
    where
        "stationStatus" = 1

        
        /* This condition is important to avoid reprocessing old data */
        and to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp > (
            select max(last_update) from "airflow"."fact"."fact_waterlevel"
        )
        
)

select * from main
  );
  
  
[0m20:07:39.003454 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:07:39.018172 [debug] [Thread-1 (]: SQL status: SELECT 72 in 0.015 seconds
[0m20:07:39.025252 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m20:07:39.025560 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: BEGIN
[0m20:07:39.025982 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m20:07:39.026307 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m20:07:39.026590 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp200738990615'
        
      order by ordinal_position

  
[0m20:07:39.029270 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.002 seconds
[0m20:07:39.032166 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m20:07:39.032452 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m20:07:39.033706 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m20:07:39.040120 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m20:07:39.040436 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp200738990615'
        
      order by ordinal_position

  
[0m20:07:39.041672 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m20:07:39.043370 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m20:07:39.043666 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m20:07:39.044874 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m20:07:39.049478 [debug] [Thread-1 (]: 
    In "airflow"."fact"."fact_waterlevel":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m20:07:39.052977 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.fact_waterlevel"
[0m20:07:39.053862 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m20:07:39.054154 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      insert into "airflow"."fact"."fact_waterlevel" ("station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update")
    (
        select "station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update"
        from "fact_waterlevel__dbt_tmp200738990615"
    )


  
[0m20:07:39.054697 [debug] [Thread-1 (]: SQL status: INSERT 0 72 in 0.000 seconds
[0m20:07:39.062065 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m20:07:39.062335 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m20:07:39.062560 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m20:07:39.063511 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m20:07:39.064609 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: Close
[0m20:07:39.065726 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59e10f94-ee12-4f52-ae23-39ad7d89115f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac896770>]}
[0m20:07:39.066281 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model fact.fact_waterlevel ................... [[32mINSERT 0 72[0m in 0.10s]
[0m20:07:39.066730 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.fact_waterlevel
[0m20:07:39.067392 [debug] [MainThread]: Using postgres connection "master"
[0m20:07:39.067675 [debug] [MainThread]: On master: BEGIN
[0m20:07:39.067911 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:07:39.069352 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m20:07:39.069624 [debug] [MainThread]: On master: COMMIT
[0m20:07:39.069862 [debug] [MainThread]: Using postgres connection "master"
[0m20:07:39.070083 [debug] [MainThread]: On master: COMMIT
[0m20:07:39.070351 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:07:39.070550 [debug] [MainThread]: On master: Close
[0m20:07:39.070809 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:07:39.071031 [debug] [MainThread]: Connection 'model.etl_waterlevel.fact_waterlevel' was properly closed.
[0m20:07:39.071295 [info ] [MainThread]: 
[0m20:07:39.071522 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.18 seconds (0.18s).
[0m20:07:39.071898 [debug] [MainThread]: Command end result
[0m20:07:39.087057 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m20:07:39.088317 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m20:07:39.091576 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m20:07:39.091795 [info ] [MainThread]: 
[0m20:07:39.092069 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:07:39.092281 [info ] [MainThread]: 
[0m20:07:39.092494 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:07:39.092997 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.5029766, "process_in_blocks": "0", "process_kernel_time": 0.072081, "process_mem_max_rss": "111348", "process_out_blocks": "1701", "process_user_time": 1.202366}
[0m20:07:39.093326 [debug] [MainThread]: Command `dbt run` succeeded at 20:07:39.093281 after 0.50 seconds
[0m20:07:39.093565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa6882e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa976cc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa6a3550>]}
[0m20:07:39.093810 [debug] [MainThread]: Flushing usage events
[0m20:07:40.790380 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:08:53.072359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a994310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89a83d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89a83cd0>]}


============================== 21:08:53.075311 | 1e6df625-dfd3-41fe-a981-4e09d8173d08 ==============================
[0m21:08:53.075311 [info ] [MainThread]: Running with dbt=1.9.0
[0m21:08:53.075725 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --models fact_waterlevel', 'send_anonymous_usage_stats': 'True'}
[0m21:08:53.157862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1e6df625-dfd3-41fe-a981-4e09d8173d08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8915e290>]}
[0m21:08:53.184311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1e6df625-dfd3-41fe-a981-4e09d8173d08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a8e41c0>]}
[0m21:08:53.184760 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:08:53.219519 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m21:08:53.268188 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:08:53.268517 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:08:53.271675 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m21:08:53.283506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1e6df625-dfd3-41fe-a981-4e09d8173d08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88cf0550>]}
[0m21:08:53.319311 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m21:08:53.323195 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m21:08:53.331651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1e6df625-dfd3-41fe-a981-4e09d8173d08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88d0f220>]}
[0m21:08:53.331953 [info ] [MainThread]: Found 3 models, 434 macros
[0m21:08:53.332189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1e6df625-dfd3-41fe-a981-4e09d8173d08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88d0f1c0>]}
[0m21:08:53.332858 [info ] [MainThread]: 
[0m21:08:53.333109 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:08:53.333320 [info ] [MainThread]: 
[0m21:08:53.333617 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:08:53.334193 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m21:08:53.372039 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m21:08:53.372454 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m21:08:53.372728 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:08:53.375442 [debug] [ThreadPool]: SQL status: SELECT 36 in 0.003 seconds
[0m21:08:53.376212 [debug] [ThreadPool]: On list_airflow: Close
[0m21:08:53.378820 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_dim)
[0m21:08:53.382180 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m21:08:53.382472 [debug] [ThreadPool]: On list_airflow_dim: BEGIN
[0m21:08:53.382722 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:08:53.386891 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m21:08:53.387239 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m21:08:53.387552 [debug] [ThreadPool]: On list_airflow_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dim'
  
[0m21:08:53.388876 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.001 seconds
[0m21:08:53.389585 [debug] [ThreadPool]: On list_airflow_dim: ROLLBACK
[0m21:08:53.389936 [debug] [ThreadPool]: On list_airflow_dim: Close
[0m21:08:53.390337 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_dim, now list_airflow_fact)
[0m21:08:53.391663 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m21:08:53.391936 [debug] [ThreadPool]: On list_airflow_fact: BEGIN
[0m21:08:53.392178 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:08:53.393642 [debug] [ThreadPool]: SQL status: BEGIN in 0.001 seconds
[0m21:08:53.393958 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m21:08:53.394247 [debug] [ThreadPool]: On list_airflow_fact: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_fact"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'fact'
  
[0m21:08:53.395439 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m21:08:53.396061 [debug] [ThreadPool]: On list_airflow_fact: ROLLBACK
[0m21:08:53.396379 [debug] [ThreadPool]: On list_airflow_fact: Close
[0m21:08:53.398770 [debug] [MainThread]: Using postgres connection "master"
[0m21:08:53.399037 [debug] [MainThread]: On master: BEGIN
[0m21:08:53.399277 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:08:53.400747 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m21:08:53.401058 [debug] [MainThread]: Using postgres connection "master"
[0m21:08:53.401359 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:08:53.404262 [debug] [MainThread]: SQL status: SELECT 2 in 0.003 seconds
[0m21:08:53.404887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1e6df625-dfd3-41fe-a981-4e09d8173d08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c3b7e50>]}
[0m21:08:53.405239 [debug] [MainThread]: On master: ROLLBACK
[0m21:08:53.405579 [debug] [MainThread]: Using postgres connection "master"
[0m21:08:53.405820 [debug] [MainThread]: On master: BEGIN
[0m21:08:53.406234 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m21:08:53.406540 [debug] [MainThread]: On master: COMMIT
[0m21:08:53.406778 [debug] [MainThread]: Using postgres connection "master"
[0m21:08:53.407017 [debug] [MainThread]: On master: COMMIT
[0m21:08:53.407332 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:08:53.407610 [debug] [MainThread]: On master: Close
[0m21:08:53.408743 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.fact_waterlevel
[0m21:08:53.409127 [info ] [Thread-1 (]: 1 of 1 START sql incremental model fact.fact_waterlevel ........................ [RUN]
[0m21:08:53.409460 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_fact, now model.etl_waterlevel.fact_waterlevel)
[0m21:08:53.409738 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.fact_waterlevel
[0m21:08:53.416601 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.fact_waterlevel"
[0m21:08:53.417366 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.fact_waterlevel
[0m21:08:53.445304 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m21:08:53.445658 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

    
  
    

  create temporary table "fact_waterlevel__dbt_tmp210853433520"
  
  
    as
  
  (
    

with main as (
    select
        distinct
        concat("stationId",'_',"stationCode") as station_key,
        "stationId" as station_id,
        "stationCode" as station_code,
        "waterLevel" as water_level,
        "waterlevelStatus" as waterlevel_status,
        case
            when "waterlevelStatus" = 3 then '🚨 Beyond Danger'
            when "waterlevelStatus" = 2 then '⚠️ Between Warning and Danger'
            when "waterlevelStatus" = 1 then '🔶 Between Alert and Warning'
            when "waterlevelStatus" = 0 then '✅ Between Normal and Alert'
            when "waterlevelStatus" = -1 then '🟢 Below Normal (Safe)'
            else '❓ Unknown Status'
        end as waterlevel_condition,
        "stationName",
        "districtName",
        to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp AS last_update
    from
        raw.waterlevels w
    where
        "stationStatus" = 1

        
        /* This condition is important to avoid reprocessing old data */
        and to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp > (
            select max(last_update) from "airflow"."fact"."fact_waterlevel"
        )
        
)

select * from main
  );
  
  
[0m21:08:53.446032 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:08:53.460765 [debug] [Thread-1 (]: SQL status: SELECT 72 in 0.015 seconds
[0m21:08:53.467836 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m21:08:53.468144 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: BEGIN
[0m21:08:53.468542 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m21:08:53.468882 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m21:08:53.469196 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp210853433520'
        
      order by ordinal_position

  
[0m21:08:53.471834 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.002 seconds
[0m21:08:53.474447 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m21:08:53.474757 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m21:08:53.476051 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m21:08:53.482394 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m21:08:53.482707 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp210853433520'
        
      order by ordinal_position

  
[0m21:08:53.483873 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m21:08:53.485515 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m21:08:53.485806 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m21:08:53.487049 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m21:08:53.491565 [debug] [Thread-1 (]: 
    In "airflow"."fact"."fact_waterlevel":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m21:08:53.494994 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.fact_waterlevel"
[0m21:08:53.495850 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m21:08:53.496169 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      insert into "airflow"."fact"."fact_waterlevel" ("station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update")
    (
        select "station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update"
        from "fact_waterlevel__dbt_tmp210853433520"
    )


  
[0m21:08:53.496683 [debug] [Thread-1 (]: SQL status: INSERT 0 72 in 0.000 seconds
[0m21:08:53.504254 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m21:08:53.504547 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m21:08:53.504814 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m21:08:53.508038 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m21:08:53.509042 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: Close
[0m21:08:53.510097 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e6df625-dfd3-41fe-a981-4e09d8173d08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cbc27a0>]}
[0m21:08:53.510578 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model fact.fact_waterlevel ................... [[32mINSERT 0 72[0m in 0.10s]
[0m21:08:53.510955 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.fact_waterlevel
[0m21:08:53.511630 [debug] [MainThread]: Using postgres connection "master"
[0m21:08:53.511856 [debug] [MainThread]: On master: BEGIN
[0m21:08:53.512065 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:08:53.513458 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m21:08:53.513731 [debug] [MainThread]: On master: COMMIT
[0m21:08:53.513994 [debug] [MainThread]: Using postgres connection "master"
[0m21:08:53.514204 [debug] [MainThread]: On master: COMMIT
[0m21:08:53.514457 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:08:53.514650 [debug] [MainThread]: On master: Close
[0m21:08:53.514919 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:08:53.515128 [debug] [MainThread]: Connection 'model.etl_waterlevel.fact_waterlevel' was properly closed.
[0m21:08:53.515345 [info ] [MainThread]: 
[0m21:08:53.515573 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.18 seconds (0.18s).
[0m21:08:53.515950 [debug] [MainThread]: Command end result
[0m21:08:53.530989 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m21:08:53.532070 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m21:08:53.535656 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m21:08:53.535892 [info ] [MainThread]: 
[0m21:08:53.536198 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:08:53.536452 [info ] [MainThread]: 
[0m21:08:53.536676 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m21:08:53.537174 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.4905734, "process_in_blocks": "0", "process_kernel_time": 0.060886, "process_mem_max_rss": "111364", "process_out_blocks": "1701", "process_user_time": 1.197757}
[0m21:08:53.537504 [debug] [MainThread]: Command `dbt run` succeeded at 21:08:53.537460 after 0.49 seconds
[0m21:08:53.537748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a994310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8915e290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8aa036d0>]}
[0m21:08:53.538038 [debug] [MainThread]: Flushing usage events
[0m21:08:55.202192 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:09:52.428198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6394370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5478520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5478580>]}


============================== 22:09:52.431149 | c142a38c-34ae-47d9-9f5d-7b8b12d2de8b ==============================
[0m22:09:52.431149 [info ] [MainThread]: Running with dbt=1.9.0
[0m22:09:52.431553 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/logs', 'profiles_dir': '/home/airflow/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --models fact_waterlevel', 'send_anonymous_usage_stats': 'True'}
[0m22:09:52.515320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c142a38c-34ae-47d9-9f5d-7b8b12d2de8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6424310>]}
[0m22:09:52.542084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c142a38c-34ae-47d9-9f5d-7b8b12d2de8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7d35810>]}
[0m22:09:52.542554 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:09:52.576843 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m22:09:52.625722 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:09:52.626046 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:09:52.629233 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m22:09:52.641065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c142a38c-34ae-47d9-9f5d-7b8b12d2de8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa46f05b0>]}
[0m22:09:52.677102 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m22:09:52.680727 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m22:09:52.689350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c142a38c-34ae-47d9-9f5d-7b8b12d2de8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa470f220>]}
[0m22:09:52.689675 [info ] [MainThread]: Found 3 models, 434 macros
[0m22:09:52.689912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c142a38c-34ae-47d9-9f5d-7b8b12d2de8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa470f1c0>]}
[0m22:09:52.690565 [info ] [MainThread]: 
[0m22:09:52.690841 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:09:52.691074 [info ] [MainThread]: 
[0m22:09:52.691416 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:09:52.692057 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m22:09:52.729658 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m22:09:52.730054 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m22:09:52.730337 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:09:52.733063 [debug] [ThreadPool]: SQL status: SELECT 36 in 0.003 seconds
[0m22:09:52.733852 [debug] [ThreadPool]: On list_airflow: Close
[0m22:09:52.736496 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_dim)
[0m22:09:52.739685 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m22:09:52.739965 [debug] [ThreadPool]: On list_airflow_dim: BEGIN
[0m22:09:52.740220 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:09:52.741810 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m22:09:52.742146 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m22:09:52.742407 [debug] [ThreadPool]: On list_airflow_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dim'
  
[0m22:09:52.743745 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.001 seconds
[0m22:09:52.744421 [debug] [ThreadPool]: On list_airflow_dim: ROLLBACK
[0m22:09:52.744755 [debug] [ThreadPool]: On list_airflow_dim: Close
[0m22:09:52.745143 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_dim, now list_airflow_fact)
[0m22:09:52.746528 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m22:09:52.746821 [debug] [ThreadPool]: On list_airflow_fact: BEGIN
[0m22:09:52.747062 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:09:52.748479 [debug] [ThreadPool]: SQL status: BEGIN in 0.001 seconds
[0m22:09:52.748814 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m22:09:52.749081 [debug] [ThreadPool]: On list_airflow_fact: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_fact"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'fact'
  
[0m22:09:52.750263 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m22:09:52.750907 [debug] [ThreadPool]: On list_airflow_fact: ROLLBACK
[0m22:09:52.751232 [debug] [ThreadPool]: On list_airflow_fact: Close
[0m22:09:52.753637 [debug] [MainThread]: Using postgres connection "master"
[0m22:09:52.753907 [debug] [MainThread]: On master: BEGIN
[0m22:09:52.754140 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:09:52.755545 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m22:09:52.755895 [debug] [MainThread]: Using postgres connection "master"
[0m22:09:52.756233 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:09:52.759134 [debug] [MainThread]: SQL status: SELECT 2 in 0.003 seconds
[0m22:09:52.759771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c142a38c-34ae-47d9-9f5d-7b8b12d2de8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7d34fd0>]}
[0m22:09:52.760102 [debug] [MainThread]: On master: ROLLBACK
[0m22:09:52.760451 [debug] [MainThread]: Using postgres connection "master"
[0m22:09:52.760696 [debug] [MainThread]: On master: BEGIN
[0m22:09:52.761089 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m22:09:52.761373 [debug] [MainThread]: On master: COMMIT
[0m22:09:52.761630 [debug] [MainThread]: Using postgres connection "master"
[0m22:09:52.761877 [debug] [MainThread]: On master: COMMIT
[0m22:09:52.762195 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:09:52.762453 [debug] [MainThread]: On master: Close
[0m22:09:52.763559 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.fact_waterlevel
[0m22:09:52.763943 [info ] [Thread-1 (]: 1 of 1 START sql incremental model fact.fact_waterlevel ........................ [RUN]
[0m22:09:52.764256 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_fact, now model.etl_waterlevel.fact_waterlevel)
[0m22:09:52.764559 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.fact_waterlevel
[0m22:09:52.771491 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.fact_waterlevel"
[0m22:09:52.772390 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.fact_waterlevel
[0m22:09:52.800813 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m22:09:52.801215 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

    
  
    

  create temporary table "fact_waterlevel__dbt_tmp220952788639"
  
  
    as
  
  (
    

with main as (
    select
        distinct
        concat("stationId",'_',"stationCode") as station_key,
        "stationId" as station_id,
        "stationCode" as station_code,
        "waterLevel" as water_level,
        "waterlevelStatus" as waterlevel_status,
        case
            when "waterlevelStatus" = 3 then '🚨 Beyond Danger'
            when "waterlevelStatus" = 2 then '⚠️ Between Warning and Danger'
            when "waterlevelStatus" = 1 then '🔶 Between Alert and Warning'
            when "waterlevelStatus" = 0 then '✅ Between Normal and Alert'
            when "waterlevelStatus" = -1 then '🟢 Below Normal (Safe)'
            else '❓ Unknown Status'
        end as waterlevel_condition,
        "stationName",
        "districtName",
        to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp AS last_update
    from
        raw.waterlevels w
    where
        "stationStatus" = 1

        
        /* This condition is important to avoid reprocessing old data */
        and to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp > (
            select max(last_update) from "airflow"."fact"."fact_waterlevel"
        )
        
)

select * from main
  );
  
  
[0m22:09:52.801557 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:09:52.816270 [debug] [Thread-1 (]: SQL status: SELECT 72 in 0.015 seconds
[0m22:09:52.823465 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m22:09:52.823777 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: BEGIN
[0m22:09:52.824185 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m22:09:52.824526 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m22:09:52.824817 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp220952788639'
        
      order by ordinal_position

  
[0m22:09:52.827471 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.002 seconds
[0m22:09:52.830093 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m22:09:52.830422 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m22:09:52.831762 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m22:09:52.838167 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m22:09:52.838478 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp220952788639'
        
      order by ordinal_position

  
[0m22:09:52.839717 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m22:09:52.841410 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m22:09:52.841710 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m22:09:52.842896 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m22:09:52.847375 [debug] [Thread-1 (]: 
    In "airflow"."fact"."fact_waterlevel":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m22:09:52.850764 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.fact_waterlevel"
[0m22:09:52.851752 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m22:09:52.852044 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      insert into "airflow"."fact"."fact_waterlevel" ("station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update")
    (
        select "station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update"
        from "fact_waterlevel__dbt_tmp220952788639"
    )


  
[0m22:09:52.852552 [debug] [Thread-1 (]: SQL status: INSERT 0 72 in 0.000 seconds
[0m22:09:52.860235 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m22:09:52.860531 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m22:09:52.860788 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m22:09:52.861599 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m22:09:52.862624 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: Close
[0m22:09:52.863670 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c142a38c-34ae-47d9-9f5d-7b8b12d2de8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8540580>]}
[0m22:09:52.864164 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model fact.fact_waterlevel ................... [[32mINSERT 0 72[0m in 0.10s]
[0m22:09:52.864610 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.fact_waterlevel
[0m22:09:52.865303 [debug] [MainThread]: Using postgres connection "master"
[0m22:09:52.865543 [debug] [MainThread]: On master: BEGIN
[0m22:09:52.865741 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:09:52.867189 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m22:09:52.867518 [debug] [MainThread]: On master: COMMIT
[0m22:09:52.867763 [debug] [MainThread]: Using postgres connection "master"
[0m22:09:52.867988 [debug] [MainThread]: On master: COMMIT
[0m22:09:52.868233 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:09:52.868453 [debug] [MainThread]: On master: Close
[0m22:09:52.868718 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:09:52.868926 [debug] [MainThread]: Connection 'model.etl_waterlevel.fact_waterlevel' was properly closed.
[0m22:09:52.869142 [info ] [MainThread]: 
[0m22:09:52.869365 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.18 seconds (0.18s).
[0m22:09:52.869742 [debug] [MainThread]: Command end result
[0m22:09:52.884794 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m22:09:52.885881 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m22:09:52.889315 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m22:09:52.889584 [info ] [MainThread]: 
[0m22:09:52.889863 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:09:52.890109 [info ] [MainThread]: 
[0m22:09:52.890338 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m22:09:52.890867 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.4885693, "process_in_blocks": "0", "process_kernel_time": 0.075193, "process_mem_max_rss": "111096", "process_out_blocks": "1701", "process_user_time": 1.185043}
[0m22:09:52.891200 [debug] [MainThread]: Command `dbt run` succeeded at 22:09:52.891154 after 0.49 seconds
[0m22:09:52.891454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6394370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6424310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6254c70>]}
[0m22:09:52.891704 [debug] [MainThread]: Flushing usage events
[0m22:09:54.429282 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:05:05.436358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff857942e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8487c520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8487c580>]}


============================== 23:05:05.440400 | e6f1a2c9-7d3a-4401-b30c-d0a88df63323 ==============================
[0m23:05:05.440400 [info ] [MainThread]: Running with dbt=1.9.0
[0m23:05:05.440765 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'profiles_dir': '/home/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --models fact_waterlevel', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:05:05.525810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e6f1a2c9-7d3a-4401-b30c-d0a88df63323', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83dea9e0>]}
[0m23:05:05.552328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e6f1a2c9-7d3a-4401-b30c-d0a88df63323', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8487c040>]}
[0m23:05:05.552820 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:05:05.587114 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m23:05:05.636175 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:05:05.636502 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:05:05.639567 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m23:05:05.651327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e6f1a2c9-7d3a-4401-b30c-d0a88df63323', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83b88520>]}
[0m23:05:05.687116 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m23:05:05.691050 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m23:05:05.699725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e6f1a2c9-7d3a-4401-b30c-d0a88df63323', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83ba7220>]}
[0m23:05:05.700048 [info ] [MainThread]: Found 3 models, 434 macros
[0m23:05:05.700281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e6f1a2c9-7d3a-4401-b30c-d0a88df63323', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83ba71c0>]}
[0m23:05:05.700946 [info ] [MainThread]: 
[0m23:05:05.701193 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:05:05.701393 [info ] [MainThread]: 
[0m23:05:05.701677 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:05:05.702271 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m23:05:05.747000 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m23:05:05.747424 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m23:05:05.747741 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:05:05.750465 [debug] [ThreadPool]: SQL status: SELECT 36 in 0.003 seconds
[0m23:05:05.751298 [debug] [ThreadPool]: On list_airflow: Close
[0m23:05:05.753986 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_dim)
[0m23:05:05.757215 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m23:05:05.757490 [debug] [ThreadPool]: On list_airflow_dim: BEGIN
[0m23:05:05.757740 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:05:05.759306 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m23:05:05.759658 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m23:05:05.759935 [debug] [ThreadPool]: On list_airflow_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dim'
  
[0m23:05:05.761237 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.001 seconds
[0m23:05:05.761924 [debug] [ThreadPool]: On list_airflow_dim: ROLLBACK
[0m23:05:05.762259 [debug] [ThreadPool]: On list_airflow_dim: Close
[0m23:05:05.762651 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_dim, now list_airflow_fact)
[0m23:05:05.764068 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m23:05:05.764320 [debug] [ThreadPool]: On list_airflow_fact: BEGIN
[0m23:05:05.764560 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:05:05.766080 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m23:05:05.766374 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m23:05:05.766633 [debug] [ThreadPool]: On list_airflow_fact: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_fact"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'fact'
  
[0m23:05:05.767903 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m23:05:05.768541 [debug] [ThreadPool]: On list_airflow_fact: ROLLBACK
[0m23:05:05.768865 [debug] [ThreadPool]: On list_airflow_fact: Close
[0m23:05:05.771261 [debug] [MainThread]: Using postgres connection "master"
[0m23:05:05.771553 [debug] [MainThread]: On master: BEGIN
[0m23:05:05.771792 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:05:05.773315 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m23:05:05.773608 [debug] [MainThread]: Using postgres connection "master"
[0m23:05:05.773919 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:05:05.776849 [debug] [MainThread]: SQL status: SELECT 2 in 0.003 seconds
[0m23:05:05.777489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e6f1a2c9-7d3a-4401-b30c-d0a88df63323', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83ba6c50>]}
[0m23:05:05.777808 [debug] [MainThread]: On master: ROLLBACK
[0m23:05:05.778166 [debug] [MainThread]: Using postgres connection "master"
[0m23:05:05.778444 [debug] [MainThread]: On master: BEGIN
[0m23:05:05.778844 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:05:05.779164 [debug] [MainThread]: On master: COMMIT
[0m23:05:05.779401 [debug] [MainThread]: Using postgres connection "master"
[0m23:05:05.779637 [debug] [MainThread]: On master: COMMIT
[0m23:05:05.779967 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:05:05.780237 [debug] [MainThread]: On master: Close
[0m23:05:05.781396 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.fact_waterlevel
[0m23:05:05.781762 [info ] [Thread-1 (]: 1 of 1 START sql incremental model fact.fact_waterlevel ........................ [RUN]
[0m23:05:05.782085 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_fact, now model.etl_waterlevel.fact_waterlevel)
[0m23:05:05.782364 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.fact_waterlevel
[0m23:05:05.789354 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.fact_waterlevel"
[0m23:05:05.791123 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.fact_waterlevel
[0m23:05:05.818850 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m23:05:05.819214 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

    
  
    

  create temporary table "fact_waterlevel__dbt_tmp230505806870"
  
  
    as
  
  (
    

with main as (
    select
        distinct
        concat("stationId",'_',"stationCode") as station_key,
        "stationId" as station_id,
        "stationCode" as station_code,
        "waterLevel" as water_level,
        "waterlevelStatus" as waterlevel_status,
        case
            when "waterlevelStatus" = 3 then '🚨 Beyond Danger'
            when "waterlevelStatus" = 2 then '⚠️ Between Warning and Danger'
            when "waterlevelStatus" = 1 then '🔶 Between Alert and Warning'
            when "waterlevelStatus" = 0 then '✅ Between Normal and Alert'
            when "waterlevelStatus" = -1 then '🟢 Below Normal (Safe)'
            else '❓ Unknown Status'
        end as waterlevel_condition,
        "stationName",
        "districtName",
        to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp AS last_update
    from
        raw.waterlevels w
    where
        "stationStatus" = 1

        
        /* This condition is important to avoid reprocessing old data */
        and to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp > (
            select max(last_update) from "airflow"."fact"."fact_waterlevel"
        )
        
)

select * from main
  );
  
  
[0m23:05:05.819527 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:05:05.834716 [debug] [Thread-1 (]: SQL status: SELECT 72 in 0.015 seconds
[0m23:05:05.841934 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m23:05:05.842252 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: BEGIN
[0m23:05:05.842659 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m23:05:05.843029 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m23:05:05.843319 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp230505806870'
        
      order by ordinal_position

  
[0m23:05:05.846004 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.002 seconds
[0m23:05:05.848590 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m23:05:05.848972 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m23:05:05.850329 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m23:05:05.856774 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m23:05:05.857102 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp230505806870'
        
      order by ordinal_position

  
[0m23:05:05.858330 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m23:05:05.859984 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m23:05:05.860275 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m23:05:05.861485 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m23:05:05.866020 [debug] [Thread-1 (]: 
    In "airflow"."fact"."fact_waterlevel":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m23:05:05.869407 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.fact_waterlevel"
[0m23:05:05.871068 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m23:05:05.871376 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      insert into "airflow"."fact"."fact_waterlevel" ("station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update")
    (
        select "station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update"
        from "fact_waterlevel__dbt_tmp230505806870"
    )


  
[0m23:05:05.871948 [debug] [Thread-1 (]: SQL status: INSERT 0 72 in 0.000 seconds
[0m23:05:05.879472 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m23:05:05.879779 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m23:05:05.880072 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m23:05:05.882581 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m23:05:05.883675 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: Close
[0m23:05:05.884690 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6f1a2c9-7d3a-4401-b30c-d0a88df63323', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87a46770>]}
[0m23:05:05.885173 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model fact.fact_waterlevel ................... [[32mINSERT 0 72[0m in 0.10s]
[0m23:05:05.885565 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.fact_waterlevel
[0m23:05:05.886237 [debug] [MainThread]: Using postgres connection "master"
[0m23:05:05.886470 [debug] [MainThread]: On master: BEGIN
[0m23:05:05.886666 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:05:05.888166 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m23:05:05.888443 [debug] [MainThread]: On master: COMMIT
[0m23:05:05.888666 [debug] [MainThread]: Using postgres connection "master"
[0m23:05:05.888859 [debug] [MainThread]: On master: COMMIT
[0m23:05:05.889153 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:05:05.889362 [debug] [MainThread]: On master: Close
[0m23:05:05.889631 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:05:05.889838 [debug] [MainThread]: Connection 'model.etl_waterlevel.fact_waterlevel' was properly closed.
[0m23:05:05.890063 [info ] [MainThread]: 
[0m23:05:05.890287 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.19 seconds (0.19s).
[0m23:05:05.890657 [debug] [MainThread]: Command end result
[0m23:05:05.905738 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m23:05:05.906931 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m23:05:05.910412 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m23:05:05.910636 [info ] [MainThread]: 
[0m23:05:05.910899 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:05:05.911103 [info ] [MainThread]: 
[0m23:05:05.911316 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:05:05.911830 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.501378, "process_in_blocks": "0", "process_kernel_time": 0.069283, "process_mem_max_rss": "111272", "process_out_blocks": "1701", "process_user_time": 1.208954}
[0m23:05:05.912159 [debug] [MainThread]: Command `dbt run` succeeded at 23:05:05.912113 after 0.50 seconds
[0m23:05:05.912408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff857942e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff879d8ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82e46ad0>]}
[0m23:05:05.912645 [debug] [MainThread]: Flushing usage events
[0m23:05:07.030601 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:05:05.631024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbaf883a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba068550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba068580>]}


============================== 00:05:05.634114 | 9fbea47f-0cc4-48f0-b943-bdceacc5a4f0 ==============================
[0m00:05:05.634114 [info ] [MainThread]: Running with dbt=1.9.0
[0m00:05:05.634479 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'debug': 'False', 'profiles_dir': '/home/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models fact_waterlevel', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:05:05.727038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9fbea47f-0cc4-48f0-b943-bdceacc5a4f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbd4935b0>]}
[0m00:05:05.754166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9fbea47f-0cc4-48f0-b943-bdceacc5a4f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbae44760>]}
[0m00:05:05.754713 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m00:05:05.789592 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m00:05:05.840907 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:05:05.841249 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:05:05.844458 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m00:05:05.856297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9fbea47f-0cc4-48f0-b943-bdceacc5a4f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb93485e0>]}
[0m00:05:05.892416 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m00:05:05.896350 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m00:05:05.906696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9fbea47f-0cc4-48f0-b943-bdceacc5a4f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9363220>]}
[0m00:05:05.907025 [info ] [MainThread]: Found 3 models, 434 macros
[0m00:05:05.907259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9fbea47f-0cc4-48f0-b943-bdceacc5a4f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb93631c0>]}
[0m00:05:05.908007 [info ] [MainThread]: 
[0m00:05:05.908269 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:05:05.908598 [info ] [MainThread]: 
[0m00:05:05.908981 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:05:05.909583 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m00:05:05.949958 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m00:05:05.950362 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m00:05:05.950641 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:05:05.954761 [debug] [ThreadPool]: SQL status: SELECT 36 in 0.004 seconds
[0m00:05:05.955573 [debug] [ThreadPool]: On list_airflow: Close
[0m00:05:05.958519 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_dim)
[0m00:05:05.961753 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m00:05:05.962043 [debug] [ThreadPool]: On list_airflow_dim: BEGIN
[0m00:05:05.962302 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:05:05.963948 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m00:05:05.964359 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m00:05:05.964634 [debug] [ThreadPool]: On list_airflow_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dim'
  
[0m00:05:05.967512 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.003 seconds
[0m00:05:05.968193 [debug] [ThreadPool]: On list_airflow_dim: ROLLBACK
[0m00:05:05.968543 [debug] [ThreadPool]: On list_airflow_dim: Close
[0m00:05:05.968935 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_dim, now list_airflow_fact)
[0m00:05:05.970307 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m00:05:05.970568 [debug] [ThreadPool]: On list_airflow_fact: BEGIN
[0m00:05:05.970813 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:05:05.972321 [debug] [ThreadPool]: SQL status: BEGIN in 0.001 seconds
[0m00:05:05.972623 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m00:05:05.972884 [debug] [ThreadPool]: On list_airflow_fact: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_fact"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'fact'
  
[0m00:05:05.974160 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m00:05:05.974792 [debug] [ThreadPool]: On list_airflow_fact: ROLLBACK
[0m00:05:05.975123 [debug] [ThreadPool]: On list_airflow_fact: Close
[0m00:05:05.977797 [debug] [MainThread]: Using postgres connection "master"
[0m00:05:05.978074 [debug] [MainThread]: On master: BEGIN
[0m00:05:05.978329 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:05:05.980034 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m00:05:05.980350 [debug] [MainThread]: Using postgres connection "master"
[0m00:05:05.980652 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:05:05.986050 [debug] [MainThread]: SQL status: SELECT 2 in 0.005 seconds
[0m00:05:05.986722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9fbea47f-0cc4-48f0-b943-bdceacc5a4f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9362d10>]}
[0m00:05:05.987027 [debug] [MainThread]: On master: ROLLBACK
[0m00:05:05.987304 [debug] [MainThread]: Using postgres connection "master"
[0m00:05:05.987505 [debug] [MainThread]: On master: BEGIN
[0m00:05:05.987810 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m00:05:05.988077 [debug] [MainThread]: On master: COMMIT
[0m00:05:05.988314 [debug] [MainThread]: Using postgres connection "master"
[0m00:05:05.988517 [debug] [MainThread]: On master: COMMIT
[0m00:05:05.988768 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:05:05.988966 [debug] [MainThread]: On master: Close
[0m00:05:05.989923 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.fact_waterlevel
[0m00:05:05.990300 [info ] [Thread-1 (]: 1 of 1 START sql incremental model fact.fact_waterlevel ........................ [RUN]
[0m00:05:05.990611 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_fact, now model.etl_waterlevel.fact_waterlevel)
[0m00:05:05.990848 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.fact_waterlevel
[0m00:05:05.998030 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.fact_waterlevel"
[0m00:05:05.999069 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.fact_waterlevel
[0m00:05:06.027796 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m00:05:06.028141 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

    
  
    

  create temporary table "fact_waterlevel__dbt_tmp000506015384"
  
  
    as
  
  (
    

with main as (
    select
        distinct
        concat("stationId",'_',"stationCode") as station_key,
        "stationId" as station_id,
        "stationCode" as station_code,
        "waterLevel" as water_level,
        "waterlevelStatus" as waterlevel_status,
        case
            when "waterlevelStatus" = 3 then '🚨 Beyond Danger'
            when "waterlevelStatus" = 2 then '⚠️ Between Warning and Danger'
            when "waterlevelStatus" = 1 then '🔶 Between Alert and Warning'
            when "waterlevelStatus" = 0 then '✅ Between Normal and Alert'
            when "waterlevelStatus" = -1 then '🟢 Below Normal (Safe)'
            else '❓ Unknown Status'
        end as waterlevel_condition,
        "stationName",
        "districtName",
        to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp AS last_update
    from
        raw.waterlevels w
    where
        "stationStatus" = 1

        
        /* This condition is important to avoid reprocessing old data */
        and to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp > (
            select max(last_update) from "airflow"."fact"."fact_waterlevel"
        )
        
)

select * from main
  );
  
  
[0m00:05:06.028532 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:05:06.104713 [debug] [Thread-1 (]: SQL status: SELECT 73 in 0.076 seconds
[0m00:05:06.112306 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m00:05:06.112616 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: BEGIN
[0m00:05:06.113007 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m00:05:06.113353 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m00:05:06.113632 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp000506015384'
        
      order by ordinal_position

  
[0m00:05:06.118718 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.005 seconds
[0m00:05:06.121426 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m00:05:06.121708 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m00:05:06.123039 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m00:05:06.129525 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m00:05:06.129838 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp000506015384'
        
      order by ordinal_position

  
[0m00:05:06.131118 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m00:05:06.132885 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m00:05:06.133196 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m00:05:06.134390 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m00:05:06.139012 [debug] [Thread-1 (]: 
    In "airflow"."fact"."fact_waterlevel":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m00:05:06.142458 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.fact_waterlevel"
[0m00:05:06.143462 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m00:05:06.143766 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      insert into "airflow"."fact"."fact_waterlevel" ("station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update")
    (
        select "station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update"
        from "fact_waterlevel__dbt_tmp000506015384"
    )


  
[0m00:05:06.144583 [debug] [Thread-1 (]: SQL status: INSERT 0 73 in 0.000 seconds
[0m00:05:06.152433 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m00:05:06.152720 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m00:05:06.152955 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m00:05:06.154348 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m00:05:06.155657 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: Close
[0m00:05:06.156960 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9fbea47f-0cc4-48f0-b943-bdceacc5a4f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbd493220>]}
[0m00:05:06.157442 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model fact.fact_waterlevel ................... [[32mINSERT 0 73[0m in 0.17s]
[0m00:05:06.157836 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.fact_waterlevel
[0m00:05:06.158562 [debug] [MainThread]: Using postgres connection "master"
[0m00:05:06.158813 [debug] [MainThread]: On master: BEGIN
[0m00:05:06.159052 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:05:06.160612 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m00:05:06.160866 [debug] [MainThread]: On master: COMMIT
[0m00:05:06.161067 [debug] [MainThread]: Using postgres connection "master"
[0m00:05:06.161252 [debug] [MainThread]: On master: COMMIT
[0m00:05:06.161528 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:05:06.161772 [debug] [MainThread]: On master: Close
[0m00:05:06.162072 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:05:06.162291 [debug] [MainThread]: Connection 'model.etl_waterlevel.fact_waterlevel' was properly closed.
[0m00:05:06.162514 [info ] [MainThread]: 
[0m00:05:06.162740 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.25 seconds (0.25s).
[0m00:05:06.163114 [debug] [MainThread]: Command end result
[0m00:05:06.178377 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m00:05:06.179606 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m00:05:06.182939 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m00:05:06.183174 [info ] [MainThread]: 
[0m00:05:06.183452 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:05:06.183691 [info ] [MainThread]: 
[0m00:05:06.183941 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m00:05:06.184517 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.58146435, "process_in_blocks": "0", "process_kernel_time": 0.113495, "process_mem_max_rss": "111648", "process_out_blocks": "2637", "process_user_time": 1.269542}
[0m00:05:06.184850 [debug] [MainThread]: Command `dbt run` succeeded at 00:05:06.184803 after 0.58 seconds
[0m00:05:06.185092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbaf883a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9629300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbae45c00>]}
[0m00:05:06.185341 [debug] [MainThread]: Flushing usage events
[0m00:05:07.562118 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:16:03.674288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84678310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83758550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83758580>]}


============================== 01:16:03.677810 | 8d73cc80-ae39-4e12-83a7-3db3d4ffb387 ==============================
[0m01:16:03.677810 [info ] [MainThread]: Running with dbt=1.9.0
[0m01:16:03.678175 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'debug': 'False', 'profiles_dir': '/home/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models fact_waterlevel', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m01:16:03.773053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8d73cc80-ae39-4e12-83a7-3db3d4ffb387', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86ae10f0>]}
[0m01:16:03.799951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8d73cc80-ae39-4e12-83a7-3db3d4ffb387', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff845cc1c0>]}
[0m01:16:03.800461 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m01:16:03.835256 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m01:16:03.886243 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:16:03.886573 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:16:03.889679 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m01:16:03.901415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8d73cc80-ae39-4e12-83a7-3db3d4ffb387', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82a24520>]}
[0m01:16:03.939982 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m01:16:03.943564 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m01:16:03.954046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8d73cc80-ae39-4e12-83a7-3db3d4ffb387', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82a3f220>]}
[0m01:16:03.954444 [info ] [MainThread]: Found 3 models, 434 macros
[0m01:16:03.954688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8d73cc80-ae39-4e12-83a7-3db3d4ffb387', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82a3f1c0>]}
[0m01:16:03.955409 [info ] [MainThread]: 
[0m01:16:03.955657 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:16:03.955860 [info ] [MainThread]: 
[0m01:16:03.956165 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:16:03.956733 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m01:16:03.996758 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m01:16:03.997185 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m01:16:03.997515 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:16:04.000513 [debug] [ThreadPool]: SQL status: SELECT 36 in 0.003 seconds
[0m01:16:04.001288 [debug] [ThreadPool]: On list_airflow: Close
[0m01:16:04.003928 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_dim)
[0m01:16:04.007139 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m01:16:04.007410 [debug] [ThreadPool]: On list_airflow_dim: BEGIN
[0m01:16:04.007652 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:16:04.009223 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m01:16:04.009577 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m01:16:04.009845 [debug] [ThreadPool]: On list_airflow_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dim'
  
[0m01:16:04.011541 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.001 seconds
[0m01:16:04.012245 [debug] [ThreadPool]: On list_airflow_dim: ROLLBACK
[0m01:16:04.012610 [debug] [ThreadPool]: On list_airflow_dim: Close
[0m01:16:04.013005 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_dim, now list_airflow_fact)
[0m01:16:04.014382 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m01:16:04.014636 [debug] [ThreadPool]: On list_airflow_fact: BEGIN
[0m01:16:04.014869 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:16:04.016297 [debug] [ThreadPool]: SQL status: BEGIN in 0.001 seconds
[0m01:16:04.016602 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m01:16:04.016861 [debug] [ThreadPool]: On list_airflow_fact: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_fact"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'fact'
  
[0m01:16:04.018056 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m01:16:04.018665 [debug] [ThreadPool]: On list_airflow_fact: ROLLBACK
[0m01:16:04.018977 [debug] [ThreadPool]: On list_airflow_fact: Close
[0m01:16:04.021409 [debug] [MainThread]: Using postgres connection "master"
[0m01:16:04.021670 [debug] [MainThread]: On master: BEGIN
[0m01:16:04.021908 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:16:04.023343 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m01:16:04.023662 [debug] [MainThread]: Using postgres connection "master"
[0m01:16:04.023957 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m01:16:04.027567 [debug] [MainThread]: SQL status: SELECT 2 in 0.003 seconds
[0m01:16:04.028291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8d73cc80-ae39-4e12-83a7-3db3d4ffb387', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82a3e9b0>]}
[0m01:16:04.028611 [debug] [MainThread]: On master: ROLLBACK
[0m01:16:04.028956 [debug] [MainThread]: Using postgres connection "master"
[0m01:16:04.029215 [debug] [MainThread]: On master: BEGIN
[0m01:16:04.029604 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m01:16:04.029892 [debug] [MainThread]: On master: COMMIT
[0m01:16:04.030135 [debug] [MainThread]: Using postgres connection "master"
[0m01:16:04.030388 [debug] [MainThread]: On master: COMMIT
[0m01:16:04.030699 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:16:04.030942 [debug] [MainThread]: On master: Close
[0m01:16:04.032061 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.fact_waterlevel
[0m01:16:04.032428 [info ] [Thread-1 (]: 1 of 1 START sql incremental model fact.fact_waterlevel ........................ [RUN]
[0m01:16:04.032739 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_fact, now model.etl_waterlevel.fact_waterlevel)
[0m01:16:04.033023 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.fact_waterlevel
[0m01:16:04.039989 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.fact_waterlevel"
[0m01:16:04.041982 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.fact_waterlevel
[0m01:16:04.070075 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m01:16:04.070434 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

    
  
    

  create temporary table "fact_waterlevel__dbt_tmp011604057993"
  
  
    as
  
  (
    

with main as (
    select
        distinct
        concat("stationId",'_',"stationCode") as station_key,
        "stationId" as station_id,
        "stationCode" as station_code,
        "waterLevel" as water_level,
        "waterlevelStatus" as waterlevel_status,
        case
            when "waterlevelStatus" = 3 then '🚨 Beyond Danger'
            when "waterlevelStatus" = 2 then '⚠️ Between Warning and Danger'
            when "waterlevelStatus" = 1 then '🔶 Between Alert and Warning'
            when "waterlevelStatus" = 0 then '✅ Between Normal and Alert'
            when "waterlevelStatus" = -1 then '🟢 Below Normal (Safe)'
            else '❓ Unknown Status'
        end as waterlevel_condition,
        "stationName",
        "districtName",
        to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp AS last_update
    from
        raw.waterlevels w
    where
        "stationStatus" = 1

        
        /* This condition is important to avoid reprocessing old data */
        and to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp > (
            select max(last_update) from "airflow"."fact"."fact_waterlevel"
        )
        
)

select * from main
  );
  
  
[0m01:16:04.070792 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:16:04.100643 [debug] [Thread-1 (]: SQL status: SELECT 73 in 0.030 seconds
[0m01:16:04.107988 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m01:16:04.108320 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: BEGIN
[0m01:16:04.108746 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m01:16:04.109107 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m01:16:04.109405 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp011604057993'
        
      order by ordinal_position

  
[0m01:16:04.112378 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.003 seconds
[0m01:16:04.115094 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m01:16:04.115406 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m01:16:04.116752 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m01:16:04.123683 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m01:16:04.124076 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp011604057993'
        
      order by ordinal_position

  
[0m01:16:04.125406 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m01:16:04.127247 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m01:16:04.127566 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m01:16:04.128831 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m01:16:04.133678 [debug] [Thread-1 (]: 
    In "airflow"."fact"."fact_waterlevel":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m01:16:04.137247 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.fact_waterlevel"
[0m01:16:04.138326 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m01:16:04.138632 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      insert into "airflow"."fact"."fact_waterlevel" ("station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update")
    (
        select "station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update"
        from "fact_waterlevel__dbt_tmp011604057993"
    )


  
[0m01:16:04.139256 [debug] [Thread-1 (]: SQL status: INSERT 0 73 in 0.000 seconds
[0m01:16:04.147458 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m01:16:04.147760 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m01:16:04.147993 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m01:16:04.148780 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m01:16:04.149943 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: Close
[0m01:16:04.151109 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d73cc80-ae39-4e12-83a7-3db3d4ffb387', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86ae1de0>]}
[0m01:16:04.151569 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model fact.fact_waterlevel ................... [[32mINSERT 0 73[0m in 0.12s]
[0m01:16:04.152103 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.fact_waterlevel
[0m01:16:04.152803 [debug] [MainThread]: Using postgres connection "master"
[0m01:16:04.153068 [debug] [MainThread]: On master: BEGIN
[0m01:16:04.153290 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:16:04.154855 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m01:16:04.155190 [debug] [MainThread]: On master: COMMIT
[0m01:16:04.155408 [debug] [MainThread]: Using postgres connection "master"
[0m01:16:04.155599 [debug] [MainThread]: On master: COMMIT
[0m01:16:04.155844 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:16:04.156087 [debug] [MainThread]: On master: Close
[0m01:16:04.156361 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:16:04.156568 [debug] [MainThread]: Connection 'model.etl_waterlevel.fact_waterlevel' was properly closed.
[0m01:16:04.156791 [info ] [MainThread]: 
[0m01:16:04.157022 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.20 seconds (0.20s).
[0m01:16:04.157394 [debug] [MainThread]: Command end result
[0m01:16:04.171545 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m01:16:04.172620 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m01:16:04.176289 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m01:16:04.176527 [info ] [MainThread]: 
[0m01:16:04.176780 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:16:04.176981 [info ] [MainThread]: 
[0m01:16:04.177240 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m01:16:04.177839 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.532186, "process_in_blocks": "0", "process_kernel_time": 0.129367, "process_mem_max_rss": "111464", "process_out_blocks": "2637", "process_user_time": 1.302699}
[0m01:16:04.178184 [debug] [MainThread]: Command `dbt run` succeeded at 01:16:04.178136 after 0.53 seconds
[0m01:16:04.178424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84678310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff845cc1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff846e8bb0>]}
[0m01:16:04.178681 [debug] [MainThread]: Flushing usage events
[0m01:16:05.588319 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:20:24.711467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac494310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab57fd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab57fcd0>]}


============================== 02:20:24.714384 | 711705d2-c7d8-49bd-9b72-426aae988bde ==============================
[0m02:20:24.714384 [info ] [MainThread]: Running with dbt=1.9.0
[0m02:20:24.714794 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --models fact_waterlevel', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m02:20:24.798516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '711705d2-c7d8-49bd-9b72-426aae988bde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaac46290>]}
[0m02:20:24.825319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '711705d2-c7d8-49bd-9b72-426aae988bde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac3e41c0>]}
[0m02:20:24.825825 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m02:20:24.859915 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m02:20:24.907724 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:20:24.908010 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:20:24.911092 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m02:20:24.922608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '711705d2-c7d8-49bd-9b72-426aae988bde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa7d0550>]}
[0m02:20:24.958765 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m02:20:24.962099 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m02:20:24.970587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '711705d2-c7d8-49bd-9b72-426aae988bde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa7ef220>]}
[0m02:20:24.970920 [info ] [MainThread]: Found 3 models, 434 macros
[0m02:20:24.971211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '711705d2-c7d8-49bd-9b72-426aae988bde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa7ef1c0>]}
[0m02:20:24.972005 [info ] [MainThread]: 
[0m02:20:24.972263 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:20:24.972480 [info ] [MainThread]: 
[0m02:20:24.972820 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:20:24.973438 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m02:20:25.011119 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m02:20:25.011508 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m02:20:25.011805 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:20:25.014567 [debug] [ThreadPool]: SQL status: SELECT 36 in 0.003 seconds
[0m02:20:25.015362 [debug] [ThreadPool]: On list_airflow: Close
[0m02:20:25.017968 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_dim)
[0m02:20:25.021088 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m02:20:25.021365 [debug] [ThreadPool]: On list_airflow_dim: BEGIN
[0m02:20:25.021617 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:20:25.023188 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m02:20:25.023535 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m02:20:25.023793 [debug] [ThreadPool]: On list_airflow_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dim'
  
[0m02:20:25.025159 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.001 seconds
[0m02:20:25.025823 [debug] [ThreadPool]: On list_airflow_dim: ROLLBACK
[0m02:20:25.026158 [debug] [ThreadPool]: On list_airflow_dim: Close
[0m02:20:25.026554 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_dim, now list_airflow_fact)
[0m02:20:25.027929 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m02:20:25.028186 [debug] [ThreadPool]: On list_airflow_fact: BEGIN
[0m02:20:25.028416 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:20:25.029956 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m02:20:25.030259 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m02:20:25.030514 [debug] [ThreadPool]: On list_airflow_fact: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_fact"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'fact'
  
[0m02:20:25.031787 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m02:20:25.032376 [debug] [ThreadPool]: On list_airflow_fact: ROLLBACK
[0m02:20:25.032695 [debug] [ThreadPool]: On list_airflow_fact: Close
[0m02:20:25.035075 [debug] [MainThread]: Using postgres connection "master"
[0m02:20:25.035336 [debug] [MainThread]: On master: BEGIN
[0m02:20:25.035624 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:20:25.037082 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m02:20:25.037398 [debug] [MainThread]: Using postgres connection "master"
[0m02:20:25.037715 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:20:25.040485 [debug] [MainThread]: SQL status: SELECT 2 in 0.002 seconds
[0m02:20:25.041152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '711705d2-c7d8-49bd-9b72-426aae988bde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffade8fe50>]}
[0m02:20:25.041476 [debug] [MainThread]: On master: ROLLBACK
[0m02:20:25.041802 [debug] [MainThread]: Using postgres connection "master"
[0m02:20:25.042051 [debug] [MainThread]: On master: BEGIN
[0m02:20:25.042461 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m02:20:25.042747 [debug] [MainThread]: On master: COMMIT
[0m02:20:25.043003 [debug] [MainThread]: Using postgres connection "master"
[0m02:20:25.043238 [debug] [MainThread]: On master: COMMIT
[0m02:20:25.043594 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m02:20:25.043840 [debug] [MainThread]: On master: Close
[0m02:20:25.044952 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.fact_waterlevel
[0m02:20:25.045317 [info ] [Thread-1 (]: 1 of 1 START sql incremental model fact.fact_waterlevel ........................ [RUN]
[0m02:20:25.045633 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_fact, now model.etl_waterlevel.fact_waterlevel)
[0m02:20:25.045928 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.fact_waterlevel
[0m02:20:25.052709 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.fact_waterlevel"
[0m02:20:25.053587 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.fact_waterlevel
[0m02:20:25.081324 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m02:20:25.081705 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

    
  
    

  create temporary table "fact_waterlevel__dbt_tmp022025069436"
  
  
    as
  
  (
    

with main as (
    select
        distinct
        concat("stationId",'_',"stationCode") as station_key,
        "stationId" as station_id,
        "stationCode" as station_code,
        "waterLevel" as water_level,
        "waterlevelStatus" as waterlevel_status,
        case
            when "waterlevelStatus" = 3 then '🚨 Beyond Danger'
            when "waterlevelStatus" = 2 then '⚠️ Between Warning and Danger'
            when "waterlevelStatus" = 1 then '🔶 Between Alert and Warning'
            when "waterlevelStatus" = 0 then '✅ Between Normal and Alert'
            when "waterlevelStatus" = -1 then '🟢 Below Normal (Safe)'
            else '❓ Unknown Status'
        end as waterlevel_condition,
        "stationName",
        "districtName",
        to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp AS last_update
    from
        raw.waterlevels w
    where
        "stationStatus" = 1

        
        /* This condition is important to avoid reprocessing old data */
        and to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp > (
            select max(last_update) from "airflow"."fact"."fact_waterlevel"
        )
        
)

select * from main
  );
  
  
[0m02:20:25.082030 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:20:25.096918 [debug] [Thread-1 (]: SQL status: SELECT 73 in 0.015 seconds
[0m02:20:25.103929 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m02:20:25.104241 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: BEGIN
[0m02:20:25.104642 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m02:20:25.105046 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m02:20:25.105331 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp022025069436'
        
      order by ordinal_position

  
[0m02:20:25.108012 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.002 seconds
[0m02:20:25.110598 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m02:20:25.110934 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m02:20:25.112274 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m02:20:25.118638 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m02:20:25.118955 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp022025069436'
        
      order by ordinal_position

  
[0m02:20:25.120187 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m02:20:25.121916 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m02:20:25.122211 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m02:20:25.123364 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m02:20:25.127866 [debug] [Thread-1 (]: 
    In "airflow"."fact"."fact_waterlevel":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m02:20:25.131296 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.fact_waterlevel"
[0m02:20:25.132127 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m02:20:25.132428 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      insert into "airflow"."fact"."fact_waterlevel" ("station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update")
    (
        select "station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update"
        from "fact_waterlevel__dbt_tmp022025069436"
    )


  
[0m02:20:25.132959 [debug] [Thread-1 (]: SQL status: INSERT 0 73 in 0.000 seconds
[0m02:20:25.140342 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m02:20:25.140648 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m02:20:25.140933 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m02:20:25.142202 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m02:20:25.143212 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: Close
[0m02:20:25.144255 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '711705d2-c7d8-49bd-9b72-426aae988bde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae6967a0>]}
[0m02:20:25.144806 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model fact.fact_waterlevel ................... [[32mINSERT 0 73[0m in 0.10s]
[0m02:20:25.145245 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.fact_waterlevel
[0m02:20:25.145984 [debug] [MainThread]: Using postgres connection "master"
[0m02:20:25.146226 [debug] [MainThread]: On master: BEGIN
[0m02:20:25.146473 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:20:25.147902 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m02:20:25.148155 [debug] [MainThread]: On master: COMMIT
[0m02:20:25.148381 [debug] [MainThread]: Using postgres connection "master"
[0m02:20:25.148599 [debug] [MainThread]: On master: COMMIT
[0m02:20:25.148873 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m02:20:25.149092 [debug] [MainThread]: On master: Close
[0m02:20:25.149366 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:20:25.149585 [debug] [MainThread]: Connection 'model.etl_waterlevel.fact_waterlevel' was properly closed.
[0m02:20:25.149808 [info ] [MainThread]: 
[0m02:20:25.150027 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.18 seconds (0.18s).
[0m02:20:25.150398 [debug] [MainThread]: Command end result
[0m02:20:25.165834 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m02:20:25.167035 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m02:20:25.170404 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m02:20:25.170632 [info ] [MainThread]: 
[0m02:20:25.170899 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:20:25.171116 [info ] [MainThread]: 
[0m02:20:25.171336 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m02:20:25.171842 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.48588613, "process_in_blocks": "0", "process_kernel_time": 0.063975, "process_mem_max_rss": "111344", "process_out_blocks": "1701", "process_user_time": 1.195537}
[0m02:20:25.172167 [debug] [MainThread]: Command `dbt run` succeeded at 02:20:25.172122 after 0.49 seconds
[0m02:20:25.172410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac494310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaac46290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac5036d0>]}
[0m02:20:25.172658 [debug] [MainThread]: Flushing usage events
[0m02:20:26.424814 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:17:53.667034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b9842b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7aa6bca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7aa6bc40>]}


============================== 03:17:53.670145 | 9265e0b1-be1a-43f3-bb12-d106982633d8 ==============================
[0m03:17:53.670145 [info ] [MainThread]: Running with dbt=1.9.0
[0m03:17:53.670548 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/airflow/.dbt', 'log_path': '/usr/app/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --models fact_waterlevel', 'send_anonymous_usage_stats': 'True'}
[0m03:17:53.754946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9265e0b1-be1a-43f3-bb12-d106982633d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a1ce170>]}
[0m03:17:53.781536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9265e0b1-be1a-43f3-bb12-d106982633d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b8d0100>]}
[0m03:17:53.782043 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m03:17:53.815906 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m03:17:53.863768 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:17:53.864052 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:17:53.867106 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m03:17:53.878722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9265e0b1-be1a-43f3-bb12-d106982633d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79d704c0>]}
[0m03:17:53.914408 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m03:17:53.918028 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m03:17:53.926320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9265e0b1-be1a-43f3-bb12-d106982633d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79d8f220>]}
[0m03:17:53.926647 [info ] [MainThread]: Found 3 models, 434 macros
[0m03:17:53.926886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9265e0b1-be1a-43f3-bb12-d106982633d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79d8f1c0>]}
[0m03:17:53.927568 [info ] [MainThread]: 
[0m03:17:53.927816 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:17:53.928014 [info ] [MainThread]: 
[0m03:17:53.928308 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m03:17:53.928873 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m03:17:53.966976 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m03:17:53.967385 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m03:17:53.967667 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:17:53.970502 [debug] [ThreadPool]: SQL status: SELECT 36 in 0.003 seconds
[0m03:17:53.971257 [debug] [ThreadPool]: On list_airflow: Close
[0m03:17:53.973877 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_fact)
[0m03:17:53.977051 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m03:17:53.977339 [debug] [ThreadPool]: On list_airflow_fact: BEGIN
[0m03:17:53.977588 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:17:53.979233 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m03:17:53.979563 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m03:17:53.979828 [debug] [ThreadPool]: On list_airflow_fact: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_fact"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'fact'
  
[0m03:17:53.981226 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m03:17:53.981889 [debug] [ThreadPool]: On list_airflow_fact: ROLLBACK
[0m03:17:53.982225 [debug] [ThreadPool]: On list_airflow_fact: Close
[0m03:17:53.982641 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_fact, now list_airflow_dim)
[0m03:17:53.983956 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m03:17:53.984216 [debug] [ThreadPool]: On list_airflow_dim: BEGIN
[0m03:17:53.984480 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:17:53.985952 [debug] [ThreadPool]: SQL status: BEGIN in 0.001 seconds
[0m03:17:53.986244 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m03:17:53.986519 [debug] [ThreadPool]: On list_airflow_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dim'
  
[0m03:17:53.987721 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.001 seconds
[0m03:17:53.988389 [debug] [ThreadPool]: On list_airflow_dim: ROLLBACK
[0m03:17:53.988705 [debug] [ThreadPool]: On list_airflow_dim: Close
[0m03:17:53.991152 [debug] [MainThread]: Using postgres connection "master"
[0m03:17:53.991422 [debug] [MainThread]: On master: BEGIN
[0m03:17:53.991663 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:17:53.993118 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m03:17:53.993444 [debug] [MainThread]: Using postgres connection "master"
[0m03:17:53.993738 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m03:17:53.996710 [debug] [MainThread]: SQL status: SELECT 2 in 0.003 seconds
[0m03:17:53.997364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9265e0b1-be1a-43f3-bb12-d106982633d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b842a10>]}
[0m03:17:53.997700 [debug] [MainThread]: On master: ROLLBACK
[0m03:17:53.998040 [debug] [MainThread]: Using postgres connection "master"
[0m03:17:53.998294 [debug] [MainThread]: On master: BEGIN
[0m03:17:53.998700 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m03:17:53.998999 [debug] [MainThread]: On master: COMMIT
[0m03:17:53.999240 [debug] [MainThread]: Using postgres connection "master"
[0m03:17:53.999496 [debug] [MainThread]: On master: COMMIT
[0m03:17:53.999828 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m03:17:54.000075 [debug] [MainThread]: On master: Close
[0m03:17:54.001367 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.fact_waterlevel
[0m03:17:54.001742 [info ] [Thread-1 (]: 1 of 1 START sql incremental model fact.fact_waterlevel ........................ [RUN]
[0m03:17:54.002070 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_dim, now model.etl_waterlevel.fact_waterlevel)
[0m03:17:54.002341 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.fact_waterlevel
[0m03:17:54.009407 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.fact_waterlevel"
[0m03:17:54.010397 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.fact_waterlevel
[0m03:17:54.040196 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m03:17:54.040694 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

    
  
    

  create temporary table "fact_waterlevel__dbt_tmp031754027564"
  
  
    as
  
  (
    

with main as (
    select
        distinct
        concat("stationId",'_',"stationCode") as station_key,
        "stationId" as station_id,
        "stationCode" as station_code,
        "waterLevel" as water_level,
        "waterlevelStatus" as waterlevel_status,
        case
            when "waterlevelStatus" = 3 then '🚨 Beyond Danger'
            when "waterlevelStatus" = 2 then '⚠️ Between Warning and Danger'
            when "waterlevelStatus" = 1 then '🔶 Between Alert and Warning'
            when "waterlevelStatus" = 0 then '✅ Between Normal and Alert'
            when "waterlevelStatus" = -1 then '🟢 Below Normal (Safe)'
            else '❓ Unknown Status'
        end as waterlevel_condition,
        "stationName",
        "districtName",
        to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp AS last_update
    from
        raw.waterlevels w
    where
        "stationStatus" = 1

        
        /* This condition is important to avoid reprocessing old data */
        and to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp > (
            select max(last_update) from "airflow"."fact"."fact_waterlevel"
        )
        
)

select * from main
  );
  
  
[0m03:17:54.041073 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:17:54.059057 [debug] [Thread-1 (]: SQL status: SELECT 73 in 0.018 seconds
[0m03:17:54.067283 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m03:17:54.067672 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: BEGIN
[0m03:17:54.068188 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m03:17:54.068656 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m03:17:54.068977 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp031754027564'
        
      order by ordinal_position

  
[0m03:17:54.072141 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.003 seconds
[0m03:17:54.075762 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m03:17:54.076182 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m03:17:54.077960 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m03:17:54.086184 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m03:17:54.086746 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp031754027564'
        
      order by ordinal_position

  
[0m03:17:54.088523 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m03:17:54.090823 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m03:17:54.091220 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m03:17:54.092854 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m03:17:54.098578 [debug] [Thread-1 (]: 
    In "airflow"."fact"."fact_waterlevel":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m03:17:54.103733 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.fact_waterlevel"
[0m03:17:54.104865 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m03:17:54.105181 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      insert into "airflow"."fact"."fact_waterlevel" ("station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update")
    (
        select "station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update"
        from "fact_waterlevel__dbt_tmp031754027564"
    )


  
[0m03:17:54.105959 [debug] [Thread-1 (]: SQL status: INSERT 0 73 in 0.000 seconds
[0m03:17:54.114218 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m03:17:54.114592 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m03:17:54.114889 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m03:17:54.116533 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m03:17:54.117918 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: Close
[0m03:17:54.119446 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9265e0b1-be1a-43f3-bb12-d106982633d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7db88af0>]}
[0m03:17:54.120240 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model fact.fact_waterlevel ................... [[32mINSERT 0 73[0m in 0.12s]
[0m03:17:54.121099 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.fact_waterlevel
[0m03:17:54.122213 [debug] [MainThread]: Using postgres connection "master"
[0m03:17:54.122498 [debug] [MainThread]: On master: BEGIN
[0m03:17:54.122698 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:17:54.124858 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m03:17:54.125295 [debug] [MainThread]: On master: COMMIT
[0m03:17:54.125567 [debug] [MainThread]: Using postgres connection "master"
[0m03:17:54.125795 [debug] [MainThread]: On master: COMMIT
[0m03:17:54.126059 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m03:17:54.126279 [debug] [MainThread]: On master: Close
[0m03:17:54.126580 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:17:54.126830 [debug] [MainThread]: Connection 'model.etl_waterlevel.fact_waterlevel' was properly closed.
[0m03:17:54.127113 [info ] [MainThread]: 
[0m03:17:54.127357 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.20 seconds (0.20s).
[0m03:17:54.127767 [debug] [MainThread]: Command end result
[0m03:17:54.145559 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m03:17:54.147485 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m03:17:54.152158 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m03:17:54.152536 [info ] [MainThread]: 
[0m03:17:54.152923 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:17:54.153160 [info ] [MainThread]: 
[0m03:17:54.153403 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m03:17:54.154319 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.51480323, "process_in_blocks": "0", "process_kernel_time": 0.069983, "process_mem_max_rss": "111356", "process_out_blocks": "1701", "process_user_time": 1.212719}
[0m03:17:54.154815 [debug] [MainThread]: Command `dbt run` succeeded at 03:17:54.154735 after 0.52 seconds
[0m03:17:54.155156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b9842b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b999bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7903a980>]}
[0m03:17:54.155491 [debug] [MainThread]: Flushing usage events
[0m03:17:55.535266 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m04:18:48.061891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8734c340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff864484f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86448550>]}


============================== 04:18:48.064906 | 24ea5105-131f-4a01-bba3-369a1919a693 ==============================
[0m04:18:48.064906 [info ] [MainThread]: Running with dbt=1.9.0
[0m04:18:48.065301 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/logs', 'profiles_dir': '/home/airflow/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --models fact_waterlevel', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m04:18:48.154130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '24ea5105-131f-4a01-bba3-369a1919a693', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff894aa7a0>]}
[0m04:18:48.180620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '24ea5105-131f-4a01-bba3-369a1919a693', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8720a7a0>]}
[0m04:18:48.181111 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m04:18:48.215553 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m04:18:48.265347 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:18:48.265724 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:18:48.268836 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m04:18:48.280604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '24ea5105-131f-4a01-bba3-369a1919a693', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85648580>]}
[0m04:18:48.316318 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m04:18:48.319908 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m04:18:48.328938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '24ea5105-131f-4a01-bba3-369a1919a693', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85667220>]}
[0m04:18:48.329259 [info ] [MainThread]: Found 3 models, 434 macros
[0m04:18:48.329499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '24ea5105-131f-4a01-bba3-369a1919a693', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff856671c0>]}
[0m04:18:48.330152 [info ] [MainThread]: 
[0m04:18:48.330416 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:18:48.330661 [info ] [MainThread]: 
[0m04:18:48.330966 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m04:18:48.331534 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m04:18:48.370638 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m04:18:48.371044 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m04:18:48.371314 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:18:48.374301 [debug] [ThreadPool]: SQL status: SELECT 36 in 0.003 seconds
[0m04:18:48.375064 [debug] [ThreadPool]: On list_airflow: Close
[0m04:18:48.377653 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_dim)
[0m04:18:48.380873 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m04:18:48.381147 [debug] [ThreadPool]: On list_airflow_dim: BEGIN
[0m04:18:48.381427 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:18:48.383054 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m04:18:48.383406 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m04:18:48.383669 [debug] [ThreadPool]: On list_airflow_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dim'
  
[0m04:18:48.385051 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.001 seconds
[0m04:18:48.385703 [debug] [ThreadPool]: On list_airflow_dim: ROLLBACK
[0m04:18:48.386032 [debug] [ThreadPool]: On list_airflow_dim: Close
[0m04:18:48.386436 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_dim, now list_airflow_fact)
[0m04:18:48.387839 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m04:18:48.388090 [debug] [ThreadPool]: On list_airflow_fact: BEGIN
[0m04:18:48.388338 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:18:48.389780 [debug] [ThreadPool]: SQL status: BEGIN in 0.001 seconds
[0m04:18:48.390086 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m04:18:48.390341 [debug] [ThreadPool]: On list_airflow_fact: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_fact"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'fact'
  
[0m04:18:48.391551 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m04:18:48.392159 [debug] [ThreadPool]: On list_airflow_fact: ROLLBACK
[0m04:18:48.392504 [debug] [ThreadPool]: On list_airflow_fact: Close
[0m04:18:48.394902 [debug] [MainThread]: Using postgres connection "master"
[0m04:18:48.395160 [debug] [MainThread]: On master: BEGIN
[0m04:18:48.395413 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:18:48.396900 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m04:18:48.397197 [debug] [MainThread]: Using postgres connection "master"
[0m04:18:48.397524 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m04:18:48.400488 [debug] [MainThread]: SQL status: SELECT 2 in 0.003 seconds
[0m04:18:48.401118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '24ea5105-131f-4a01-bba3-369a1919a693', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85666d10>]}
[0m04:18:48.401448 [debug] [MainThread]: On master: ROLLBACK
[0m04:18:48.401781 [debug] [MainThread]: Using postgres connection "master"
[0m04:18:48.402028 [debug] [MainThread]: On master: BEGIN
[0m04:18:48.402411 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m04:18:48.402710 [debug] [MainThread]: On master: COMMIT
[0m04:18:48.402952 [debug] [MainThread]: Using postgres connection "master"
[0m04:18:48.403179 [debug] [MainThread]: On master: COMMIT
[0m04:18:48.403520 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m04:18:48.403786 [debug] [MainThread]: On master: Close
[0m04:18:48.404940 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.fact_waterlevel
[0m04:18:48.405325 [info ] [Thread-1 (]: 1 of 1 START sql incremental model fact.fact_waterlevel ........................ [RUN]
[0m04:18:48.405646 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_fact, now model.etl_waterlevel.fact_waterlevel)
[0m04:18:48.405917 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.fact_waterlevel
[0m04:18:48.412845 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.fact_waterlevel"
[0m04:18:48.413716 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.fact_waterlevel
[0m04:18:48.441924 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m04:18:48.442306 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

    
  
    

  create temporary table "fact_waterlevel__dbt_tmp041848429860"
  
  
    as
  
  (
    

with main as (
    select
        distinct
        concat("stationId",'_',"stationCode") as station_key,
        "stationId" as station_id,
        "stationCode" as station_code,
        "waterLevel" as water_level,
        "waterlevelStatus" as waterlevel_status,
        case
            when "waterlevelStatus" = 3 then '🚨 Beyond Danger'
            when "waterlevelStatus" = 2 then '⚠️ Between Warning and Danger'
            when "waterlevelStatus" = 1 then '🔶 Between Alert and Warning'
            when "waterlevelStatus" = 0 then '✅ Between Normal and Alert'
            when "waterlevelStatus" = -1 then '🟢 Below Normal (Safe)'
            else '❓ Unknown Status'
        end as waterlevel_condition,
        "stationName",
        "districtName",
        to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp AS last_update
    from
        raw.waterlevels w
    where
        "stationStatus" = 1

        
        /* This condition is important to avoid reprocessing old data */
        and to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp > (
            select max(last_update) from "airflow"."fact"."fact_waterlevel"
        )
        
)

select * from main
  );
  
  
[0m04:18:48.442665 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:18:48.458612 [debug] [Thread-1 (]: SQL status: SELECT 73 in 0.016 seconds
[0m04:18:48.465671 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m04:18:48.465982 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: BEGIN
[0m04:18:48.466401 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m04:18:48.466742 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m04:18:48.467020 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp041848429860'
        
      order by ordinal_position

  
[0m04:18:48.469858 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.003 seconds
[0m04:18:48.472412 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m04:18:48.472713 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m04:18:48.474036 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m04:18:48.480414 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m04:18:48.480720 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp041848429860'
        
      order by ordinal_position

  
[0m04:18:48.481945 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m04:18:48.483567 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m04:18:48.483860 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m04:18:48.485053 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m04:18:48.489511 [debug] [Thread-1 (]: 
    In "airflow"."fact"."fact_waterlevel":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m04:18:48.492922 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.fact_waterlevel"
[0m04:18:48.493732 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m04:18:48.494036 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      insert into "airflow"."fact"."fact_waterlevel" ("station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update")
    (
        select "station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update"
        from "fact_waterlevel__dbt_tmp041848429860"
    )


  
[0m04:18:48.494597 [debug] [Thread-1 (]: SQL status: INSERT 0 73 in 0.000 seconds
[0m04:18:48.502044 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m04:18:48.502345 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m04:18:48.502611 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m04:18:48.504020 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m04:18:48.505036 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: Close
[0m04:18:48.506126 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24ea5105-131f-4a01-bba3-369a1919a693', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff894aa7d0>]}
[0m04:18:48.506617 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model fact.fact_waterlevel ................... [[32mINSERT 0 73[0m in 0.10s]
[0m04:18:48.507027 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.fact_waterlevel
[0m04:18:48.507723 [debug] [MainThread]: Using postgres connection "master"
[0m04:18:48.507950 [debug] [MainThread]: On master: BEGIN
[0m04:18:48.508141 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m04:18:48.509562 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m04:18:48.509839 [debug] [MainThread]: On master: COMMIT
[0m04:18:48.510066 [debug] [MainThread]: Using postgres connection "master"
[0m04:18:48.510279 [debug] [MainThread]: On master: COMMIT
[0m04:18:48.510547 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m04:18:48.510747 [debug] [MainThread]: On master: Close
[0m04:18:48.511004 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:18:48.511219 [debug] [MainThread]: Connection 'model.etl_waterlevel.fact_waterlevel' was properly closed.
[0m04:18:48.511436 [info ] [MainThread]: 
[0m04:18:48.511698 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.18 seconds (0.18s).
[0m04:18:48.512097 [debug] [MainThread]: Command end result
[0m04:18:48.530320 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m04:18:48.531622 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m04:18:48.534990 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m04:18:48.535228 [info ] [MainThread]: 
[0m04:18:48.535502 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:18:48.535716 [info ] [MainThread]: 
[0m04:18:48.535932 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m04:18:48.536486 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.5007777, "process_in_blocks": "0", "process_kernel_time": 0.106522, "process_mem_max_rss": "111180", "process_out_blocks": "1701", "process_user_time": 1.189672}
[0m04:18:48.536862 [debug] [MainThread]: Command `dbt run` succeeded at 04:18:48.536805 after 0.50 seconds
[0m04:18:48.537141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8734c340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff873d0790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85639d20>]}
[0m04:18:48.537411 [debug] [MainThread]: Flushing usage events
[0m04:18:49.719674 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m05:19:39.205708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8878c2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87870520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87870580>]}


============================== 05:19:39.208908 | fa292b08-da6b-4353-b7fb-69cede0a6159 ==============================
[0m05:19:39.208908 [info ] [MainThread]: Running with dbt=1.9.0
[0m05:19:39.209325 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --models fact_waterlevel', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m05:19:39.295876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fa292b08-da6b-4353-b7fb-69cede0a6159', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86fda9e0>]}
[0m05:19:39.322706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fa292b08-da6b-4353-b7fb-69cede0a6159', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87870040>]}
[0m05:19:39.323211 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m05:19:39.357681 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m05:19:39.406959 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:19:39.407254 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:19:39.410354 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m05:19:39.422034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fa292b08-da6b-4353-b7fb-69cede0a6159', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86b7c520>]}
[0m05:19:39.457894 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m05:19:39.461655 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m05:19:39.470339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fa292b08-da6b-4353-b7fb-69cede0a6159', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86b9b220>]}
[0m05:19:39.470717 [info ] [MainThread]: Found 3 models, 434 macros
[0m05:19:39.470994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fa292b08-da6b-4353-b7fb-69cede0a6159', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86b9b1c0>]}
[0m05:19:39.471700 [info ] [MainThread]: 
[0m05:19:39.471975 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m05:19:39.472209 [info ] [MainThread]: 
[0m05:19:39.472517 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m05:19:39.473195 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m05:19:39.511271 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m05:19:39.511687 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m05:19:39.511965 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:19:39.514717 [debug] [ThreadPool]: SQL status: SELECT 36 in 0.003 seconds
[0m05:19:39.515487 [debug] [ThreadPool]: On list_airflow: Close
[0m05:19:39.518131 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_fact)
[0m05:19:39.521307 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m05:19:39.521589 [debug] [ThreadPool]: On list_airflow_fact: BEGIN
[0m05:19:39.521842 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:19:39.523479 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m05:19:39.523857 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m05:19:39.524172 [debug] [ThreadPool]: On list_airflow_fact: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_fact"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'fact'
  
[0m05:19:39.525505 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m05:19:39.526182 [debug] [ThreadPool]: On list_airflow_fact: ROLLBACK
[0m05:19:39.526520 [debug] [ThreadPool]: On list_airflow_fact: Close
[0m05:19:39.526912 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_fact, now list_airflow_dim)
[0m05:19:39.528242 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m05:19:39.528500 [debug] [ThreadPool]: On list_airflow_dim: BEGIN
[0m05:19:39.528742 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:19:39.530116 [debug] [ThreadPool]: SQL status: BEGIN in 0.001 seconds
[0m05:19:39.530417 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m05:19:39.530682 [debug] [ThreadPool]: On list_airflow_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dim'
  
[0m05:19:39.531883 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.001 seconds
[0m05:19:39.532586 [debug] [ThreadPool]: On list_airflow_dim: ROLLBACK
[0m05:19:39.532917 [debug] [ThreadPool]: On list_airflow_dim: Close
[0m05:19:39.535382 [debug] [MainThread]: Using postgres connection "master"
[0m05:19:39.535650 [debug] [MainThread]: On master: BEGIN
[0m05:19:39.535889 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:19:39.537409 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m05:19:39.537731 [debug] [MainThread]: Using postgres connection "master"
[0m05:19:39.538039 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m05:19:39.540896 [debug] [MainThread]: SQL status: SELECT 2 in 0.003 seconds
[0m05:19:39.541547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fa292b08-da6b-4353-b7fb-69cede0a6159', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a930e80>]}
[0m05:19:39.541872 [debug] [MainThread]: On master: ROLLBACK
[0m05:19:39.542244 [debug] [MainThread]: Using postgres connection "master"
[0m05:19:39.542494 [debug] [MainThread]: On master: BEGIN
[0m05:19:39.542894 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m05:19:39.543206 [debug] [MainThread]: On master: COMMIT
[0m05:19:39.543455 [debug] [MainThread]: Using postgres connection "master"
[0m05:19:39.543688 [debug] [MainThread]: On master: COMMIT
[0m05:19:39.544019 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m05:19:39.544288 [debug] [MainThread]: On master: Close
[0m05:19:39.545426 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.fact_waterlevel
[0m05:19:39.545797 [info ] [Thread-1 (]: 1 of 1 START sql incremental model fact.fact_waterlevel ........................ [RUN]
[0m05:19:39.546206 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_dim, now model.etl_waterlevel.fact_waterlevel)
[0m05:19:39.546481 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.fact_waterlevel
[0m05:19:39.553380 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.fact_waterlevel"
[0m05:19:39.554304 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.fact_waterlevel
[0m05:19:39.582818 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m05:19:39.583184 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

    
  
    

  create temporary table "fact_waterlevel__dbt_tmp051939570579"
  
  
    as
  
  (
    

with main as (
    select
        distinct
        concat("stationId",'_',"stationCode") as station_key,
        "stationId" as station_id,
        "stationCode" as station_code,
        "waterLevel" as water_level,
        "waterlevelStatus" as waterlevel_status,
        case
            when "waterlevelStatus" = 3 then '🚨 Beyond Danger'
            when "waterlevelStatus" = 2 then '⚠️ Between Warning and Danger'
            when "waterlevelStatus" = 1 then '🔶 Between Alert and Warning'
            when "waterlevelStatus" = 0 then '✅ Between Normal and Alert'
            when "waterlevelStatus" = -1 then '🟢 Below Normal (Safe)'
            else '❓ Unknown Status'
        end as waterlevel_condition,
        "stationName",
        "districtName",
        to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp AS last_update
    from
        raw.waterlevels w
    where
        "stationStatus" = 1

        
        /* This condition is important to avoid reprocessing old data */
        and to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp > (
            select max(last_update) from "airflow"."fact"."fact_waterlevel"
        )
        
)

select * from main
  );
  
  
[0m05:19:39.583519 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:19:39.599096 [debug] [Thread-1 (]: SQL status: SELECT 73 in 0.016 seconds
[0m05:19:39.606262 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m05:19:39.606579 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: BEGIN
[0m05:19:39.606990 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m05:19:39.607327 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m05:19:39.607620 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp051939570579'
        
      order by ordinal_position

  
[0m05:19:39.610321 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.002 seconds
[0m05:19:39.612952 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m05:19:39.613260 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m05:19:39.614604 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m05:19:39.621255 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m05:19:39.621642 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp051939570579'
        
      order by ordinal_position

  
[0m05:19:39.622870 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m05:19:39.624576 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m05:19:39.624872 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m05:19:39.626132 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m05:19:39.630751 [debug] [Thread-1 (]: 
    In "airflow"."fact"."fact_waterlevel":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m05:19:39.634198 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.fact_waterlevel"
[0m05:19:39.635097 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m05:19:39.635413 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      insert into "airflow"."fact"."fact_waterlevel" ("station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update")
    (
        select "station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update"
        from "fact_waterlevel__dbt_tmp051939570579"
    )


  
[0m05:19:39.635970 [debug] [Thread-1 (]: SQL status: INSERT 0 73 in 0.000 seconds
[0m05:19:39.643472 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m05:19:39.643788 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m05:19:39.644062 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m05:19:39.645933 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m05:19:39.647289 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: Close
[0m05:19:39.648448 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa292b08-da6b-4353-b7fb-69cede0a6159', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a92cc40>]}
[0m05:19:39.648911 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model fact.fact_waterlevel ................... [[32mINSERT 0 73[0m in 0.10s]
[0m05:19:39.649290 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.fact_waterlevel
[0m05:19:39.649979 [debug] [MainThread]: Using postgres connection "master"
[0m05:19:39.650217 [debug] [MainThread]: On master: BEGIN
[0m05:19:39.650438 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:19:39.651907 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m05:19:39.652188 [debug] [MainThread]: On master: COMMIT
[0m05:19:39.652416 [debug] [MainThread]: Using postgres connection "master"
[0m05:19:39.652639 [debug] [MainThread]: On master: COMMIT
[0m05:19:39.652948 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m05:19:39.653160 [debug] [MainThread]: On master: Close
[0m05:19:39.653431 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:19:39.653650 [debug] [MainThread]: Connection 'model.etl_waterlevel.fact_waterlevel' was properly closed.
[0m05:19:39.653866 [info ] [MainThread]: 
[0m05:19:39.654095 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.18 seconds (0.18s).
[0m05:19:39.654465 [debug] [MainThread]: Command end result
[0m05:19:39.668737 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m05:19:39.669841 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m05:19:39.673264 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m05:19:39.673537 [info ] [MainThread]: 
[0m05:19:39.673812 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:19:39.674024 [info ] [MainThread]: 
[0m05:19:39.674241 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m05:19:39.674806 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.4952473, "process_in_blocks": "0", "process_kernel_time": 0.070651, "process_mem_max_rss": "111360", "process_out_blocks": "1701", "process_user_time": 1.205062}
[0m05:19:39.675202 [debug] [MainThread]: Command `dbt run` succeeded at 05:19:39.675136 after 0.50 seconds
[0m05:19:39.675479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8878c2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff887a7550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff878485e0>]}
[0m05:19:39.675730 [debug] [MainThread]: Flushing usage events
[0m05:19:41.070236 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:05:04.634432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffadc84310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffacd6fd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffacd6fcd0>]}


============================== 06:05:04.637428 | f1dc5981-1a56-47ac-8a0c-e56ccaadfebd ==============================
[0m06:05:04.637428 [info ] [MainThread]: Running with dbt=1.9.0
[0m06:05:04.637817 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models fact_waterlevel', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:05:04.725867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f1dc5981-1a56-47ac-8a0c-e56ccaadfebd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac4da290>]}
[0m06:05:04.752451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f1dc5981-1a56-47ac-8a0c-e56ccaadfebd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffadbd41c0>]}
[0m06:05:04.752914 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m06:05:04.787057 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m06:05:04.836913 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:05:04.837235 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:05:04.840368 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m06:05:04.852108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f1dc5981-1a56-47ac-8a0c-e56ccaadfebd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac064550>]}
[0m06:05:04.887897 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m06:05:04.891649 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m06:05:04.900826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f1dc5981-1a56-47ac-8a0c-e56ccaadfebd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac083220>]}
[0m06:05:04.901140 [info ] [MainThread]: Found 3 models, 434 macros
[0m06:05:04.901372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f1dc5981-1a56-47ac-8a0c-e56ccaadfebd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac0831c0>]}
[0m06:05:04.902077 [info ] [MainThread]: 
[0m06:05:04.902382 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:05:04.902726 [info ] [MainThread]: 
[0m06:05:04.903132 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:05:04.903755 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m06:05:04.942401 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m06:05:04.942813 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m06:05:04.943085 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:05:04.945914 [debug] [ThreadPool]: SQL status: SELECT 36 in 0.003 seconds
[0m06:05:04.946689 [debug] [ThreadPool]: On list_airflow: Close
[0m06:05:04.949300 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_fact)
[0m06:05:04.952470 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m06:05:04.952756 [debug] [ThreadPool]: On list_airflow_fact: BEGIN
[0m06:05:04.953010 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:05:04.954581 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m06:05:04.954936 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m06:05:04.955201 [debug] [ThreadPool]: On list_airflow_fact: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_fact"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'fact'
  
[0m06:05:04.956618 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m06:05:04.957264 [debug] [ThreadPool]: On list_airflow_fact: ROLLBACK
[0m06:05:04.957635 [debug] [ThreadPool]: On list_airflow_fact: Close
[0m06:05:04.958039 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_fact, now list_airflow_dim)
[0m06:05:04.959371 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m06:05:04.959663 [debug] [ThreadPool]: On list_airflow_dim: BEGIN
[0m06:05:04.959900 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:05:04.961327 [debug] [ThreadPool]: SQL status: BEGIN in 0.001 seconds
[0m06:05:04.961649 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m06:05:04.961905 [debug] [ThreadPool]: On list_airflow_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dim'
  
[0m06:05:04.963100 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.001 seconds
[0m06:05:04.963762 [debug] [ThreadPool]: On list_airflow_dim: ROLLBACK
[0m06:05:04.964077 [debug] [ThreadPool]: On list_airflow_dim: Close
[0m06:05:04.966532 [debug] [MainThread]: Using postgres connection "master"
[0m06:05:04.966798 [debug] [MainThread]: On master: BEGIN
[0m06:05:04.967038 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:05:04.968524 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m06:05:04.968819 [debug] [MainThread]: Using postgres connection "master"
[0m06:05:04.969115 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:05:04.972048 [debug] [MainThread]: SQL status: SELECT 2 in 0.003 seconds
[0m06:05:04.972730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f1dc5981-1a56-47ac-8a0c-e56ccaadfebd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf6c1f00>]}
[0m06:05:04.973058 [debug] [MainThread]: On master: ROLLBACK
[0m06:05:04.973412 [debug] [MainThread]: Using postgres connection "master"
[0m06:05:04.973661 [debug] [MainThread]: On master: BEGIN
[0m06:05:04.974070 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m06:05:04.974366 [debug] [MainThread]: On master: COMMIT
[0m06:05:04.974636 [debug] [MainThread]: Using postgres connection "master"
[0m06:05:04.974867 [debug] [MainThread]: On master: COMMIT
[0m06:05:04.975189 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:05:04.975447 [debug] [MainThread]: On master: Close
[0m06:05:04.976595 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.fact_waterlevel
[0m06:05:04.976971 [info ] [Thread-1 (]: 1 of 1 START sql incremental model fact.fact_waterlevel ........................ [RUN]
[0m06:05:04.977289 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_dim, now model.etl_waterlevel.fact_waterlevel)
[0m06:05:04.977583 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.fact_waterlevel
[0m06:05:04.984488 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.fact_waterlevel"
[0m06:05:04.985332 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.fact_waterlevel
[0m06:05:05.013430 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m06:05:05.013802 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

    
  
    

  create temporary table "fact_waterlevel__dbt_tmp060505001257"
  
  
    as
  
  (
    

with main as (
    select
        distinct
        concat("stationId",'_',"stationCode") as station_key,
        "stationId" as station_id,
        "stationCode" as station_code,
        "waterLevel" as water_level,
        "waterlevelStatus" as waterlevel_status,
        case
            when "waterlevelStatus" = 3 then '🚨 Beyond Danger'
            when "waterlevelStatus" = 2 then '⚠️ Between Warning and Danger'
            when "waterlevelStatus" = 1 then '🔶 Between Alert and Warning'
            when "waterlevelStatus" = 0 then '✅ Between Normal and Alert'
            when "waterlevelStatus" = -1 then '🟢 Below Normal (Safe)'
            else '❓ Unknown Status'
        end as waterlevel_condition,
        "stationName",
        "districtName",
        to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp AS last_update
    from
        raw.waterlevels w
    where
        "stationStatus" = 1

        
        /* This condition is important to avoid reprocessing old data */
        and to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp > (
            select max(last_update) from "airflow"."fact"."fact_waterlevel"
        )
        
)

select * from main
  );
  
  
[0m06:05:05.014132 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:05:05.029909 [debug] [Thread-1 (]: SQL status: SELECT 73 in 0.016 seconds
[0m06:05:05.037017 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m06:05:05.037327 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: BEGIN
[0m06:05:05.037773 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m06:05:05.038108 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m06:05:05.038401 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp060505001257'
        
      order by ordinal_position

  
[0m06:05:05.041204 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.002 seconds
[0m06:05:05.043769 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m06:05:05.044070 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m06:05:05.045443 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m06:05:05.051799 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m06:05:05.052123 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp060505001257'
        
      order by ordinal_position

  
[0m06:05:05.053350 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m06:05:05.055011 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m06:05:05.055311 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m06:05:05.056541 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m06:05:05.061041 [debug] [Thread-1 (]: 
    In "airflow"."fact"."fact_waterlevel":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m06:05:05.064457 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.fact_waterlevel"
[0m06:05:05.065292 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m06:05:05.065603 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      insert into "airflow"."fact"."fact_waterlevel" ("station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update")
    (
        select "station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update"
        from "fact_waterlevel__dbt_tmp060505001257"
    )


  
[0m06:05:05.066071 [debug] [Thread-1 (]: SQL status: INSERT 0 73 in 0.000 seconds
[0m06:05:05.073699 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m06:05:05.074005 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m06:05:05.074285 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m06:05:05.074780 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m06:05:05.075796 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: Close
[0m06:05:05.076875 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1dc5981-1a56-47ac-8a0c-e56ccaadfebd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffafe927a0>]}
[0m06:05:05.077436 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model fact.fact_waterlevel ................... [[32mINSERT 0 73[0m in 0.10s]
[0m06:05:05.077859 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.fact_waterlevel
[0m06:05:05.078604 [debug] [MainThread]: Using postgres connection "master"
[0m06:05:05.078853 [debug] [MainThread]: On master: BEGIN
[0m06:05:05.079052 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:05:05.080556 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m06:05:05.080814 [debug] [MainThread]: On master: COMMIT
[0m06:05:05.081021 [debug] [MainThread]: Using postgres connection "master"
[0m06:05:05.081216 [debug] [MainThread]: On master: COMMIT
[0m06:05:05.081458 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:05:05.081650 [debug] [MainThread]: On master: Close
[0m06:05:05.081931 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:05:05.082144 [debug] [MainThread]: Connection 'model.etl_waterlevel.fact_waterlevel' was properly closed.
[0m06:05:05.082358 [info ] [MainThread]: 
[0m06:05:05.082585 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.18 seconds (0.18s).
[0m06:05:05.082952 [debug] [MainThread]: Command end result
[0m06:05:05.097831 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m06:05:05.098975 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m06:05:05.102184 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m06:05:05.102415 [info ] [MainThread]: 
[0m06:05:05.102668 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:05:05.102872 [info ] [MainThread]: 
[0m06:05:05.103081 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m06:05:05.103605 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.4948315, "process_in_blocks": "0", "process_kernel_time": 0.073566, "process_mem_max_rss": "111284", "process_out_blocks": "1701", "process_user_time": 1.22577}
[0m06:05:05.103927 [debug] [MainThread]: Command `dbt run` succeeded at 06:05:05.103882 after 0.50 seconds
[0m06:05:05.104181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffadc84310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac4da290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffadcf36d0>]}
[0m06:05:05.104458 [debug] [MainThread]: Flushing usage events
[0m06:05:06.586093 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:05:48.843505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff971782e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96260520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96260580>]}


============================== 07:05:48.847831 | 876ba733-19ad-4051-992b-ff71ff763170 ==============================
[0m07:05:48.847831 [info ] [MainThread]: Running with dbt=1.9.0
[0m07:05:48.848206 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'debug': 'False', 'profiles_dir': '/home/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --models fact_waterlevel', 'send_anonymous_usage_stats': 'True'}
[0m07:05:48.933785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '876ba733-19ad-4051-992b-ff71ff763170', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff959229e0>]}
[0m07:05:48.960398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '876ba733-19ad-4051-992b-ff71ff763170', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96260040>]}
[0m07:05:48.960867 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m07:05:48.995277 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m07:05:49.045915 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:05:49.046271 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:05:49.049421 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m07:05:49.061030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '876ba733-19ad-4051-992b-ff71ff763170', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff954ac520>]}
[0m07:05:49.096560 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m07:05:49.100060 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m07:05:49.108977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '876ba733-19ad-4051-992b-ff71ff763170', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff954cb220>]}
[0m07:05:49.109284 [info ] [MainThread]: Found 3 models, 434 macros
[0m07:05:49.109519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '876ba733-19ad-4051-992b-ff71ff763170', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff954cb1c0>]}
[0m07:05:49.110206 [info ] [MainThread]: 
[0m07:05:49.110452 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:05:49.110649 [info ] [MainThread]: 
[0m07:05:49.110980 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:05:49.111691 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m07:05:49.149427 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m07:05:49.149848 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m07:05:49.150126 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:05:49.152995 [debug] [ThreadPool]: SQL status: SELECT 36 in 0.003 seconds
[0m07:05:49.153812 [debug] [ThreadPool]: On list_airflow: Close
[0m07:05:49.156458 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_dim)
[0m07:05:49.159662 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m07:05:49.159940 [debug] [ThreadPool]: On list_airflow_dim: BEGIN
[0m07:05:49.160190 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:05:49.161818 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m07:05:49.162194 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m07:05:49.162463 [debug] [ThreadPool]: On list_airflow_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dim'
  
[0m07:05:49.163814 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.001 seconds
[0m07:05:49.164495 [debug] [ThreadPool]: On list_airflow_dim: ROLLBACK
[0m07:05:49.164825 [debug] [ThreadPool]: On list_airflow_dim: Close
[0m07:05:49.165220 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_dim, now list_airflow_fact)
[0m07:05:49.166661 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m07:05:49.166926 [debug] [ThreadPool]: On list_airflow_fact: BEGIN
[0m07:05:49.167158 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:05:49.168628 [debug] [ThreadPool]: SQL status: BEGIN in 0.001 seconds
[0m07:05:49.168923 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m07:05:49.169177 [debug] [ThreadPool]: On list_airflow_fact: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_fact"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'fact'
  
[0m07:05:49.170386 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m07:05:49.171026 [debug] [ThreadPool]: On list_airflow_fact: ROLLBACK
[0m07:05:49.171369 [debug] [ThreadPool]: On list_airflow_fact: Close
[0m07:05:49.173739 [debug] [MainThread]: Using postgres connection "master"
[0m07:05:49.174004 [debug] [MainThread]: On master: BEGIN
[0m07:05:49.174236 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:05:49.175664 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m07:05:49.175956 [debug] [MainThread]: Using postgres connection "master"
[0m07:05:49.176251 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:05:49.179169 [debug] [MainThread]: SQL status: SELECT 2 in 0.003 seconds
[0m07:05:49.179826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '876ba733-19ad-4051-992b-ff71ff763170', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff954cac50>]}
[0m07:05:49.180144 [debug] [MainThread]: On master: ROLLBACK
[0m07:05:49.180486 [debug] [MainThread]: Using postgres connection "master"
[0m07:05:49.180733 [debug] [MainThread]: On master: BEGIN
[0m07:05:49.181118 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m07:05:49.181446 [debug] [MainThread]: On master: COMMIT
[0m07:05:49.181716 [debug] [MainThread]: Using postgres connection "master"
[0m07:05:49.181944 [debug] [MainThread]: On master: COMMIT
[0m07:05:49.182268 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:05:49.182529 [debug] [MainThread]: On master: Close
[0m07:05:49.183676 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.fact_waterlevel
[0m07:05:49.184030 [info ] [Thread-1 (]: 1 of 1 START sql incremental model fact.fact_waterlevel ........................ [RUN]
[0m07:05:49.184371 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_fact, now model.etl_waterlevel.fact_waterlevel)
[0m07:05:49.184649 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.fact_waterlevel
[0m07:05:49.191625 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.fact_waterlevel"
[0m07:05:49.193671 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.fact_waterlevel
[0m07:05:49.221597 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m07:05:49.221940 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

    
  
    

  create temporary table "fact_waterlevel__dbt_tmp070549209616"
  
  
    as
  
  (
    

with main as (
    select
        distinct
        concat("stationId",'_',"stationCode") as station_key,
        "stationId" as station_id,
        "stationCode" as station_code,
        "waterLevel" as water_level,
        "waterlevelStatus" as waterlevel_status,
        case
            when "waterlevelStatus" = 3 then '🚨 Beyond Danger'
            when "waterlevelStatus" = 2 then '⚠️ Between Warning and Danger'
            when "waterlevelStatus" = 1 then '🔶 Between Alert and Warning'
            when "waterlevelStatus" = 0 then '✅ Between Normal and Alert'
            when "waterlevelStatus" = -1 then '🟢 Below Normal (Safe)'
            else '❓ Unknown Status'
        end as waterlevel_condition,
        "stationName",
        "districtName",
        to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp AS last_update
    from
        raw.waterlevels w
    where
        "stationStatus" = 1

        
        /* This condition is important to avoid reprocessing old data */
        and to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp > (
            select max(last_update) from "airflow"."fact"."fact_waterlevel"
        )
        
)

select * from main
  );
  
  
[0m07:05:49.222310 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:05:49.238118 [debug] [Thread-1 (]: SQL status: SELECT 73 in 0.016 seconds
[0m07:05:49.245128 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m07:05:49.245418 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: BEGIN
[0m07:05:49.245801 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m07:05:49.246123 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m07:05:49.246426 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp070549209616'
        
      order by ordinal_position

  
[0m07:05:49.249144 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.002 seconds
[0m07:05:49.251765 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m07:05:49.252078 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m07:05:49.253398 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m07:05:49.259788 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m07:05:49.260097 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp070549209616'
        
      order by ordinal_position

  
[0m07:05:49.261314 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m07:05:49.263006 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m07:05:49.263300 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m07:05:49.264476 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m07:05:49.268981 [debug] [Thread-1 (]: 
    In "airflow"."fact"."fact_waterlevel":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m07:05:49.272439 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.fact_waterlevel"
[0m07:05:49.273345 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m07:05:49.273669 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      insert into "airflow"."fact"."fact_waterlevel" ("station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update")
    (
        select "station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update"
        from "fact_waterlevel__dbt_tmp070549209616"
    )


  
[0m07:05:49.274180 [debug] [Thread-1 (]: SQL status: INSERT 0 73 in 0.000 seconds
[0m07:05:49.281681 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m07:05:49.281985 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m07:05:49.282260 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m07:05:49.282977 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m07:05:49.283975 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: Close
[0m07:05:49.285079 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '876ba733-19ad-4051-992b-ff71ff763170', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9936e770>]}
[0m07:05:49.285574 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model fact.fact_waterlevel ................... [[32mINSERT 0 73[0m in 0.10s]
[0m07:05:49.286023 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.fact_waterlevel
[0m07:05:49.286924 [debug] [MainThread]: Using postgres connection "master"
[0m07:05:49.287167 [debug] [MainThread]: On master: BEGIN
[0m07:05:49.287411 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:05:49.288872 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m07:05:49.289161 [debug] [MainThread]: On master: COMMIT
[0m07:05:49.289386 [debug] [MainThread]: Using postgres connection "master"
[0m07:05:49.289581 [debug] [MainThread]: On master: COMMIT
[0m07:05:49.289825 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:05:49.290020 [debug] [MainThread]: On master: Close
[0m07:05:49.290279 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:05:49.290493 [debug] [MainThread]: Connection 'model.etl_waterlevel.fact_waterlevel' was properly closed.
[0m07:05:49.290705 [info ] [MainThread]: 
[0m07:05:49.290921 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.18 seconds (0.18s).
[0m07:05:49.291283 [debug] [MainThread]: Command end result
[0m07:05:49.306530 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m07:05:49.307615 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m07:05:49.311257 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m07:05:49.311483 [info ] [MainThread]: 
[0m07:05:49.311743 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:05:49.311955 [info ] [MainThread]: 
[0m07:05:49.312167 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m07:05:49.312695 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.49525622, "process_in_blocks": "0", "process_kernel_time": 0.067702, "process_mem_max_rss": "111388", "process_out_blocks": "1701", "process_user_time": 1.20271}
[0m07:05:49.313028 [debug] [MainThread]: Command `dbt run` succeeded at 07:05:49.312980 after 0.50 seconds
[0m07:05:49.313274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff971782e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97193550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95478820>]}
[0m07:05:49.313575 [debug] [MainThread]: Flushing usage events
[0m07:05:50.773902 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:06:48.210473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89a84220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88b60520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88b60580>]}


============================== 08:06:48.214323 | fdd9f760-6b93-484a-8cb0-69b58ac64194 ==============================
[0m08:06:48.214323 [info ] [MainThread]: Running with dbt=1.9.0
[0m08:06:48.214699 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --models fact_waterlevel', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m08:06:48.300123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fdd9f760-6b93-484a-8cb0-69b58ac64194', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff899405e0>]}
[0m08:06:48.326760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fdd9f760-6b93-484a-8cb0-69b58ac64194', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89aeea40>]}
[0m08:06:48.327277 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m08:06:48.361216 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m08:06:48.409894 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:06:48.410202 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:06:48.413392 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m08:06:48.425035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fdd9f760-6b93-484a-8cb0-69b58ac64194', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87e28460>]}
[0m08:06:48.460175 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m08:06:48.463572 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m08:06:48.472390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fdd9f760-6b93-484a-8cb0-69b58ac64194', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87e47220>]}
[0m08:06:48.472708 [info ] [MainThread]: Found 3 models, 434 macros
[0m08:06:48.472955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fdd9f760-6b93-484a-8cb0-69b58ac64194', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87e471c0>]}
[0m08:06:48.473635 [info ] [MainThread]: 
[0m08:06:48.473937 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:06:48.474174 [info ] [MainThread]: 
[0m08:06:48.474486 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:06:48.475062 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m08:06:48.513306 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m08:06:48.513733 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m08:06:48.514039 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:06:48.516871 [debug] [ThreadPool]: SQL status: SELECT 36 in 0.003 seconds
[0m08:06:48.517662 [debug] [ThreadPool]: On list_airflow: Close
[0m08:06:48.520369 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_dim)
[0m08:06:48.523568 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m08:06:48.523877 [debug] [ThreadPool]: On list_airflow_dim: BEGIN
[0m08:06:48.524130 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:06:48.525779 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m08:06:48.526135 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m08:06:48.526396 [debug] [ThreadPool]: On list_airflow_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dim'
  
[0m08:06:48.527795 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.001 seconds
[0m08:06:48.528464 [debug] [ThreadPool]: On list_airflow_dim: ROLLBACK
[0m08:06:48.528790 [debug] [ThreadPool]: On list_airflow_dim: Close
[0m08:06:48.529187 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_dim, now list_airflow_fact)
[0m08:06:48.530568 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m08:06:48.530829 [debug] [ThreadPool]: On list_airflow_fact: BEGIN
[0m08:06:48.531088 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:06:48.532504 [debug] [ThreadPool]: SQL status: BEGIN in 0.001 seconds
[0m08:06:48.532801 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m08:06:48.533087 [debug] [ThreadPool]: On list_airflow_fact: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_fact"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'fact'
  
[0m08:06:48.534335 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m08:06:48.534987 [debug] [ThreadPool]: On list_airflow_fact: ROLLBACK
[0m08:06:48.535315 [debug] [ThreadPool]: On list_airflow_fact: Close
[0m08:06:48.537710 [debug] [MainThread]: Using postgres connection "master"
[0m08:06:48.538000 [debug] [MainThread]: On master: BEGIN
[0m08:06:48.538251 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:06:48.539692 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m08:06:48.540014 [debug] [MainThread]: Using postgres connection "master"
[0m08:06:48.540314 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:06:48.543122 [debug] [MainThread]: SQL status: SELECT 2 in 0.003 seconds
[0m08:06:48.543765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fdd9f760-6b93-484a-8cb0-69b58ac64194', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87e47820>]}
[0m08:06:48.544114 [debug] [MainThread]: On master: ROLLBACK
[0m08:06:48.544463 [debug] [MainThread]: Using postgres connection "master"
[0m08:06:48.544721 [debug] [MainThread]: On master: BEGIN
[0m08:06:48.545123 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m08:06:48.545436 [debug] [MainThread]: On master: COMMIT
[0m08:06:48.545682 [debug] [MainThread]: Using postgres connection "master"
[0m08:06:48.545941 [debug] [MainThread]: On master: COMMIT
[0m08:06:48.546266 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:06:48.546512 [debug] [MainThread]: On master: Close
[0m08:06:48.547665 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.fact_waterlevel
[0m08:06:48.548042 [info ] [Thread-1 (]: 1 of 1 START sql incremental model fact.fact_waterlevel ........................ [RUN]
[0m08:06:48.548379 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_fact, now model.etl_waterlevel.fact_waterlevel)
[0m08:06:48.548668 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.fact_waterlevel
[0m08:06:48.555559 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.fact_waterlevel"
[0m08:06:48.557631 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.fact_waterlevel
[0m08:06:48.585568 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m08:06:48.585948 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

    
  
    

  create temporary table "fact_waterlevel__dbt_tmp080648573591"
  
  
    as
  
  (
    

with main as (
    select
        distinct
        concat("stationId",'_',"stationCode") as station_key,
        "stationId" as station_id,
        "stationCode" as station_code,
        "waterLevel" as water_level,
        "waterlevelStatus" as waterlevel_status,
        case
            when "waterlevelStatus" = 3 then '🚨 Beyond Danger'
            when "waterlevelStatus" = 2 then '⚠️ Between Warning and Danger'
            when "waterlevelStatus" = 1 then '🔶 Between Alert and Warning'
            when "waterlevelStatus" = 0 then '✅ Between Normal and Alert'
            when "waterlevelStatus" = -1 then '🟢 Below Normal (Safe)'
            else '❓ Unknown Status'
        end as waterlevel_condition,
        "stationName",
        "districtName",
        to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp AS last_update
    from
        raw.waterlevels w
    where
        "stationStatus" = 1

        
        /* This condition is important to avoid reprocessing old data */
        and to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp > (
            select max(last_update) from "airflow"."fact"."fact_waterlevel"
        )
        
)

select * from main
  );
  
  
[0m08:06:48.586273 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:06:48.601919 [debug] [Thread-1 (]: SQL status: SELECT 73 in 0.016 seconds
[0m08:06:48.609035 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m08:06:48.609351 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: BEGIN
[0m08:06:48.609747 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m08:06:48.610147 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m08:06:48.610438 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp080648573591'
        
      order by ordinal_position

  
[0m08:06:48.613097 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.002 seconds
[0m08:06:48.615675 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m08:06:48.616003 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m08:06:48.617332 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m08:06:48.623725 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m08:06:48.624057 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp080648573591'
        
      order by ordinal_position

  
[0m08:06:48.625314 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m08:06:48.626965 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m08:06:48.627260 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m08:06:48.628430 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m08:06:48.632930 [debug] [Thread-1 (]: 
    In "airflow"."fact"."fact_waterlevel":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m08:06:48.636408 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.fact_waterlevel"
[0m08:06:48.638005 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m08:06:48.638300 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      insert into "airflow"."fact"."fact_waterlevel" ("station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update")
    (
        select "station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update"
        from "fact_waterlevel__dbt_tmp080648573591"
    )


  
[0m08:06:48.638876 [debug] [Thread-1 (]: SQL status: INSERT 0 73 in 0.000 seconds
[0m08:06:48.646308 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m08:06:48.646616 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m08:06:48.646906 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m08:06:48.648342 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m08:06:48.649374 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: Close
[0m08:06:48.650431 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fdd9f760-6b93-484a-8cb0-69b58ac64194', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bad76d0>]}
[0m08:06:48.651001 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model fact.fact_waterlevel ................... [[32mINSERT 0 73[0m in 0.10s]
[0m08:06:48.651453 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.fact_waterlevel
[0m08:06:48.652232 [debug] [MainThread]: Using postgres connection "master"
[0m08:06:48.652477 [debug] [MainThread]: On master: BEGIN
[0m08:06:48.652688 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:06:48.654134 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m08:06:48.654454 [debug] [MainThread]: On master: COMMIT
[0m08:06:48.654693 [debug] [MainThread]: Using postgres connection "master"
[0m08:06:48.654937 [debug] [MainThread]: On master: COMMIT
[0m08:06:48.655198 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:06:48.655408 [debug] [MainThread]: On master: Close
[0m08:06:48.655675 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:06:48.655895 [debug] [MainThread]: Connection 'model.etl_waterlevel.fact_waterlevel' was properly closed.
[0m08:06:48.656118 [info ] [MainThread]: 
[0m08:06:48.656365 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.18 seconds (0.18s).
[0m08:06:48.656732 [debug] [MainThread]: Command end result
[0m08:06:48.672094 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m08:06:48.673418 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m08:06:48.677271 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m08:06:48.677509 [info ] [MainThread]: 
[0m08:06:48.677766 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:06:48.677983 [info ] [MainThread]: 
[0m08:06:48.678205 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m08:06:48.678721 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.49422753, "process_in_blocks": "0", "process_kernel_time": 0.047187, "process_mem_max_rss": "111216", "process_out_blocks": "1701", "process_user_time": 1.214835}
[0m08:06:48.679053 [debug] [MainThread]: Command `dbt run` succeeded at 08:06:48.679009 after 0.49 seconds
[0m08:06:48.679302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89a84220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88b64580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87df4a00>]}
[0m08:06:48.679556 [debug] [MainThread]: Flushing usage events
[0m08:06:50.078580 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:07:42.314187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b8883a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a977d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a977d30>]}


============================== 09:07:42.318320 | b111667a-3d4a-4bac-b603-515e6c2ae626 ==============================
[0m09:07:42.318320 [info ] [MainThread]: Running with dbt=1.9.0
[0m09:07:42.318707 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'debug': 'False', 'profiles_dir': '/home/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --models fact_waterlevel', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:07:42.408271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b111667a-3d4a-4bac-b603-515e6c2ae626', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9da05900>]}
[0m09:07:42.435095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b111667a-3d4a-4bac-b603-515e6c2ae626', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b7487f0>]}
[0m09:07:42.435580 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:07:42.470126 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m09:07:42.520790 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:07:42.521124 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:07:42.524203 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m09:07:42.536037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b111667a-3d4a-4bac-b603-515e6c2ae626', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99bf85e0>]}
[0m09:07:42.571154 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m09:07:42.574357 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m09:07:42.583880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b111667a-3d4a-4bac-b603-515e6c2ae626', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99c17220>]}
[0m09:07:42.584200 [info ] [MainThread]: Found 3 models, 434 macros
[0m09:07:42.584437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b111667a-3d4a-4bac-b603-515e6c2ae626', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99c171c0>]}
[0m09:07:42.585102 [info ] [MainThread]: 
[0m09:07:42.585362 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:07:42.585568 [info ] [MainThread]: 
[0m09:07:42.585858 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:07:42.586458 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m09:07:42.625603 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m09:07:42.626031 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m09:07:42.626306 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:07:42.629202 [debug] [ThreadPool]: SQL status: SELECT 36 in 0.003 seconds
[0m09:07:42.630025 [debug] [ThreadPool]: On list_airflow: Close
[0m09:07:42.632617 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_fact)
[0m09:07:42.635818 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m09:07:42.636106 [debug] [ThreadPool]: On list_airflow_fact: BEGIN
[0m09:07:42.636345 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:07:42.637980 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m09:07:42.638324 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m09:07:42.638592 [debug] [ThreadPool]: On list_airflow_fact: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_fact"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'fact'
  
[0m09:07:42.639986 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m09:07:42.640627 [debug] [ThreadPool]: On list_airflow_fact: ROLLBACK
[0m09:07:42.640956 [debug] [ThreadPool]: On list_airflow_fact: Close
[0m09:07:42.641347 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_fact, now list_airflow_dim)
[0m09:07:42.642679 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m09:07:42.642959 [debug] [ThreadPool]: On list_airflow_dim: BEGIN
[0m09:07:42.643194 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:07:42.644702 [debug] [ThreadPool]: SQL status: BEGIN in 0.001 seconds
[0m09:07:42.645048 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m09:07:42.645294 [debug] [ThreadPool]: On list_airflow_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dim'
  
[0m09:07:42.646522 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.001 seconds
[0m09:07:42.647186 [debug] [ThreadPool]: On list_airflow_dim: ROLLBACK
[0m09:07:42.647504 [debug] [ThreadPool]: On list_airflow_dim: Close
[0m09:07:42.649979 [debug] [MainThread]: Using postgres connection "master"
[0m09:07:42.650235 [debug] [MainThread]: On master: BEGIN
[0m09:07:42.650476 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:07:42.651871 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m09:07:42.652184 [debug] [MainThread]: Using postgres connection "master"
[0m09:07:42.652474 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:07:42.655322 [debug] [MainThread]: SQL status: SELECT 2 in 0.003 seconds
[0m09:07:42.655982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b111667a-3d4a-4bac-b603-515e6c2ae626', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e459d80>]}
[0m09:07:42.656370 [debug] [MainThread]: On master: ROLLBACK
[0m09:07:42.656703 [debug] [MainThread]: Using postgres connection "master"
[0m09:07:42.656955 [debug] [MainThread]: On master: BEGIN
[0m09:07:42.657344 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m09:07:42.657657 [debug] [MainThread]: On master: COMMIT
[0m09:07:42.657897 [debug] [MainThread]: Using postgres connection "master"
[0m09:07:42.658162 [debug] [MainThread]: On master: COMMIT
[0m09:07:42.658494 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:07:42.658739 [debug] [MainThread]: On master: Close
[0m09:07:42.659876 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.fact_waterlevel
[0m09:07:42.660283 [info ] [Thread-1 (]: 1 of 1 START sql incremental model fact.fact_waterlevel ........................ [RUN]
[0m09:07:42.660608 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_dim, now model.etl_waterlevel.fact_waterlevel)
[0m09:07:42.660873 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.fact_waterlevel
[0m09:07:42.667807 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.fact_waterlevel"
[0m09:07:42.669684 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.fact_waterlevel
[0m09:07:42.697874 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m09:07:42.698241 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

    
  
    

  create temporary table "fact_waterlevel__dbt_tmp090742685735"
  
  
    as
  
  (
    

with main as (
    select
        distinct
        concat("stationId",'_',"stationCode") as station_key,
        "stationId" as station_id,
        "stationCode" as station_code,
        "waterLevel" as water_level,
        "waterlevelStatus" as waterlevel_status,
        case
            when "waterlevelStatus" = 3 then '🚨 Beyond Danger'
            when "waterlevelStatus" = 2 then '⚠️ Between Warning and Danger'
            when "waterlevelStatus" = 1 then '🔶 Between Alert and Warning'
            when "waterlevelStatus" = 0 then '✅ Between Normal and Alert'
            when "waterlevelStatus" = -1 then '🟢 Below Normal (Safe)'
            else '❓ Unknown Status'
        end as waterlevel_condition,
        "stationName",
        "districtName",
        to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp AS last_update
    from
        raw.waterlevels w
    where
        "stationStatus" = 1

        
        /* This condition is important to avoid reprocessing old data */
        and to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp > (
            select max(last_update) from "airflow"."fact"."fact_waterlevel"
        )
        
)

select * from main
  );
  
  
[0m09:07:42.698572 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:07:42.714324 [debug] [Thread-1 (]: SQL status: SELECT 73 in 0.016 seconds
[0m09:07:42.721477 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m09:07:42.721782 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: BEGIN
[0m09:07:42.722197 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m09:07:42.722544 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m09:07:42.722826 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp090742685735'
        
      order by ordinal_position

  
[0m09:07:42.725657 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.002 seconds
[0m09:07:42.728321 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m09:07:42.728632 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m09:07:42.729982 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m09:07:42.736440 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m09:07:42.736753 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp090742685735'
        
      order by ordinal_position

  
[0m09:07:42.737900 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m09:07:42.739707 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m09:07:42.740593 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m09:07:42.742327 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m09:07:42.749015 [debug] [Thread-1 (]: 
    In "airflow"."fact"."fact_waterlevel":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m09:07:42.753507 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.fact_waterlevel"
[0m09:07:42.755573 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m09:07:42.756530 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      insert into "airflow"."fact"."fact_waterlevel" ("station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update")
    (
        select "station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update"
        from "fact_waterlevel__dbt_tmp090742685735"
    )


  
[0m09:07:42.757537 [debug] [Thread-1 (]: SQL status: INSERT 0 73 in 0.000 seconds
[0m09:07:42.767361 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m09:07:42.767899 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m09:07:42.768415 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m09:07:42.769856 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m09:07:42.771181 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: Close
[0m09:07:42.772413 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b111667a-3d4a-4bac-b603-515e6c2ae626', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d995b10>]}
[0m09:07:42.772983 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model fact.fact_waterlevel ................... [[32mINSERT 0 73[0m in 0.11s]
[0m09:07:42.773402 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.fact_waterlevel
[0m09:07:42.774252 [debug] [MainThread]: Using postgres connection "master"
[0m09:07:42.774534 [debug] [MainThread]: On master: BEGIN
[0m09:07:42.774766 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:07:42.776685 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m09:07:42.777095 [debug] [MainThread]: On master: COMMIT
[0m09:07:42.777338 [debug] [MainThread]: Using postgres connection "master"
[0m09:07:42.777538 [debug] [MainThread]: On master: COMMIT
[0m09:07:42.777782 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:07:42.777984 [debug] [MainThread]: On master: Close
[0m09:07:42.778259 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:07:42.778510 [debug] [MainThread]: Connection 'model.etl_waterlevel.fact_waterlevel' was properly closed.
[0m09:07:42.778752 [info ] [MainThread]: 
[0m09:07:42.779019 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.19 seconds (0.19s).
[0m09:07:42.779437 [debug] [MainThread]: Command end result
[0m09:07:42.795312 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m09:07:42.796578 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m09:07:42.800248 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m09:07:42.800477 [info ] [MainThread]: 
[0m09:07:42.800733 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:07:42.800940 [info ] [MainThread]: 
[0m09:07:42.801149 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m09:07:42.801699 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.5137666, "process_in_blocks": "0", "process_kernel_time": 0.089199, "process_mem_max_rss": "111236", "process_out_blocks": "1701", "process_user_time": 1.218725}
[0m09:07:42.802051 [debug] [MainThread]: Command `dbt run` succeeded at 09:07:42.802003 after 0.51 seconds
[0m09:07:42.802311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b8883a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9da05900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b231480>]}
[0m09:07:42.802565 [debug] [MainThread]: Flushing usage events
[0m09:07:44.420356 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:08:51.450475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a194340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89283d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89283d30>]}


============================== 10:08:51.454331 | 2b68dbed-3010-4cbf-84ef-1696d4b658be ==============================
[0m10:08:51.454331 [info ] [MainThread]: Running with dbt=1.9.0
[0m10:08:51.454889 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/logs', 'profiles_dir': '/home/airflow/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --models fact_waterlevel', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:08:51.538780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2b68dbed-3010-4cbf-84ef-1696d4b658be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c3c27a0>]}
[0m10:08:51.565955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2b68dbed-3010-4cbf-84ef-1696d4b658be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a0567a0>]}
[0m10:08:51.566613 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:08:51.601486 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m10:08:51.650643 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:08:51.650977 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:08:51.654223 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m10:08:51.667066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2b68dbed-3010-4cbf-84ef-1696d4b658be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8851c580>]}
[0m10:08:51.702607 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m10:08:51.706197 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m10:08:51.715031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2b68dbed-3010-4cbf-84ef-1696d4b658be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8853b220>]}
[0m10:08:51.715370 [info ] [MainThread]: Found 3 models, 434 macros
[0m10:08:51.715650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2b68dbed-3010-4cbf-84ef-1696d4b658be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8853b1c0>]}
[0m10:08:51.716344 [info ] [MainThread]: 
[0m10:08:51.716628 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:08:51.716886 [info ] [MainThread]: 
[0m10:08:51.717223 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:08:51.717811 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m10:08:51.755881 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m10:08:51.756300 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m10:08:51.756574 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:08:51.759362 [debug] [ThreadPool]: SQL status: SELECT 36 in 0.003 seconds
[0m10:08:51.760120 [debug] [ThreadPool]: On list_airflow: Close
[0m10:08:51.762755 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_fact)
[0m10:08:51.765915 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m10:08:51.766211 [debug] [ThreadPool]: On list_airflow_fact: BEGIN
[0m10:08:51.766460 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:08:51.768053 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m10:08:51.768423 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m10:08:51.768706 [debug] [ThreadPool]: On list_airflow_fact: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_fact"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'fact'
  
[0m10:08:51.770117 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m10:08:51.770771 [debug] [ThreadPool]: On list_airflow_fact: ROLLBACK
[0m10:08:51.771102 [debug] [ThreadPool]: On list_airflow_fact: Close
[0m10:08:51.771479 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_fact, now list_airflow_dim)
[0m10:08:51.772785 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m10:08:51.773060 [debug] [ThreadPool]: On list_airflow_dim: BEGIN
[0m10:08:51.773307 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:08:51.774817 [debug] [ThreadPool]: SQL status: BEGIN in 0.001 seconds
[0m10:08:51.775165 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m10:08:51.775435 [debug] [ThreadPool]: On list_airflow_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dim'
  
[0m10:08:51.776612 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.001 seconds
[0m10:08:51.777273 [debug] [ThreadPool]: On list_airflow_dim: ROLLBACK
[0m10:08:51.777597 [debug] [ThreadPool]: On list_airflow_dim: Close
[0m10:08:51.780068 [debug] [MainThread]: Using postgres connection "master"
[0m10:08:51.780339 [debug] [MainThread]: On master: BEGIN
[0m10:08:51.780577 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:08:51.782067 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m10:08:51.782375 [debug] [MainThread]: Using postgres connection "master"
[0m10:08:51.782670 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:08:51.785585 [debug] [MainThread]: SQL status: SELECT 2 in 0.003 seconds
[0m10:08:51.786240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2b68dbed-3010-4cbf-84ef-1696d4b658be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c356350>]}
[0m10:08:51.786564 [debug] [MainThread]: On master: ROLLBACK
[0m10:08:51.786909 [debug] [MainThread]: Using postgres connection "master"
[0m10:08:51.787164 [debug] [MainThread]: On master: BEGIN
[0m10:08:51.787570 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:08:51.787879 [debug] [MainThread]: On master: COMMIT
[0m10:08:51.788160 [debug] [MainThread]: Using postgres connection "master"
[0m10:08:51.788399 [debug] [MainThread]: On master: COMMIT
[0m10:08:51.788719 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:08:51.788999 [debug] [MainThread]: On master: Close
[0m10:08:51.790127 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.fact_waterlevel
[0m10:08:51.790479 [info ] [Thread-1 (]: 1 of 1 START sql incremental model fact.fact_waterlevel ........................ [RUN]
[0m10:08:51.790800 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_dim, now model.etl_waterlevel.fact_waterlevel)
[0m10:08:51.791080 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.fact_waterlevel
[0m10:08:51.798011 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.fact_waterlevel"
[0m10:08:51.799775 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.fact_waterlevel
[0m10:08:51.830397 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m10:08:51.831067 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

    
  
    

  create temporary table "fact_waterlevel__dbt_tmp100851815363"
  
  
    as
  
  (
    

with main as (
    select
        distinct
        concat("stationId",'_',"stationCode") as station_key,
        "stationId" as station_id,
        "stationCode" as station_code,
        "waterLevel" as water_level,
        "waterlevelStatus" as waterlevel_status,
        case
            when "waterlevelStatus" = 3 then '🚨 Beyond Danger'
            when "waterlevelStatus" = 2 then '⚠️ Between Warning and Danger'
            when "waterlevelStatus" = 1 then '🔶 Between Alert and Warning'
            when "waterlevelStatus" = 0 then '✅ Between Normal and Alert'
            when "waterlevelStatus" = -1 then '🟢 Below Normal (Safe)'
            else '❓ Unknown Status'
        end as waterlevel_condition,
        "stationName",
        "districtName",
        to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp AS last_update
    from
        raw.waterlevels w
    where
        "stationStatus" = 1

        
        /* This condition is important to avoid reprocessing old data */
        and to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp > (
            select max(last_update) from "airflow"."fact"."fact_waterlevel"
        )
        
)

select * from main
  );
  
  
[0m10:08:51.831521 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:08:51.848978 [debug] [Thread-1 (]: SQL status: SELECT 73 in 0.017 seconds
[0m10:08:51.857441 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m10:08:51.857810 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: BEGIN
[0m10:08:51.858265 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m10:08:51.858617 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m10:08:51.858964 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp100851815363'
        
      order by ordinal_position

  
[0m10:08:51.862006 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.003 seconds
[0m10:08:51.865037 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m10:08:51.865699 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m10:08:51.867666 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m10:08:51.874397 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m10:08:51.874775 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp100851815363'
        
      order by ordinal_position

  
[0m10:08:51.876085 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m10:08:51.877826 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m10:08:51.878143 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m10:08:51.879394 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m10:08:51.884018 [debug] [Thread-1 (]: 
    In "airflow"."fact"."fact_waterlevel":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m10:08:51.887463 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.fact_waterlevel"
[0m10:08:51.888323 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m10:08:51.888620 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      insert into "airflow"."fact"."fact_waterlevel" ("station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update")
    (
        select "station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update"
        from "fact_waterlevel__dbt_tmp100851815363"
    )


  
[0m10:08:51.889220 [debug] [Thread-1 (]: SQL status: INSERT 0 73 in 0.000 seconds
[0m10:08:51.897087 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m10:08:51.897423 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m10:08:51.897682 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m10:08:51.898285 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m10:08:51.899363 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: Close
[0m10:08:51.900563 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b68dbed-3010-4cbf-84ef-1696d4b658be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c3c27d0>]}
[0m10:08:51.901098 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model fact.fact_waterlevel ................... [[32mINSERT 0 73[0m in 0.11s]
[0m10:08:51.901542 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.fact_waterlevel
[0m10:08:51.902249 [debug] [MainThread]: Using postgres connection "master"
[0m10:08:51.902496 [debug] [MainThread]: On master: BEGIN
[0m10:08:51.902728 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:08:51.904400 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m10:08:51.904682 [debug] [MainThread]: On master: COMMIT
[0m10:08:51.904939 [debug] [MainThread]: Using postgres connection "master"
[0m10:08:51.905150 [debug] [MainThread]: On master: COMMIT
[0m10:08:51.905418 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:08:51.905623 [debug] [MainThread]: On master: Close
[0m10:08:51.905895 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:08:51.906117 [debug] [MainThread]: Connection 'model.etl_waterlevel.fact_waterlevel' was properly closed.
[0m10:08:51.906333 [info ] [MainThread]: 
[0m10:08:51.906573 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.19 seconds (0.19s).
[0m10:08:51.906989 [debug] [MainThread]: Command end result
[0m10:08:51.921587 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m10:08:51.922695 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m10:08:51.926437 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m10:08:51.926678 [info ] [MainThread]: 
[0m10:08:51.926950 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:08:51.927170 [info ] [MainThread]: 
[0m10:08:51.927397 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:08:51.927902 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.503589, "process_in_blocks": "0", "process_kernel_time": 0.064009, "process_mem_max_rss": "111324", "process_out_blocks": "1701", "process_user_time": 1.222177}
[0m10:08:51.928220 [debug] [MainThread]: Command `dbt run` succeeded at 10:08:51.928177 after 0.50 seconds
[0m10:08:51.928492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a194340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a218790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89253dc0>]}
[0m10:08:51.928761 [debug] [MainThread]: Flushing usage events
[0m10:08:53.346041 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:09:15.195489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb65982e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5680520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5680580>]}


============================== 11:09:15.198816 | 8fc2fef2-21fa-419d-8732-811454d671d0 ==============================
[0m11:09:15.198816 [info ] [MainThread]: Running with dbt=1.9.0
[0m11:09:15.199256 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models fact_waterlevel', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:09:15.297714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8fc2fef2-21fa-419d-8732-811454d671d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4b9e9e0>]}
[0m11:09:15.325045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8fc2fef2-21fa-419d-8732-811454d671d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5680040>]}
[0m11:09:15.325552 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m11:09:15.362371 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m11:09:15.412499 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:09:15.412821 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:09:15.416118 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m11:09:15.429893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8fc2fef2-21fa-419d-8732-811454d671d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb493c520>]}
[0m11:09:15.465703 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m11:09:15.469849 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m11:09:15.479261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8fc2fef2-21fa-419d-8732-811454d671d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb495b220>]}
[0m11:09:15.479585 [info ] [MainThread]: Found 3 models, 434 macros
[0m11:09:15.479831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8fc2fef2-21fa-419d-8732-811454d671d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb495b1c0>]}
[0m11:09:15.480524 [info ] [MainThread]: 
[0m11:09:15.480780 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:09:15.480980 [info ] [MainThread]: 
[0m11:09:15.481295 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:09:15.481922 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m11:09:15.527525 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m11:09:15.528025 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m11:09:15.528424 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:09:15.533523 [debug] [ThreadPool]: SQL status: SELECT 36 in 0.005 seconds
[0m11:09:15.534353 [debug] [ThreadPool]: On list_airflow: Close
[0m11:09:15.537085 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_fact)
[0m11:09:15.540376 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m11:09:15.540659 [debug] [ThreadPool]: On list_airflow_fact: BEGIN
[0m11:09:15.540916 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:09:15.542687 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m11:09:15.543104 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m11:09:15.543433 [debug] [ThreadPool]: On list_airflow_fact: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_fact"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'fact'
  
[0m11:09:15.544912 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m11:09:15.545566 [debug] [ThreadPool]: On list_airflow_fact: ROLLBACK
[0m11:09:15.545897 [debug] [ThreadPool]: On list_airflow_fact: Close
[0m11:09:15.546272 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_fact, now list_airflow_dim)
[0m11:09:15.547610 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m11:09:15.547883 [debug] [ThreadPool]: On list_airflow_dim: BEGIN
[0m11:09:15.548123 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:09:15.549784 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m11:09:15.550126 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m11:09:15.550394 [debug] [ThreadPool]: On list_airflow_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dim'
  
[0m11:09:15.551683 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.001 seconds
[0m11:09:15.552344 [debug] [ThreadPool]: On list_airflow_dim: ROLLBACK
[0m11:09:15.552687 [debug] [ThreadPool]: On list_airflow_dim: Close
[0m11:09:15.555235 [debug] [MainThread]: Using postgres connection "master"
[0m11:09:15.555499 [debug] [MainThread]: On master: BEGIN
[0m11:09:15.555741 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:09:15.557239 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m11:09:15.557587 [debug] [MainThread]: Using postgres connection "master"
[0m11:09:15.557900 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:09:15.561003 [debug] [MainThread]: SQL status: SELECT 2 in 0.003 seconds
[0m11:09:15.561675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8fc2fef2-21fa-419d-8732-811454d671d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb86e0ca0>]}
[0m11:09:15.562019 [debug] [MainThread]: On master: ROLLBACK
[0m11:09:15.562375 [debug] [MainThread]: Using postgres connection "master"
[0m11:09:15.562611 [debug] [MainThread]: On master: BEGIN
[0m11:09:15.563017 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m11:09:15.563322 [debug] [MainThread]: On master: COMMIT
[0m11:09:15.563559 [debug] [MainThread]: Using postgres connection "master"
[0m11:09:15.563798 [debug] [MainThread]: On master: COMMIT
[0m11:09:15.564138 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:09:15.564394 [debug] [MainThread]: On master: Close
[0m11:09:15.565547 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.fact_waterlevel
[0m11:09:15.565929 [info ] [Thread-1 (]: 1 of 1 START sql incremental model fact.fact_waterlevel ........................ [RUN]
[0m11:09:15.566305 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_dim, now model.etl_waterlevel.fact_waterlevel)
[0m11:09:15.566578 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.fact_waterlevel
[0m11:09:15.573677 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.fact_waterlevel"
[0m11:09:15.574567 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.fact_waterlevel
[0m11:09:15.603102 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m11:09:15.603472 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

    
  
    

  create temporary table "fact_waterlevel__dbt_tmp110915590877"
  
  
    as
  
  (
    

with main as (
    select
        distinct
        concat("stationId",'_',"stationCode") as station_key,
        "stationId" as station_id,
        "stationCode" as station_code,
        "waterLevel" as water_level,
        "waterlevelStatus" as waterlevel_status,
        case
            when "waterlevelStatus" = 3 then '🚨 Beyond Danger'
            when "waterlevelStatus" = 2 then '⚠️ Between Warning and Danger'
            when "waterlevelStatus" = 1 then '🔶 Between Alert and Warning'
            when "waterlevelStatus" = 0 then '✅ Between Normal and Alert'
            when "waterlevelStatus" = -1 then '🟢 Below Normal (Safe)'
            else '❓ Unknown Status'
        end as waterlevel_condition,
        "stationName",
        "districtName",
        to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp AS last_update
    from
        raw.waterlevels w
    where
        "stationStatus" = 1

        
        /* This condition is important to avoid reprocessing old data */
        and to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp > (
            select max(last_update) from "airflow"."fact"."fact_waterlevel"
        )
        
)

select * from main
  );
  
  
[0m11:09:15.603831 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:09:15.622122 [debug] [Thread-1 (]: SQL status: SELECT 73 in 0.018 seconds
[0m11:09:15.629633 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m11:09:15.629946 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: BEGIN
[0m11:09:15.630353 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m11:09:15.630709 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m11:09:15.630985 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp110915590877'
        
      order by ordinal_position

  
[0m11:09:15.633829 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.003 seconds
[0m11:09:15.636586 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m11:09:15.636907 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m11:09:15.638324 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m11:09:15.644854 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m11:09:15.645189 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp110915590877'
        
      order by ordinal_position

  
[0m11:09:15.646421 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m11:09:15.648122 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m11:09:15.648473 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m11:09:15.649673 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m11:09:15.654324 [debug] [Thread-1 (]: 
    In "airflow"."fact"."fact_waterlevel":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m11:09:15.657813 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.fact_waterlevel"
[0m11:09:15.658686 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m11:09:15.658984 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      insert into "airflow"."fact"."fact_waterlevel" ("station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update")
    (
        select "station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update"
        from "fact_waterlevel__dbt_tmp110915590877"
    )


  
[0m11:09:15.659689 [debug] [Thread-1 (]: SQL status: INSERT 0 73 in 0.000 seconds
[0m11:09:15.667646 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m11:09:15.667951 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m11:09:15.668226 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m11:09:15.669269 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m11:09:15.670334 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: Close
[0m11:09:15.671542 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8fc2fef2-21fa-419d-8732-811454d671d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb874e770>]}
[0m11:09:15.672013 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model fact.fact_waterlevel ................... [[32mINSERT 0 73[0m in 0.10s]
[0m11:09:15.672391 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.fact_waterlevel
[0m11:09:15.673114 [debug] [MainThread]: Using postgres connection "master"
[0m11:09:15.673354 [debug] [MainThread]: On master: BEGIN
[0m11:09:15.673551 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:09:15.675175 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m11:09:15.675461 [debug] [MainThread]: On master: COMMIT
[0m11:09:15.675691 [debug] [MainThread]: Using postgres connection "master"
[0m11:09:15.675884 [debug] [MainThread]: On master: COMMIT
[0m11:09:15.676137 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:09:15.676337 [debug] [MainThread]: On master: Close
[0m11:09:15.676609 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:09:15.676865 [debug] [MainThread]: Connection 'model.etl_waterlevel.fact_waterlevel' was properly closed.
[0m11:09:15.677120 [info ] [MainThread]: 
[0m11:09:15.677355 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.20 seconds (0.20s).
[0m11:09:15.677722 [debug] [MainThread]: Command end result
[0m11:09:15.692673 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m11:09:15.693728 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m11:09:15.697314 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m11:09:15.697579 [info ] [MainThread]: 
[0m11:09:15.697862 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:09:15.698092 [info ] [MainThread]: 
[0m11:09:15.698320 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:09:15.698877 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.5302711, "process_in_blocks": "0", "process_kernel_time": 0.129382, "process_mem_max_rss": "111396", "process_out_blocks": "1701", "process_user_time": 1.262972}
[0m11:09:15.699259 [debug] [MainThread]: Command `dbt run` succeeded at 11:09:15.699202 after 0.53 seconds
[0m11:09:15.699535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb65982e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb65b3550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5659e10>]}
[0m11:09:15.699806 [debug] [MainThread]: Flushing usage events
[0m11:09:17.191996 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:07:07.465900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b250310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a34c520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a34c580>]}


============================== 12:07:07.469662 | 0b37ee68-7c8b-4441-a14a-5226999ca5f5 ==============================
[0m12:07:07.469662 [info ] [MainThread]: Running with dbt=1.9.0
[0m12:07:07.470068 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --models fact_waterlevel', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:07:07.562855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0b37ee68-7c8b-4441-a14a-5226999ca5f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff999e6290>]}
[0m12:07:07.589656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0b37ee68-7c8b-4441-a14a-5226999ca5f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b19c1c0>]}
[0m12:07:07.590153 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:07:07.626569 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m12:07:07.678213 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:07:07.678567 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:07:07.681802 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.etl_waterlevel.staging
[0m12:07:07.693753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0b37ee68-7c8b-4441-a14a-5226999ca5f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99570550>]}
[0m12:07:07.729947 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m12:07:07.733731 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m12:07:07.745523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0b37ee68-7c8b-4441-a14a-5226999ca5f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9958f220>]}
[0m12:07:07.746005 [info ] [MainThread]: Found 3 models, 434 macros
[0m12:07:07.746307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b37ee68-7c8b-4441-a14a-5226999ca5f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9958f1c0>]}
[0m12:07:07.747152 [info ] [MainThread]: 
[0m12:07:07.747446 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:07:07.747680 [info ] [MainThread]: 
[0m12:07:07.748086 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:07:07.748764 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m12:07:07.793967 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m12:07:07.794359 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m12:07:07.794662 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:07:07.798015 [debug] [ThreadPool]: SQL status: SELECT 36 in 0.003 seconds
[0m12:07:07.798824 [debug] [ThreadPool]: On list_airflow: Close
[0m12:07:07.801555 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_fact)
[0m12:07:07.804786 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m12:07:07.805080 [debug] [ThreadPool]: On list_airflow_fact: BEGIN
[0m12:07:07.805328 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:07:07.807176 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m12:07:07.807587 [debug] [ThreadPool]: Using postgres connection "list_airflow_fact"
[0m12:07:07.807853 [debug] [ThreadPool]: On list_airflow_fact: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_fact"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'fact'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'fact'
  
[0m12:07:07.809373 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m12:07:07.810035 [debug] [ThreadPool]: On list_airflow_fact: ROLLBACK
[0m12:07:07.810379 [debug] [ThreadPool]: On list_airflow_fact: Close
[0m12:07:07.810796 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_fact, now list_airflow_dim)
[0m12:07:07.812132 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m12:07:07.812414 [debug] [ThreadPool]: On list_airflow_dim: BEGIN
[0m12:07:07.812655 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:07:07.814205 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m12:07:07.814552 [debug] [ThreadPool]: Using postgres connection "list_airflow_dim"
[0m12:07:07.814816 [debug] [ThreadPool]: On list_airflow_dim: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "list_airflow_dim"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dim'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dim'
  
[0m12:07:07.816068 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.001 seconds
[0m12:07:07.816708 [debug] [ThreadPool]: On list_airflow_dim: ROLLBACK
[0m12:07:07.817024 [debug] [ThreadPool]: On list_airflow_dim: Close
[0m12:07:07.819578 [debug] [MainThread]: Using postgres connection "master"
[0m12:07:07.819843 [debug] [MainThread]: On master: BEGIN
[0m12:07:07.820088 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:07:07.821603 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m12:07:07.821927 [debug] [MainThread]: Using postgres connection "master"
[0m12:07:07.822227 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:07:07.825209 [debug] [MainThread]: SQL status: SELECT 2 in 0.003 seconds
[0m12:07:07.825861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b37ee68-7c8b-4441-a14a-5226999ca5f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cbd1f00>]}
[0m12:07:07.826186 [debug] [MainThread]: On master: ROLLBACK
[0m12:07:07.826565 [debug] [MainThread]: Using postgres connection "master"
[0m12:07:07.826814 [debug] [MainThread]: On master: BEGIN
[0m12:07:07.827215 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:07:07.827582 [debug] [MainThread]: On master: COMMIT
[0m12:07:07.827870 [debug] [MainThread]: Using postgres connection "master"
[0m12:07:07.828104 [debug] [MainThread]: On master: COMMIT
[0m12:07:07.828430 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:07:07.828674 [debug] [MainThread]: On master: Close
[0m12:07:07.829852 [debug] [Thread-1 (]: Began running node model.etl_waterlevel.fact_waterlevel
[0m12:07:07.830235 [info ] [Thread-1 (]: 1 of 1 START sql incremental model fact.fact_waterlevel ........................ [RUN]
[0m12:07:07.830604 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_dim, now model.etl_waterlevel.fact_waterlevel)
[0m12:07:07.830879 [debug] [Thread-1 (]: Began compiling node model.etl_waterlevel.fact_waterlevel
[0m12:07:07.837997 [debug] [Thread-1 (]: Writing injected SQL for node "model.etl_waterlevel.fact_waterlevel"
[0m12:07:07.839209 [debug] [Thread-1 (]: Began executing node model.etl_waterlevel.fact_waterlevel
[0m12:07:07.868141 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m12:07:07.868496 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

    
  
    

  create temporary table "fact_waterlevel__dbt_tmp120707855178"
  
  
    as
  
  (
    

with main as (
    select
        distinct
        concat("stationId",'_',"stationCode") as station_key,
        "stationId" as station_id,
        "stationCode" as station_code,
        "waterLevel" as water_level,
        "waterlevelStatus" as waterlevel_status,
        case
            when "waterlevelStatus" = 3 then '🚨 Beyond Danger'
            when "waterlevelStatus" = 2 then '⚠️ Between Warning and Danger'
            when "waterlevelStatus" = 1 then '🔶 Between Alert and Warning'
            when "waterlevelStatus" = 0 then '✅ Between Normal and Alert'
            when "waterlevelStatus" = -1 then '🟢 Below Normal (Safe)'
            else '❓ Unknown Status'
        end as waterlevel_condition,
        "stationName",
        "districtName",
        to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp AS last_update
    from
        raw.waterlevels w
    where
        "stationStatus" = 1

        
        /* This condition is important to avoid reprocessing old data */
        and to_timestamp("lastUpdate", 'DD/MM/YYYY HH24:MI:SS')::timestamp > (
            select max(last_update) from "airflow"."fact"."fact_waterlevel"
        )
        
)

select * from main
  );
  
  
[0m12:07:07.868813 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:07:07.886755 [debug] [Thread-1 (]: SQL status: SELECT 73 in 0.018 seconds
[0m12:07:07.893990 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m12:07:07.894301 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: BEGIN
[0m12:07:07.894733 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m12:07:07.895075 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m12:07:07.895361 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp120707855178'
        
      order by ordinal_position

  
[0m12:07:07.898376 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.003 seconds
[0m12:07:07.901005 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m12:07:07.901312 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m12:07:07.902683 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m12:07:07.909122 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m12:07:07.909450 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel__dbt_tmp120707855178'
        
      order by ordinal_position

  
[0m12:07:07.910690 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m12:07:07.912393 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m12:07:07.912722 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airflow".INFORMATION_SCHEMA.columns
      where table_name = 'fact_waterlevel'
        
        and table_schema = 'fact'
        
      order by ordinal_position

  
[0m12:07:07.913909 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m12:07:07.918460 [debug] [Thread-1 (]: 
    In "airflow"."fact"."fact_waterlevel":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m12:07:07.921905 [debug] [Thread-1 (]: Writing runtime sql for node "model.etl_waterlevel.fact_waterlevel"
[0m12:07:07.922883 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m12:07:07.923179 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "etl_waterlevel", "target_name": "dev", "node_id": "model.etl_waterlevel.fact_waterlevel"} */

      insert into "airflow"."fact"."fact_waterlevel" ("station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update")
    (
        select "station_key", "station_id", "station_code", "water_level", "waterlevel_status", "waterlevel_condition", "stationName", "districtName", "last_update"
        from "fact_waterlevel__dbt_tmp120707855178"
    )


  
[0m12:07:07.923757 [debug] [Thread-1 (]: SQL status: INSERT 0 73 in 0.000 seconds
[0m12:07:07.931369 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m12:07:07.931653 [debug] [Thread-1 (]: Using postgres connection "model.etl_waterlevel.fact_waterlevel"
[0m12:07:07.931889 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: COMMIT
[0m12:07:07.932957 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m12:07:07.933982 [debug] [Thread-1 (]: On model.etl_waterlevel.fact_waterlevel: Close
[0m12:07:07.935055 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b37ee68-7c8b-4441-a14a-5226999ca5f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d3c27a0>]}
[0m12:07:07.935648 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model fact.fact_waterlevel ................... [[32mINSERT 0 73[0m in 0.10s]
[0m12:07:07.936092 [debug] [Thread-1 (]: Finished running node model.etl_waterlevel.fact_waterlevel
[0m12:07:07.936838 [debug] [MainThread]: Using postgres connection "master"
[0m12:07:07.937068 [debug] [MainThread]: On master: BEGIN
[0m12:07:07.937263 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:07:07.938777 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m12:07:07.939053 [debug] [MainThread]: On master: COMMIT
[0m12:07:07.939264 [debug] [MainThread]: Using postgres connection "master"
[0m12:07:07.939461 [debug] [MainThread]: On master: COMMIT
[0m12:07:07.939713 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:07:07.939913 [debug] [MainThread]: On master: Close
[0m12:07:07.940176 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:07:07.940391 [debug] [MainThread]: Connection 'model.etl_waterlevel.fact_waterlevel' was properly closed.
[0m12:07:07.940603 [info ] [MainThread]: 
[0m12:07:07.940825 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.19 seconds (0.19s).
[0m12:07:07.941209 [debug] [MainThread]: Command end result
[0m12:07:07.955491 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m12:07:07.956581 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m12:07:07.960072 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m12:07:07.960296 [info ] [MainThread]: 
[0m12:07:07.960560 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:07:07.960813 [info ] [MainThread]: 
[0m12:07:07.961229 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:07:07.961846 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.5246185, "process_in_blocks": "0", "process_kernel_time": 0.126813, "process_mem_max_rss": "111284", "process_out_blocks": "1701", "process_user_time": 1.238178}
[0m12:07:07.962200 [debug] [MainThread]: Command `dbt run` succeeded at 12:07:07.962149 after 0.53 seconds
[0m12:07:07.962471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b250310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff999e6290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b2bf6d0>]}
[0m12:07:07.962728 [debug] [MainThread]: Flushing usage events
[0m12:07:09.416051 [debug] [MainThread]: An error was encountered while trying to flush usage events
